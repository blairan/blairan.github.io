<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Wemos mini+é»ç‡ˆapp+å°ç±³éŸ³ç®±æ§åˆ¶å®¤å…§ç‡ˆ</title>
      <link href="/2021/12/29/wemos-mini-dian-deng-app-xiao-mi-yin-xiang-kong-zhi-shi-nei-deng/"/>
      <url>/2021/12/29/wemos-mini-dian-deng-app-xiao-mi-yin-xiang-kong-zhi-shi-nei-deng/</url>
      
        <content type="html"><![CDATA[<h1 id="Wemos-mini-é»ç‡ˆapp-å°ç±³éŸ³ç®±æ§åˆ¶å®¤å…§ç‡ˆ"><a href="#Wemos-mini-é»ç‡ˆapp-å°ç±³éŸ³ç®±æ§åˆ¶å®¤å…§ç‡ˆ" class="headerlink" title="Wemos mini+é»ç‡ˆapp+å°ç±³éŸ³ç®±æ§åˆ¶å®¤å…§ç‡ˆ"></a>Wemos mini+é»ç‡ˆapp+å°ç±³éŸ³ç®±æ§åˆ¶å®¤å…§ç‡ˆ</h1><h6 id="tags-esp8266-blinker-é»ç‡ˆ-å°ç±³"><a href="#tags-esp8266-blinker-é»ç‡ˆ-å°ç±³" class="headerlink" title="tags: esp8266 blinker é»ç‡ˆ å°ç±³"></a>tags: <code>esp8266</code> <code>blinker</code> <code>é»ç‡ˆ</code> <code>å°ç±³</code></h6><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>ç”±æ–¼å®¶è£¡ä½¿ç”¨å°ç±³éŸ³ç®±å¹¾å¹´ä¸‹ä¾†ï¼Œä¹Ÿè²·äº†ä¸€å€‹æ™ºèƒ½æ’åº§ï¼Œ</p><p>ä¸¦ä¸”ä½¿ç”¨å°ç±³æ‰‹ç’°ï¼Œå¸¸å¸¸åœ¨å¤–å°±èƒ½æ§åˆ¶å®¶é›»æˆäº†æˆ‘åœ¨å‰µ</p><p>ä½œçš„è€ƒé‡ï¼Œåœ¨ç¶²è·¯ä¸Šå¶ç„¶çœ‹åˆ°å¤§é™¸æœ‰ä¸€æ¬¾é»ç‡ˆAppï¼Œå®ƒ</p><p>æœ‰ç¶²ç«™ï¼Œä¸¦ä¸”æœ‰é™„å¾ˆå¤šçš„æ•å­¸ï¼Œé‡é»æ˜¯å®ƒå¯ä»¥æ¥å…¥å°ç±³</p><p>éŸ³ç®±ï¼Œæ‰€ä»¥æˆ‘å°±è©¦è©¦åšå‡ºä¸€å€‹å®¤å…§ç‡ˆä¾†ç‰©è¯ä¸€ä¸‹ã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/637809851175296312#">é»ç‡ˆç§‘æŠ€</a></p><p><a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/637809851175296312#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEixntAgGkVemUrN-E9pE3YuSjR68W98mgrXaUebHs6MUB3WcawIZG_QFAGVkZJlKfb-C_yYzw5uF9Qn2FOX5rBgkN76XYuUjRfjJGBljaP6-wSTmyJ7aUAF61dSlYIOSBVcrVHhEYgkLdb5ciRsoszJxGDFTNZlN-0657kzovgC-oPLWT092dQTWLfZ=w705-h313"></a></p><p>æ¯”è¼ƒå¯æƒœçš„æ˜¯ï¼Œç¾åœ¨å¤§é™¸çš„ç¶²ç«™éƒ½è¦å¯¦ååˆ¶å±…å¤šï¼Œæ‰€</p><p>ä»¥è¦é€éå¤§é™¸æœ‹å‹çš„æ‰‹æ©Ÿå¯¦åä¸€ä¸‹æ‰èƒ½ä½¿ç”¨</p><h2 id="æˆæœ"><a href="#æˆæœ" class="headerlink" title="æˆæœ"></a>æˆæœ</h2><p><strong>æ¸¬è©¦</strong></p><div class="video-container"><iframe src="https://www.youtube.com/embed/c0LwOdTvTXA" frameborder="0" loading="lazy" allowfullscreen></iframe></div><p><strong>ä½¿ç”¨appé–‹ç‡ˆ</strong></p><div class="video-container"><iframe src="https://www.youtube.com/embed/mQ9UM-wkp8w" frameborder="0" loading="lazy" allowfullscreen></iframe></div><p><strong>å‘¼å–šå°æ„›é–‹ç‡ˆ</strong></p><div class="video-container"><iframe src="https://www.youtube.com/embed/e2hEN39lIsE" frameborder="0" loading="lazy" allowfullscreen></iframe></div><h2 id="ææ–™"><a href="#ææ–™" class="headerlink" title="ææ–™"></a>ææ–™</h2><p>WEMOS D1 MINI</p><p>D1 MINIæ“´å±•ç¹¼é›»å™¨</p><p>æ’é ­å¼ç‡ˆåº§</p><p>ç‡ˆæ³¡</p><p>äº¤æµ110Vè½‰ç›´æµ5Vè®Šå£“å™¨æ¨¡çµ„</p><p>å°ç±³éŸ³ç®±</p><p>é»ç‡ˆApp</p><h2 id="æµç¨‹åœ–"><a href="#æµç¨‹åœ–" class="headerlink" title="æµç¨‹åœ–"></a>æµç¨‹åœ–</h2><p><a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/637809851175296312#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEiM2D4rvXJajh8FhX7fBa7SQEA5Oe-VhxKCa9gVv8ShXS8sByJj1f24So8tKkEWxS-6qAxZZIch5Jo8xcQqCEXfvOwSYzHQG2N0CnhqnhoZI4GamlQ5LWaTbBiwLNBPix3ICy0wdAZhTsBkWJcguj3LiAiS96D_IMgczn8o-4leMlsqum-K8V7ap0am=w829-h494"></a></p><h2 id="å¯¦ä½œ"><a href="#å¯¦ä½œ" class="headerlink" title="å¯¦ä½œ"></a>å¯¦ä½œ</h2><h3 id="æ”¹é€ æ’åº§"><a href="#æ”¹é€ æ’åº§" class="headerlink" title="æ”¹é€ æ’åº§"></a>æ”¹é€ æ’åº§</h3><p>(é è¨­æ˜¯ç”¨D1 MINIæ“´å±•ç¹¼é›»å™¨è…³ä½è¼¸å‡ºç«¯æ‰æ˜¯åœ¨D5)</p><p><a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/637809851175296312#"><img src="https://lh3.googleusercontent.com/-L99U1cMxDqE/Ycp2_NipJuI/AAAAAAAAfIs/eJco8C5kYFoXEl5i0p8K6GhWgrLZZGA1wCNcBGAsYHQ/s1600/1640658666951677-0.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/637809851175296312#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEiX2UaeFg12G1HeBIUSpUSOKroYk_1AMMQ3_nwUI5pmS2MHs0W_XC0Vl7l-ZV-1VOtGZ2X_kkGe-zr9Dse9ynwNfjmGJmLjJwCWWlX7p9QYMjZDzC9bmw9vk6XCgg9ompfcBZUVUNZDLupMgyzo0M5B3XvDzBVZzVX_zmYae6e9ecwGOqUF-HSqOkQC=w304-h644"></a></p><h3 id="è¨­å®šBlinkerAPP"><a href="#è¨­å®šBlinkerAPP" class="headerlink" title="è¨­å®šBlinkerAPP"></a>è¨­å®šBlinkerAPP</h3><div class="video-container"><iframe src="https://www.youtube.com/embed/IchXdK3neoc" frameborder="0" loading="lazy" allowfullscreen></iframe></div><h3 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h3><p><a href="https://blogger.googleusercontent.com/img/a/AVvXsEiHQGlUHYCtnMhWTPs4OkaxwM4KgtpmiLclvbr8BhJL46npjkJv__R_jkpMSIcCuRBYpguRiWj_kXhy_Xsi4agPIhhEFBmC2yEYWF8QbzMdQKbgb2qEnfVJ5KEsPoaa5jqQb-7qY8-FmOnqW36G3188PjPDOIi1PferZ05YuSyds_yJy-v3E8O1TmJT=s1625"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEiHQGlUHYCtnMhWTPs4OkaxwM4KgtpmiLclvbr8BhJL46npjkJv__R_jkpMSIcCuRBYpguRiWj_kXhy_Xsi4agPIhhEFBmC2yEYWF8QbzMdQKbgb2qEnfVJ5KEsPoaa5jqQb-7qY8-FmOnqW36G3188PjPDOIi1PferZ05YuSyds_yJy-v3E8O1TmJT=w729-h310"></a></p><h3 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h3><p><em>è¦å…ˆå»<a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/637809851175296312#">https://diandeng.tech/dev</a>ä¸‹è¼‰å‡½å¼åº«,ç”¨ArduinoIDEçš„åŒ¯å…¥.ZIPçš„æ–¹å¼åŒ¯å…¥</em></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#define BLINKER_WIFI#define BLINKER\_MIOT\_LIGHT#include &lt;Blinker.h&gt;  const char* auth &#x3D; &quot;b868-------&quot;;const char* ssid &#x3D; &quot;19N_2F-2.4G&quot;;&#x2F;&#x2F;const char* ssid &#x3D; &quot;CTK&quot;;const char* pswd &#x3D; &quot;c-----&quot;;  &#x2F;&#x2F; æ–°å»ºç»„ä»¶å¯¹è±¡BlinkerButton Button1(&quot;btn-room&quot;);&#x2F;&#x2F;&quot;btn&#x3D;room&quot;è¦è·Ÿæ‰‹æ©Ÿappè£¡è¨­çš„ä¸€æ¨£  const int pin&#x3D;5;  void miopowerState(const String&amp;state)&#123;Â  BLINKER_LOG(&quot;get powerstate state: &quot;, state);Â  if (state&#x3D;&#x3D;BLINKER\_CMD\_ON)&#123;Â  Â  Â  digitalWrite(LED_BUILTIN, LOW);Â  Â  Â  digitalWrite(pin, HIGH);Â  Â  Â  BlinkerMIOT.powerState(&quot;on&quot;);Â  Â  Â  BlinkerMIOT.print();Â  &#125;else if (state&#x3D;&#x3D;BLINKER\_CMD\_OFF)&#123;Â  Â  Â  digitalWrite(LED_BUILTIN, HIGH);Â  Â  Â  digitalWrite(pin, LOW);Â  Â  Â  BlinkerMIOT.powerState(&quot;off&quot;);Â  Â  Â  BlinkerMIOT.print();Â  &#125;Â  if (digitalRead(pin)&#x3D;&#x3D;HIGH)&#123;Â  Â  Button1.color(&quot;#FF0000&quot;);Â  Â  Button1.print(&quot;on&quot;);Â  &#125;else if (digitalRead(pin)&#x3D;&#x3D;LOW)&#123;Â  Â  Button1.color(&quot;#FF8000&quot;);Â  Â  Button1.print(&quot;off&quot;);Â  &#125;Â  Button1.print();&#125;  &#x2F;&#x2F; æŒ‰ä¸‹æŒ‰é”®å³ä¼šæ‰§è¡Œè¯¥å‡½æ•°void button1_callback(const String&amp;state)&#123;Â  BLINKER_LOG(&quot;get powerstate state: &quot;, state);Â  digitalWrite(LED_BUILTIN, !digitalRead(LED_BUILTIN));Â  digitalWrite(pin, !digitalRead(pin));Â  if (digitalRead(pin)&#x3D;&#x3D;HIGH)&#123;Â  Â  Button1.color(&quot;#FF0000&quot;);Â  Â  Button1.print(&quot;on&quot;);Â  &#125;else if (digitalRead(pin)&#x3D;&#x3D;LOW)&#123;Â  Â  Button1.color(&quot;#FF8000&quot;);Â  Â  Button1.print(&quot;off&quot;);Â  &#125;Â  Button1.print();&#125;  void setup() &#123;Â  Serial.begin(115200);Â  pinMode(LED_BUILTIN, OUTPUT);Â  pinMode(pin, OUTPUT);Â  digitalWrite(LED_BUILTIN, HIGH);Â  digitalWrite(pin, LOW);Â  &#x2F;&#x2F; åˆå§‹åŒ–blinkerÂ  Blinker.begin(auth, ssid, pswd);Â  Button1.attach(button1_callback);Â  BlinkerMIOT.attachPowerState(miopowerState);&#125;  void loop() &#123;Â  Blinker.run();&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> blinker </category>
          
          <category> wemos d1 mini </category>
          
          <category> å°æ„›åŒå­¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> esp8266 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQTT-DashBoard+æº«æ¿•åº¦+OLED-ESP32</title>
      <link href="/2021/11/24/mqtt-dashboard-wen-shi-du-oled-esp32/"/>
      <url>/2021/11/24/mqtt-dashboard-wen-shi-du-oled-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="MQTT-DashBoard-æº«æ¿•åº¦-OLED-ESP32"><a href="#MQTT-DashBoard-æº«æ¿•åº¦-OLED-ESP32" class="headerlink" title="MQTT-DashBoard+æº«æ¿•åº¦+OLED-ESP32"></a>MQTT-DashBoard+æº«æ¿•åº¦+OLED-ESP32</h1><h3 id="æ‰‹æ©ŸAPPä¸Šçš„é¡¯ç¤º"><a href="#æ‰‹æ©ŸAPPä¸Šçš„é¡¯ç¤º" class="headerlink" title="æ‰‹æ©ŸAPPä¸Šçš„é¡¯ç¤º"></a><strong>æ‰‹æ©ŸAPPä¸Šçš„é¡¯ç¤º</strong></h3><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEiYi1pizLpB1f8sp20nVhZvRgsoM0FoAydPfmqpyrDawABQEEj1NITwqC7eF5JHlU0jdVwiEOanEi-KgnluiSYCQbwJtxucnG6pK1fvpqILvyTChtuSy5ZXWkBbvU3nV5c2QjZNweThwNIog2MymwsB18v3fmzfSk9E5n-fyYvVNnO6WtbU12-XRi9J=w406-h632"></a></p><h3 id="DashBoardä¸Šçš„é¡¯ç¤º"><a href="#DashBoardä¸Šçš„é¡¯ç¤º" class="headerlink" title="DashBoardä¸Šçš„é¡¯ç¤º"></a>DashBoardä¸Šçš„é¡¯ç¤º</h3><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEgzeV_egiLtXjXWyBUkc0VqlHYqQBP9nsu-0-8JbqCVfx5v1chZGpRMDidhEx6j3jW8_yEKan7T-c0SMlq6J_Zpi6Gh0HpZAlneizrVLFD45DdVGHyjVvgrA2BvhUyJW9HN6vUjrtutBakE3CyrTc8lsiBN-7ibuhSUhOUs6q4x59A7bYCsft4aS426=w818-h363"></a></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å› ç‚ºæ•´å€‹æµç¨‹æœ‰é»è¤‡é›œ,æ‰€ä»¥æˆ‘æŠŠå®ƒå¯«æˆæµç¨‹åœ–æ¯”è¼ƒå®¹æ˜“ç†è§£ã€‚<br>ç•¶æ™‚æˆ‘çš„æ§‹æƒ³æ˜¯æƒ³åšå¤©æ°£æ™‚é˜ï¼Œè©¦éç”¨æ™‚é˜æ¨¡çµ„é¡¯ç¤ºæ™‚é–“ï¼Œä½†å› ç‚ºæ¨¡çµ„æœ¬èº«æ™‚é–“ä¸¦ä¸ç²¾æº–ï¼Œæ‰€ä»¥åªå¥½å–å€¼ç”¨å…¬é–‹APIä¾†ç¶“éæ¨¹è“æ´¾çš„Brokerçš„æ¨é€è®“ESP32è¨‚é–±topicï¼Œå¾Œä¾†ç™¼ç¾è¦è®“æ™‚é–“å’Œæº«æ¿•åº¦ä¸è¦ä»¥è¼ªæ›¿çš„æ–¹å¼åœ¨OLEDä¸Šé¡¯ç¤ºï¼Œåªå¥½åœ¨ESP32ç”¨ä¸ŠDHT11è®“å…¶åµæ¸¬æº«æ¿•åº¦ï¼Œæœ¬ä¾†æœ‰åšè©¦ç”¨æŒ‰éˆ•ä¾†åˆ‡æ›æ™‚é–“å’Œæº«æ¿•åº¦ï¼Œä½†æœ‰é»éº»ç…©ï¼Œæ‰€ä»¥å°±åªå…ˆå…¨é¡¯ç¤ºåœ¨ä¸€å€‹0.96çš„OLEDç„¶å¾Œæ‰‹æ©ŸAPPä¸Šä¹Ÿè¨‚é–±æ¨¹è“æ´¾çš„MQTTï¼Œå¦å¤–åœ¨DashBoardå¢åŠ ä¸€å€‹é–‹é—œä¾†æ§åˆ¶ESP32ä¸Šçš„LEDã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEic1sJoPNTrFGMPrEkJf7q7Q2fjoVAHHQ1x0tqI_DSvgwGOz57QeHv97eBkSvff5pmFqVshaAkfgtmJ-uBI4DoHAigevisD4n5GVf-Bg8nmM0dFwc2G4MrBI3j7OWLiMm5jlTKUkcKP-fTGHQ4udE4hPzXvBiYUNA3cj66LsBTMELxsznWxJ4Qro3o5=w598-h400"></a></p><p>Â </p><hr><h2 id="æ¥ç·šåœ–"><a href="#æ¥ç·šåœ–" class="headerlink" title="æ¥ç·šåœ–"></a>æ¥ç·šåœ–</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#"><img src="https://1.bp.blogspot.com/-oicXzD5wEek/YYDTVlMRiVI/AAAAAAAAfAQ/K5TlzcHzC0o2_rv_RZm8k9E4ec58vmgSwCNcBGAsYHQ/w649-h601/image.png"></a></p><hr><h2 id="æ¨¹è“æ´¾Node-RED"><a href="#æ¨¹è“æ´¾Node-RED" class="headerlink" title="æ¨¹è“æ´¾Node-RED"></a>æ¨¹è“æ´¾Node-RED</h2><p><strong>é–‹å§‹ä¹‹å‰å…ˆå‚™å¦¥æ¨¹è“æ´¾ä¸Šæ‰€é ˆçš„è»Ÿç¡¬é«”</strong></p><ol><li> <strong><em>å®‰è£<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#">Mosquitto broker</a>(å¦‚æœæ²’ç©éæ¨¹è“æ´¾,è«‹é€£çµ<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#">é€™è£¡</a>å®‰è£æ¨¹è“æ´¾ç³»çµ±å’Œ<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#">å¦‚</a></em></strong></li><li> <strong><em><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#">ä½•ä½¿ç”¨SSHå’ŒVNCé¡åƒ</a>)</em></strong></li><li> <strong><em>å®‰è£ <a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#">Node-RED installed</a>Â Â å’ŒÂ <a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#">Node-RED Dashboard</a>åœ¨æ¨¹è“æ´¾ä¸Šã€‚</em></strong></li><li> <strong>_å‚™è¨»:å®‰è£Node-REDæ™‚è‹¥å‡ºç¾éŒ¯èª¤è¨Šæ¯æ”¹ç”¨ä¸‹é¢æ‰€é™„ä¸‹è¼‰ _****<em>bash &lt;(curl -sL <a href="https://raw.githubusercontent.com/node-red/linux-installers/master/deb/update-nodejs-and-nodered">https://raw.githubusercontent.com/node-red/linux-installers/master/deb/update-nodejs-and-nodered</a>)</em></strong></li><li><strong><em>æ¥ä¸‹ä¾†å…ˆæ¸¬è©¦BMP280æ˜¯å¦å¯æ­£å¸¸æ¸¬æº«åº¦å’Œå£“åŠ›-è«‹åƒè€ƒä¹‹å‰çš„ç´€éŒ„(<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#">é»æˆ‘å‚³é€</a>)ã€‚</em></strong></li></ol><p><em><strong>å…ˆä¾†çœ‹ä¸€ä¸‹æ•´å€‹ç™¼é€åŸç†æ¯”è¼ƒå®¹æ˜“ç†è§£è‡ªå·±è¦å­¸çš„é‡é»åœ¨å“ªè£¡</strong></em></p><p><em><strong>æ­¤æ¬¡å¯¦é©—æˆ‘åªå¯«å¾ESP32ç™¼é€æ•¸æ“šåˆ°æ¨¹è“æ´¾çš„Mosquittoä»£ç†æ¥æ”¶/ç™¼é€</strong></em></p><p><em><strong>ç„¶å¾Œé€šéMQTTé€šä¿¡å”è­°å»æ§åˆ¶ESP32ç™¼é€æ•¸æ“šåˆ°Node-RED,å…¶å¯¦æˆ‘è¦º</strong></em></p><p><em><strong>å¾—å’ŒThingSpeakå¾ˆé¡ä¼¼,åªæ˜¯ä½¿ç”¨Node-REDæ›´èƒ½å®¢è£½åŒ–ã€‚</strong></em></p><p><em><strong>çœ‹ä¸€ä¸‹é€™å¼µåœ–</strong></em></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#"><strong><img src="https://lh3.googleusercontent.com/-dbEK49_w9_A/YQP1Mii2utI/AAAAAAAAelI/zvaBPu6JqXIcyeXVPyqIHhOt6CVSYkCrgCNcBGAsYHQ/w642-h341/image.png"></strong></a></p><h2 id="Node-Redé…ç½®"><a href="#Node-Redé…ç½®" class="headerlink" title="Node-Redé…ç½®"></a>Node-Redé…ç½®</h2><p><strong>DashBoardé…ç½®æª”â€“<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#">https://github.com/blairan/esp32.git</a></strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEjYzRzB1LGB2uRGLNtyqHrKI8o0I6djuq3Ndsc0Qf8sA1pHSAb_W4J9Bf6IEAYvBC2u06uvf9kEzR9efWqmEAo3bJ57wYpDaYsXVUZhplWLGgVQdJlzlDYrNpuScbNNfTJtRTcBtpsM8J5QORhMchfpwaiX23wNyPGfqtBXJEv2hA2it_IXkAUEeIFX=w809-h360"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEgTc1J_l9qUq4Uv8I85JUIfEmplhNPVoLQKNgPccjhzJSx-AkSahWOZJGSZZF0OsYOkRJXi-vPmJK8Q61dbOSV4WPQLtLNaHCe3AZkSHa4kKhK9Y4lWfdg2hNnd_ADAnIkDFC8HATm9_VKMSa_1z8irVCDW1dco5yQ_Vj-oUOwYhh7qs95LRtZu8BgH=w858-h381"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEirPqivf_M5GvNW0hMvykHAD3T1zK7DKbIv79sPS6lb1zu1bhWJLR2H3klBu9UkLmWMCyHKDGh_v3gLkW_GQA2vOQIfxxOApYHjenqYJo5nWv0_FYI6J6nxQI8_DPnRYA6OpeVWLcJUs2sJxz6zemPBHjZBwR16it-zepYst7cqRFj36IWyPEV7LxMF=w913-h405"></a></p><h2 id="æ‰‹æ©Ÿç«¯MQTTappè¨­å®š"><a href="#æ‰‹æ©Ÿç«¯MQTTappè¨­å®š" class="headerlink" title="æ‰‹æ©Ÿç«¯MQTTappè¨­å®š"></a>æ‰‹æ©Ÿç«¯MQTTappè¨­å®š</h2><p>åŸå‰‡ä¸Šæ³¨æ„Topicè¦å’ŒNODE-REDä¸Šçš„ä¸€è‡´æ‰èƒ½è¨‚é–±å’Œæ¨é€çš„åˆ°</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEivM8ABQ13x-Jk0HrCV-I7Fr5aNWJaxPhCh0CWZPcu_RtJXcWw3VhqOoB5Ky6xGFQXDAIRjqL85CqCnYGarphcewjQ5QASX2z5SS7pWIMrW1tTY6NylHOczrxWfQCPCQd_qIWyNl9omHWmLPV4rQM2pgk6X_2AeFX7T-EIcJtYrRKBlzWCq3gRI-DjU=w396-h787"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEjJxkJq9m5VPKmjNefbM3nVBLwLMUsPYo-5vVDQo92khdoyqYlTpnvXTf9uucF5nE5-MB_Y4jCpGupi1bIYjq5lcVeh5PJX6Dgr5u2KtWn7dFEdujvlMCUMirUTR-Ce4wBAU1NywGQF-nOc5FmuvfQwmF7tcBRiUzqdrDRjqd3EbhmnmBVpJgN_pSai=w395-h785"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEhUz2kL0xutbHzGOByBGHA-bdx6dUwtcbBYZZOnD3k6a2Jhi9e-K-GRbq-lyQ2tMJ-8if47Mnk24z5fquQD83HXprzaVwqt9Q3mht9woqRWUjWYu82dpzBm_qxXnb5RsF1SyFkMr7mHGWvwGTkr6XObbvQx5x98IX2FHNF32mElzQsIG57gjh5nNLM1=w397-h789"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEjDVWAr1ht_zTEo7AlYEMNefC2dlp5L7O0XAE2OZD9xciYPfduZ_pPEXd_NAmsyN08HuKHcVCgGMJ2WcXfOSofnbgGDf1RIev1xvsyQCN91OXBNurF6DmFkIpxNbKCKLVvkuiFkQJWgDMQZblN-0HHSHvC8DT-WnPDnPELGx19zbcImI6Mm3ohUwBmq=w374-h744"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEhJTiGEipxNu6TNOxWdhSwUeveTdSYT3CLVSAhQM24omXS-CpBX4FsVjf8u33upM831a9R16TgT0Woo76rfLkcxas7hDhThokYM567y4vfcUoF2d9a2axLikgIw5EaSX3gpJGtfFgiS77VuUWy1A1lWdGwcx4_5NVLjJG8TlWkKvouvT-H_RfErvtPh=w383-h762"></a></p><p>payloadæ˜¯NODE-REDè£¡é–‹é—œçš„æ§åˆ¶é …</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1989024688801179907#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEgEUl_lYIh0QvcFECrX4Ett9zhJETVyxQieuR5F9Bf7txP6wJ9cTqWql3RQMO0NbHNGsTDUef6zsRN8Q9H3gAClK5R-a3IrUvpAvvwH-h5G7yIOWxtnze-flL8jVWpUSKZLJscuotERT7gqqsajst7bUKwmwJINfNqtQ9FjE0hM5GcLYRHeljYsRm0d=w398-h796"></a></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><p>ç”¨åˆ°çš„å‡½å¼åº«,è‡ªè¡Œæœå°‹ä¸‹è¼‰</p><pre class="line-numbers language-none"><code class="language-none">U8g2libAdafruit_SensorWiFiClientPubSubClientAdafruit_SensorDHT<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>------------------------</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;U8g2lib.h&gt; &#x2F;&#x2F;è¼‰å…¥OLEDåº«#include &lt;Adafruit_Sensor.h&gt;#include &lt;WiFi.h&gt;#include &lt;WiFiClient.h&gt;#include &lt;PubSubClient.h&gt;#include &lt;Adafruit_Sensor.h&gt;#include &lt;DHT.h&gt;  const char* ssid&#x3D;&quot;CTK&quot;;const char* password&#x3D;&quot;------&quot;;const char* mqtt_server&#x3D;&quot;192.168.41.22&quot;;&#x2F;&#x2F;dht11#define DHTPIN 13#define DHTTYPE DHT11DHT dht(DHTPIN, DHTTYPE);  WiFiClient espClient;PubSubClient client(espClient);&#x2F;&#x2F;è¨‚é–±topicString SubDate&#x3D;&quot;esp32&#x2F;date&quot;;String sw&#x3D;&quot;esp32&#x2F;switch&quot;;U8G2_SSD1306_128X64_NONAME_1_HW_I2C u8g2(U8G2_R0, &#x2F;* reset&#x3D;*&#x2F; U8X8_PIN_NONE);&#x2F;&#x2F;è‡ªå®šç¾©è‡ªåº«const uint8_t myFont[1156] U8G2_FONT_SECTION(&quot;myFont&quot;) &#x3D;   &quot;&amp;\0\3\2\4\5\3\4\6\17\20\0\376\16\376\16\376\0\0\0\0\0\302%\24\247\212h\64))%&quot;  &quot;\221\222\306i\42%QR\322\24\0,\10Bn(\224D\1-\7\24\314(\206\0.\7\42\216(\206&quot;  &quot;\0\60\21\246\212\250\264(\11\265)Q\242ML\242L\2\61\13\245\214\250\62)\11\373\64\10\62\16\246&quot;  &quot;\212h\206$\24\323L\13\253\351\60\63\20\246\212h\206$\24\323hNE\61\31\22\0\64\20\246\212(&quot;  &quot;C-\211*Y\222%\303\230V\0\65\16\246\212(\16iu\220\323TL\206\4\66\16\246\212\250\246\60&quot;  &quot;M\7%tL\206\4\67\13\246\212(\256\305\264\230\66\1\70\17\246\212h\206$\64&amp;C\22:&amp;C&quot;  &quot;\2\71\16\246\212h\206$\64&amp;\203\332\30M\0:\10r\236(\206x\10\0\0\0\4\377\377N-\35&quot;  &quot;\13mps,\307r,\35\36C\61\24C\61\24\303\341!\254\346X\216\345X\12Y\32\42\14kp&quot;  &quot;s\60\307\206!L\263\61\7\242\34Rb)\334\206\265\246FR\226#uH\7\346\35\2[\214%\17&quot;  &quot;i\260sJ\216\14\17J\216\352h\70\334\71\17\17q\226cu\254\16\205Y\32fa\232E:\60$&quot;  &quot;\0]\362\37\354|\60\36r\60\7s\60\312\221(G\242\341\20\345&#96;\16\346&#96;\216\351\230\216%\303A&quot;  &quot;^t%\17i\360rBNx\320\322\34Is \316\241\341\220\206\71\24\346P\30\17\337\221\234\220\23&quot;  &quot;rBN\210\1^\246%\17i\360\201\234\222#\303C\224\225\263\362\360\326\234\225\263A\316\11\311\60\250&quot;  &quot;Q\32\326\322t\15\65u\7\6b\20)\17i\360\241$G\243\34\314\201\17Q\234\3q\16\304Y\66&quot;  &quot;HYS\326%\314*a\26F\225\232\224d\245\244\34\316\5e\345\34\371n\60\36r@\7t@\7&quot;  &quot;t\340A\7t@\7t@\7t\340A\7\2fB(\16k\360\241\34\16\7\261\226\14C\222\205\265&quot;  &quot;\260\66|\216\262\70\312\222\341\26GY\224E\203\26\325\342\34Lr\64\3ft\62\16k\360\241\34\16&quot;  &quot;\207d\70Di\30E\303\220Di\30%\303C\216E\321\60$Q\65\211\242aH\242j\62D\303\220&quot;  &quot;D\325\34\310\222\34\10#\0g\10(\14m\360\206[\16d\71\220\345@\226\3\331p\313\201,\7\262&quot;  &quot;\34\310\206[\16d\71\20\345H\224#u \321\241\4g\37\63\16i\260\262\34\312\242A\31\206$\213&quot;  &quot;\262(\213\262(\213\6i\220\262(\213\262(\213\6)\213\262h\220\262(\33.Y\32\205Q\226\204I&quot;  &quot;\232%j\5n\253.\377xprJ\66\14a\26\225\223\250-\351\226Db\226D\303\20fi\230\243&quot;  &quot;\332p\312\242$\252EIT\213\222\250\26%Qi\70\10o\325.\376h\260\242\341\226\344@\226\14\207&quot;  &quot;\60\7\222l\270\204\325$J\242,\231\266b\64U\242\322\220\14Q\16GI)\213*Q\230%Q\0&quot;  &quot;&#125;P.\17i\360\342\34\210\353@\234$\303%J\303!\316\201l\30\262\34\216rlX\206!N\322&quot;  &quot;\34I\243\244\65JZ\223x\30r$M\0&#125;\262&#x2F;\17i\360rB\66\14R\30G\241\226\224*\245&quot;  &quot;a\32\6\255\224Ea\26\25\207A\211*\341\240\64\346@\62$&#x3D;&#39;\235\223\216\211\234&amp;\0\215\357,&quot;  &quot;\17i\360\241x\320\342,\33\262R\326\322\70\210\71\220&amp;q\230\245Y\252$\323\240%aV\11\263J&quot;  &quot;\230U\246,Z\7\35+\1\220#&#39;\377x\360\241\70\7r \31\16R\234c\303\71\253L\303-\312&quot;  &quot;\232\206[\234\3\311p\220\342\34\210+im\70\10\225\223&#39;\374j\60\6i\330\242l\230\206-\312\206&quot;  &quot;i\330\61i\230\244\60\222\206I\12#i\230\244\60\322\61\35It(\1\226c\61\16k\360\241p\20&quot;  &quot;k\311pJ\303(\32\206\244\26U\242.Q\64\14I\226D\225,\211*Y\62\14\211\222\206I\64\34&quot;  &quot;r$\314\221\60GB\0\226p-\16k\360\241p\20k\225,\312J-YR\312\62)\32\246:\20&quot;  &quot;eiV\31\206$\313!%\31\16IZ\316\242t\30\222\70L\0\226\350&amp;\377h\60~\7rBN&quot;  &quot;\310\221\341!JKi\251%\213\262$j-\265dQ\226D\255\245\64K\242\34\213\0\226\362&#39;\17i&quot;  &quot;\260\206\203\16\345\310\360\240\244\261\264$K\216\344\330\222\354\344\341\240s\34&gt;\246\71\220\3\351p\320\11&quot;  &quot;\21\0\0&quot;;  &#x2F;&#x2F;wifié€£ç·švoid wifiConn()&#123;Â  WiFi.begin(ssid, password);Â  while (WiFi.status() !&#x3D; WL_CONNECTED)&#123;Â  Â  Serial.print(&quot;*&quot;);Â  Â  u8g2.firstPage();Â  Â  do&#123;Â  Â  Â  u8g2.setCursor(15, 30);Â  Â  Â  u8g2.print(&quot;ç¶²è·¯é€£çµä¸­...&quot;);Â  Â  &#125;while (u8g2.nextPage());Â  Â  delay(500);Â  &#125;Â  Serial.println(&quot;Connected successful!&quot;);Â  u8g2.firstPage();Â  do&#123;Â  Â  u8g2.setCursor(15, 30);Â  Â  u8g2.print(&quot;ç¶²è·¯å·²é€£çµ!&quot;);Â  &#125;while (u8g2.nextPage());Â  delay(500);&#125;&#x2F;&#x2F;é€£ç·šå¾Œè‡ªå‹•åŸ·è¡Œæ”¶å–è¨‚é–±ä¸»é¡Œå’Œå…§å®¹void callback(char *topic, byte *msg, unsigned int length)&#123;Â  String date, ledMsg;Â  Serial.print(&quot;topic: &quot;);Â  Serial.println(topic);Â  Serial.print(&quot;message: &quot;);Â  for (int i &#x3D; 0; i &lt; length; i++)&#123;Â  Â  Serial.print(char(msg[i]));Â  Â  date +&#x3D; char(msg[i]);Â  Â  ledMsg +&#x3D; char(msg[i]);Â  &#125;Â  Serial.println();Â  delay(2000);Â  float t&#x3D;dht.readTemperature();Â  float h&#x3D;dht.readHumidity();Â  if (isnan(h) || isnan(t)) &#123;Â  Â  Serial.println(&quot;Failed to read from DHT sensor!&quot;);Â  &#125;Â  if (String(topic)&#x3D;&#x3D;SubDate)&#123;Â  Â  u8g2.firstPage();Â  Â  do&#123;Â  Â  Â  u8g2.setCursor(0, 15);Â  Â  Â  u8g2.print(&quot;æ—¥æœŸ-æ™‚é–“&quot;);Â  Â  Â  u8g2.setCursor(75, 15);Â  Â  Â  u8g2.print(date.substring(0,4));Â  Â  Â  u8g2.setCursor(110, 15);Â  Â  Â  u8g2.print(&quot;å¹´&quot;);Â  Â  Â  u8g2.setCursor(0, 30);Â  Â  Â  u8g2.print(date.substring(5,7));Â  Â  Â  u8g2.setCursor(15, 30);Â  Â  Â  u8g2.print(&quot;æœˆ&quot;);Â  Â  Â  u8g2.setCursor(30, 30);Â  Â  Â  u8g2.print(date.substring(8,10));Â  Â  Â  u8g2.setCursor(45, 30);Â  Â  Â  u8g2.print(&quot;æ—¥&quot;);Â  Â  Â  u8g2.setCursor(60, 30);Â  Â  Â  u8g2.print(date.substring(11,19));Â  Â  Â  u8g2.setCursor(0, 45);Â  Â  Â  u8g2.print(&quot;æº«:&quot;);Â  Â  Â  u8g2.setCursor(25, 45);Â  Â  Â  u8g2.print(t,1);Â  Â  Â  u8g2.setCursor(60, 45);Â  Â  Â  u8g2.print(&quot;åº¦&quot;);Â  Â  Â  u8g2.setCursor(0, 60);Â  Â  Â  u8g2.print(&quot;æ¿•:&quot;);Â  Â  Â  u8g2.setCursor(25, 60);Â  Â  Â  u8g2.print(h,1);Â  Â  Â  u8g2.setCursor(60, 60);Â  Â  Â  u8g2.print(&quot;%&quot;);Â  Â  &#125;while (u8g2.nextPage());Â  &#125;Â  if (String(topic)&#x3D;&#x3D;&quot;esp32&#x2F;switch&quot;)&#123;Â  Â  if (ledMsg&#x3D;&#x3D;&quot;on&quot;)&#123;Â  Â  Â  digitalWrite(LED_BUILTIN, HIGH);Â  Â  &#125;else if (ledMsg&#x3D;&#x3D;&quot;off&quot;)&#123;Â  Â  Â  digitalWrite(LED_BUILTIN, LOW);Â  Â  &#125;Â  &#125;&#125;&#x2F;&#x2F;å¦‚æœæ²’é€£ä¸Šmqttå‰‡åšè©¦é‡é€£void reConnMqtt()&#123;Â  while (! client.connected())&#123;Â  Â  Serial.println(&quot;åšè©¦é€£ç·šMQTT...&quot;);Â  Â  if (client.connect(&quot;esp32Client&quot;))&#123;Â  Â  Â  client.subscribe(&quot;esp32&#x2F;date&quot;);Â  Â  Â  client.subscribe(&quot;esp32&#x2F;switch&quot;);Â  Â  &#125;else&#123;Â  Â  Â  Serial.print(&quot;ç„¡æ³•é€£ç·šçš„åŸå› æ˜¯: &quot;);Â  Â  Â  Serial.print(client.state());Â  Â  Â  delay(2000);Â  Â  &#125;Â  &#125;&#125;void setup()&#123;Â  Serial.begin(115200);Â  pinMode(LED_BUILTIN, OUTPUT);Â  u8g2.begin();Â  u8g2.setFont(myFont);Â  u8g2.enableUTF8Print();Â  wifiConn();Â  dht.begin();Â  &#x2F;&#x2F;mqttåˆå§‹åŒ–Â  client.setServer(mqtt_server, 1883);Â  &#x2F;&#x2F;ç›£è½è¨‚é–±å‚³ä¾†çš„è¨Šæ¯Â  client.setCallback(callback);&#125;  void loop()&#123;Â  if (! client.connected())&#123;Â  Â  reConnMqtt();Â  &#125;Â  client.loop();&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> mqtt </category>
          
          <category> dht11 </category>
          
          <category> node-red </category>
          
      </categories>
      
      
        <tags>
            
            <tag> esp32 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DHT11+OLED+LINE-notity-micropython</title>
      <link href="/2021/11/04/dht11-oled-line-notity-micropython/"/>
      <url>/2021/11/04/dht11-oled-line-notity-micropython/</url>
      
        <content type="html"><![CDATA[<h1 id="DHT11-OLED-LINE-notity-micropython"><a href="#DHT11-OLED-LINE-notity-micropython" class="headerlink" title="DHT11+OLED+LINE-notity-micropython"></a>DHT11+OLED+LINE-notity-micropython</h1><h6 id="tags-micropython-line-dht11-dht12-esp32"><a href="#tags-micropython-line-dht11-dht12-esp32" class="headerlink" title="tags: micropython line dht11/dht12 esp32"></a>tags: <code>micropython</code> <code>line</code> <code>dht11/dht12</code> <code>esp32</code></h6><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/7332703368352171140#"><img src="https://lh3.googleusercontent.com/-0l3K9zYlDiI/YYM7Sb6lFAI/AAAAAAAAfB4/Wm9MiuDoPZMobYuqda900V-PsFoXdWb-wCNcBGAsYHQ/s1600/1635990333055348-0.png"></a></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><strong>é€™æ¬¡è¦ä¾†å¯¦é©—èœå¸‚å ´å‚³æ„Ÿå™¨ğŸ˜‚-DHT11åœ¨OLEDä¸Šé¡¯ç¤ºä¸¦ä¸”åœ¨LINEä¸Šé€šçŸ¥</strong></p><p><strong>æº«æ¿•åº¦ã€‚</strong></p><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/7332703368352171140#"><img src="https://lh3.googleusercontent.com/-oicXzD5wEek/YYDTVlMRiVI/AAAAAAAAfAQ/K5TlzcHzC0o2_rv_RZm8k9E4ec58vmgSwCNcBGAsYHQ/w495-h457/image.png"></a></p><h3 id="é—œæ–¼DHT11-12å¾€é€™è£¡èµ°"><a href="#é—œæ–¼DHT11-12å¾€é€™è£¡èµ°" class="headerlink" title="é—œæ–¼DHT11/12å¾€é€™è£¡èµ°"></a>é—œæ–¼DHT11/12å¾€<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/7332703368352171140#">é€™è£¡</a>èµ°</h3><h3 id="OLEDå¾€é€™è£¡èµ°"><a href="#OLEDå¾€é€™è£¡èµ°" class="headerlink" title="OLEDå¾€é€™è£¡èµ°"></a>OLEDå¾€<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/7332703368352171140#">é€™è£¡</a>èµ°</h3><h2 id="IFTTTç”³è«‹å’Œè¨­å®š"><a href="#IFTTTç”³è«‹å’Œè¨­å®š" class="headerlink" title="IFTTTç”³è«‹å’Œè¨­å®š"></a>IFTTTç”³è«‹å’Œè¨­å®š</h2><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/7332703368352171140#">https://ifttt.com</a></p><p><img src="https://img1.blogblog.com/img/video_object.png"></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> dht<span class="token punctuation">,</span> ssd1306<span class="token punctuation">,</span> urequests<span class="token punctuation">,</span> network<span class="token punctuation">,</span> gc<span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token punctuation">,</span> SoftI2C<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep  <span class="token comment">#wifié€£ç·š</span><span class="token keyword">def</span> <span class="token function">wifiConn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    ssid <span class="token operator">=</span> <span class="token string">"---"</span>    password <span class="token operator">=</span> <span class="token string">"-----"</span>    wifi <span class="token operator">=</span> network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>    wifi<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>    wifi<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span>    <span class="token keyword">while</span> wifi<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connect successful!"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IP: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>wifi<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#åµæ¸¬æº«æ¿•åº¦</span><span class="token keyword">def</span> <span class="token function">detectDHT</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> d11    d11<span class="token operator">=</span>dht<span class="token punctuation">.</span>DHT11<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    d11<span class="token punctuation">.</span>measure<span class="token punctuation">(</span><span class="token punctuation">)</span>    temp<span class="token operator">=</span>d11<span class="token punctuation">.</span>temperature<span class="token punctuation">(</span><span class="token punctuation">)</span>    hum<span class="token operator">=</span>d11<span class="token punctuation">.</span>humidity<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> temp<span class="token punctuation">,</span> hum  <span class="token comment">#OLEDé¡¯ç¤º</span><span class="token keyword">def</span> <span class="token function">oledDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    i2c<span class="token operator">=</span>SoftI2C<span class="token punctuation">(</span>sda<span class="token operator">=</span>Pin<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">,</span> scl<span class="token operator">=</span>Pin<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    oled<span class="token operator">=</span>ssd1306<span class="token punctuation">.</span>SSD1306_I2C<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> i2c<span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>fill<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">'~ TEMP &amp; HUMID ~'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">'Temp = &#123;&#125; C'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">'Humid= &#123;&#125; %'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    wifiConn<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">#IFTTTç¶²é è£¡çµ¦å®šçš„KEY</span>    token<span class="token operator">=</span><span class="token string">"hVvZLHqWXg1d0hNaIVr1lw1XXXXXXXXXXXXXXX"</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>        t<span class="token punctuation">,</span> h<span class="token operator">=</span>detectDHT<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">#IFTTTç¶²é è£¡,æ–‡ä»¶å‘ŠçŸ¥çš„ç²å–æ•¸å€¼çš„æ–¹æ³•</span>        url<span class="token operator">=</span><span class="token string">"https://maker.ifttt.com/trigger/dhtTest/with/key/"</span><span class="token operator">+</span>\        <span class="token string">"&#123;&#125;?value1=&#123;&#125;&amp;value2=&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span>t<span class="token punctuation">,</span> h<span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            lineUrl<span class="token operator">=</span>urequests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'code=&#123;&#125;,content=&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>lineUrl<span class="token punctuation">.</span>status_code<span class="token punctuation">,</span>lineUrl<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>            wifiConn<span class="token punctuation">(</span><span class="token punctuation">)</span>        lineUrl<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>        oledDisplay<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Temperature:&#123;&#125;*C"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Humiduty:&#123;&#125;%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/7332703368352171140#"><img src="https://lh3.googleusercontent.com/-CtkAvegyAqI/YYM7PcEvW2I/AAAAAAAAfB0/H0d7bV0ElfwAPCsD1WD2MxTeMJRs7lpcACNcBGAsYHQ/s1600/1635990328374186-1.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> line </tag>
            
            <tag> dht11 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OLED+DHT11æº«æ¿•åº¦+LINE-ESP32</title>
      <link href="/2021/11/02/oled-dht11-wen-shi-du-line-esp32/"/>
      <url>/2021/11/02/oled-dht11-wen-shi-du-line-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="OLED-DHT11æº«æ¿•åº¦-LINE-ESP32"><a href="#OLED-DHT11æº«æ¿•åº¦-LINE-ESP32" class="headerlink" title="OLED+DHT11æº«æ¿•åº¦+LINE-ESP32"></a>OLED+DHT11æº«æ¿•åº¦+LINE-ESP32</h1><h6 id="tags-esp32-line-dht11-dht12"><a href="#tags-esp32-line-dht11-dht12" class="headerlink" title="tags: esp32 line dht11/dht12"></a>tags: <code>esp32</code> <code>line</code> <code>dht11/dht12</code></h6><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4765408381612901090#"><img src="https://lh3.googleusercontent.com/-MVZ3fuUntoI/YYDdgokSSAI/AAAAAAAAfBo/IZHppl54L9ATxGmke7cIdTQg-7kAHNARgCNcBGAsYHQ/s1600/1635835258964992-0.png"></a></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>é€™æ¬¡è¦ä¾†å¯¦é©—èœå¸‚å ´å‚³æ„Ÿå™¨ğŸ˜‚-DHT11åœ¨OLEDä¸Šé¡¯ç¤ºä¸¦ä¸”åœ¨LINEä¸Šé€šçŸ¥æº«æ¿•åº¦ã€‚</p><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4765408381612901090#"><img src="https://lh3.googleusercontent.com/-oicXzD5wEek/YYDTVlMRiVI/AAAAAAAAfAQ/K5TlzcHzC0o2_rv_RZm8k9E4ec58vmgSwCNcBGAsYHQ/w495-h457/image.png"></a></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><p><strong>é—œæ–¼DHT11å¯ä»¥åƒè€ƒ<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4765408381612901090#">é€™ç¯‡</a></strong></p><p><strong>å…ˆæ¸¬è©¦å‚³æ„Ÿå™¨ä½¿å…¶èƒ½é¡¯ç¤ºæ–¼OLEDä¸Š</strong></p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;Wire.h&gt;#include &lt;Adafruit_GFX.h&gt;#include &lt;Adafruit_GrayOLED.h&gt;#include &lt;Adafruit_SSD1306.h&gt;#include &lt;Adafruit_Sensor.h&gt;  #define DHTPIN 4 &#x2F;&#x2F; Digital pin connected to the DHT sensor  #define DHTTYPE DHT11 &#x2F;&#x2F; DHT 11  #define SCREEN_WIDTH 128#define SCREEN_HEIGHT 64Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT, &amp;Wire, -1);  DHT dht(DHTPIN, DHTTYPE);  void setup() &#123;Â  Serial.begin(115200);Â  &#x2F;&#x2F; Initialize device.Â  dht.begin();Â  Serial.print(&quot;success connected!&quot;);Â  if(!display.begin(SSD1306_SWITCHCAPVCC, 0x3C)) &#123;Â  Â  Serial.println(F(&quot;SSD1306 allocation failed&quot;));Â  Â  for(;;);Â  &#125;Â  delay(2000);Â  display.clearDisplay();Â  display.setTextColor(WHITE);&#125;void loop() &#123;Â  &#x2F;&#x2F; Delay between measurements.Â  delay(2000);Â  float t&#x3D;dht.readTemperature();Â  float h&#x3D;dht.readHumidity();Â  if (isnan(h) || isnan(t)) &#123;Â  Â  Serial.println(&quot;Failed to read from DHT sensor!&quot;);Â  &#125;Â  &#x2F;&#x2F; clear displayÂ  display.clearDisplay();Â  &#x2F;&#x2F; display temperatureÂ  display.setTextSize(1);Â  display.setCursor(0,10);Â  display.print(&quot;Temperature: &quot;);Â  display.setTextSize(2);Â  display.setCursor(0,20);Â  display.print(t);Â  display.print(&quot; &quot;);Â  display.setTextSize(1);Â  display.cp437(true);Â  display.write(167);Â  display.setTextSize(2);Â  display.print(&quot;C&quot;);Â  &#x2F;&#x2F; display humidityÂ  display.setTextSize(1);Â  display.setCursor(0, 35);Â  display.print(&quot;Humidity: &quot;);Â  display.setTextSize(2);Â  display.setCursor(0, 45);Â  display.print(h);Â  display.print(&quot; %&quot;);Â  display.display();&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="LINEçš„è¨­å®š"><a href="#LINEçš„è¨­å®š" class="headerlink" title="LINEçš„è¨­å®š"></a>LINEçš„è¨­å®š</h2><h2 id="ç”³è«‹-LINE-Notify-æ¬Šæ–"><a href="#ç”³è«‹-LINE-Notify-æ¬Šæ–" class="headerlink" title="ç”³è«‹ LINE Notify æ¬Šæ–"></a><em>ç”³è«‹ LINE Notify æ¬Šæ–</em></h2><p>æ‰“é–‹ LINE Notify çš„ç¶²ç«™ (Â <a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4765408381612901090#">https://notify-bot.line.me/zh_TW/</a>Â )ï¼Œç”¨è‡ªå·±çš„ LINE å¸³è™Ÿç™»å…¥</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4765408381612901090#"><img src="https://www.oxxostudio.tw/img/articles/201806/line-notify-01.jpg"></a></p><p>æŒ‰å³ä¸Šè§’â€ç™»å…¥â€</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4765408381612901090#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEgg6T6SgSIRT7Vo4ErmbHe186RaPft-8u68K-y7ALJEpAEqplF9a8e3pAAbsRqfFtM4QAGN7d0rXmCDD4ZNoKD-Xh9umAFGpQ_vy9U3LAPAPnxMBVNlyXhZ8WOR7H_txVDmYhISbMwZlWNR7yjS69yyBXBdLqmEfEth47rGn9ra5FS2jEVzXV0L1Voy=w621-h349"></a></p><p>è¼¸å…¥è‡ªå·±çš„LINEå¸³è™Ÿå¯†ç¢¼</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4765408381612901090#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEgmTV3SeiS_Eem9EdGkW6BwjS4OezsGwyKPoc7TzXlKQvz_ixGwZotDUuM1Sp7hHhU8OKfFKTuNhJ_mSJzDBJ61L9VgRJdbbhuhqDFv7wRP2H50edMI5MdhiPdx2yQbV8SIk75sKf9Zc10uhJWsND9WE9JzyN0-MtrCmrm0fyzfSmgAtOVU_-jLuTmy=w626-h352"></a></p><p>å³ä¸Šè§’é»é¸â€å€‹äººé é¢â€</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4765408381612901090#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEgLNkhqI0_cYmiFTLkb7gysGYexPT05_lThilvAhDfFqjXAcK-gfJZSNHmXzQhALgBOQ-JHkJnuAqJ3VBL-5kYsrhE4f364JXcwh7qMEo-sC6EfftFbWNYlthN2q2M1pmIY1Zrq5Gr1w61g4up6lOJzJbJ8jYDOGArKuAAuVBLKAHiAwiLa6gyUdET3=w629-h355"></a></p><p>é»é¸â€ç™¼è¡Œæ¬Šæ–â€</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4765408381612901090#"><img src="https://i.imgur.com/3fwskdF.png"></a></p><p>ç•¶å‡ºç¾é€™ç•«é¢æ™‚ï¼Œå°±æ˜¯é–‹å§‹ç”³è«‹æ¬Šæ–(Token)ï¼Œæ‰€ä»¥è«‹å…ˆè¼¸å…¥åç¨±ï¼ŒåŠé¸æ“‡é€é1å°1èŠå¤©æ¥æ”¶Line Notifyçš„é€šçŸ¥ï¼Œéƒ½é¸æ“‡å¥½å¾Œé»æ“Šç™¼è¡Œ</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4765408381612901090#"><img src="https://i.imgur.com/sqJjfyS.png"></a></p><p>å°‡æ¬Šæ–è¤‡è£½ä¸¦å­˜åˆ°è¨˜äº‹æœ¬,é€™è£¡æ¬Šé™åªæœƒé¡¯ç¤ºä¸€æ¬¡,è¦ç‰¹åˆ¥ç•™æ„</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4765408381612901090#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEhaCa9vCJtpsN0J735eX-4yue6H4vTm2dRCKv0KzcAaC64sB37LzJ46JWFa2rj1NA7dobPeyGYCSWvANDW_KNrvN_TzQf3AzAi3O-irF9K9Bk8M9c1D22D1I0alYHmJ9VPYMXs7mfktt8LtXQbbxzecStOy-lj_fpGK97zXxoPuzbN9h4HjQ8ruNw9o=w583-h385"></a></p><p>å†å›åˆ°ç¨‹å¼ç¢¼ä¸¦åŠ å…¥ç›¸é—œå‡½å¼</p><h2 id="åŠ å…¥LINEç¨‹å¼ç¢¼"><a href="#åŠ å…¥LINEç¨‹å¼ç¢¼" class="headerlink" title="åŠ å…¥LINEç¨‹å¼ç¢¼"></a>åŠ å…¥LINEç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;Wire.h&gt;#include &lt;Adafruit_GFX.h&gt;#include &lt;Adafruit_GrayOLED.h&gt;#include &lt;Adafruit_SSD1306.h&gt;#include &lt;Adafruit_Sensor.h&gt;#include &lt;TridentTD_LineNotify.h&gt;#include &lt;WiFi.h&gt;#include &lt;WiFiClient.h&gt;#include &lt;DHT.h&gt;  #define LINE_TOKEN &quot;q6LtMY1QO2BC5VxVGK7oveZf5----------------&quot;  #define DHTPIN 4 &#x2F;&#x2F; Digital pin connected to the DHT sensor#define DHTTYPE DHT11 &#x2F;&#x2F; DHT 11  #define SCREEN_WIDTH 128#define SCREEN_HEIGHT 64Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT, &amp;Wire, -1);  DHT dht(DHTPIN, DHTTYPE);  &#x2F;&#x2F; è¨­å®šç„¡ç·šåŸºåœ°å°SSIDè·Ÿå¯†ç¢¼const char* ssid Â  Â  &#x3D; &quot;CTK&quot;;const char* password &#x3D; &quot;ctk674011&quot;;void setup() &#123;Â  Serial.begin(115200);Â  &#x2F;&#x2F; Initialize device.Â  dht.begin();Â  WiFi.begin(ssid, password);Â  while (WiFi.isConnected()&#x3D;&#x3D;false)Â  &#123;Â  Â  delay(500);Â  Â  Serial.print(&quot;.&quot;);Â  &#125;Â  Serial.print(&quot;success connected!&quot;);Â  if(!display.begin(SSD1306_SWITCHCAPVCC, 0x3C)) &#123;Â  Â  Serial.println(F(&quot;SSD1306 allocation failed&quot;));Â  Â  for(;;);Â  &#125;Â  delay(2000);Â  display.clearDisplay();Â  display.setTextColor(WHITE);Â  &#x2F;&#x2F; é¡¯ç¤º Lineç‰ˆæœ¬Â  Serial.println(LINE.getVersion());&#125;void loop() &#123;Â  &#x2F;&#x2F; Delay between measurements.Â  delay(2000);Â  float t&#x3D;dht.readTemperature();Â  float h&#x3D;dht.readHumidity();Â  if (isnan(h) || isnan(t)) &#123;Â  Â  Serial.println(&quot;Failed to read from DHT sensor!&quot;);Â  &#125;Â  &#x2F;&#x2F; clear displayÂ  display.clearDisplay();Â  &#x2F;&#x2F; display temperatureÂ  display.setTextSize(1);Â  display.setCursor(0,10);Â  display.print(&quot;Temperature: &quot;);Â  display.setTextSize(2);Â  display.setCursor(0,20);Â  display.print(t);Â  display.print(&quot; &quot;);Â  display.setTextSize(1);Â  display.cp437(true);Â  display.write(167);Â  display.setTextSize(2);Â  display.print(&quot;C&quot;);Â  &#x2F;&#x2F; display humidityÂ  display.setTextSize(1);Â  display.setCursor(0, 35);Â  display.print(&quot;Humidity: &quot;);Â  display.setTextSize(2);Â  display.setCursor(0, 45);Â  display.print(h);Â  display.print(&quot; %&quot;);Â  display.display();Â  String tempe&#x3D;&quot;æº«åº¦:&quot;+String(t)+&quot;â„ƒ&quot;; Â Â  String humid&#x3D;&quot;æ¿•åº¦:&quot;+String(h)+&quot;ï¼…&quot;;  Â  LINE.setToken(LINE_TOKEN);Â  &#x2F;&#x2F; å…ˆæ›è¡Œå†é¡¯ç¤ºÂ  LINE.notify(&quot;\\n&quot; + tempe + &quot; ï¼›&quot; + humid); Â Â  &#x2F;&#x2F; æ¯2åˆ†é˜ç™¼é€ä¸€æ¬¡(delay120000)Â  delay(100000);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4765408381612901090#"><img src="https://lh3.googleusercontent.com/-WYyqdHTvfhE/YYDdeqK8y-I/AAAAAAAAfBk/GMSyTOYK_roZY-GEVwLd7mdBZ8QpnrPQgCNcBGAsYHQ/s1600/1635835251176872-1.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> line </tag>
            
            <tag> dht11 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2.å‘¼å¸ç‡ˆ-æ¨¹è“æ´¾</title>
      <link href="/2021/10/30/2-hu-xi-deng-shu-mei-pai/"/>
      <url>/2021/10/30/2-hu-xi-deng-shu-mei-pai/</url>
      
        <content type="html"><![CDATA[<h1 id="2-å‘¼å¸ç‡ˆ-æ¨¹è“æ´¾"><a href="#2-å‘¼å¸ç‡ˆ-æ¨¹è“æ´¾" class="headerlink" title="2.å‘¼å¸ç‡ˆ-æ¨¹è“æ´¾"></a>2.å‘¼å¸ç‡ˆ-æ¨¹è“æ´¾</h1><h2 id="ä»€éº¼æ˜¯PWM"><a href="#ä»€éº¼æ˜¯PWM" class="headerlink" title="ä»€éº¼æ˜¯PWM"></a>ä»€éº¼æ˜¯PWM</h2><p>ç°¡å–®ä¾†èªªï¼ŒPWMå°±æ˜¯é€šéæ§åˆ¶ä¸€å®šæ™‚é–“å…§çš„å¹³å‡é›»å£“ä¾†èª¿ç¯€é€™æ®µæ™‚é–“LEDç‡ˆçš„æ˜æš—ç¨‹åº¦ã€‚é‚£PWMæ˜¯æ€éº¼æ§åˆ¶ä¸€å®šæ™‚é–“å…§çš„å¹³å‡é›»å£“å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯é€šéæ”¹è®Šä½”ç©ºæ¯”(Duty Cycle)ï¼Œä½”ç©ºæ¯”æŒ‡é›»è·¯è¢«æ¥é€šçš„æ™‚é–“ä½”æ•´å€‹é›»è·¯å·¥ä½œé€±æœŸçš„ç™¾åˆ†æ¯”ã€‚</p><p>çµåˆè¦–é »ä¸­çš„ä¾‹å­ä¾†è¬›ï¼šä»¥100æ¯«ç§’ç‚ºä¸€å€‹é€±æœŸï¼Œå…¶ä¸­50æ¯«ç§’é€šé›»ï¼Œ50æ¯«ç§’æ–·é›»ã€‚é‚£éº¼ç‡ˆæ³¡åœ¨100æ¯«ç§’å…§å…¶å¯¦åªæœ‰ä¸€åŠæ™‚é–“æ˜¯é€šé›»çš„ï¼Œä½”ç©ºæ¯”å°±æ˜¯50%äº†ã€‚ 100æ¯«ç§’å…§ç‡ˆæ³¡å¾—åˆ°çš„é›»å£“åªæœ‰ä¸€åŠï¼Œé‚£éº¼äº®åº¦è‡ªç„¶ä¹Ÿå°±è®Šç‚ºäº†ä¸€åŠã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/3150406505283704665/8333327948209781762#"><img src="https://pic2.zhimg.com/80/v2-43929176c2841581b7093ec86406aae9_1440w.jpg"></a></p><p>æˆ‘å€‘å¯ä»¥é€šéRPi.GPIOä¸­çš„PWMé¡ä¾†æ§åˆ¶è¼¸å‡ºçš„å¹³å‡é›»å£“ã€‚</p><p>ç¬¬ä¸€å€‹åƒæ•¸ç‚ºå¼•è…³ç·¨è™Ÿï¼Œç¬¬äºŒå€‹åƒæ•¸ç‚ºé »ç‡</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">pwm <span class="token operator">=</span> GPIO<span class="token punctuation">.</span>PWM<span class="token punctuation">(</span>num<span class="token punctuation">,</span> frequency<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¬¬äºŒå€‹åƒæ•¸è¦å¡«å¯«é »ç‡ï¼Œé€™è£¡è¦ç”¨åˆ°é »ç‡(f)å’Œå‘¨æœŸ(T)çš„è½‰æ›å…¬å¼ï¼š [å…¬å¼]</p><p>æˆ‘å€‘å‡è¨­é€±æœŸç‚º20æ¯«ç§’ï¼Œé‚£å¾—åˆ°é »ç‡ç‚º1/0.02sï¼Œå³50Hzã€‚</p><p>æ³¨ï¼šå¦‚æœé–‹é—œå‹•ä½œçš„å‘¨æœŸå¦‚æœå¤ªé•·ï¼Œå³é »ç‡å¤ªå°ï¼Œé‚£éº¼äººçš„è‚‰çœ¼å°±å¯ä»¥è¾¨è­˜å‡ºç‡ˆçš„é–‹é—œç‹€æ…‹ï¼Œä¹Ÿå°±æ˜¯èªªLEDç‡ˆçœ‹èµ·ä¾†å°±æ˜¯é–ƒçˆçš„ã€‚</p><p>ä¹‹å¾Œèª¿ç”¨p.start(dc)ä¾†é–‹å•ŸPWMï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># é–‹å•ŸPWMï¼Œåƒæ•¸dcç‚ºä½”ç©ºæ¯”ï¼Œå–å€¼ç¯„åœç‚º0-100</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">pwm<span class="token punctuation">.</span>start<span class="token punctuation">(</span>dc<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœè¦æ›´æ”¹é »ç‡ï¼Œå¯ä»¥èª¿ç”¨ChangeFrequency()æ–¹æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">pwm<span class="token punctuation">.</span>ChangeFrequency<span class="token punctuation">(</span>frequency<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœè¦ä¿®æ”¹ä½”ç©ºæ¯”ï¼Œå¯ä»¥èª¿ç”¨ChangeDutyCycle()æ–¹æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">pwm<span class="token punctuation">.</span>ChangeDutyCycle<span class="token punctuation">(</span>dc<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç•¶ä¸éœ€è¦PWMæ™‚ï¼Œå¯ä»¥èª¿ç”¨stop()ä¾†åœæ­¢ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">pwm<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> RPi<span class="token punctuation">.</span>GPIO <span class="token keyword">as</span> GPIO  <span class="token keyword">from</span> time <span class="token keyword">import</span> sleep    led <span class="token operator">=</span> <span class="token number">20</span>  freg <span class="token operator">=</span> <span class="token number">60</span>  dc <span class="token operator">=</span> <span class="token number">0</span>    GPIO<span class="token punctuation">.</span>setmode<span class="token punctuation">(</span>GPIO<span class="token punctuation">.</span>BCM<span class="token punctuation">)</span>  GPIO<span class="token punctuation">.</span>setup<span class="token punctuation">(</span>led<span class="token punctuation">,</span> GPIO<span class="token punctuation">.</span>OUT<span class="token punctuation">)</span>    p <span class="token operator">=</span> GPIO<span class="token punctuation">.</span>PWM<span class="token punctuation">(</span>led<span class="token punctuation">,</span> freg<span class="token punctuation">)</span>  p<span class="token punctuation">.</span>start<span class="token punctuation">(</span>dc<span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>      <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>          p<span class="token punctuation">.</span>ChangeDutyCycle<span class="token punctuation">(</span>i<span class="token punctuation">)</span>          sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span>      <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>          p<span class="token punctuation">.</span>ChangeDutyCycle<span class="token punctuation">(</span>i<span class="token punctuation">)</span>          sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span>  p<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>  GPIO<span class="token punctuation">.</span>cleanup<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/my9RtMC3J0o" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> æ¨¹è“æ´¾ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‘¼å¸ç‡ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>1.æŒ‰éˆ•æ§åˆ¶LED-æ¨¹è“æ´¾</title>
      <link href="/2021/10/29/1-an-niu-kong-zhi-led-shu-mei-pai/"/>
      <url>/2021/10/29/1-an-niu-kong-zhi-led-shu-mei-pai/</url>
      
        <content type="html"><![CDATA[<h1 id="1-æŒ‰éˆ•æ§åˆ¶LED-æ¨¹è“æ´¾"><a href="#1-æŒ‰éˆ•æ§åˆ¶LED-æ¨¹è“æ´¾" class="headerlink" title="1.æŒ‰éˆ•æ§åˆ¶LED-æ¨¹è“æ´¾"></a>1.æŒ‰éˆ•æ§åˆ¶LED-æ¨¹è“æ´¾</h1><h2 id="æº–å‚™ææ–™"><a href="#æº–å‚™ææ–™" class="headerlink" title="æº–å‚™ææ–™"></a>æº–å‚™ææ–™</h2><p>æ¨¹è“æ´¾ x1</p><p>æŒ‰éˆ•é–‹é–‹(æˆ‘æ‰‹é‚Šåªæœ‰å¸¸é–‰çš„,æ‰€ä»¥å‹•ä½œæœƒå’Œä¸€èˆ¬çš„ç›¸å) x1</p><p>æœé‚¦ç·š è‹¥å¹²</p><p>é¢åŒ…æ¿ x1</p><p>20k ohm x1</p><p>200 ohm x1</p><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><a href="https://draft.blogger.com/blog/post/edit/3150406505283704665/4448320227057174628#"><img src="https://1.bp.blogspot.com/-r6UOuE6eUKE/YXubaqZ90HI/AAAAAAAAe_s/C5rnnFakPowL9Hg5MP_i2GewqYJH0-nTwCNcBGAsYHQ/w685-h244/LED_BUTTON.png"></a></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> RPi<span class="token punctuation">.</span>GPIO <span class="token keyword">as</span> GPIO  <span class="token keyword">from</span> time <span class="token keyword">import</span> sleep    led_pin <span class="token operator">=</span> <span class="token number">20</span>  button_pin <span class="token operator">=</span> <span class="token number">21</span>  GPIO<span class="token punctuation">.</span>setmode<span class="token punctuation">(</span>GPIO<span class="token punctuation">.</span>BCM<span class="token punctuation">)</span>  GPIO<span class="token punctuation">.</span>setup<span class="token punctuation">(</span>button_pin<span class="token punctuation">,</span> GPIO<span class="token punctuation">.</span>IN<span class="token punctuation">)</span>  GPIO<span class="token punctuation">.</span>setup<span class="token punctuation">(</span>led_pin<span class="token punctuation">,</span> GPIO<span class="token punctuation">.</span>OUT<span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>      <span class="token keyword">if</span> GPIO<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">(</span>button_pin<span class="token punctuation">)</span><span class="token punctuation">:</span>          <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"led is off"</span><span class="token punctuation">)</span>          GPIO<span class="token punctuation">.</span>output<span class="token punctuation">(</span>led_pin<span class="token punctuation">,</span> GPIO<span class="token punctuation">.</span>LOW<span class="token punctuation">)</span>          sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>      <span class="token keyword">else</span><span class="token punctuation">:</span>          <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"led is on"</span><span class="token punctuation">)</span>          GPIO<span class="token punctuation">.</span>output<span class="token punctuation">(</span>led_pin<span class="token punctuation">,</span> GPIO<span class="token punctuation">.</span>HIGH<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/TGQFLai7lzM" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> æ¨¹è“æ´¾ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> led </tag>
            
            <tag> button </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¹³è¡¡å°è»Š(balance-Robot)-åŸºæœ¬å¹³è¡¡-Arduino</title>
      <link href="/2021/10/18/ping-heng-xiao-che-balance-robot-ji-ben-ping-heng-arduino/"/>
      <url>/2021/10/18/ping-heng-xiao-che-balance-robot-ji-ben-ping-heng-arduino/</url>
      
        <content type="html"><![CDATA[<h1 id="å¹³è¡¡å°è»Š-balance-Robot-åŸºæœ¬å¹³è¡¡"><a href="#å¹³è¡¡å°è»Š-balance-Robot-åŸºæœ¬å¹³è¡¡" class="headerlink" title="å¹³è¡¡å°è»Š(balance-Robot)-åŸºæœ¬å¹³è¡¡"></a>å¹³è¡¡å°è»Š(balance-Robot)-åŸºæœ¬å¹³è¡¡</h1><h6 id="tags-arduino-å¹³è¡¡å°è»Š"><a href="#tags-arduino-å¹³è¡¡å°è»Š" class="headerlink" title="tags: arduino å¹³è¡¡å°è»Š"></a>tags: <code>arduino</code> <code>å¹³è¡¡å°è»Š</code></h6><p>åƒè€ƒ-<a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/8021272046367614203#">https://circuitdigest.com/microcontroller-projects/arduino-based-self-balancing-robot</a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/8021272046367614203#"><img src="https://1.bp.blogspot.com/-WdYKxKZ08M0/YWz_pLZD1eI/AAAAAAAAe-A/ce68muikSDU459LrcSNNCJayZql7Ht_SACNcBGAsYHQ/w368-h349/%25E5%25B9%25B3%25E8%25A1%25A1%25E8%25BB%258A2.jpg"></a></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç”³æ˜ä¸€ä¸‹ï¼Œæœ‰äº›åŸç†å’Œç¨‹å¼æ˜¯å€ŸåŠ©ä¸€äº›åŸå‰µè€…çš„æ–‡ç« åšç‚ºåƒç…§ï¼Œå› ç‚ºå¹³è¡¡è»Š</p><p>å¦‚æœçœŸçš„è¦ä¸€æ­¥æ­¥å¾ç¡¬é«”å’Œç¨‹å¼å…¨åŒ…ï¼Œé ˆè¦èŠ±å¾ˆå¤šæ™‚é–“å­¸ç¿’ï¼Œå°¤å…¶æ˜¯ï¼°ï¼©ï¼¤</p><p>çš„å¯«æ³•ç®—æ³•ï¼Œæ…¶å¹¸çš„æ˜¯æœ‰å¾ˆå¤šå‰µè€…å‰äººä¸ååˆ†äº«ï¼Œæ‰€ä»¥æˆ‘é€™å¾Œäººæ‰å¾—å·²å°‘èµ°</p><p>æ­§é€”ã€‚</p><h2 id="å¹³è¡¡è»ŠåŸç†"><a href="#å¹³è¡¡è»ŠåŸç†" class="headerlink" title="å¹³è¡¡è»ŠåŸç†"></a>å¹³è¡¡è»ŠåŸç†</h2><p>å¹³è¡¡å°è»Šæ˜¯é€šéå…©å€‹é›»æ©Ÿé‹å‹•ä¸‹å¯¦ç¾å°è»Šä¸å€’ä¸‹ç›´ç«‹è¡Œèµ°çš„å¤šåŠŸèƒ½æ™ºèƒ½å°</p><p>è»Šï¼Œåœ¨å¤–åŠ›çš„æ¨æ‹‰ä¸‹ï¼Œå°è»Šä¾ç„¶ä¿æŒä¸å€’ä¸‹ã€‚é€šéè² åé¥‹å¯¦ç¾å¹³è¡¡ã€‚èˆ‡ä¸Šé¢ä¿</p><p>æŒæœ¨æ£’ç›´ç«‹æ¯”è¼ƒå‰‡ç›¸å°ç°¡å–®ï¼Œå› ç‚ºå°è»Šæœ‰å…©å€‹è¼ªå­è‘—åœ°ï¼Œè»Šé«”åªæœƒåœ¨è¼ªå­æ»¾å‹•</p><p>çš„æ–¹å‘ä¸Šç™¼ç”Ÿå‚¾æ–œã€‚æ§åˆ¶è¼ªå­è½‰å‹•ï¼ŒæŠµæ¶ˆåœ¨ä¸€å€‹ç¶­åº¦ä¸Šå‚¾æ–œçš„è¶¨å‹¢ä¾¿å¯ä»¥ä¿æŒ</p><p>è»Šé«”å¹³è¡¡äº†ã€‚</p><p>æ‰€ä»¥æ ¹æ“šä¸Šè¿°çš„åŸç†ï¼Œé€šéæ¸¬é‡å°è»Šçš„å‚¾è§’å’Œå‚¾è§’é€Ÿåº¦æ§åˆ¶å°è»Šè»Šè¼ªçš„åŠ é€Ÿåº¦</p><p>ä¾†æ¶ˆé™¤å°è»Šçš„å‚¾è§’ã€‚å› æ­¤ï¼Œå°è»Šå‚¾è§’ä»¥åŠå‚¾è§’é€Ÿåº¦çš„æ¸¬é‡æˆç‚ºæ§åˆ¶å°è»Šç›´ç«‹</p><p>çš„é—œéµã€‚æˆ‘å€‘çš„äºåšæ™ºèƒ½å¹³è¡¡å°è»Šä½¿ç”¨äº†æ¸¬é‡å‚¾è§’å’Œå‚¾è§’é€Ÿåº¦çš„é›†æˆå‚³æ„Ÿå™¨é™€</p><p>èºå„€-MPU6050ã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/8021272046367614203#"><img src="https://www.yahboom.com/Public/ueditor/php/upload/image/20170428/1493391676860635.png"></a></p><h2 id="PIDåŸºç¤åŸç†"><a href="#PIDåŸºç¤åŸç†" class="headerlink" title="PIDåŸºç¤åŸç†"></a>PIDåŸºç¤åŸç†</h2><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/8021272046367614203#"><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTzao2WL5PfdKdzRKN0BewHy5ofJqsEeCmNCA&usqp=CAU"></a></p><p>PIDèª¿ç¯€ç³»çµ±PIDåŠŸèƒ½ç”±PIDèª¿ç¯€å™¨æˆ–DCSç³»çµ±å…§éƒ¨åŠŸèƒ½ç¨‹åºæ¨¡å¡Šå¯¦ç¾ï¼Œäº†è§£èˆ‡PIDèª¿ç¯€ç›¸é—œçš„ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼Œæœ‰åŠ©æ–¼PIDå…¥é–€æ–°æ‰‹å¿«é€Ÿç†Ÿæ‚‰èª¿ç¯€å™¨æ‡‰ç”¨ï¼Œåœ¨è‡ªå‹•èª¿ç¯€ç³»çµ±ä¸­æˆåŠŸæ•´å®šPIDåƒæ•¸ã€‚</p><p>1ã€è¢«èª¿é‡</p><p>è¢«èª¿é‡å°±æ˜¯åæ˜ è¢«èª¿å°è±¡çš„å¯¦éš›æ³¢å‹•çš„é‡å€¼ã€‚è¢«èª¿é‡æ˜¯ç¶“å¸¸è®ŠåŒ–çš„ã€‚</p><p>2ã€è¨­å®šå€¼</p><p>PIDèª¿ç¯€å™¨è¨­å®šå€¼å°±æ˜¯äººå€‘æœŸå¾…è¢«èª¿é‡éœ€è¦é”åˆ°çš„å€¼ã€‚è¨­å®šå€¼å¯ä»¥æ˜¯å›ºå®šçš„ï¼Œä¹Ÿå¯ä»¥æ˜¯è®ŠåŒ–çš„ã€‚</p><p>3ã€æ§åˆ¶è¼¸å‡º</p><p>Â  Â  æ§åˆ¶è¼¸å‡ºæŒ‡PIDèª¿ç¯€å™¨æ ¹æ“šè¢«èª¿é‡çš„è®ŠåŒ–æƒ…æ³é‹ç®—ä¹‹å¾Œç™¼å‡ºçš„è®“å¤–éƒ¨åŸ·è¡Œçµæ§‹æŒ‰ç…§å®ƒçš„è¦æ±‚å‹•ä½œçš„æŒ‡ä»¤ã€‚åœ¨PIDèª¿ç¯€å™¨å’ŒåŸ·è¡Œæ©Ÿæ§‹ä¹‹é–“é‚„æœƒæœ‰å…¶ä»–ç’°ç¯€ï¼Œæ¯”å¦‚é™å¹…ã€ä¼ºæœæ”¾å¤§å™¨ç­‰ã€‚é™å¹…åŠŸèƒ½é€šå¸¸åœ¨PIDèª¿ç¯€å™¨å…§å®Œæˆï¼›å¦‚æœå¦‚æœå°‡PIDã€é™å¹…å’Œä¼ºæœæ”¾å¤§å™¨åŠŸèƒ½åšåœ¨ä¸€å°å„€è¡¨å…§å°±æ§‹æˆé–¥ä½æ§åˆ¶PIDèª¿ç¯€å™¨ï¼›å°‡ä¼ºæœæ”¾å¤§å™¨å’Œé™å¹…åšåœ¨åŸ·è¡Œæ©Ÿæ§‹è£¡å°±æ§‹æˆæ™ºèƒ½åŸ·è¡Œæ©Ÿæ§‹ã€‚</p><p>4ã€è¼¸å…¥åå·®</p><p>è¼¸å…¥åå·®æ™‚è¢«èª¿é‡å’Œè¨­å®šå€¼ä¹‹é–“çš„å·®å€¼</p><p>5ã€Pï¼ˆæ¯”ä¾‹ï¼‰</p><p>På°±æ˜¯æ¯”ä¾‹ä½œç”¨ï¼Œç°¡å–®èªªå°±æ˜¯è¼¸å…¥åå·®ä¹˜ä»¥ä¸€å€‹ä¿‚æ•¸ã€‚</p><p>6ã€Iï¼ˆç©åˆ†ï¼‰</p><p>Iå°±æ˜¯ç©åˆ†ï¼Œç°¡å–®èªªå°±æ˜¯å°‡è¼¸å…¥åå·®é€²è¡Œç©åˆ†é‹ç®—ã€‚</p><p>7ã€Dï¼ˆå¾®åˆ†ï¼‰</p><p>Då°±æ˜¯å¾®åˆ†ï¼Œç°¡å–®èªªå°±æ˜¯å°‡è¼¸å…¥åå·®é€²è¡Œå¾®åˆ†é‹ç®—</p><p>8ã€PIDåŸºæœ¬å…¬å¼</p><p>PIDèª¿ç¯€å™¨åƒæ•¸æ•´å®šéç¨‹é€šä¿—è¬›å°±æ˜¯å…ˆæŠŠç³»çµ±èª¿ç‚ºç´”æ¯”ä¾‹ä½œç”¨ï¼Œé€æ­¥å¢å¼·æ¯”ä¾‹ä½œç”¨è®“ç³»çµ±æŒ¯ç›ªï¼Œè¨˜éŒ„ä¸‹æ¯”ä¾‹ä½œç”¨å’ŒæŒ¯ç›ªé€±æœŸï¼Œç„¶å¾Œé€™å€‹æ¯”ä¾‹ä½œç”¨ä¹˜ä»¥0.6ï¼Œç©åˆ†ä½œç”¨é©ç•¶å»¶é•·</p><p>KP=0.6 Km</p><p>KD= KPÃ—Ï€/4Ï‰</p><p>KI= KPÃ—Ï‰/Ï€</p><p>Â  Â  Â å…¬å¼ä¸­KPç‚ºæ¯”ä¾‹æ§åˆ¶åƒæ•¸ï¼›KIç‚ºç©åˆ†æ§åˆ¶åƒæ•¸ï¼›KDç‚ºå¾®åˆ†æ§åˆ¶åƒæ•¸ï¼›Kmç‚ºç³»çµ±é–‹å§‹æŒ¯ç›ªæ˜¯çš„æ¯”ä¾‹å€¼ï¼›Ï‰ç‚ºæ¥µåæ¨™ä¸‹æŒ¯ç›ªæ™‚çš„é »ç‡</p><p>9ã€å‹•æ…‹åå·®</p><p>åœ¨èª¿ç¯€éç¨‹ä¸­ï¼Œè¢«èª¿é‡å’Œè¨­å®šå€¼ä¹‹é–“çš„åå·®éš¨æ™‚æ”¹è®Šï¼Œä»»æ„æ™‚åˆ»å…©è€…ä¹‹é–“çš„åå·®å«åšå‹•æ…‹åå·®ã€‚</p><p>10ã€éœæ…‹åå·®</p><p>Â  Â  èª¿ç¯€è¶¨æ–¼ç©©å®šä¹‹å¾Œï¼Œè¢«èª¿é‡å’Œè¨­å®šå€¼ä¹‹é–“é‚„å­˜åœ¨çš„åå·®äº¤éœæ…‹åå·®ã€‚æ¶ˆé™¤éœæ…‹åå·®æ˜¯é€šéPIDèª¿ç¯€å™¨ç©åˆ†ä½œç”¨ä¾†å¯¦ç¾çš„ã€‚</p><h2 id="å…¶å¯¦ä¸€é–‹å§‹çœ‹èµ·ä¾†å¾ˆè¤‡é›œï¼Œä½†åŸç†å­¸ç¿’æ˜¯å¿…é ˆçš„ï¼Œé‚„å¥½ç¾åœ¨æœ‰ä¸€ç¨®PIDçš„å‡½å¼é–‹æºï¼Œæ¸›è¼•äº†æƒ³å­¸å¹³è¡¡è»Šçš„å°ç™½å£“åŠ›ã€‚"><a href="#å…¶å¯¦ä¸€é–‹å§‹çœ‹èµ·ä¾†å¾ˆè¤‡é›œï¼Œä½†åŸç†å­¸ç¿’æ˜¯å¿…é ˆçš„ï¼Œé‚„å¥½ç¾åœ¨æœ‰ä¸€ç¨®PIDçš„å‡½å¼é–‹æºï¼Œæ¸›è¼•äº†æƒ³å­¸å¹³è¡¡è»Šçš„å°ç™½å£“åŠ›ã€‚" class="headerlink" title="å…¶å¯¦ä¸€é–‹å§‹çœ‹èµ·ä¾†å¾ˆè¤‡é›œï¼Œä½†åŸç†å­¸ç¿’æ˜¯å¿…é ˆçš„ï¼Œé‚„å¥½ç¾åœ¨æœ‰ä¸€ç¨®PIDçš„å‡½å¼é–‹æºï¼Œæ¸›è¼•äº†æƒ³å­¸å¹³è¡¡è»Šçš„å°ç™½å£“åŠ›ã€‚"></a>å…¶å¯¦ä¸€é–‹å§‹çœ‹èµ·ä¾†å¾ˆè¤‡é›œï¼Œä½†åŸç†å­¸ç¿’æ˜¯å¿…é ˆçš„ï¼Œé‚„å¥½ç¾åœ¨æœ‰ä¸€ç¨®PIDçš„å‡½å¼é–‹æºï¼Œæ¸›è¼•äº†æƒ³å­¸å¹³è¡¡è»Šçš„å°ç™½å£“åŠ›ã€‚</h2><hr><h2 id="å°è»Šçµæ§‹"><a href="#å°è»Šçµæ§‹" class="headerlink" title="å°è»Šçµæ§‹"></a>å°è»Šçµæ§‹</h2><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/8021272046367614203#"><img src="https://1.bp.blogspot.com/-dSw5qBhX-4w/YW0ARu-BDCI/AAAAAAAAe-Q/ZczglO3TM_ApVnzwrx6hzq7Yr2RFnn4rgCNcBGAsYHQ/w284-h320/%25E5%25B9%25B3%25E8%25A1%25A1%25E8%25BB%258A3.jpg"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/8021272046367614203#"><img src="https://1.bp.blogspot.com/-luczZi6wtjY/YWz_5Io5bOI/AAAAAAAAe-I/9F3D8UvgGpU0g0l-rFmcwuxPgHPAXwptgCNcBGAsYHQ/s320/%25E5%25B9%25B3%25E8%25A1%25A1%25E8%25BB%258A1.jpg"></a>  </p><p>å¹³è¡¡è»Šä¸»è¦ç”¨çš„é›»æ©Ÿé¦¬é”å¸¸è¦‹çš„æ˜¯ç·¨ç¢¼å¼çš„ï¼Œå…¶å¯¦ç”¨ä¸€èˆ¬é¦¬é”ä¹Ÿå¯ä»¥ï¼Œå·®åˆ¥åœ¨æ–¼ç©©å®šæ€§ï¼Œå› ç‚ºç¬¬ä¸€æ¬¡åšï¼Œæ‰€ä»¥æˆ‘é¸ç”¨ä¸€èˆ¬é›»æ©Ÿé¦¬é”ã€‚</p><p>å¯¦é«”å¦‚æœæ˜¯è‡ªå·±è‡ªåˆ¶ï¼Œé‚£é…ç½®å¹³è¡¡å°±è¦ç•™æ„äº›ï¼Œä¹Ÿå°±æ˜¯èªªåœ¨é…ç½®ç¡¬é«”æ™‚ï¼Œéœæ…‹çš„ç‹€æ…‹ä¸‹æœ€å¥½èƒ½æœ‰ä¸€å®šçš„å¹³è¡¡é»ã€‚</p><p>é¦¬é”çš„éƒ¨ä»½ï¼Œåœ¨å®‰ç½®å…©é‚Šé¦¬é”ï¼Œæ¸›é€Ÿçµ„å’Œåœ°é¢å‘ˆå‚ç›´ï¼Œè»Šé«”æ‰ä¸æœƒåå‘å‰å¾Œè®Šå¾—ä¸å¹³è¡¡ã€‚</p><h2 id="æ¥ç·šæ–¹å¼"><a href="#æ¥ç·šæ–¹å¼" class="headerlink" title="æ¥ç·šæ–¹å¼"></a>æ¥ç·šæ–¹å¼</h2><p><strong>é€™è£¡è¦ç‰¹åˆ¥æ³¨æ„ï¼Œé›–ç„¶åœ–ä¸Šç•«çš„L298Nç”¨ä¸€çµ„é›»æ± ä¾›æ‡‰L298Nå’ŒArduinoï¼Œä½†æˆ‘å€‹äººæäº†ä¸€å¤©æ‰ç™¼ç¾ï¼Œæœ€å¥½L298Nå’ŒUNOåˆ†é–‹ä¾›é›»ã€‚</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/8021272046367614203#"><img src="https://circuitdigest.com/sites/default/files/circuitdiagram_mic/Circuit-Diagram-for-DIY-Self-Balancing-Robot-using-Arduino.png"></a></p><hr><h2 id="ç·¨è¼¯ç¨‹å¼"><a href="#ç·¨è¼¯ç¨‹å¼" class="headerlink" title="ç·¨è¼¯ç¨‹å¼"></a>ç·¨è¼¯ç¨‹å¼</h2><p>ä¾†æºåƒè€ƒ:<a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/8021272046367614203#">https://www.yiboard.com/thread-939-1-1.html</a></p><p>ç¾åœ¨æˆ‘å€‘éœ€è¦å°Arduino UNOé–‹ç™¼æ¿é€²è¡Œç·¨ç¨‹ä»¥å¹³è¡¡æ©Ÿå™¨äººã€‚é€™å°±æ˜¯æ‰€æœ‰ç¥å¥‡é­”æ³•ç™¼ç”Ÿçš„åœ°æ–¹ï¼›å®ƒèƒŒå¾Œçš„æ¦‚å¿µå¾ˆç°¡å–®ã€‚æˆ‘å€‘éœ€è¦é€šéä½¿ç”¨MPU6050ä¾†æª¢æŸ¥æ©Ÿå™¨äººæ˜¯å¦å‘å‰å‚¾æ–œæˆ–å‘å¾Œå‚¾æ–œï¼Œç„¶å¾Œå¦‚æœå®ƒå‘å‰å‚¾æ–œæˆ‘å€‘å¿…é ˆå‘å‰æ—‹è½‰è»Šè¼ªï¼Œå¦‚æœå®ƒå‘å¾Œå‚¾æ–œæˆ‘å€‘å¿…é ˆåœ¨ç›¸åçš„æ–¹å‘æ—‹è½‰è»Šè¼ªã€‚</p><p>åŒæ™‚æˆ‘å€‘é‚„å¿…é ˆæ§åˆ¶è»Šè¼ªæ—‹è½‰çš„é€Ÿåº¦ï¼Œå¦‚æœæ©Ÿå™¨äººå¾ä¸­å¿ƒä½ç½®ç•¥å¾®è¿·å¤±æ–¹å‘ï¼Œè»Šè¼ªæœƒç·©æ…¢æ—‹è½‰ï¼Œä¸¦ä¸”ç•¶è»Šè¼›é›¢ä¸­å¿ƒä½ç½®è¶Šä¾†è¶Šé æ™‚é€Ÿåº¦æœƒå¢åŠ ã€‚ç‚ºäº†å¯¦ç¾é€™å€‹é‚è¼¯ï¼Œæˆ‘å€‘ä½¿ç”¨PIDç®—æ³•ï¼Œå…¶ä¸­å¿ƒä½ç½®ç‚ºè¨­å®šé»ï¼Œè¿·å¤±æ–¹å‘çš„å¼·åº¦ç‚ºè¼¸å‡ºã€‚</p><p>è¦çŸ¥é“æ©Ÿå™¨äººçš„ç•¶å‰ä½ç½®ï¼Œæˆ‘å€‘ä½¿ç”¨MPU6050ï¼Œå®ƒæ˜¯ä¸€å€‹6è»¸åŠ é€Ÿåº¦è¨ˆå’Œé™€èºå„€å‚³æ„Ÿå™¨ç›¸çµåˆã€‚ç‚ºäº†å¾å‚³æ„Ÿå™¨ç²å¾—å¯é çš„ä½ç½®å€¼ï¼Œæˆ‘å€‘éœ€è¦ä½¿ç”¨åŠ é€Ÿåº¦è¨ˆå’Œé™€èºå„€çš„å€¼ï¼Œå› ç‚ºåŠ é€Ÿåº¦è¨ˆçš„å€¼å­˜åœ¨å™ªè²å•é¡Œï¼Œé™€èºå„€çš„å€¼æœƒéš¨æ™‚é–“æ¼‚ç§»ã€‚å› æ­¤ï¼Œæˆ‘å€‘å¿…é ˆçµåˆå…©è€…ä¸¦ç²å¾—æˆ‘å€‘çš„æ©Ÿå™¨äººçš„åèˆªä¿¯ä»°å’Œæ»¾å‹•çš„å€¼ï¼Œå…¶ä¸­æˆ‘å€‘å°‡åƒ…ä½¿ç”¨åèˆªçš„å€¼ã€‚</p><p>è½èµ·ä¾†æœ‰é»é ­æšˆå—ï¼Ÿä½†æ˜¯ä¸ç”¨æ“”å¿ƒï¼Œåœ¨Arduinoç¤¾å€ï¼Œæˆ‘å€‘æœ‰ç¾æˆçš„åº«ï¼Œå¯ä»¥åŸ·è¡ŒPIDè¨ˆç®—ï¼Œä¹Ÿå¯ä»¥å¾MPU6050ç²å¾—åèˆªå€¼ã€‚è©²åº«åˆ†åˆ¥ç”±br3ttbå’Œjrowbergé–‹ç™¼ã€‚åœ¨å¾ä»¥ä¸‹éˆæ¥ä¸‹è¼‰é€™äº›åº«ä¹‹å‰ï¼Œå…ˆå°‡å®ƒå€‘æ·»åŠ åˆ°æ‚¨çš„Arduino libç›®éŒ„ä¸­ã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/8021272046367614203#">https://github.com/br3ttb/Arduino-PID-Library/blob/master/PID_v1.h</a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/8021272046367614203#">https://github.com/jrowberg/i2cdevlib/tree/master/Arduino/MPU6050</a></p><p>ç¾åœ¨ï¼Œæˆ‘å€‘å·²å°‡åº«æ·»åŠ åˆ°Arduino IDEä¸­ã€‚è®“æˆ‘å€‘é–‹å§‹ç‚ºè‡ªå¹³è¡¡æ©Ÿå™¨äººç·¨ç¨‹ã€‚æˆ‘å€‘åœ¨æœ¬é æœ«å°¾è™•çµ¦å‡ºäº†é …ç›®çš„å®Œæ•´ä»£ç¢¼ï¼Œé€™è£¡æˆ‘å€‘åªæ˜¯è§£é‡‹ä»£ç¢¼ä¸­æœ€é‡è¦çš„ä»£ç¢¼ç‰‡æ®µã€‚åœ¨ä»‹ç´¹é€™äº›ä»£ç¢¼ä¹‹å‰ï¼Œæˆ‘å€‘å…ˆè²æ˜ï¼Œä»£ç¢¼æ˜¯å»ºç«‹åœ¨MPU6050ç¤ºä¾‹ä»£ç¢¼ä¹‹ä¸Šçš„ï¼Œæˆ‘å€‘åªæ˜¯ç‚ºäº†ç›®çš„å„ªåŒ–ä»£ç¢¼ï¼Œä¸¦ç‚ºæˆ‘å€‘çš„è‡ªå¹³è¡¡æ©Ÿå™¨äººæ·»åŠ PIDå’Œæ§åˆ¶æŠ€è¡“ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘å€‘åŒ…æ‹¬æ­¤ç¨‹åºå·¥ä½œæ‰€éœ€çš„åº«ã€‚åŒ…æ‹¬å…§ç½®I2Cåº«ã€æˆ‘å€‘å‰›å‰›ä¸‹è¼‰çš„PIDåº«å’ŒMPU6050åº«ã€‚</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">1.  #include &quot;I2Cdev.h&quot;      2.  #include &lt;PID\_v1.h&gt; &#x2F;&#x2F;From https:&#x2F;&#x2F;github.com&#x2F;br3ttb&#x2F;Arduino-PID-Library&#x2F;blob&#x2F;master&#x2F;PID\_v1.h      3.  #include &quot;MPU6050\_6Axis\_MotionApps20.h&quot; &#x2F;&#x2F;https:&#x2F;&#x2F;github.com&#x2F;jrowberg&#x2F;i2cdevlib&#x2F;tree&#x2F;master&#x2F;Arduino&#x2F;MPU6050<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶å¾Œæˆ‘å€‘è²æ˜å¾MPU6050å‚³æ„Ÿå™¨ç²å–æ•¸æ“šæ‰€éœ€çš„è®Šé‡ã€‚æˆ‘å€‘è®€å–äº†é‡åŠ›çŸ¢é‡å’Œå››å…ƒæ•¸å€¼ï¼Œç„¶å¾Œè¨ˆç®—æ©Ÿå™¨äººçš„åèˆªä¿¯ä»°å’Œæ»¾è½‰å€¼ã€‚æµ®é»æ•¸çµ„ypr [3]å°‡ä¿å­˜æœ€çµ‚çµæœã€‚</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">1.  &#x2F;&#x2F; MPU control&#x2F;status vars      2.  bool dmpReady &#x3D; false;Â Â &#x2F;&#x2F; set true if DMP init was successful      3.  uint8_t mpuIntStatus;Â  Â &#x2F;&#x2F; holds actual interrupt status byte from MPU      4.  uint8_t devStatus;Â  Â Â  Â &#x2F;&#x2F; return status after each device operation (0 &#x3D; success, !0 &#x3D; error)      5.  uint16_t packetSize;Â  Â  &#x2F;&#x2F; expected DMP packet size (default is 42 bytes)      6.  uint16_t fifoCount;Â  Â Â Â &#x2F;&#x2F; count of all bytes currently in FIFO      7.  uint8_t fifoBuffer[64]; &#x2F;&#x2F; FIFO storage buffer      8.        9.  &#x2F;&#x2F; orientation&#x2F;motion vars      10.  Quaternion q;Â  Â Â  Â Â  Â Â Â &#x2F;&#x2F; [w, x, y, z]Â  Â Â  Â Â  Â quaternion container      11.  VectorFloat gravity;Â  Â  &#x2F;&#x2F; [x, y, z]Â  Â Â  Â Â  Â Â  Â gravity vector      12.  float ypr[3];Â  Â Â  Â Â  Â Â Â &#x2F;&#x2F; [yaw, pitch, roll]Â  Â yaw&#x2F;pitch&#x2F;roll container and gravity vector<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ä¸‹ä¾†æ˜¯ä»£ç¢¼ä¸­éå¸¸é‡è¦çš„éƒ¨åˆ†ï¼Œé€™æ˜¯æ‚¨åœ¨èª¿æ•´æ­£ç¢ºçš„å€¼é›†æ™‚èŠ±è²»å¾ˆé•·æ™‚é–“çš„åœ°æ–¹ã€‚å¦‚æœæ‚¨çš„æ©Ÿå™¨äººå…·æœ‰éå¸¸å¥½çš„é‡å¿ƒä¸¦ä¸”çµ„ä»¶å°ç¨±æ’åˆ—ï¼ˆåœ¨å¤§å¤šæ•¸æƒ…æ³ä¸‹ä¸æ˜¯ï¼‰ï¼Œé‚£éº¼æ‚¨çš„è¨­å®šé»çš„å€¼å°‡ç‚º180ã€‚å¦å‰‡å°‡æ‚¨çš„æ©Ÿå™¨äººé€£æ¥åˆ°Arduinoä¸²è¡Œç›£è¦–å™¨ä¸¦å°‡å…¶å‚¾æ–œç›´åˆ°ä½ æ‰¾åˆ°äº†ä¸€å€‹å¾ˆå¥½çš„å¹³è¡¡ä½ç½®ï¼Œè®€å–ä¸²è¡Œç›£è¦–å™¨ä¸Šé¡¯ç¤ºçš„å€¼ï¼Œé€™æ˜¯ä½ çš„è¨­å®šå€¼ã€‚ Kpã€Kdå’ŒKiçš„å€¼å¿…é¬šæ ¹æ“šæ‚¨çš„æ©Ÿå™¨äººé€²è¡Œèª¿æ•´ã€‚æ²’æœ‰å…©å€‹ç›¸åŒçš„æ©Ÿå™¨äººå°‡å…·æœ‰ç›¸åŒçš„Kpã€Kdå’ŒKiå€¼ï¼Œå› æ­¤æ²’æœ‰æ–¹æ³•é¿å…ã€‚</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">1.  &#x2F;\*\*\*\*\*\*\*\*\*Tune these 4 values for your BOT\*\*\*\*\*\*\*\*\*&#x2F;      2.  double setpoint&#x3D; 176; &#x2F;&#x2F;set the value when the bot is perpendicular to ground using serial monitor.      3.  &#x2F;&#x2F;Read the project documentation on circuitdigest.com to learn how to set these values      4.  double Kp &#x3D; 21; &#x2F;&#x2F;Set this first      5.  double Kd &#x3D; 0.8; &#x2F;&#x2F;Set this secound      6.  double Ki &#x3D; 140; &#x2F;&#x2F;Finally set this      7.  &#x2F;\*\*\*\*\*\*End of values setting\*\*\*\*\*\*\*\*\*&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨æ¥ä¸‹ä¾†çš„ä»£ç¢¼ä¸­ï¼Œæˆ‘å€‘é€šéå‚³éè¼¸å…¥è®Šé‡è¼¸å…¥ã€è¼¸å‡ºã€è¨­å®šé»ã€Kpã€Kiå’ŒKdä¾†åˆå§‹åŒ–PIDç®—æ³•ã€‚å…¶ä¸­æˆ‘å€‘å·²ç¶“åœ¨ä¸Šé¢çš„ä»£ç¢¼ç‰‡æ®µä¸­è¨­ç½®äº†è¨­å®šé»Kpã€Kiå’ŒKdçš„å€¼ã€‚è¼¸å…¥å€¼å°‡æ˜¯å¾MPU6050å‚³æ„Ÿå™¨è®€å–çš„åèˆªçš„ç•¶å‰å€¼ï¼Œè¼¸å‡ºå€¼å°‡æ˜¯PIDç®—æ³•è¨ˆç®—çš„å€¼ã€‚å› æ­¤ï¼ŒåŸºæœ¬ä¸ŠPIDç®—æ³•å°‡ç‚ºæˆ‘å€‘æä¾›ä¸€å€‹è¼¸å‡ºå€¼ï¼Œè©²è¼¸å‡ºå€¼æ‡‰è©²ç”¨æ–¼å°‡è¼¸å…¥å€¼æ ¡æ­£ç‚ºæ¥è¿‘è¨­å®šé»ã€‚</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">1.  PID pid(&amp;input, &amp;output, &amp;setpoint, Kp, Ki, Kd, DIRECT);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨void setup()å‡½æ•¸ä¸­ï¼Œæˆ‘å€‘é€šéé…ç½®DMPï¼ˆæ•¸å­—é‹å‹•è™•ç†å™¨ï¼‰åˆå§‹åŒ–MPU6050ã€‚é€™å°‡æœ‰åŠ©æ–¼æˆ‘å€‘å°‡åŠ é€Ÿåº¦è¨ˆæ•¸æ“šèˆ‡é™€èºå„€æ•¸æ“šç›¸çµåˆï¼Œä¸¦æä¾›å¯é çš„åèˆªã€ä¿¯ä»°å’Œæ»¾è½‰å€¼ã€‚æˆ‘å€‘ä¸æœƒæ·±å…¥ç ”ç©¶é€™ä¸€é»ï¼Œå› ç‚ºå®ƒé é è¶…å‡ºäº†ä¸»é¡Œã€‚ç„¡è«–å¦‚ä½•ï¼Œæ‚¨å¿…é ˆåœ¨setupå‡½æ•¸ä¸­æŸ¥æ‰¾çš„ä¸€æ®µä»£ç¢¼æ˜¯é™€èºå„€åç§»å€¼ã€‚æ¯å€‹MPU6050å‚³æ„Ÿå™¨éƒ½æœ‰è‡ªå·±çš„åç§»å€¼ï¼Œ<strong>æ‚¨å¯ä»¥ä½¿ç”¨æ­¤<a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/8021272046367614203#">Arduinoç¯„ä¾‹</a>è¨ˆç®—å‚³æ„Ÿå™¨çš„åç§»å€¼ï¼Œä¸¦åœ¨ç¨‹åºä¸­ç›¸æ‡‰æ›´æ–°ä»¥ä¸‹è¡Œ</strong>ã€‚</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">1.  Â &#x2F;&#x2F; supply your own gyro offsets here, scaled for min sensitivity      2.  Â  Â  mpu.setXGyroOffset(220);      3.  Â  Â  mpu.setYGyroOffset(76);      4.  Â  Â  mpu.setZGyroOffset(-85);      5.  Â  Â  mpu.setZAccelOffset(1688);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬è¿˜å¿…é¡»åˆå§‹åŒ–æˆ‘ä»¬ç”¨æ¥è¿æ¥ç”µæœºçš„æ•°å­—PWMå¼•è„šã€‚ åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œä½¿ç”¨çš„æ˜¯D6ã€D9ã€D10å’ŒD11ã€‚ å› æ­¤æˆ‘ä»¬åˆå§‹åŒ–è¿™äº›å¼•è„šä¸ºè¾“å‡ºå¼•è„šï¼Œé»˜è®¤ä¸ºä½ç”µå¹³ã€‚</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">1.  &#x2F;&#x2F;Initialise the Motor outpu pins      2.  Â  Â  pinMode (6, OUTPUT);      3.  Â  Â  pinMode (9, OUTPUT);      4.  Â  Â  pinMode (10, OUTPUT);      5.  Â  Â  pinMode (11, OUTPUT);      6.        7.  &#x2F;&#x2F;By default turn off both the motors      8.  Â  Â  analogWrite(6,LOW);      9.  Â  Â  analogWrite(9,LOW);      10.  Â  Â  analogWrite(10,LOW);      11.  Â  Â  analogWrite(11,LOW);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨loopå‡½æ•¸å…§éƒ¨ï¼Œæˆ‘å€‘æª¢æŸ¥MPU6050çš„æ•¸æ“šæ˜¯å¦å¯ä»¥è®€å–ã€‚å¦‚æœæ˜¯ï¼Œå‰‡æˆ‘å€‘ä½¿ç”¨å®ƒä¾†è¨ˆç®—PIDå€¼ï¼Œç„¶å¾Œåœ¨ä¸²è¡Œç›£è¦–å™¨ä¸Šé¡¯ç¤ºPIDçš„è¼¸å…¥å’Œè¼¸å‡ºå€¼ï¼Œä»¥æª¢æŸ¥PIDçš„éŸ¿æ‡‰æ–¹å¼ã€‚ç„¶å¾Œæ ¹æ“šè¼¸å‡ºå€¼æˆ‘å€‘æ±ºå®šæ©Ÿå™¨äººæ˜¯å‘å‰é‚„æ˜¯å‘å¾Œç§»å‹•é‚„æ˜¯éœæ­¢ä¸å‹•ã€‚</p><p>å› ç‚ºæˆ‘å€‘å‡è¨­ç•¶æ©Ÿå™¨äººç›´ç«‹æ™‚MPU6050å°‡è¿”å›180ã€‚ç•¶æ©Ÿå™¨äººå‘å‰å‚¾æ–œæ™‚ï¼Œæˆ‘å€‘å°‡ç²å¾—æ­£å€¼æ ¡æ­£å€¼ï¼Œå¦‚æœæ©Ÿå™¨äººå‘å¾Œå‚¾æ–œï¼Œæˆ‘å€‘å°‡å¾—åˆ°è² å€¼ã€‚æ‰€ä»¥æˆ‘å€‘æª¢æŸ¥é€™å€‹æ¢ä»¶ä¸¦èª¿ç”¨ç›¸æ‡‰çš„å‡½æ•¸ä¾†ç§»å‹•æ©Ÿå™¨äººå‰é€²æˆ–å¾Œé€€ã€‚</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">1.  Â while (!mpuInterrupt &amp;&amp; fifoCount &lt; packetSize)      2.  Â  Â  &#123;      3.  Â  Â Â  Â Â Â &#x2F;&#x2F;no mpu data - performing PID calculations and output to motorsÂ  Â       4.  Â  Â Â  Â Â Â pid.Compute();Â Â       5.  Â  Â Â  Â       6.  Â  Â Â  Â Â Â &#x2F;&#x2F;Print the value of Input and Output on serial monitor to check how it is working.      7.  Â  Â Â  Â Â Â Serial.print(input); Serial.print(&quot; &#x3D;&gt;&quot;); Serial.println(output);      8.  Â  Â Â  Â Â  Â Â  Â Â Â       9.  Â  Â Â  Â Â Â if (input&gt;150 &amp;&amp; input&lt;200)&#123;&#x2F;&#x2F;If the Bot is falling      10.  Â  Â Â  Â Â  Â       11.  Â  Â Â  Â Â Â if (output&gt;0) &#x2F;&#x2F;Falling towards front      12.  Â  Â Â  Â Â Â Forward(); &#x2F;&#x2F;Rotate the wheels forward      13.  Â  Â Â  Â Â Â else if (output&lt;0) &#x2F;&#x2F;Falling towards back      14.  Â  Â Â  Â Â Â Reverse(); &#x2F;&#x2F;Rotate the wheels backward      15.  Â  Â Â  Â Â Â &#125;      16.  Â  Â Â  Â Â Â else &#x2F;&#x2F;If Bot not falling      17.  Â  Â Â  Â Â Â Stop(); &#x2F;&#x2F;Hold the wheels still      18.  Â  Â  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>PIDè¼¸å‡ºè®Šé‡é‚„æ±ºå®šäº†é›»æ©Ÿæ—‹è½‰çš„é€Ÿåº¦ã€‚å¦‚æœæ©Ÿå™¨äººå³å°‡æ‘”å€’ï¼Œé‚£éº¼æˆ‘å€‘é€šéç·©æ…¢æ—‹è½‰è»Šè¼ªé€²è¡Œå¾®å°ä¿®æ­£ã€‚å¦‚æœé€™äº›å°çš„æ ¡æ­£å·¥ä½œä»ç„¶æœ‰æ•ˆï¼Œä½†å¦‚æœæ©Ÿå™¨äººè·Œè½ï¼Œæˆ‘å€‘æœƒæé«˜é›»æ©Ÿçš„é€Ÿåº¦ã€‚è»Šè¼ªæ—‹è½‰çš„é€Ÿåº¦å€¼å°‡ç”±PIç®—æ³•æ±ºå®šã€‚è«‹æ³¨æ„ï¼Œå°æ–¼Reverseå‡½æ•¸ï¼Œæˆ‘å€‘å°‡è¼¸å‡ºå€¼ä¹˜ä»¥-1ï¼Œä»¥ä¾¿æˆ‘å€‘å¯ä»¥å°‡è² å€¼è½‰æ›ç‚ºæ­£å€¼ã€‚</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">1.  void Forward() &#x2F;&#x2F;Code to rotate the wheel forward      2.  &#123;      3.  Â  Â  analogWrite(6,output);      4.  Â  Â  analogWrite(9,0);      5.  Â  Â  analogWrite(10,output);      6.  Â  Â  analogWrite(11,0);      7.  Â  Â  Serial.print(&quot;F&quot;); &#x2F;&#x2F;Debugging information      8.  &#125;      9.        10.  void Reverse() &#x2F;&#x2F;Code to rotate the wheel Backward      11.  &#123;      12.  Â  Â  analogWrite(6,0);      13.  Â  Â  analogWrite(9,output*-1);      14.  Â  Â  analogWrite(10,0);      15.  Â  Â  analogWrite(11,output*-1);      16.  Â  Â Serial.print(&quot;R&quot;);      17.  &#125;      18.        19.  void Stop() &#x2F;&#x2F;Code to stop both the wheels      20.  &#123;      21.  Â  Â  analogWrite(6,0);      22.  Â  Â  analogWrite(9,0);      23.  Â  Â  analogWrite(10,0);      24.  Â  Â  analogWrite(11,0);      25.  Â  Â  Serial.print(&quot;S&quot;);      26.  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å®Œæ•´ç¨‹å¼ç¢¼"><a href="#å®Œæ•´ç¨‹å¼ç¢¼" class="headerlink" title="å®Œæ•´ç¨‹å¼ç¢¼"></a>å®Œæ•´ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;*Arduino Self Balancing RobotÂ \* Code by: B.Aswinth RajÂ \* Build on top of Lib: https:&#x2F;&#x2F;github.com&#x2F;jrowberg&#x2F;i2cdevlib&#x2F;tree&#x2F;master&#x2F;Arduino&#x2F;MPU6050Â \* Website: circuitdigest.comÂ *&#x2F;#include &quot;I2Cdev.h&quot;#include &lt;PID_v1.h&gt; &#x2F;&#x2F;From https:&#x2F;&#x2F;github.com&#x2F;br3ttb&#x2F;Arduino-PID-Library&#x2F;blob&#x2F;master&#x2F;PID_v1.h#include &quot;MPU6050_6Axis_MotionApps20.h&quot; &#x2F;&#x2F;https:&#x2F;&#x2F;github.com&#x2F;jrowberg&#x2F;i2cdevlib&#x2F;tree&#x2F;master&#x2F;Arduino&#x2F;MPU6050  MPU6050 mpu;  &#x2F;&#x2F; MPU control&#x2F;status varsbool dmpReady &#x3D; false; &#x2F;&#x2F; å¦‚æœDMPåˆå§‹åŒ–æˆåŠŸï¼Œåˆ™è®¾ç½®ä¸º1uint8_t mpuIntStatus; &#x2F;&#x2F; ä¿å­˜mpuä¸­æ–­çŠ¶æ€uint8_t devStatus; &#x2F;&#x2F; è¿è¡Œåè¿”å›çŠ¶æ€0è¡¨ç¤ºæˆåŠŸï¼Œ!0æœ‰é”™è¯¯uint16_t packetSize; &#x2F;&#x2F; DMPæ•°æ®åŒ…çš„å¤§å°uint16_t fifoCount; &#x2F;&#x2F; ç»Ÿè®¡å½“å‰åœ¨FIFOçš„å­—èŠ‚æ•°uint8_t fifoBuffer[64]; &#x2F;&#x2F; FIFOå‚¨å­˜ç¼“å†²åŒº  &#x2F;&#x2F; orientation&#x2F;motion varsQuaternion q; &#x2F;&#x2F; [w, x, y, z] &#x2F;&#x2F; (æ–¹ä½,è¿åŠ¨)å˜é‡VectorFloat gravity; &#x2F;&#x2F; [x, y, z] &#x2F;&#x2F;é‡åŠ›çŸ¢é‡float ypr[3]; &#x2F;&#x2F;yaw&#x2F;pitch&#x2F;rollï¼ˆåèˆª&#x2F;ä¿¯ä»°&#x2F;æ»šåŠ¨ï¼‰æ•°ç»„  &#x2F;\*\*\*\*\*\*\*\*\*Tune these 4 values for your BOT\*\*\*\*\*\*\*\*\*&#x2F;double setpoint&#x3D; 182; &#x2F;&#x2F;å¹³è¡¡è½¦å‚ç›´äºåœ°é¢æ—¶çš„å€¼ï¼ˆç›®æ ‡å€¼ï¼‰,å¾åºåˆ—ç›£æ§å–å¾—å°è»Šåœ¨ç›´ç«‹å¹³è¡¡ç‹€æ³ä¸‹çš„å€¼&#x2F;&#x2F;(ä¾ç…§P-&gt;D-&gt;Ié †åºèª¿åƒ)double Kp &#x3D; 20; &#x2F;&#x2F;1.è®¾ç½®åå·®æ¯”ä¾‹ç³»æ•°(èª¿ç¯€æ–½äºˆå¤–åŠ›çš„ç›´ç«‹,çµ¦çš„éå¤§æœƒéœ‡ç›ª)double Kd &#x3D; 0.8; &#x2F;&#x2F;2.è°ƒç§¯åˆ†(æ¶ˆæŠ–,çµ¦çš„éå¤§æœƒéœ‡ç›ª)double Ki &#x3D; 140; &#x2F;&#x2F;3.è°ƒå¾®åˆ†(èª¿ç¯€å¿«é€Ÿå¹³è¡¡)&#x2F;\*\*\*\*\*\*End of values setting\*\*\*\*\*\*\*\*\*&#x2F;  double input, output;PID pid(&amp;input, &amp;output, &amp;setpoint, Kp, Ki, Kd, DIRECT);  volatile bool mpuInterrupt &#x3D; false; &#x2F;&#x2F; MPUä¸­æ–­void dmpDataReady()&#123;Â  Â  mpuInterrupt &#x3D; true;&#125;  void Forward() &#x2F;&#x2F;é›»æ©Ÿå‰é€²&#123;Â  Â  analogWrite(6,output);Â  Â  analogWrite(9,0);Â  Â  analogWrite(10,output);Â  Â  analogWrite(11,0);Â  Â  Serial.print(&quot;F&quot;); &#x2F;&#x2F;Debugging information&#125;  void Reverse() &#x2F;&#x2F;é›»æ©Ÿå¾Œé€€&#123;Â  Â  analogWrite(6,0);Â  Â  analogWrite(9,output*-1);Â  Â  analogWrite(10,0);Â  Â  analogWrite(11,output*-1);Â  Â  Serial.print(&quot;R&quot;);&#125;  void Stop() &#x2F;&#x2F;é›»æ©Ÿåœæ­¢&#123;Â  Â  analogWrite(6,0);Â  Â  analogWrite(9,0);Â  Â  analogWrite(10,0);Â  Â  analogWrite(11,0);Â  Â  Serial.print(&quot;S&quot;);&#125;void setup() &#123;Â  Serial.begin(115200);Â  &#x2F;&#x2F; initialize deviceÂ  Â  Serial.println(F(&quot;Initializing I2C devices...&quot;));Â  Â  mpu.initialize();Â  Â  Â &#x2F;&#x2F; verify connectionÂ  Â  Serial.println(F(&quot;Testing device connections...&quot;));Â  Â  Serial.println(mpu.testConnection() ? F(&quot;MPU6050 connection successful&quot;) : F(&quot;MPU6050 connection failed&quot;));Â  Â  &#x2F;&#x2F; load and configure the DMPÂ  Â  devStatus &#x3D; mpu.dmpInitialize();Â  Â  &#x2F;&#x2F; supply your own gyro offsets here, scaled for min sensitivityÂ  Â  mpu.setXGyroOffset(57);Â  Â  mpu.setYGyroOffset(-29);Â  Â  mpu.setZGyroOffset(3);Â  Â  mpu.setZAccelOffset(967);Â  Â  Â  &#x2F;&#x2F; make sure it worked (returns 0 if so)Â  Â  if (devStatus &#x3D;&#x3D; 0)Â  Â  &#123;Â  Â  Â  Â  &#x2F;&#x2F; turn on the DMP, now that it&#39;s readyÂ  Â  Â  Â  Serial.println(F(&quot;Enabling DMP...&quot;));Â  Â  Â  Â  mpu.setDMPEnabled(true);Â  Â  Â  Â  &#x2F;&#x2F; enable Arduino interrupt detectionÂ  Â  Â  Â  Serial.println(F(&quot;Enabling interrupt detection (Arduino external interrupt 0)...&quot;));Â  Â  Â  Â  attachInterrupt(0, dmpDataReady, RISING);Â  Â  Â  Â  mpuIntStatus &#x3D; mpu.getIntStatus();Â  Â  Â  Â  &#x2F;&#x2F; set our DMP Ready flag so the main loop() function knows it&#39;s okay to use itÂ  Â  Â  Â  Serial.println(F(&quot;DMP ready! Waiting for first interrupt...&quot;));Â  Â  Â  Â  dmpReady &#x3D; true;Â  Â  Â  Â  &#x2F;&#x2F; get expected DMP packet size for later comparisonÂ  Â  Â  Â  packetSize &#x3D; mpu.dmpGetFIFOPacketSize();Â  Â  Â  Â  &#x2F;&#x2F;setup PIDÂ  Â  Â  Â  pid.SetMode(AUTOMATIC);Â  Â  Â  Â  pid.SetSampleTime(10);Â  Â  Â  Â  pid.SetOutputLimits(-255, 255); Â Â  Â  &#125;Â  Â  elseÂ  Â  &#123;Â  Â  Â  Â  &#x2F;&#x2F; ERROR!Â  Â  Â  Â  &#x2F;&#x2F; 1 &#x3D; initial memory load failedÂ  Â  Â  Â  &#x2F;&#x2F; 2 &#x3D; DMP configuration updates failedÂ  Â  Â  Â  &#x2F;&#x2F; (if it&#39;s going to break, usually the code will be 1)Â  Â  Â  Â  Serial.print(F(&quot;DMP Initialization failed (code &quot;));Â  Â  Â  Â  Serial.print(devStatus);Â  Â  Â  Â  Serial.println(F(&quot;)&quot;));Â  Â  &#125;&#x2F;&#x2F;åˆå§‹åŒ–é›»æ©Ÿè¼¸å‡ºå¼•è…³Â  Â  pinMode (6, OUTPUT);Â  Â  pinMode (9, OUTPUT);Â  Â  pinMode (10, OUTPUT);Â  Â  pinMode (11, OUTPUT);&#x2F;&#x2F;é»˜èªæƒ…æ³ä¸‹é—œé–‰é›»æ©ŸÂ  Â  analogWrite(6,LOW);Â  Â  analogWrite(9,LOW);Â  Â  analogWrite(10,LOW);Â  Â  analogWrite(11,LOW);&#125;void loop() &#123;Â  Â  &#x2F;&#x2F; å¦‚æœç¨‹åºå¤±è´¥ç›´æ¥returnã€‚åœæ­¢Â  Â  if (!dmpReady) return;Â  Â  &#x2F;&#x2F; ç­‰å¾…çŸ¥é“MPUä¸­æ–­è¿”å›å€¼å¯ç”¨ã€æ•°æ®åŒ…æ­£å¸¸Â  Â  while (!mpuInterrupt &amp;&amp; fifoCount &lt; packetSize)Â  Â  &#123;Â  Â  Â  Â  &#x2F;&#x2F;æ— mpuæ•°æ®,è¿è¡ŒPIDå¹¶è¾“å‡ºåˆ°ç”µæœºÂ  Â  Â  Â  pid.Compute(); Â Â  Â  Â  Â  &#x2F;&#x2F;Print the value of Input and Output on serial monitor to check how it is working.Â  Â  Â  Â  Serial.print(input); Serial.print(&quot; &#x3D;&gt;&quot;); Serial.println(output);Â  Â  Â  Â  if (input&gt;150 &amp;&amp; input&lt;200)&#123;&#x2F;&#x2F;If the Bot is fallingÂ  Â  Â  Â  if (output&gt;0) &#x2F;&#x2F;Falling towards frontÂ  Â  Â  Â  Forward(); &#x2F;&#x2F;Rotate the wheels forwardÂ  Â  Â  Â  else if (output&lt;0) &#x2F;&#x2F;Falling towards backÂ  Â  Â  Â  Reverse(); &#x2F;&#x2F;Rotate the wheels backwardÂ  Â  Â  Â  &#125;Â  Â  Â  Â  else &#x2F;&#x2F;If Bot not fallingÂ  Â  Â  Â  Stop(); &#x2F;&#x2F;Hold the wheels stillÂ  Â  &#125;  Â  Â  &#x2F;&#x2F; é‡ç½®ä¸­æ–­æ ‡å¿—,å¹¶è·å–INT_STATUSæ•°æ®Â  Â  mpuInterrupt &#x3D; false;Â  Â  mpuIntStatus &#x3D; mpu.getIntStatus();Â  Â  &#x2F;&#x2F; è·å–å½“å‰FIFOè®¡æ•°Â  Â  fifoCount &#x3D; mpu.getFIFOCount();  Â  Â  &#x2F;&#x2F; check for overflow (this should never happen unless our code is too inefficient)Â  Â  if ((mpuIntStatus &amp; 0x10) || fifoCount &#x3D;&#x3D; 1024)Â  Â  &#123;Â  Â  Â  Â &#x2F;&#x2F; é‡ç½®Â  Â  Â  Â  mpu.resetFIFO();Â  Â  Â  Â  Serial.println(F(&quot;FIFO overflow!&quot;));Â  Â  &#x2F;&#x2F; å¦åˆ™ï¼Œæ£€æŸ¥DMPæ•°æ®å‡†å¤‡ä¸­æ–­Â  Â  &#125;Â  Â  else if (mpuIntStatus &amp; 0x02)Â  Â  &#123;Â  Â  Â  Â  &#x2F;&#x2F; ç­‰å¾…æ­£ç¡®çš„å¯ç”¨çš„æ•°æ®Â  Â  Â  Â  while (fifoCount &lt; packetSize) fifoCount &#x3D; mpu.getFIFOCount();Â  Â  Â  Â  &#x2F;&#x2F; è¯»å–å…ˆè¿›å…ˆå‡ºçš„åŒ…Â  Â  Â  Â  mpu.getFIFOBytes(fifoBuffer, packetSize);Â  Â  Â  Â  &#x2F;&#x2F; track FIFO count here in case there is &gt; 1 packet availableÂ  Â  Â  Â  &#x2F;&#x2F; (this lets us immediately read more without waiting for an interrupt)Â  Â  Â  Â  fifoCount -&#x3D; packetSize;Â  Â  Â  Â  mpu.dmpGetQuaternion(&amp;q, fifoBuffer); &#x2F;&#x2F;è·å–qå€¼Â  Â  Â  Â  mpu.dmpGetGravity(&amp;gravity, &amp;q); &#x2F;&#x2F;è·å–é‡åŠ›å€¼Â  Â  Â  Â  mpu.dmpGetYawPitchRoll(ypr, &amp;q, &amp;gravity); &#x2F;&#x2F;è·å–yprå€¼Â  Â  Â  Â  input &#x3D; ypr[1] * 180&#x2F;M_PI + 180;Â  Â &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/B5t3DpG-vN8" frameborder="0" loading="lazy" allowfullscreen></iframe></div><div class="video-container"><iframe src="https://www.youtube.com/embed/VKTeuM2Dz7Y" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> arduino </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¹³è¡¡å°è»Š </tag>
            
            <tag> balace robot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯èª¿ç‡ˆ-PWM_LED-MQTT-micropython</title>
      <link href="/2021/10/18/ke-diao-deng-pwm-led-mqtt-micropython/"/>
      <url>/2021/10/18/ke-diao-deng-pwm-led-mqtt-micropython/</url>
      
        <content type="html"><![CDATA[<h1 id="å¯èª¿ç‡ˆ-PWM-LED-MQTTâ€“micropython"><a href="#å¯èª¿ç‡ˆ-PWM-LED-MQTTâ€“micropython" class="headerlink" title="å¯èª¿ç‡ˆ-PWM_LED-MQTTâ€“micropython"></a>å¯èª¿ç‡ˆ-PWM_LED-MQTTâ€“micropython</h1><h6 id="tags-micropython-pwm-led"><a href="#tags-micropython-pwm-led" class="headerlink" title="tags: micropython pwm led"></a>tags: <code>micropython</code> <code>pwm</code> <code>led</code></h6><p><strong>é€™å€‹å…¶å¯¦æ˜¯æ¯”è¼ƒç°¡å–®çš„åˆ©ç”¨MQTTä½œæ³•ï¼Œæ‰€ä»¥å°±ç›´æ¥é€²å…¥æ­£é¡Œ</strong></p><h2 id="ææ–™"><a href="#ææ–™" class="headerlink" title="ææ–™"></a>ææ–™</h2><ul><li>  æ¨¹è“æ´¾Â  x1</li><li>  ESP32 x 1</li><li>  æœé‚¦ç·š xå°‘è¨±</li><li>  LED x 1</li><li>  10kæ­å§†é›·é˜» x 1</li></ul><hr><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/8163949108134810939#"><img src="https://lh3.googleusercontent.com/-7VCXf9sLnfM/YWzMCtI5jqI/AAAAAAAAe88/R0fXLsZyAVsrTEhNQKcTfPEFdSpLEoPDwCNcBGAsYHQ/w458-h288/image.png"></a></p><hr><h2 id="MQTT-brokerå¸ƒå±€"><a href="#MQTT-brokerå¸ƒå±€" class="headerlink" title="MQTT_brokerå¸ƒå±€"></a>MQTT_brokerå¸ƒå±€</h2><p>æ¨¹è“æ´¾ä¸Šè£MQTTå’ŒNord-REDå›é¡§<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/8163949108134810939#">-é»æˆ‘å›é¡§</a></p><p>**1.**é¦–å…ˆå®‰è£å¥½MQTTå’ŒNODE-REDå¾Œ,åœ¨ç€è¦½å™¨ç¶²å€åˆ—é–‹å•“<a href="http://localhost:1880/">http://localhost:1880/</a></p><p>å¦‚æœæ˜¯æ¨¹è“æ´¾,localhostæ›¿æ›å¡«ä¸Šæ¨¹è“æ´¾çš„IPåŠ ä¸Š:1880</p><p>**2.**åŠ å…¥slideræ»‘è»Œå’Œmqtt_outç™¼é€</p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/8163949108134810939#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEhBasdBsMbhhgs9zBzp9nwF_D1gkhjey_pDp_DS9GyWo174iJZEsFxU-PzFczTcU1YzL1FXfpeH2dkOIhd6EXXCw7FAoptmOl1SRLrgOXVHMtNg-gqIEJ3_jdYeTWOAbeRwAjOuU-B5gbVvOc6yBOerP4s3pGk0rZKKaYMY51Uac0Up-zRWA86i87lO=w662-h298"></a></p><p>**3.**lableçš„åœ°æ–¹å¡«ä¸ŠPWMï¼Œrangeå¡«å…¥è„ˆæ³¢ç¯„åœ</p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/8163949108134810939#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEigtCoDFX8zFtjWGGZL7hcDrD-WdejmF1epNOty06jZD12xMzrHusz1bPbdiHL6agkk_xXqisZMEojyxJOlAzM9AIV3jYbvkrXcEzUpT0Vy0hKq8hcMpL2Sgx0xPps50mlN-N57RS76nTYL2uDQW77Yf1aDr_7tvpUxq79u2WTDBXPDjSaAOvYyTDep=w618-h276"></a></p><p>**4.**æ¥ä¸‹ä¾†å¸ƒç½®mqtt_out</p><p>æœå‹™å™¨é¸æ“‡æœ¬åœ°ç«¯</p><p>ä¸»é¡Œå¡«å…¥esp32/pwm,é€™å€‹æ˜¯å®¢æˆ¶ç«¯è¨‚é–±ä¸»é¡Œ</p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/8163949108134810939#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEhMvVMQAhu0XO7IIF4W5RDP2uZbD3o8stmPQJWk5g5VFLv6Fi5M60k-6nZH8pkjN8cQTUW_b9EgoLaFYFfkLH1TMlG60iwrOzKdIXUufKnE_Nxy53EtzhvqOXgpCsmyq-dvuV3WUF4SmgcmQ9Y5xpa-GkieZ6GkX_BluwIOBZKW7MCS8jh3Ur3beIk1=w616-h276"></a></p><p>**5.**æœ€å¾ŒæŒ‰ä¸‹å³ä¸Šè§’â€<strong>éƒ¨ç½²</strong>â€œ</p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/8163949108134810939#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEjlbuaf5ZIUcFrqNQ-kTL9X_1XJjoW385Ewdio1efiY0SmGe9iud3wygNy6fQsrCaj08U5mySM25QODlnqGe-W6K6B9n-Wp_npCj1cBt-5fTFpuQUiEOsfh-6XFVs-WxZnqtlz6wyG-ieuRuApMpZcCsuVDNUoUzKdFl0LKzLQJQ9DNEBVhh-cEPrWE=w626-h280"></a></p><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token punctuation">,</span> PWM<span class="token punctuation">,</span> freq<span class="token punctuation">,</span> reset<span class="token punctuation">,</span> sleep<span class="token keyword">import</span> network<span class="token punctuation">,</span> binascii<span class="token punctuation">,</span> socket<span class="token punctuation">,</span> machine<span class="token keyword">from</span> umqtt<span class="token punctuation">.</span>simple <span class="token keyword">import</span> MQTTClient  ssid <span class="token operator">=</span> <span class="token string">"---"</span>password <span class="token operator">=</span> <span class="token string">"--------"</span><span class="token comment">#æˆ‘æ¨¹è‹ºæ´¾ä¸Šçš„ip</span>serverIP <span class="token operator">=</span> <span class="token string">"192.168.97.22"</span><span class="token comment">#å°‡å®¢æˆ¶ç«¯IDè½‰æ›ç‚º16é€²ä½,ä»¥ä¾¿MQTTä¼ºæœç«¯è®€å–</span>mqtt_id <span class="token operator">=</span> binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>machine<span class="token punctuation">.</span>unique_id<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#å’ŒNord-REDä¸Šçš„ä¸»é¡Œä¸€è‡´</span>client_topic <span class="token operator">=</span> <span class="token string">b'esp32/pwm'</span><span class="token comment">#led_pwmè¨­å®šè…³ä½å’Œé »ç‡</span>led_pwm <span class="token operator">=</span> PWM<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span>  <span class="token comment">#wifié€£ç·š</span><span class="token keyword">def</span> <span class="token function">wifi_connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    wifi <span class="token operator">=</span> network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>    wifi<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>    wifi<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span>    <span class="token keyword">while</span> wifi<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connected successed"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IP: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>wifi<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#é€£ç·šMQTT,é€£ç·šæˆåŠŸå¾Œè¨‚é–±ä¸»é¡Œ</span><span class="token keyword">def</span> <span class="token function">mqtt_connected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        client <span class="token operator">=</span> MQTTClient<span class="token punctuation">(</span>mqtt_id<span class="token punctuation">,</span> serverIP<span class="token punctuation">)</span>        client<span class="token punctuation">.</span>set_callback<span class="token punctuation">(</span>callBack<span class="token punctuation">)</span>        client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>        client<span class="token punctuation">.</span>subscribe<span class="token punctuation">(</span>client_topic<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connected to %s"</span><span class="token operator">%</span>serverIP<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"subscribe Topic: %s"</span><span class="token operator">%</span>client_topic<span class="token punctuation">)</span>        <span class="token keyword">return</span> client    <span class="token keyword">except</span> OSError <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"it's not to connect, wait a moment to connect"</span><span class="token punctuation">)</span>        machine<span class="token punctuation">.</span>reset<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#æ¨¹è“æ´¾ä¸Šçš„mqttå›æ‡‰è¨‚é–±</span><span class="token keyword">def</span> <span class="token function">callBack</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> topic <span class="token operator">==</span> client_topic<span class="token punctuation">:</span>        led_pwm<span class="token punctuation">.</span>duty<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span>wifi_connect<span class="token punctuation">(</span><span class="token punctuation">)</span>client <span class="token operator">=</span> mqtt_connected<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    client<span class="token punctuation">.</span>wait_msg<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/w_a0Fq4Pi5Q" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> led </tag>
            
            <tag> mqtt </tag>
            
            <tag> pwm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WebServer_PWMæ»‘è»Œ(slider)æ§åˆ¶LED-ESP32</title>
      <link href="/2021/10/12/webserver-pwm-hua-gui-slider-kong-zhi-led-esp32/"/>
      <url>/2021/10/12/webserver-pwm-hua-gui-slider-kong-zhi-led-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="WebServer-PWMæ»‘è»Œ-slider-æ§åˆ¶LED-ESP32"><a href="#WebServer-PWMæ»‘è»Œ-slider-æ§åˆ¶LED-ESP32" class="headerlink" title="WebServer_PWMæ»‘è»Œ(slider)æ§åˆ¶LED-ESP32"></a>WebServer_PWMæ»‘è»Œ(slider)æ§åˆ¶LED-ESP32</h1><h6 id="tags-esp32-pwm-webserver-amp-led"><a href="#tags-esp32-pwm-webserver-amp-led" class="headerlink" title="tags: esp32 pwm `webserver&amp;led"></a>tags: <code>esp32</code> <code>pwm</code> `webserver&amp;led</h6><p><strong><em>åƒè€ƒ</em></strong>-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5133599767551513904#">https://microcontrollerslab.com/esp32-pwm-slider-web-server-control-led-brightness/</a></p><h2 id="æ‰€é ˆå…ƒä»¶"><a href="#æ‰€é ˆå…ƒä»¶" class="headerlink" title="æ‰€é ˆå…ƒä»¶"></a>æ‰€é ˆå…ƒä»¶</h2><ol><li> ESP32æ¿</li><li> LED</li><li> 220 æ­å§†é›»é˜»</li><li> é€£æ¥ç·š</li><li> éºµåŒ…æ¿</li></ol><h2 id="æ¥ç·šæ–¹å¼"><a href="#æ¥ç·šæ–¹å¼" class="headerlink" title="æ¥ç·šæ–¹å¼"></a>æ¥ç·šæ–¹å¼</h2><p>å¯ä»¥é¸æ“‡ä»»ä½•æœ‰PWMçš„è…³ä½</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5133599767551513904#"><img src="https://microcontrollerslab.com/wp-content/uploads/2021/04/ESP32-PWM-Micropython-LED-Fading-circuit.jpg"></a></p><hr><h2 id="æ‰€é ˆå®‰è£çš„å‡½å¼åº«"><a href="#æ‰€é ˆå®‰è£çš„å‡½å¼åº«" class="headerlink" title="æ‰€é ˆå®‰è£çš„å‡½å¼åº«"></a>æ‰€é ˆå®‰è£çš„å‡½å¼åº«</h2><p>è‡ªè¡Œå‰å¾€ä¸‹è¼‰ä¸¦æ”¾å…¥AduinoIDEçš„library</p><p>æˆ‘å€‹äººæ…£ç”¨platfromIO,ç›´æ¥åœ¨å®ƒå…§å»ºçš„æœå°‹æ‰¾åˆ°åº«å®‰è£å³å¯</p><ul><li>  <a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5133599767551513904#">ESPAsyncWebServer</a></li><li>  <a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5133599767551513904#">AsyncTCP</a></li></ul><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include   &lt;WiFi.h&gt;#include   &lt;AsyncTCP.h&gt;#include   &lt;ESPAsyncWebServer.h&gt;&#x2F;&#x2F;wifié€£ç·šå¸³å¯†const char *ssid &#x3D;&quot;---&quot;;const char *password &#x3D; &quot;-------&quot;;&#x2F;&#x2F;æœå‹™å™¨ç›£è½è«‹æ±‚ç«¯å£AsyncWebServer server(80);&#x2F;&#x2F;LEDPinconst int led &#x3D; 2;&#x2F;&#x2F;æ»‘è»Œä»‹é¢é è¨­å€¼String slider_val &#x3D; &quot;0&quot;;  &#x2F;&#x2F;å‰ç«¯ç¶²é const char indexHtml[] PROGMEM &#x3D; R&quot;rawliteral(Â  &lt;!DOCTYPE HTML&gt;&lt;html&gt;&lt;head&gt;Â  &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;Â  &lt;title&gt;ESP32 Brightness Control Web Server&lt;&#x2F;title&gt;Â  &lt;style&gt;Â  Â  html &#123;font-family: Times New Roman; display: inline-block; text-align: center;&#125;Â  Â  h2 &#123;font-size: 2.3rem;&#125;Â  Â  p &#123;font-size: 1.9rem;&#125;Â  Â  body &#123;max-width: 400px; margin:0px auto; padding-bottom: 25px;&#125;Â  Â  .slider &#123; -webkit-appearance: none; margin: 14px; width: 360px; height: 25px; background: #38c0ff Â ;Â  Â  Â  outline: none; -webkit-transition: .2s; transition: opacity .2s;&#125;Â  Â  .slider::-webkit-slider-thumb &#123;-webkit-appearance: none; appearance: none; width: 35px; height: 35px; background:#01070a; cursor: pointer;&#125;Â  Â  .slider::-moz-range-thumb &#123; width: 35px; height: 35px; background: #01070a; cursor: pointer; &#125;Â  &lt;&#x2F;style&gt;&lt;&#x2F;head&gt;&lt;body&gt;Â  &lt;h2&gt;ESP32 Brightness Control Web Server&lt;&#x2F;h2&gt;Â  &lt;p&gt;&lt;span id&#x3D;&quot;textslider_value&quot;&gt;%SLIDERVALUE%&lt;&#x2F;span&gt;&lt;&#x2F;p&gt;Â  &lt;p&gt;&lt;input type&#x3D;&quot;range&quot; onchange&#x3D;&quot;updateSliderPWM(this)&quot; id&#x3D;&quot;pwmSlider&quot; min&#x3D;&quot;0&quot; max&#x3D;&quot;255&quot; value&#x3D;&quot;%SLIDERVALUE%&quot; step&#x3D;&quot;1&quot; class&#x3D;&quot;slider&quot;&gt;&lt;&#x2F;p&gt;&lt;script&gt;function updateSliderPWM(element) &#123;Â  var slider_val &#x3D; document.getElementById(&quot;pwmSlider&quot;).value;Â  document.getElementById(&quot;textslider_value&quot;).innerHTML &#x3D; slider_val;Â  console.log(slider_val);Â  var xhr &#x3D; new XMLHttpRequest();Â  xhr.open(&quot;GET&quot;, &quot;&#x2F;slider?value&#x3D;&quot;+slider_val, true);Â  xhr.send();&#125;&lt;&#x2F;script&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;)rawliteral&quot;;  &#x2F;&#x2F;åœ¨processor() å‡½æ•¸ä¸­ï¼Œä½”ä½ç¬¦%SLIDERVALUE%&#x2F;&#x2F;å°‡è¢«æ›¿æ›ç‚ºå…¶ç‰¹å®šè®Šé‡(slider_value) ä¸­ä¿å­˜çš„å€¼ã€‚&#x2F;&#x2F;ç„¶å¾Œè¿”å›ä¿å­˜åœ¨â€˜slider_valueâ€™è®Šé‡ä¸­çš„é€™å€‹å€¼ã€‚String PWM_LED_Processor(const String&amp;var)&#123;Â  if (var &#x3D;&#x3D; &quot;SLIDERVALUE&quot;)&#123;Â  Â  return slider_val;Â  &#125;Â  return String();&#125;  void setup() &#123;Â  Serial.begin(115200);Â  &#x2F;&#x2F;pwmè¨­ç½®Â  ledcSetup(0, 5000, 8);Â  ledcAttachPin(led, 0);Â  ledcWrite(0, slider_val.toInt());Â  &#x2F;&#x2F;wifié€£ç·šè¨­ç½®Â  WiFi.begin(ssid, password);Â  while (WiFi.status() !&#x3D; WL_CONNECTED)&#123;Â  Â  delay(500);Â  Â  Serial.print(&quot;.&quot;);Â  &#125;Â  Serial.println(&quot;CONNECTED SUCCESS!!&quot;);Â  Serial.print(&quot;IP: &quot;);Â  Serial.println(WiFi.localIP());Â  &#x2F;&#x2F;æˆ‘å€‘å°‡è™•ç† ESP32 æ¿å°‡æ”¶åˆ°çš„ &#x2F;root URL è«‹æ±‚ã€‚&#x2F;&#x2F;æˆ‘å€‘å°‡ä½¿ç”¨ send_P() æ–¹æ³•ã€‚è™•ç†å‡½æ•¸å°‡é€šéå°è«‹æ±‚å°è±¡ä½¿ç”¨ send_P() æ–¹æ³•ä¾†éŸ¿æ‡‰å®¢æˆ¶ç«¯ã€‚&#x2F;&#x2F;æ­¤æ–¹æ³•å°‡æ¥å—å››å€‹åƒæ•¸ã€‚ç¬¬ä¸€å€‹æ˜¯ 200ï¼Œå®ƒæ˜¯â€œokâ€çš„ HTTP ç‹€æ…‹ä»£ç¢¼ã€‚ç¬¬äºŒå€‹æ˜¯â€œtext&#x2F;htmlâ€ï¼Œ&#x2F;&#x2F;å®ƒå°æ‡‰æ–¼éŸ¿æ‡‰çš„å…§å®¹é¡å‹ã€‚ç¬¬ä¸‰å€‹è¼¸å…¥æ˜¯ä¿å­˜åœ¨ index_html è®Šé‡ä¸­çš„æ–‡æœ¬ï¼Œå®ƒå°‡è¢«ç™¼é€ã€‚&#x2F;&#x2F;æœ€å¾Œï¼Œæœ€å¾Œä¸€å€‹åƒæ•¸æ˜¯è™•ç†å™¨å‡½æ•¸ï¼Œå…¶ä¸­ä½”ä½ç¬¦å°‡è¢«å…¶ç•¶å‰å€¼æ›¿æ›ã€‚Â  server.on(&quot;&#x2F;&quot;, HTTP_GET, [](AsyncWebServerRequest *request)&#123;Â  Â  request-&gt;send_P(200, &quot;text&#x2F;html&quot;, indexHtml,PWM_LED_Processor);Â  &#125;);Â  &#x2F;&#x2F;æ»‘å¡Šå€¼å°‡ä¿å­˜åœ¨è®Šé‡â€œæ¶ˆæ¯â€ä¸­ã€‚æ­¤å¤–ï¼Œé‚„å°‡èª¿ç”¨ ledcWrite() å‡½æ•¸ï¼ŒÂ  &#x2F;&#x2F;è©²å‡½æ•¸å°‡ç”Ÿæˆèˆ‡å¾ slider_value.toInt() è¨ªå•çš„ä½”ç©ºæ¯”å€¼ç›¸å°æ‡‰çš„ PWM ä¿¡è™Ÿã€‚Â  &#x2F;&#x2F;è©²å€¼ä¹Ÿå°‡æ‰“å°åœ¨æˆ‘å€‘çš„ä¸²è¡Œç›£è¦–å™¨ä¸Šã€‚Â  server.on(&quot;&#x2F;slider&quot;, HTTP_GET, [] (AsyncWebServerRequest *request) &#123;Â  Â  String message;Â  Â  if (request-&gt;hasParam(&quot;value&quot;)) &#123;Â  Â  Â  message &#x3D; request-&gt;getParam(&quot;value&quot;)-&gt;value();Â  Â  Â  slider_val &#x3D; message;Â  Â  Â  ledcWrite(0, slider_val.toInt());Â  Â  &#125;Â  Â  else &#123;Â  Â  Â  message &#x3D; &quot;No message sent&quot;;Â  Â  &#125;Â  Â  Serial.println(message);Â  Â  request-&gt;send(200, &quot;text&#x2F;plain&quot;, &quot;OK&quot;);Â  &#125;);Â  server.begin();&#125;void loop() &#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/p-EtpIFTbW8" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webserver </tag>
            
            <tag> led </tag>
            
            <tag> pwm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ESP32-å¾®æ³¢é›·é”RCWL-0506+Adafruit_Neopixelsç‡ˆæ¢</title>
      <link href="/2021/10/04/esp32-wei-bo-lei-da-rcwl-0506-adafruit-neopixels-deng-tiao/"/>
      <url>/2021/10/04/esp32-wei-bo-lei-da-rcwl-0506-adafruit-neopixels-deng-tiao/</url>
      
        <content type="html"><![CDATA[<h3 id="ESP32-å¾®æ³¢é›·é”RCWL-0506-Adafruit-Neopixelsç‡ˆæ¢"><a href="#ESP32-å¾®æ³¢é›·é”RCWL-0506-Adafruit-Neopixelsç‡ˆæ¢" class="headerlink" title="ESP32-å¾®æ³¢é›·é”RCWL-0506+Adafruit_Neopixelsç‡ˆæ¢"></a>ESP32-å¾®æ³¢é›·é”RCWL-0506+Adafruit_Neopixelsç‡ˆæ¢</h3><h2 id="RCWL-0506å¾®æ³¢é›·é”ç‰¹é»"><a href="#RCWL-0506å¾®æ³¢é›·é”ç‰¹é»" class="headerlink" title="RCWL-0506å¾®æ³¢é›·é”ç‰¹é»"></a>RCWL-0506å¾®æ³¢é›·é”ç‰¹é»</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/6901600445849823#"><img src="https://1.bp.blogspot.com/-t4A_xNnjt1U/YVKmz39JdsI/AAAAAAAAe7o/VmJs-reePecRxCpxFAOP6Uoyvt4vwLcrACNcBGAsYHQ/w372-h185/RCWL0506.jpg"></a></p><p><strong>ç‰¹é»ï¼š</strong></p><ul><li>  éˆæ•åº¦é«˜ã€æ„Ÿæ‡‰è·é›¢é ã€å¯é æ€§é«˜ã€æ„Ÿæ‡‰è§’åº¦å¤§ã€ä¾›é›»é›»å£“ç¯„åœå¤§ç­‰ç‰¹é»</li><li>  4.0 V è‡³ 28.0 V çš„å·¥ä½œé›»å£“</li><li>RCWL-0516 æ˜¯ä¸€ç¨®åˆ©ç”¨é›·é”å¤šæ™®å‹’ã€å¾®æ³¢æ„Ÿæ‡‰å°ˆç”¨æ¨¡å¡Šæª¢æ¸¬ç§»å‹•ç‰©é«”çš„æŠ€è¡“ã€‚</li></ul><hr><h2 id="Adafruit-Neopixelsç‡ˆæ¢"><a href="#Adafruit-Neopixelsç‡ˆæ¢" class="headerlink" title="Adafruit_Neopixelsç‡ˆæ¢"></a>Adafruit_Neopixelsç‡ˆæ¢</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/6901600445849823#"><img src="https://1.bp.blogspot.com/-XvmLPHjykj4/YVKpBVj5lsI/AAAAAAAAe7w/C3I7d6MDEJ85BWBAdP9_26xuW_rApCXJACNcBGAsYHQ/s320/1426-00.jpg"></a></p><p><strong>ä¸»è¦ç‰¹è‰²:</strong></p><p>ä½¿ç”¨é€™æ¬¾ NeoPixel LED ç‡ˆ,è‡ªè¡Œä½ˆç½®å° LED ç‡ˆæ¢ã€‚ æˆ‘å€‘å°‡ 8 å€‹å°å‹ 5050 (5 å…¬é‡ x 5 å…¬é‡) æ™ºæ…§å‹ RGB LED ç‡ˆæ“ åœ¨ä¸€å€‹å…·æœ‰å®‰è£å­”å’Œå¯éˆè¨­è¨ˆçš„å°åˆ·é›»è·¯æ¿ä¸Šã€‚ åƒ…ä½¿ç”¨ä¸€å€‹å¾®æ§åˆ¶å™¨é‡è…³ä¾†æ§åˆ¶ç›¡å¯èƒ½å¤šåœ°é€£æ¥åœ¨ä¸€èµ·! â€‹ æ¯å€‹LEDç‡ˆéƒ½å¯ä»¥å®šä½,å› ç‚ºé©…å‹•èŠ¯ç‰‡åœ¨LEDå…§ã€‚ æ¯å€‹éƒ½æœ‰ç´„ 18 mA çš„æ†å®šé›»æµé©…å‹•,å› æ­¤å³ä½¿é›»å£“è®ŠåŒ–,é¡è‰²ä¹Ÿæœƒéå¸¸ä¸€è‡´,ä¸¦ä¸”ä¸éœ€è¦å¤–éƒ¨é˜»æ–·é›»é˜»,ä½¿è¨­è¨ˆæ›´åŠ çº–è–„ã€‚ ä½¿ç”¨ 5VDC ä¾›é›»(4-7V å·¥ä½œ),æ‚¨æº–å‚™å¥½æ–æ»¾ã€‚ é€šéå°‡ä¸€å€‹æ£’å­çš„è¼¸å‡ºé€£æ¥åˆ°å¦ä¸€å€‹æ£’å­çš„è¼¸å…¥ä¸­,LED å¯ä»¥ã€Œéˆã€ - è«‹åƒé–±ä¸Šé¢çš„ç…§ç‰‡ã€‚ åªæœ‰ä¸€æ¢æ•¸æ“šè¡Œ,å…·æœ‰éå¸¸ç‰¹å®šè¨ˆæ™‚çš„å”è­°ã€‚ ç”±æ–¼è©²å”è­°å°å®šæ™‚éå¸¸æ•æ„Ÿ,å®ƒéœ€è¦ä¸€å€‹å³æ™‚å¾®æ§åˆ¶å™¨,å¦‚ AVRã€Arduinoã€PICã€mbed ç­‰ã€‚ ç„¡æ³•èˆ‡åŸºæ–¼ Linux çš„å¾®é›»è…¦æˆ–è¢«è§£é‡‹çš„å¾®æ§åˆ¶å™¨é…åˆä½¿ç”¨,å¦‚ netduino æˆ– Basic Stampã€‚ Adafruit;ç‚º Arduino ç·¨å¯«çš„ç²¾ç¾çš„ Neopixel åº«æ”¯æŒé€™äº›åƒç´ ! ç”±æ–¼éœ€è¦æ‰‹å‹•èª¿æ•´çµ„è£</p><hr><h2 id="å¯¦ä½œé ˆæ±‚"><a href="#å¯¦ä½œé ˆæ±‚" class="headerlink" title="å¯¦ä½œé ˆæ±‚:"></a>å¯¦ä½œé ˆæ±‚:</h2><p>å°‡å¾®æ³¢é›·é”å’Œç‡ˆæ¢ä½µç”¨,å½¢æˆæ„Ÿæ‡‰ç‡ˆæ‡‰ç”¨,å¦‚æœæœ‰äººç¶“é,ç‡ˆäº®,å¦‚æœæ²’äºº,3ç§’å¾Œè‡ªå‹•æ»…æ‰</p><p>ä½†å¦‚æœæœ‰äººç¹¼çºŒåœ¨æ„Ÿæ‡‰å€,ç‡ˆå‰‡æŒçºŒäº®,ç›´åˆ°æ„Ÿæ‡‰å€æ²’äººã€‚</p><hr><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/6901600445849823#"><img src="https://1.bp.blogspot.com/-Do9-DzeILZA/YVqnW6eU_DI/AAAAAAAAe8E/Hf6P_BC9vc0UTOUoQsHddLQre4reykwBACNcBGAsYHQ/w750-h407/%25E6%259C%25AA%25E5%2591%25BD%25E5%2590%258D.jpg"></a></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><p>é ˆåŒ¯å…¥Adafruit_NeoPixel(é»<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/6901600445849823#">æ­¤è™•</a>ä¸‹è¼‰ç¨‹å¼åº«,ä¸¦åŒ¯å…¥ArduinoIDE)</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;Arduino.h&gt;#include &lt;Adafruit_NeoPixel.h&gt;  constÂ intÂ pinSensorÂ &#x3D;Â 19;&#x2F;&#x2F;constÂ intÂ pinLedÂ &#x3D;Â LED_BUILTIN;intÂ ismotion;intÂ stateÂ &#x3D;Â 0;  &#x2F;&#x2F;ç‡ˆæ¢è…³ä½#define PIN 5&#x2F;&#x2F;å…±æœ‰é¡†led#define NUM 8  &#x2F;&#x2F;è¨­å®šç‡ˆæ¢çš„ç›¸é—œç³»æ•¸Adafruit_NeoPixelÂ pixelsÂ &#x3D;Â Adafruit_NeoPixel(60,Â PIN,Â NEO_GRBÂ +Â NEO_KHZ800);  voidÂ static1()&#123;Â Â for(intÂ i&#x3D;0;i&lt;&#x3D;NUM;i++)&#123;Â Â pixels.setPixelColor(i,Â pixels.Color(0,0,0));Â Â pixels.show();Â Â &#125;&#125;voidÂ static2()&#123;Â Â for(intÂ i&#x3D;0;i&lt;&#x3D;NUM;i++)&#123;Â Â pixels.setPixelColor(i,Â pixels.Color(150,70,100));Â Â pixels.show();Â Â &#125;&#125;voidÂ setup()Â &#123;Â Â pixels.begin();Â Â pixels.setBrightness(50);Â Â pixels.show();Â &#x2F;&#x2F;Â InitializeÂ allÂ pixelsÂ toÂ &#39;off&#39;Â Â Serial.begin(115200);Â Â Â pinModeÂ (pinSensor,Â INPUT);Â &#x2F;&#x2F;å®šç¾©Â SensorÂ Â &#x2F;&#x2F;pinModeÂ (pinLed,Â OUTPUT);Â Â Â &#x2F;&#x2F;å®šç¾©Â LED&#125;voidÂ loop()Â &#123;Â Â ismotionÂ &#x3D;Â digitalRead(pinSensor);Â Â &#x2F;&#x2F;Â å¾sensorè®€è³‡æ–™Â Â if(ismotionÂ &#x3D;&#x3D;Â HIGH)&#123;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &#x2F;&#x2F;Â æ„Ÿæ‡‰å•Ÿå‹•Â Â Â Â &#x2F;&#x2F;digitalWrite(pinLed,HIGH);Â Â Â Â Â Â Â Â Â &#x2F;&#x2F;Â LedÂ ç‡ˆäº®Â Â Â Â static2();Â Â Â Â Serial.println(&quot;Detectived&quot;);Â Â Â Â stateÂ &#x3D;Â 1;Â Â Â Â Serial.println(state);Â Â Â Â ifÂ (stateÂ &#x3D;&#x3D;Â 1)&#123;Â Â Â Â Â Â Serial.println(&quot;Detectived&quot;);Â Â Â Â Â Â Serial.println(state);Â Â Â Â &#125;Â Â &#125;else&#123;Â Â Â Â Â Â &#x2F;&#x2F;digitalWrite(pinLed,Â LOW);Â Â Â Â Â Â static1();Â Â Â Â Â Â Serial.println(&quot;NotÂ Detectived&quot;);Â Â Â Â Â Â stateÂ &#x3D;Â 0;Â Â Â Â Â Â Serial.println(state);Â Â &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/mZWInUebGAg" frameborder="0" loading="lazy" allowfullscreen></iframe></div><p><strong>å¾ŒçºŒ~</strong></p><p><em><strong>å¾®æ³¢é›·é”æ­£å¸¸å·¥ä½œé›»å£“æ˜¯5V,å¦‚æœçµ¦æ–¼3.3V,å‹•ä½œæœƒç•°å¸¸,ä½†ä¸€èˆ¬ESP32éƒ½æ˜¯åªçµ¦3.3V,<br>æ‰€ä»¥æˆ‘æ›äº†ESP32çš„å¦ä¸€æ¬¾æœ‰5Vçš„LOLIN32ä¹‹å¾Œ,ä¸¦ç”¨10000mAçš„è¡Œå‹•é›»æºæ”¾æ–¼å®¶ä¸­çš„é»‘æš—<br>èµ°é“,å¯¦æ¸¬ä¸‹ä¾†å‡ºå¥‡çš„å¥½,å¾…æ©Ÿ+å‹•ä½œç´„ç‚º5~6å¤©,æ‰€ä»¥ç”¨3Dåˆ—å°åšå€‹æ®¼,é€™æ¨£å°±èƒ½ç”¨äº†ã€‚</strong></em></p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RCWL-0506 </tag>
            
            <tag> å¾®æ³¢é›·é” </tag>
            
            <tag> NeoPixelsç‡ˆæ¢ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æ³¢é›·é”RCWL-0506+Adafruit_Neopixelsç‡ˆæ¢-esp8266</title>
      <link href="/2021/09/28/wei-bo-lei-da-rcwl-0506-adafruit-neopixels-deng-tiao-esp8266/"/>
      <url>/2021/09/28/wei-bo-lei-da-rcwl-0506-adafruit-neopixels-deng-tiao-esp8266/</url>
      
        <content type="html"><![CDATA[<h2 id="ESP8266-å¾®æ³¢é›·é”RCWL-0506-Adafruit-Neopixelsç‡ˆæ¢"><a href="#ESP8266-å¾®æ³¢é›·é”RCWL-0506-Adafruit-Neopixelsç‡ˆæ¢" class="headerlink" title="ESP8266-å¾®æ³¢é›·é”RCWL-0506+Adafruit_Neopixelsç‡ˆæ¢"></a>ESP8266-å¾®æ³¢é›·é”RCWL-0506+Adafruit_Neopixelsç‡ˆæ¢</h2><h6 id="tags-esp8266-rcwl-0506-adafruit-neopixels"><a href="#tags-esp8266-rcwl-0506-adafruit-neopixels" class="headerlink" title="tags: esp8266 rcwl-0506 adafruit_neopixels"></a>tags: <code>esp8266</code> <code>rcwl-0506</code> <code>adafruit_neopixels</code></h6><h2 id="RCWL-0506å¾®æ³¢é›·é”ç‰¹é»"><a href="#RCWL-0506å¾®æ³¢é›·é”ç‰¹é»" class="headerlink" title="RCWL-0506å¾®æ³¢é›·é”ç‰¹é»"></a>RCWL-0506å¾®æ³¢é›·é”ç‰¹é»</h2><p><a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/7108154971082560493#"><img src="https://1.bp.blogspot.com/-t4A_xNnjt1U/YVKmz39JdsI/AAAAAAAAe7o/VmJs-reePecRxCpxFAOP6Uoyvt4vwLcrACNcBGAsYHQ/w372-h185/RCWL0506.jpg"></a></p><p><strong>ç‰¹é»ï¼š</strong></p><ul><li>  éˆæ•åº¦é«˜ã€æ„Ÿæ‡‰è·é›¢é ã€å¯é æ€§é«˜ã€æ„Ÿæ‡‰è§’åº¦å¤§ã€ä¾›é›»é›»å£“ç¯„åœå¤§ç­‰ç‰¹é»</li><li>  4.0 V è‡³ 28.0 V çš„å·¥ä½œé›»å£“</li><li>RCWL-0516 æ˜¯ä¸€ç¨®åˆ©ç”¨é›·é”å¤šæ™®å‹’ã€å¾®æ³¢æ„Ÿæ‡‰å°ˆç”¨æ¨¡å¡Šæª¢æ¸¬ç§»å‹•ç‰©é«”çš„æŠ€è¡“ã€‚</li></ul><hr><h2 id="Adafruit-Neopixelsç‡ˆæ¢"><a href="#Adafruit-Neopixelsç‡ˆæ¢" class="headerlink" title="Adafruit_Neopixelsç‡ˆæ¢"></a>Adafruit_Neopixelsç‡ˆæ¢</h2><p><a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/7108154971082560493#"><img src="https://1.bp.blogspot.com/-XvmLPHjykj4/YVKpBVj5lsI/AAAAAAAAe7w/C3I7d6MDEJ85BWBAdP9_26xuW_rApCXJACNcBGAsYHQ/s320/1426-00.jpg"></a></p><p>ä¸»è¦ç‰¹è‰²:</p><p>ä½¿ç”¨é€™æ¬¾ NeoPixel LED ç‡ˆ,è‡ªè¡Œä½ˆç½®å° LED ç‡ˆæ¢ã€‚ æˆ‘å€‘å°‡ 8 å€‹å°å‹ 5050 (5 å…¬é‡ x 5 å…¬é‡) æ™ºæ…§å‹ RGB LED ç‡ˆæ“ åœ¨ä¸€å€‹å…·æœ‰å®‰è£å­”å’Œå¯éˆè¨­è¨ˆçš„å°åˆ·é›»è·¯æ¿ä¸Šã€‚ åƒ…ä½¿ç”¨ä¸€å€‹å¾®æ§åˆ¶å™¨é‡è…³ä¾†æ§åˆ¶ç›¡å¯èƒ½å¤šåœ°é€£æ¥åœ¨ä¸€èµ·! â€‹ æ¯å€‹LEDç‡ˆéƒ½å¯ä»¥å®šä½,å› ç‚ºé©…å‹•èŠ¯ç‰‡åœ¨LEDå…§ã€‚ æ¯å€‹éƒ½æœ‰ç´„ 18 mA çš„æ†å®šé›»æµé©…å‹•,å› æ­¤å³ä½¿é›»å£“è®ŠåŒ–,é¡è‰²ä¹Ÿæœƒéå¸¸ä¸€è‡´,ä¸¦ä¸”ä¸éœ€è¦å¤–éƒ¨é˜»æ–·é›»é˜»,ä½¿è¨­è¨ˆæ›´åŠ çº–è–„ã€‚ ä½¿ç”¨ 5VDC ä¾›é›»(4-7V å·¥ä½œ),æ‚¨æº–å‚™å¥½æ–æ»¾ã€‚ é€šéå°‡ä¸€å€‹æ£’å­çš„è¼¸å‡ºé€£æ¥åˆ°å¦ä¸€å€‹æ£’å­çš„è¼¸å…¥ä¸­,LED å¯ä»¥ã€Œéˆã€ - è«‹åƒé–±ä¸Šé¢çš„ç…§ç‰‡ã€‚ åªæœ‰ä¸€æ¢æ•¸æ“šè¡Œ,å…·æœ‰éå¸¸ç‰¹å®šè¨ˆæ™‚çš„å”è­°ã€‚ ç”±æ–¼è©²å”è­°å°å®šæ™‚éå¸¸æ•æ„Ÿ,å®ƒéœ€è¦ä¸€å€‹å³æ™‚å¾®æ§åˆ¶å™¨,å¦‚ AVRã€Arduinoã€PICã€mbed ç­‰ã€‚ ç„¡æ³•èˆ‡åŸºæ–¼ Linux çš„å¾®é›»è…¦æˆ–è¢«è§£é‡‹çš„å¾®æ§åˆ¶å™¨é…åˆä½¿ç”¨,å¦‚ netduino æˆ– Basic Stampã€‚ Adafruit;ç‚º Arduino ç·¨å¯«çš„ç²¾ç¾çš„ Neopixel åº«æ”¯æŒé€™äº›åƒç´ ! ç”±æ–¼éœ€è¦æ‰‹å‹•èª¿æ•´çµ„è£</p><hr><h2 id="å¯¦ä½œé ˆæ±‚"><a href="#å¯¦ä½œé ˆæ±‚" class="headerlink" title="å¯¦ä½œé ˆæ±‚:"></a>å¯¦ä½œé ˆæ±‚:</h2><p>å°‡å¾®æ³¢é›·é”å’Œç‡ˆæ¢ä½µç”¨,å½¢æˆæ„Ÿæ‡‰ç‡ˆæ‡‰ç”¨,å¦‚æœæœ‰äººç¶“é,ç‡ˆäº®,å¦‚æœæ²’äºº,3ç§’å¾Œè‡ªå‹•æ»…æ‰</p><p>ä½†å¦‚æœæœ‰äººç¹¼çºŒåœ¨æ„Ÿæ‡‰å€,ç‡ˆå‰‡æŒçºŒäº®,ç›´åˆ°æ„Ÿæ‡‰å€æ²’äººã€‚</p><hr><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/7108154971082560493#"><img src="https://1.bp.blogspot.com/-a936gFUrvEw/YVKuz7DmYSI/AAAAAAAAe74/0BH0AMd33B8XfZVzMTyOV2buK9RvwxcnACNcBGAsYHQ/w761-h364/RCWLneopixel.jpg"></a></p><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><p>å¦‚æœæ˜¯ä½¿ç”¨micropythonï¼Œneopixel.pyå‡½å¼åº«å…ˆä¸Šå‚³åˆ°æ¿å­ä¸Š</p><p>neopixel.py-<a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/7108154971082560493#">https://github.com/adafruit/Adafruit_CircuitPython_NeoPixel/blob/main/neopixel.py</a></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">fromÂ machineÂ importÂ PinfromÂ timeÂ importÂ sleepimportÂ neopixelnÂ &#x3D;Â 8Â #ledç‡ˆæ•¸pÂ &#x3D;Â 4Â #è…³ä½sensor&#x3D;Pin(14,Â Pin.IN)#neopixelæ–¹æ³•è¨­å®šnpÂ &#x3D;Â neopixel.NeoPixel(Pin(p),Â n)stateÂ &#x3D;Â 1whileÂ True:Â Â Â Â sÂ &#x3D;Â sensor.value()Â Â Â Â ifÂ sÂ &#x3D;&#x3D;Â 1:Â Â Â Â Â Â Â Â print(&quot;on&quot;)Â Â Â Â Â Â Â Â forÂ iÂ inÂ range(n):Â Â Â Â Â Â Â Â Â Â Â Â np[i]Â &#x3D;Â (100,Â 200,Â 200)Â Â Â Â Â Â Â Â Â Â Â Â np.write()Â Â Â Â Â Â Â Â sleep(3)Â Â Â Â Â Â Â Â #å¦‚æœç‹€æ…‹é‚„æ˜¯åœ¨é«˜è…³ä½,ç¹¼çºŒä¿æŒäº®Â Â Â Â Â Â Â Â ifÂ stateÂ &#x3D;&#x3D;Â 1:Â Â Â Â Â Â Â Â Â Â Â Â print(&quot;pass&quot;)Â Â Â Â Â Â Â Â Â Â Â Â passÂ Â Â Â else:Â Â Â Â Â Â Â Â print(&quot;off&quot;)Â Â Â Â Â Â Â Â forÂ iÂ inÂ range(n):Â Â Â Â Â Â Â Â Â Â Â Â np[i]Â &#x3D;Â (0,Â 0,Â 0)Â Â Â Â Â Â Â Â Â Â Â Â np.write()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/41Z7yvr-LXk" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp8266 </category>
          
          <category> micropython </category>
          
      </categories>
      
      
        <tags>
            
            <tag> rcwl-0506 </tag>
            
            <tag> adafruit_neopixel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Timerè¨ˆæ™‚å™¨å‡½å¼å¯¦ä½œ-ESP8266</title>
      <link href="/2021/09/27/timer-ji-shi-qi-han-shi-shi-zuo-esp8266/"/>
      <url>/2021/09/27/timer-ji-shi-qi-han-shi-shi-zuo-esp8266/</url>
      
        <content type="html"><![CDATA[<h1 id="Timerè¨ˆæ™‚å™¨å‡½å¼å¯¦ä½œ-ESP8266"><a href="#Timerè¨ˆæ™‚å™¨å‡½å¼å¯¦ä½œ-ESP8266" class="headerlink" title="Timerè¨ˆæ™‚å™¨å‡½å¼å¯¦ä½œ-ESP8266"></a>Timerè¨ˆæ™‚å™¨å‡½å¼å¯¦ä½œ-ESP8266</h1><h6 id="tags-â€˜esp8266â€™-â€˜timerâ€™"><a href="#tags-â€˜esp8266â€™-â€˜timerâ€™" class="headerlink" title="tags: â€˜esp8266â€™ â€˜timerâ€™"></a>tags: â€˜esp8266â€™ â€˜timerâ€™</h6><p>micropythonæœ¬èº«æä¾›Timerçš„ç¨‹å¼åº«è¨­å®šè™•ç†å™¨å…§éƒ¨çš„è¨ˆæ™‚å™¨</p><h2 id="å‡½å¼ç”¨æ³•"><a href="#å‡½å¼ç”¨æ³•" class="headerlink" title="å‡½å¼ç”¨æ³•"></a>å‡½å¼ç”¨æ³•</h2><p><strong>Timer(ç·¨è™Ÿ)</strong>â€”esp32ç·¨è™Ÿå¯ä»¥æ˜¯0~3,(esp8266ç·¨è™Ÿæ˜¯-1)</p><p><strong>init(é€±æœŸ, æ¨¡å¼, å›å‘¼)</strong>â€”è¨ˆæ™‚å™¨å•“å‹•åŸ·è¡Œ</p><ul><li>  preiod(é€±æœŸ)â€“é–“éš”æ™‚é–“ä»¥ms(æ¯«ç§’)</li><li>  mode(æ¨¡å¼)â€“Timer.PERIODIC(é€±æœŸå®šæ™‚åŸ·è¡Œ)/Timer.ONE_SHOT(åªåŸ·è¡Œä¸€æ¬¡)</li><li>  callback()â€“äº‹ä»¶ç™¼ç”Ÿè¢«åŸ·è¡Œçš„å‡½å¼</li></ul><p><strong>deinit()</strong>â€”è§£é™¤è¨ˆæ™‚å™¨</p><h2 id="ç¯„ä¾‹"><a href="#ç¯„ä¾‹" class="headerlink" title="ç¯„ä¾‹"></a>ç¯„ä¾‹</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token punctuation">,</span> Timer led <span class="token operator">=</span> Pin<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span> Pin<span class="token punctuation">.</span>OUT<span class="token punctuation">)</span> tim <span class="token operator">=</span> Timer<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>tim<span class="token punctuation">.</span>init<span class="token punctuation">(</span>period<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> mode<span class="token operator">=</span>Timer<span class="token punctuation">.</span>PERIODIC<span class="token punctuation">,</span> callback<span class="token operator">=</span><span class="token keyword">lambda</span> t<span class="token punctuation">:</span>led<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token keyword">not</span> led<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">try</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span><span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>    tim<span class="token punctuation">.</span>deinit<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'stopped'</span><span class="token punctuation">)</span><span class="token keyword">lambda</span> t<span class="token punctuation">:</span>led<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token keyword">not</span> led<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€™æ®µå…¶å¯¦æ˜¯ç”¨åŒ¿åå‡½å¼å¯«æˆ,åŸæœ¬çš„å…·åå‡½å¼å¦‚ä¸‹:</p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">def</span> timer<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">:</span>    led<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token keyword">not</span> led<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/NwFATgqya4o" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp8266 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> timer </tag>
            
            <tag> è¨ˆæ™‚å™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MPU-6050&amp;webServerç¶²é é¡¯ç¤º-micropython</title>
      <link href="/2021/09/18/mpu-6050-webserver-wang-ye-xian-shi-micropython/"/>
      <url>/2021/09/18/mpu-6050-webserver-wang-ye-xian-shi-micropython/</url>
      
        <content type="html"><![CDATA[<h1 id="MPU-6050-amp-webServerç¶²é é¡¯ç¤º-micropython"><a href="#MPU-6050-amp-webServerç¶²é é¡¯ç¤º-micropython" class="headerlink" title="MPU-6050&amp;webServerç¶²é é¡¯ç¤º-micropython"></a>MPU-6050&amp;webServerç¶²é é¡¯ç¤º-micropython</h1><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5609914849128090650#"><img src="https://lh3.googleusercontent.com/-AuOUWjHmS6E/YUFZSsQF-3I/AAAAAAAAe7A/Ld6q4qhLaIgcPs2T3TiXfqmoNovtQ1LtwCNcBGAsYHQ/s1600/1631672633719436-0.png"></a></p><h2 id="å¯¦é©—ç›®æ¨™"><a href="#å¯¦é©—ç›®æ¨™" class="headerlink" title="å¯¦é©—ç›®æ¨™:"></a>å¯¦é©—ç›®æ¨™:</h2><p><strong>æ­¤æ¬¡å¯¦é©—è¦æŠŠå¯¦æ™‚é‡æ¸¬çš„åŠ é€Ÿåº¦è¨ˆå’Œé™€èºå„€xyzå€¼é¡¯ç¤ºæ–¼ç¶²é ä¸Šã€‚</strong></p><h2 id="MPU-6050ç°¡ä»‹"><a href="#MPU-6050ç°¡ä»‹" class="headerlink" title="MPU-6050ç°¡ä»‹"></a>MPU-6050ç°¡ä»‹</h2><p><strong>MPU-6050 IMU</strong>ï¼ˆæ…£æ€§æ¸¬é‡å–®å…ƒï¼‰æ˜¯ä¸€å€‹ 3 è»¸åŠ é€Ÿåº¦è¨ˆå’Œ 3 è»¸é™€èºå„€å‚³æ„Ÿå™¨ã€‚åŠ é€Ÿåº¦è¨ˆæ¸¬é‡é‡åŠ›åŠ é€Ÿåº¦ï¼Œé™€èºå„€æ¸¬é‡æ—‹è½‰é€Ÿåº¦ã€‚æ­¤å¤–ï¼Œè©²æ¨¡å¡Šé‚„æ¸¬é‡æº«åº¦ã€‚è©²å‚³æ„Ÿå™¨éå¸¸é©åˆç¢ºå®šç§»å‹•ç‰©é«”çš„æ–¹å‘ã€‚</p><p>MPU-6050 æ˜¯ä¸€å€‹å¸¶æœ‰ 3 è»¸åŠ é€Ÿåº¦è¨ˆå’Œ 3 è»¸é™€èºå„€çš„æ¨¡çµ„ã€‚</p><p>**é™€èºå„€-**ç”¨æ–¼æ¸¬é‡æ—‹è½‰é€Ÿåº¦ (rad/s)ï¼Œé€™æ˜¯è§’åº¦ä½ç½®æ²¿ Xã€Y å’Œ Z è»¸ï¼ˆæ»¾å‹•ã€ä¿¯ä»°å’Œåèˆªï¼‰éš¨æ™‚é–“çš„è®ŠåŒ–ã€‚é€™ä½¿æˆ‘å€‘èƒ½å¤ ç¢ºå®šç‰©é«”çš„æ–¹å‘ã€‚</p><p>**åŠ é€Ÿåº¦è¨ˆ-**æ¸¬é‡åŠ é€Ÿåº¦å®ƒå¯ä»¥æ„Ÿæ‡‰é‡åŠ› (9.8m/s2) ç­‰éœæ…‹åŠ›æˆ–æŒ¯å‹•æˆ–é‹å‹•ç­‰å‹•æ…‹åŠ›ã€‚Â </p><p>MPU-6050Â æ¸¬é‡ Xã€Y å’Œ Z è»¸ä¸Šçš„åŠ é€Ÿåº¦ã€‚ç†æƒ³æƒ…æ³ä¸‹ï¼Œåœ¨éœæ…‹ç‰©é«”ä¸­ï¼ŒZ è»¸ä¸Šçš„åŠ é€Ÿåº¦ç­‰æ–¼é‡åŠ›ï¼Œä¸¦ä¸”åœ¨ X å’Œ Y è»¸ä¸Šæ‡‰ç‚ºé›¶ã€‚<br>**åŠ é€Ÿåº¦è¨ˆ-**å¯ä»¥ä½¿ç”¨ä¸‰è§’æ³•è¨ˆç®—æ©«æ»¾è§’å’Œä¿¯ä»°è§’ã€‚ä½†ç„¡æ³•è¨ˆç®—åèˆªã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5609914849128090650#"><img src="https://1.bp.blogspot.com/-u8-QyUWHTwI/YTrKgEmaSII/AAAAAAAAe5o/3EOJc0UTKPUQY1FE1LjaMLpJXF-WUeGJwCNcBGAsYHQ/w403-h368/MPU6050-Module-Gyroscope-Axis.jpg"></a></p><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5609914849128090650#"><img src="https://1.bp.blogspot.com/-Jzy9JzxJVRI/YTrMxxtTrRI/AAAAAAAAe54/GM3Hk8tPHz0oT7ezO6IWl0iy3GS2xOh5gCNcBGAsYHQ/w1272-h481/MPU6050.jpg"></a></p><h2 id="é ˆåŒ¯å…¥çš„ç¨‹å¼åº«"><a href="#é ˆåŒ¯å…¥çš„ç¨‹å¼åº«" class="headerlink" title="é ˆåŒ¯å…¥çš„ç¨‹å¼åº«"></a>é ˆåŒ¯å…¥çš„ç¨‹å¼åº«</h2><p>å°‡ä»¥ä¸‹çš„pyæª”ä¸Šå‚³åˆ°esp32æ¿ä¸Š</p><p>mpu6050.py</p><pre class="line-numbers language-py" data-language="py"><code class="language-py">importÂ machineclassÂ accel():Â Â Â Â defÂ __init__(self,Â i2c,Â addr&#x3D;0x68):Â Â Â Â Â Â Â Â self.iicÂ &#x3D;Â i2cÂ Â Â Â Â Â Â Â self.addrÂ &#x3D;Â addrÂ Â Â Â Â Â Â Â self.iic.start()Â Â Â Â Â Â Â Â self.iic.writeto(self.addr,Â bytearray([107,Â 0]))Â Â Â Â Â Â Â Â self.iic.stop()  Â Â Â Â defÂ get_raw_values(self):Â Â Â Â Â Â Â Â self.iic.start()Â Â Â Â Â Â Â Â aÂ &#x3D;Â self.iic.readfrom_mem(self.addr,Â 0x3B,Â 14)Â Â Â Â Â Â Â Â self.iic.stop()Â Â Â Â Â Â Â Â returnÂ aÂ Â Â Â defÂ get_ints(self):Â Â Â Â Â Â Â Â bÂ &#x3D;Â self.get_raw_values()Â Â Â Â Â Â Â Â cÂ &#x3D;Â []Â Â Â Â Â Â Â Â forÂ iÂ inÂ b:Â Â Â Â Â Â Â Â Â Â Â Â c.append(i)Â Â Â Â Â Â Â Â returnÂ cÂ Â Â Â defÂ bytes_toint(self,Â firstbyte,Â secondbyte):Â Â Â Â Â Â Â Â ifÂ notÂ firstbyteÂ &amp;Â 0x80:Â Â Â Â Â Â Â Â Â Â Â Â returnÂ firstbyteÂ &lt;&lt;Â 8Â |Â secondbyteÂ Â Â Â Â Â Â Â returnÂ -Â (((firstbyteÂ ^Â 255)Â &lt;&lt;Â 8)Â |Â (secondbyteÂ ^Â 255)Â +Â 1)  Â Â Â Â defÂ get_values(self):Â Â Â Â Â Â Â Â raw_intsÂ &#x3D;Â self.get_raw_values()Â Â Â Â Â Â Â Â valsÂ &#x3D;Â &#123;&#125;Â Â Â Â Â Â Â Â vals[&quot;AcX&quot;]Â &#x3D;Â self.bytes_toint(raw_ints[0],Â raw_ints[1])Â Â Â Â Â Â Â Â vals[&quot;AcY&quot;]Â &#x3D;Â self.bytes_toint(raw_ints[2],Â raw_ints[3])Â Â Â Â Â Â Â Â vals[&quot;AcZ&quot;]Â &#x3D;Â self.bytes_toint(raw_ints[4],Â raw_ints[5])Â Â Â Â Â Â Â Â vals[&quot;Tmp&quot;]Â &#x3D;Â self.bytes_toint(Â Â Â Â Â Â Â Â Â Â Â Â raw_ints[6],Â raw_ints[7])Â &#x2F;Â 340.00Â +Â 36.53Â Â Â Â Â Â Â Â vals[&quot;GyX&quot;]Â &#x3D;Â self.bytes_toint(raw_ints[8],Â raw_ints[9])Â Â Â Â Â Â Â Â vals[&quot;GyY&quot;]Â &#x3D;Â self.bytes_toint(raw_ints[10],Â raw_ints[11])Â Â Â Â Â Â Â Â vals[&quot;GyZ&quot;]Â &#x3D;Â self.bytes_toint(raw_ints[12],Â raw_ints[13])Â Â Â Â Â Â Â Â returnÂ valsÂ Â #Â returnedÂ inÂ rangeÂ ofÂ Int16Â Â Â Â Â Â Â Â #Â -32768Â toÂ 32767  Â Â Â Â defÂ val_test(self):Â Â #Â ONLYÂ FORÂ TESTING!Â Also,Â fastÂ readingÂ sometimesÂ crashesÂ IICÂ Â Â Â Â Â Â Â fromÂ timeÂ importÂ sleepÂ Â Â Â Â Â Â Â whileÂ 1:Â Â Â Â Â Â Â Â Â Â Â Â print(self.get_values())Â Â Â Â Â Â Â Â Â Â Â Â sleep(0.05)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ä¸»ç¨‹å¼"><a href="#ä¸»ç¨‹å¼" class="headerlink" title="ä¸»ç¨‹å¼"></a>ä¸»ç¨‹å¼</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py">fromÂ machineÂ importÂ Pin,Â I2CimportÂ mpu6050importÂ socketimportÂ network  #è¨­å®šé€£ç·šwifissidÂ &#x3D;Â &quot;---&quot;passwordÂ &#x3D;Â &quot;------&quot;wifiÂ &#x3D;Â network.WLAN(network.STA_IF)wifi.active(True)wifi.connect(ssid,Â password)whileÂ wifi.isconnected()Â &#x3D;&#x3D;Â False:Â Â Â Â passprint(&quot;connectÂ successful!&quot;)print(&quot;IP:Â &#123;&#125;&quot;.format(wifi.ifconfig()))  #è®€å–mpu6050å„æ•¸å€¼defÂ getMPUval(i2c,Â mpu):Â Â Â Â globalÂ gx,Â gy,Â gz,Â ax,Â ay,Â azÂ Â Â Â mpuValÂ &#x3D;Â mpu.get_values()Â Â Â Â gx,Â gy,Â gzÂ &#x3D;Â mpuVal[&#39;GyX&#39;],Â mpuVal[&#39;GyY&#39;],Â mpuVal[&#39;GyZ&#39;]Â Â Â Â ax,Â ay,Â azÂ &#x3D;Â mpuVal[&#39;AcX&#39;],Â mpuVal[&#39;AcY&#39;],Â mpuVal[&#39;AcZ&#39;]Â Â Â Â returnÂ gx,Â gy,Â gz,Â ax,Â ay,Â az#ç¶²é defÂ htmlPage():Â Â Â Â htmlÂ &#x3D;Â &quot;&quot;&quot;Â Â Â Â Â Â Â Â &lt;html&gt;Â Â Â Â &lt;head&gt;Â Â Â Â Â Â Â Â &lt;metaÂ charset&#x3D;&quot;utf-8&quot;Â &#x2F;&gt;Â Â Â Â Â Â Â Â &lt;metaÂ http-equiv&#x3D;&quot;refresh&quot;Â content&#x3D;&quot;0.2&quot;Â &#x2F;&gt;Â Â Â Â Â Â Â Â &lt;metaÂ name&#x3D;&quot;viewport&quot;Â content&#x3D;&quot;width&#x3D;device-width,Â initial-scale&#x3D;1.0&quot;Â &#x2F;&gt;Â Â Â Â Â Â Â Â &lt;style&gt;Â Â Â Â Â Â Â Â Â Â Â Â h1Â &#123;text-align:Â center;Â background-color:Â rgb(226,Â 155,Â 23);Â color:Â rgb(47,Â 49,Â 42);Â margin-right:Â 5px;&#125;Â Â Â Â Â Â Â Â Â Â Â Â h2Â &#123;text-align:Â center;Â Â color:Â rgb(47,Â 49,Â 42);Â background-color:Â rgb(197,Â 194,Â 11);margin-right:Â 5px;&#125;Â Â Â Â Â Â Â Â Â Â Â Â dlÂ &#123;width:Â 320px;Â margin:Â auto;&#125;Â Â Â Â Â Â Â Â Â Â Â Â dtÂ &#123;font-size:Â 20pt;Â color:Â rgb(36,Â 45,Â 168);Â background-color:Â rgb(197,Â 194,Â 11);Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â margin:Â 6ptÂ 0;Â padding:Â 6ptÂ 12pt;&#125;Â Â Â Â Â Â Â Â Â Â Â Â pÂ &#123;text-align:Â center;Â padding-right:Â 6pt;Â 6pt;Â line-height:20px&#125;Â Â Â Â Â Â Â Â Â Â Â Â .valÂ p&#123;Â margin:0Â auto&#125;Â Â Â Â Â Â Â Â Â Â Â Â Â .valÂ &#123;Â font-size:Â 20pt;Â color:Â rgb(255,Â 120,Â 30);Â &#125;Â Â Â Â Â Â Â Â &lt;&#x2F;style&gt;Â Â Â Â &lt;&#x2F;head&gt;Â Â Â Â &lt;body&gt;Â Â Â Â Â Â Â Â &lt;h1&gt;MPU-6050Â Test&lt;&#x2F;h1&gt;Â Â Â Â Â Â Â Â &lt;h2&gt;AccelerationÂ (m&#x2F;s^2)&lt;&#x2F;h2&gt;Â Â Â Â Â Â Â Â &lt;pÂ class&#x3D;val&gt;AXÂ &quot;&quot;&quot;+str(ax)+&quot;&quot;&quot;&lt;&#x2F;p&gt;Â Â Â Â Â Â Â Â &lt;pÂ class&#x3D;val&gt;AYÂ &quot;&quot;&quot;+str(ay)+&quot;&quot;&quot;&lt;&#x2F;p&gt;Â Â Â Â Â Â Â Â &lt;pÂ class&#x3D;val&gt;AZÂ &quot;&quot;&quot;+str(az)+&quot;&quot;&quot;&lt;&#x2F;p&gt;Â Â Â Â Â Â Â Â &lt;h2&gt;Gyro(rad&#x2F;s)&lt;&#x2F;h2&gt;Â Â Â Â Â Â Â Â &lt;pÂ class&#x3D;val&gt;GXÂ &quot;&quot;&quot;+str(gx)+&quot;&quot;&quot;&lt;&#x2F;p&gt;Â Â Â Â Â Â Â Â &lt;pÂ class&#x3D;val&gt;GYÂ &quot;&quot;&quot;+str(gy)+&quot;&quot;&quot;&lt;&#x2F;p&gt;Â Â Â Â Â Â Â Â &lt;pÂ class&#x3D;val&gt;GZÂ &quot;&quot;&quot;+str(gz)+&quot;&quot;&quot;&lt;&#x2F;p&gt;Â Â Â Â &lt;&#x2F;body&gt;Â Â Â Â &lt;&#x2F;html&gt;Â Â Â Â &quot;&quot;&quot;Â Â Â Â returnÂ html  #socketå¥—æ¥s&#x3D;socket.socket(socket.AF_INET,Â socket.SOCK_STREAM)s.bind((&#39;&#39;,Â 80))s.listen(5)i2cÂ &#x3D;Â I2C(scl&#x3D;Pin(22),Â sda&#x3D;Pin(21))mpuÂ &#x3D;Â mpu6050.accel(i2c)whileÂ True:Â Â Â Â conn,Â addrÂ &#x3D;Â s.accept()Â Â Â Â print(&#39;GotÂ aÂ connectionÂ fromÂ %s&#39;Â %Â str(addr))Â Â Â Â reqÂ &#x3D;Â conn.recv(1024)Â Â Â Â print(&#39;ContentÂ &#x3D;Â %s&#39;Â %Â str(req))Â Â Â Â readMPUvalÂ &#x3D;Â getMPUval(i2c,Â mpu)Â Â Â Â responseÂ &#x3D;Â htmlPage()Â Â Â Â conn.send(&quot;http&#x2F;1.1Â 200Â OK\n&quot;)Â Â Â Â conn.send(&quot;Content-Type:Â text&#x2F;html\n&quot;)Â Â Â Â conn.send(&quot;Connection:Â close\n\n&quot;)Â Â Â Â conn.sendall(response)Â Â Â Â conn.close()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/oT70vaBiiLo" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web server </tag>
            
            <tag> mpu-6050 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webserverç¶²é é¡¯ç¤ºmpu6050</title>
      <link href="/2021/09/15/webserver-wang-ye-xian-shi-mpu6050/"/>
      <url>/2021/09/15/webserver-wang-ye-xian-shi-mpu6050/</url>
      
        <content type="html"><![CDATA[<h1 id="MPU-6050-amp-webServerç¶²é é¡¯ç¤º-ESP32"><a href="#MPU-6050-amp-webServerç¶²é é¡¯ç¤º-ESP32" class="headerlink" title="MPU-6050&amp;webServerç¶²é é¡¯ç¤º-ESP32"></a>MPU-6050&amp;webServerç¶²é é¡¯ç¤º-ESP32</h1><h6 id="tags-esp32-mpu-6050"><a href="#tags-esp32-mpu-6050" class="headerlink" title="tags: esp32 mpu-6050"></a>tags: <code>esp32</code> <code>mpu-6050</code></h6><h2 id="å¯¦é©—ç›®æ¨™"><a href="#å¯¦é©—ç›®æ¨™" class="headerlink" title="å¯¦é©—ç›®æ¨™:"></a>å¯¦é©—ç›®æ¨™:</h2><p><strong>æ­¤æ¬¡å¯¦é©—è¦æŠŠå¯¦æ™‚é‡æ¸¬çš„xyzå€¼é¡¯ç¤ºæ–¼ç¶²é ä¸Šã€‚</strong></p><h2 id="MPU-6050ç°¡ä»‹"><a href="#MPU-6050ç°¡ä»‹" class="headerlink" title="MPU-6050ç°¡ä»‹"></a>MPU-6050ç°¡ä»‹</h2><p><strong>MPU-6050 IMU</strong>ï¼ˆæ…£æ€§æ¸¬é‡å–®å…ƒï¼‰æ˜¯ä¸€å€‹ 3 è»¸åŠ é€Ÿåº¦è¨ˆå’Œ 3 è»¸é™€èºå„€å‚³æ„Ÿå™¨ã€‚åŠ é€Ÿåº¦è¨ˆæ¸¬é‡é‡åŠ›åŠ é€Ÿåº¦ï¼Œé™€èºå„€æ¸¬é‡æ—‹è½‰é€Ÿåº¦ã€‚æ­¤å¤–ï¼Œè©²æ¨¡å¡Šé‚„æ¸¬é‡æº«åº¦ã€‚è©²å‚³æ„Ÿå™¨éå¸¸é©åˆç¢ºå®šç§»å‹•ç‰©é«”çš„æ–¹å‘ã€‚</p><p>MPU-6050 æ˜¯ä¸€å€‹å¸¶æœ‰ 3 è»¸åŠ é€Ÿåº¦è¨ˆå’Œ 3 è»¸é™€èºå„€çš„æ¨¡çµ„ã€‚</p><p>**é™€èºå„€-**ç”¨æ–¼æ¸¬é‡æ—‹è½‰é€Ÿåº¦ (rad/s)ï¼Œé€™æ˜¯è§’åº¦ä½ç½®æ²¿ Xã€Y å’Œ Z è»¸ï¼ˆæ»¾å‹•ã€ä¿¯ä»°å’Œåèˆªï¼‰éš¨æ™‚é–“çš„è®ŠåŒ–ã€‚é€™ä½¿æˆ‘å€‘èƒ½å¤ ç¢ºå®šç‰©é«”çš„æ–¹å‘ã€‚</p><p>**åŠ é€Ÿåº¦è¨ˆ-**æ¸¬é‡åŠ é€Ÿåº¦å®ƒå¯ä»¥æ„Ÿæ‡‰é‡åŠ› (9.8m/s2) ç­‰éœæ…‹åŠ›æˆ–æŒ¯å‹•æˆ–é‹å‹•ç­‰å‹•æ…‹åŠ›ã€‚Â </p><p>MPU-6050Â æ¸¬é‡ Xã€Y å’Œ Z è»¸ä¸Šçš„åŠ é€Ÿåº¦ã€‚ç†æƒ³æƒ…æ³ä¸‹ï¼Œåœ¨éœæ…‹ç‰©é«”ä¸­ï¼ŒZ è»¸ä¸Šçš„åŠ é€Ÿåº¦ç­‰æ–¼é‡åŠ›ï¼Œä¸¦ä¸”åœ¨ X å’Œ Y è»¸ä¸Šæ‡‰ç‚ºé›¶ã€‚<br>**åŠ é€Ÿåº¦è¨ˆ-**å¯ä»¥ä½¿ç”¨ä¸‰è§’æ³•è¨ˆç®—æ©«æ»¾è§’å’Œä¿¯ä»°è§’ã€‚ä½†ç„¡æ³•è¨ˆç®—åèˆªã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/6706108357817778210#"><img src="https://1.bp.blogspot.com/-u8-QyUWHTwI/YTrKgEmaSII/AAAAAAAAe5o/3EOJc0UTKPUQY1FE1LjaMLpJXF-WUeGJwCNcBGAsYHQ/w403-h368/MPU6050-Module-Gyroscope-Axis.jpg"></a></p><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/6706108357817778210#"><img src="https://1.bp.blogspot.com/-Jzy9JzxJVRI/YTrMxxtTrRI/AAAAAAAAe54/GM3Hk8tPHz0oT7ezO6IWl0iy3GS2xOh5gCNcBGAsYHQ/w1272-h481/MPU6050.jpg"></a></p><h2 id="é ˆåŒ¯å…¥çš„ç¨‹å¼åº«"><a href="#é ˆåŒ¯å…¥çš„ç¨‹å¼åº«" class="headerlink" title="é ˆåŒ¯å…¥çš„ç¨‹å¼åº«"></a>é ˆåŒ¯å…¥çš„ç¨‹å¼åº«</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/6706108357817778210#">Adafruit_MPU6050</a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/6706108357817778210#">Adafruit_Sensor</a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/6706108357817778210#">ESPAsyncWebServer</a></p><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;Arduino.h&gt;&#x2F;&#x2F;åŒ…å«Â MPU-6050Â å‚³æ„Ÿå™¨æ‰€éœ€çš„åº«ï¼šAdafruit_MPU6050Â å’ŒÂ Adafruit_Sensorã€‚#include &lt;Adafruit_MPU6050.h&gt;#include &lt;Adafruit_Sensor.h&gt;#include &lt;WiFi.h&gt;#include &lt;ESPAsyncWebServer.h&gt;  &#x2F;&#x2F;wifiå¸³å¯†constÂ charÂ *ssidÂ &#x3D;Â &quot;---&quot;;constÂ charÂ *passwordÂ &#x3D;Â &quot;-----&quot;;Adafruit_MPU6050Â mpu;AsyncWebServerÂ server(80);&#x2F;&#x2F;htmlconstÂ charÂ indexHtml[]Â PROGMEMÂ &#x3D;Â R&quot;&#x3D;&#x3D;&#x3D;(Â Â &lt;html&gt;&lt;head&gt;Â Â Â Â &lt;metaÂ charset&#x3D;&quot;utf-8&quot;Â &#x2F;&gt;Â Â Â Â &lt;metaÂ http-equiv&#x3D;&quot;refresh&quot;Â content&#x3D;&quot;0.5&quot;Â &#x2F;&gt;Â Â Â Â &lt;metaÂ name&#x3D;&quot;viewport&quot;Â content&#x3D;&quot;width&#x3D;device-width,Â initial-scale&#x3D;1.0&quot;Â &#x2F;&gt;Â Â Â Â &lt;style&gt;Â Â Â Â Â Â Â Â h1Â &#123;text-align:Â center;Â background-color:Â rgb(226,Â 155,Â 23);Â color:Â rgb(47,Â 49,Â 42);Â margin-right:Â 5px;&#125;Â Â Â Â Â Â Â Â h2Â &#123;text-align:Â center;Â Â color:Â rgb(47,Â 49,Â 42);Â background-color:Â rgb(197,Â 194,Â 11);margin-right:Â 5px;&#125;Â Â Â Â Â Â Â Â dlÂ &#123;width:Â 320px;Â margin:Â auto;&#125;Â Â Â Â Â Â Â Â dtÂ &#123;font-size:Â 20pt;Â color:Â rgb(36,Â 45,Â 168);Â background-color:Â rgb(197,Â 194,Â 11);Â Â Â Â Â Â Â Â Â Â Â Â margin:Â 6ptÂ 0;Â padding:Â 6ptÂ 12pt;&#125;Â Â Â Â Â Â Â Â pÂ &#123;text-align:Â center;Â padding-right:Â 6pt;Â 6pt;Â line-height:20px&#125;Â Â Â Â Â Â Â Â .valÂ p&#123;Â margin:0Â auto&#125;Â Â Â Â Â Â Â Â Â .valÂ &#123;Â font-size:Â 20pt;Â color:Â rgb(255,Â 120,Â 30);Â &#125;Â Â Â Â &lt;&#x2F;style&gt;&lt;&#x2F;head&gt;&lt;body&gt;Â Â Â Â &lt;h1&gt;MPU-6050åŠ é€Ÿåº¦&amp;é™€èºå„€æ¸¬è©¦&lt;&#x2F;h1&gt;Â Â Â Â &lt;h2&gt;åŠ é€Ÿåº¦è¨ˆÂ (m&#x2F;s^2)&lt;&#x2F;h2&gt;Â Â Â Â &lt;pÂ class&#x3D;val&gt;AXÂ %ax%&lt;&#x2F;p&gt;Â Â Â Â &lt;pÂ class&#x3D;val&gt;AYÂ %ay%&lt;&#x2F;p&gt;Â Â Â Â &lt;pÂ class&#x3D;val&gt;AZÂ %az%&lt;&#x2F;p&gt;Â Â Â Â &lt;h2&gt;é™€èºå„€(rad&#x2F;s)&lt;&#x2F;h2&gt;Â Â Â Â &lt;pÂ class&#x3D;val&gt;GXÂ %gx%&lt;&#x2F;p&gt;Â Â Â Â &lt;pÂ class&#x3D;val&gt;GYÂ %gy%&lt;&#x2F;p&gt;Â Â Â Â &lt;pÂ class&#x3D;val&gt;GZÂ %gz%&lt;&#x2F;p&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;)&#x3D;&#x3D;&#x3D;&quot;;&#x2F;&#x2F;ä»¥ä¸‹æ˜¯è®€å–åŠ é€Ÿåº¦è¨ˆå’Œé™€èºå„€çš„xyzå€¼StringÂ readX()&#123;Â Â mpu.begin();Â Â sensors_event_tÂ a,Â g,Â temp;Â Â mpu.getEvent(&amp;a,Â &amp;g,Â &amp;temp);Â Â returnÂ String(a.acceleration.x);&#125;StringÂ readY()&#123;Â Â sensors_event_tÂ a,Â g,Â temp;Â Â mpu.getEvent(&amp;a,Â &amp;g,Â &amp;temp);Â Â returnÂ String(a.acceleration.y);&#125;StringÂ readZ()&#123;Â Â sensors_event_tÂ a,Â g,Â temp;Â Â mpu.getEvent(&amp;a,Â &amp;g,Â &amp;temp);Â Â returnÂ String(a.acceleration.z);&#125;StringÂ readGX()&#123;Â Â Â sensors_event_tÂ a,Â g,Â temp;Â Â mpu.getEvent(&amp;a,Â &amp;g,Â &amp;temp);Â Â returnÂ String(g.gyro.x);&#125;StringÂ readGY()&#123;Â Â Â sensors_event_tÂ a,Â g,Â temp;Â Â mpu.getEvent(&amp;a,Â &amp;g,Â &amp;temp);Â Â returnÂ String(g.gyro.y);&#125;StringÂ readGZ()&#123;Â Â Â sensors_event_tÂ a,Â g,Â temp;Â Â mpu.getEvent(&amp;a,Â &amp;g,Â &amp;temp);Â Â returnÂ String(g.gyro.z);&#125;StringÂ mpuProcessor(constÂ StringÂ &amp;Â val)&#123;Â Â ifÂ (valÂ &#x3D;&#x3D;Â &quot;ax&quot;)&#123;Â Â Â Â returnÂ readX();Â Â &#125;elseÂ ifÂ (valÂ &#x3D;&#x3D;Â &quot;ay&quot;)&#123;Â Â Â Â returnÂ readY();Â Â &#125;elseÂ ifÂ (valÂ &#x3D;&#x3D;Â &quot;az&quot;)&#123;Â Â Â Â returnÂ readZ();Â Â &#125;elseÂ ifÂ (valÂ &#x3D;&#x3D;Â &quot;gx&quot;)&#123;Â Â Â Â returnÂ readGX();Â Â &#125;elseÂ ifÂ (valÂ &#x3D;&#x3D;Â &quot;gy&quot;)&#123;Â Â Â Â returnÂ readGY();Â Â &#125;elseÂ ifÂ (valÂ &#x3D;&#x3D;Â &quot;gz&quot;)&#123;Â Â Â Â returnÂ readGZ();Â Â &#125;Â Â returnÂ String();&#125;  voidÂ setup()Â &#123;Â Â Serial.begin(115200);Â Â WiFi.begin(ssid,Â password);Â Â mpu.begin();Â Â whileÂ (WiFi.status()Â !&#x3D;Â WL_CONNECTED)&#123;Â Â Â Â Â Â Serial.print(&quot;.&quot;);Â Â Â Â Â Â delay(500);Â Â &#125;Â Â Serial.println(&quot;ConnectedÂ successful!&quot;);Â Â Serial.print(&quot;IP:Â &quot;);Â Serial.println(WiFi.localIP());Â Â &#x2F;&#x2F;å‚³é€çµ¦ç¶²é ä¼ºæœå™¨ä¸¦é¡¯ç¤ºæ–¼é é¢çš„å€¼Â Â server.on(&quot;&#x2F;&quot;,Â HTTP_GET,Â [](AsyncWebServerRequestÂ *request)&#123;Â Â Â Â Â Â Â Â request-&gt;send_P(200,Â &quot;text&#x2F;html&quot;,Â indexHtml,Â mpuProcessor);Â Â Â Â &#125;);Â Â server.on(&quot;AX&quot;,Â HTTP_GET,Â [](AsyncWebServerRequestÂ *request)&#123;Â Â Â Â Â Â Â Â request-&gt;send_P(200,Â &quot;text&#x2F;plain&quot;,Â readX().c_str());Â Â Â Â &#125;);Â Â server.on(&quot;AY&quot;,Â HTTP_GET,Â [](AsyncWebServerRequestÂ *request)&#123;Â Â Â Â Â Â Â Â request-&gt;send_P(200,Â &quot;text&#x2F;plain&quot;,Â readY().c_str());Â Â Â Â &#125;);Â Â server.on(&quot;AZ&quot;,Â HTTP_GET,Â [](AsyncWebServerRequestÂ *request)&#123;Â Â Â Â Â Â Â Â request-&gt;send_P(200,Â &quot;text&#x2F;plain&quot;,Â readZ().c_str());Â Â Â Â &#125;);Â Â server.on(&quot;GX&quot;,Â HTTP_GET,Â [](AsyncWebServerRequestÂ *request)&#123;Â Â Â Â Â Â Â Â request-&gt;send_P(200,Â &quot;text&#x2F;plain&quot;,Â readGX().c_str());Â Â Â Â &#125;);Â Â server.on(&quot;GY&quot;,Â HTTP_GET,Â [](AsyncWebServerRequestÂ *request)&#123;Â Â Â Â Â Â Â Â request-&gt;send_P(200,Â &quot;text&#x2F;plain&quot;,Â readGY().c_str());Â Â Â Â &#125;);Â Â server.on(&quot;GZ&quot;,Â HTTP_GET,Â [](AsyncWebServerRequestÂ *request)&#123;Â Â Â Â Â Â Â Â request-&gt;send_P(200,Â &quot;text&#x2F;plain&quot;,Â readGZ().c_str());Â Â Â Â &#125;);Â Â server.begin();&#125;voidÂ loop()Â &#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/YR07MMNbcWc" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web server </tag>
            
            <tag> mpu6050 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MPU-6050åŠ é€Ÿåº¦-é™€èºå„€-æº«åº¦å‚³æ„Ÿå™¨-micropython</title>
      <link href="/2021/09/10/mpu-6050-jia-su-du-tuo-luo-yi-wen-du-chuan-gan-qi-micropython/"/>
      <url>/2021/09/10/mpu-6050-jia-su-du-tuo-luo-yi-wen-du-chuan-gan-qi-micropython/</url>
      
        <content type="html"><![CDATA[<h2 id="MPU-6050åŠ é€Ÿåº¦-é™€èºå„€-æº«åº¦å‚³æ„Ÿå™¨-micropython"><a href="#MPU-6050åŠ é€Ÿåº¦-é™€èºå„€-æº«åº¦å‚³æ„Ÿå™¨-micropython" class="headerlink" title="MPU-6050åŠ é€Ÿåº¦-é™€èºå„€-æº«åº¦å‚³æ„Ÿå™¨-micropython"></a>MPU-6050åŠ é€Ÿåº¦-é™€èºå„€-æº«åº¦å‚³æ„Ÿå™¨-micropython</h2><h6 id="tags-micropython-mpu-6050"><a href="#tags-micropython-mpu-6050" class="headerlink" title="tags: micropython mpu-6050"></a>tags: <code>micropython</code> <code>mpu-6050</code></h6><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/7574901053087696690#"><img src="https://1.bp.blogspot.com/-vLDJAqcfOeU/YTrKHZdaKqI/AAAAAAAAe5g/kIY1BLNq_9Y7NrutJsQzYbPDZ02howdIgCNcBGAsYHQ/w406-h227/mpu6050.jpg"></a></p><h2 id="å¯¦é©—ç›®æ¨™"><a href="#å¯¦é©—ç›®æ¨™" class="headerlink" title="å¯¦é©—ç›®æ¨™:"></a>å¯¦é©—ç›®æ¨™:</h2><p>MPU-6050 IMUï¼ˆæ…£æ€§æ¸¬é‡å–®å…ƒï¼‰æ˜¯ä¸€å€‹ 3 è»¸åŠ é€Ÿåº¦è¨ˆå’Œ 3 è»¸é™€èºå„€å‚³æ„Ÿå™¨ã€‚åŠ é€Ÿåº¦è¨ˆæ¸¬é‡é‡åŠ›åŠ é€Ÿåº¦ï¼Œé™€èºå„€æ¸¬é‡æ—‹è½‰é€Ÿåº¦ã€‚æ­¤å¤–ï¼Œè©²æ¨¡å¡Šé‚„æ¸¬é‡æº«åº¦ã€‚è©²å‚³æ„Ÿå™¨éå¸¸é©åˆç¢ºå®šç§»å‹•ç‰©é«”çš„æ–¹å‘ã€‚</p><h2 id="MPU-6050ç°¡ä»‹"><a href="#MPU-6050ç°¡ä»‹" class="headerlink" title="MPU-6050ç°¡ä»‹"></a>MPU-6050ç°¡ä»‹</h2><p>MPU-6050 æ˜¯ä¸€å€‹å¸¶æœ‰ 3 è»¸åŠ é€Ÿåº¦è¨ˆå’Œ 3 è»¸é™€èºå„€çš„æ¨¡çµ„ã€‚</p><p><strong>é™€èºå„€</strong>-ç”¨æ–¼æ¸¬é‡æ—‹è½‰é€Ÿåº¦ (rad/s)ï¼Œé€™æ˜¯è§’åº¦ä½ç½®æ²¿ Xã€Y å’Œ Z è»¸ï¼ˆæ»¾å‹•ã€ä¿¯ä»°å’Œåèˆªï¼‰éš¨æ™‚é–“çš„è®ŠåŒ–ã€‚é€™ä½¿æˆ‘å€‘èƒ½å¤ ç¢ºå®šç‰©é«”çš„æ–¹å‘ã€‚</p><p><strong>åŠ é€Ÿåº¦è¨ˆ</strong>-æ¸¬é‡åŠ é€Ÿåº¦å®ƒå¯ä»¥æ„Ÿæ‡‰é‡åŠ› (9.8m/s2) ç­‰éœæ…‹åŠ›æˆ–æŒ¯å‹•æˆ–é‹å‹•ç­‰å‹•æ…‹åŠ›ã€‚Â </p><p>MPU-6050Â æ¸¬é‡ Xã€Y å’Œ Z è»¸ä¸Šçš„åŠ é€Ÿåº¦ã€‚ç†æƒ³æƒ…æ³ä¸‹ï¼Œåœ¨éœæ…‹ç‰©é«”ä¸­ï¼ŒZ è»¸ä¸Šçš„åŠ é€Ÿåº¦ç­‰æ–¼é‡åŠ›ï¼Œä¸¦ä¸”åœ¨ X å’Œ Y è»¸ä¸Šæ‡‰ç‚ºé›¶ã€‚<br><strong>åŠ é€Ÿåº¦è¨ˆ</strong>-å¯ä»¥ä½¿ç”¨ä¸‰è§’æ³•è¨ˆç®—æ©«æ»¾è§’å’Œä¿¯ä»°è§’ã€‚ä½†ç„¡æ³•è¨ˆç®—åèˆªã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/7574901053087696690#"><img src="https://1.bp.blogspot.com/-u8-QyUWHTwI/YTrKgEmaSII/AAAAAAAAe5o/3EOJc0UTKPUQY1FE1LjaMLpJXF-WUeGJwCNcBGAsYHQ/w403-h368/MPU6050-Module-Gyroscope-Axis.jpg"></a></p><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/7574901053087696690#"><img src="https://1.bp.blogspot.com/-Jzy9JzxJVRI/YTrMxxtTrRI/AAAAAAAAe54/GM3Hk8tPHz0oT7ezO6IWl0iy3GS2xOh5gCNcBGAsYHQ/w1403-h530/MPU6050.jpg"></a></p><h2 id="é ˆåŒ¯å…¥çš„ç¨‹å¼åº«"><a href="#é ˆåŒ¯å…¥çš„ç¨‹å¼åº«" class="headerlink" title="é ˆåŒ¯å…¥çš„ç¨‹å¼åº«"></a>é ˆåŒ¯å…¥çš„ç¨‹å¼åº«</h2><p><strong><em>æ–°é–‹ä¸€å€‹mpu6050.pyå’Œmain.pyæ”¾ä¸€èµ·,ä¸¦ä¸Šå‚³åˆ°ESP32æ¿ä¸Š</em></strong></p><h3 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> machine<span class="token keyword">class</span> <span class="token class-name">accel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> __init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> i2c<span class="token punctuation">,</span> addr<span class="token operator">=</span><span class="token number">0x68</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>iic <span class="token operator">=</span> i2c        self<span class="token punctuation">.</span>addr <span class="token operator">=</span> addr        self<span class="token punctuation">.</span>iic<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>iic<span class="token punctuation">.</span>writeto<span class="token punctuation">(</span>self<span class="token punctuation">.</span>addr<span class="token punctuation">,</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">107</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>iic<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token keyword">def</span> get_raw_values<span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>iic<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>        a <span class="token operator">=</span> self<span class="token punctuation">.</span>iic<span class="token punctuation">.</span>readfrom_mem<span class="token punctuation">(</span>self<span class="token punctuation">.</span>addr<span class="token punctuation">,</span> <span class="token number">0x3B</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>iic<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> a      <span class="token keyword">def</span> get_ints<span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        b <span class="token operator">=</span> self<span class="token punctuation">.</span>get_raw_values<span class="token punctuation">(</span><span class="token punctuation">)</span>        c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> b<span class="token punctuation">:</span>            c<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        <span class="token keyword">return</span> c      <span class="token keyword">def</span> bytes_toint<span class="token punctuation">(</span>self<span class="token punctuation">,</span> firstbyte<span class="token punctuation">,</span> secondbyte<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> firstbyte <span class="token operator">&amp;</span> <span class="token number">0x80</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> firstbyte <span class="token operator">&lt;&lt;</span> <span class="token number">8</span> <span class="token operator">|</span> secondbyte        <span class="token keyword">return</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>firstbyte <span class="token operator">^</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>secondbyte <span class="token operator">^</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>      <span class="token keyword">def</span> get_values<span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        raw_ints <span class="token operator">=</span> self<span class="token punctuation">.</span>get_raw_values<span class="token punctuation">(</span><span class="token punctuation">)</span>        vals <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>        vals<span class="token punctuation">[</span><span class="token string">"AcX"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>bytes_toint<span class="token punctuation">(</span>raw_ints<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> raw_ints<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        vals<span class="token punctuation">[</span><span class="token string">"AcY"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>bytes_toint<span class="token punctuation">(</span>raw_ints<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> raw_ints<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        vals<span class="token punctuation">[</span><span class="token string">"AcZ"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>bytes_toint<span class="token punctuation">(</span>raw_ints<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> raw_ints<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        vals<span class="token punctuation">[</span><span class="token string">"Tmp"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>bytes_toint<span class="token punctuation">(</span>            raw_ints<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> raw_ints<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">340.00</span> <span class="token operator">+</span> <span class="token number">36.53</span>        vals<span class="token punctuation">[</span><span class="token string">"GyX"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>bytes_toint<span class="token punctuation">(</span>raw_ints<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> raw_ints<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        vals<span class="token punctuation">[</span><span class="token string">"GyY"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>bytes_toint<span class="token punctuation">(</span>raw_ints<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> raw_ints<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        vals<span class="token punctuation">[</span><span class="token string">"GyZ"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>bytes_toint<span class="token punctuation">(</span>raw_ints<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span> raw_ints<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> vals  <span class="token comment"># returned in range of Int16</span>        <span class="token comment"># -32768 to 32767</span>      <span class="token keyword">def</span> val_test<span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># ONLY FOR TESTING! Also, fast reading sometimes crashes IIC</span>        <span class="token keyword">from</span> time <span class="token keyword">import</span> sleep        <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>get_values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ä¸»ç¨‹å¼1"><a href="#ä¸»ç¨‹å¼1" class="headerlink" title="ä¸»ç¨‹å¼1"></a>ä¸»ç¨‹å¼1</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token punctuation">,</span> I2C<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">import</span> mpu6050  i2c <span class="token operator">=</span> I2C<span class="token punctuation">(</span>scl<span class="token operator">=</span>Pin<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sda<span class="token operator">=</span>Pin<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span>mpu <span class="token operator">=</span> mpu6050<span class="token punctuation">.</span>accel<span class="token punctuation">(</span>i2c<span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    mpuVal <span class="token operator">=</span> mpu<span class="token punctuation">.</span>get_values<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"GX:&#123;:.1f&#125;/ GY:&#123;:.1f&#125;/ GZ:&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mpuVal<span class="token punctuation">[</span><span class="token string">'GyX'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>mpuVal<span class="token punctuation">[</span><span class="token string">'GyY'</span><span class="token punctuation">]</span>\<span class="token punctuation">,</span>mpuVal<span class="token punctuation">[</span><span class="token string">'GyX'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mpuVal<span class="token punctuation">[</span><span class="token string">'GyZ'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"AX:&#123;:.1f&#125;/ AY:&#123;:.1f&#125;/ AZ:&#123;:.1f&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mpuVal<span class="token punctuation">[</span><span class="token string">'AcX'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\mpuVal<span class="token punctuation">[</span><span class="token string">'AcY'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mpuVal<span class="token punctuation">[</span><span class="token string">'AcZ'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="çµæœ"><a href="#çµæœ" class="headerlink" title="çµæœ"></a>çµæœ</h2><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/7574901053087696690#"><img src="https://1.bp.blogspot.com/-N_i09FWlltk/YTsA07RtbOI/AAAAAAAAe6Y/BwbDWlzg2ToB2KsyI1TLYKLVfACebZ0rwCNcBGAsYHQ/w418-h297/AXIS.jpg"></a></p><h2 id="é‡æ¸¬æ•¸å€¼é¡¯ç¤ºæ–¼OLED"><a href="#é‡æ¸¬æ•¸å€¼é¡¯ç¤ºæ–¼OLED" class="headerlink" title="é‡æ¸¬æ•¸å€¼é¡¯ç¤ºæ–¼OLED"></a>é‡æ¸¬æ•¸å€¼é¡¯ç¤ºæ–¼OLED</h2><p>å»ºç«‹<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/7574901053087696690#">ssd1306.py</a>å‡½å¼åº«ä¸¦ä¸Šå‚³åˆ°ESP32</p><h2 id="ä¸»ç¨‹å¼2"><a href="#ä¸»ç¨‹å¼2" class="headerlink" title="ä¸»ç¨‹å¼2"></a>ä¸»ç¨‹å¼2</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token punctuation">,</span> I2C<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">import</span> mpu6050<span class="token keyword">import</span> ssd1306i2c <span class="token operator">=</span> I2C<span class="token punctuation">(</span>scl<span class="token operator">=</span>Pin<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sda<span class="token operator">=</span>Pin<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span>width<span class="token operator">=</span><span class="token number">128</span> <span class="token comment">#oledé«˜</span>height<span class="token operator">=</span><span class="token number">64</span> <span class="token comment">#oledå¯›</span>oled<span class="token operator">=</span>ssd1306<span class="token punctuation">.</span>SSD1306_I2C<span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> i2c<span class="token punctuation">)</span> <span class="token comment">#è³¦äºˆè®Šæ•¸çµ¦è¨­åˆ¶å¥½çš„ssd1306æ¨¡çµ„,ä¸¦çµ¦äºˆæ‰€é ˆåƒæ•¸</span>oled<span class="token punctuation">.</span>fill<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>mpu <span class="token operator">=</span> mpu6050<span class="token punctuation">.</span>accel<span class="token punctuation">(</span>i2c<span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    mpuVal <span class="token operator">=</span> mpu<span class="token punctuation">.</span>get_values<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"GX:&#123;:.1f&#125;/ GY:&#123;:.1f&#125;/ GZ:&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mpuVal<span class="token punctuation">[</span><span class="token string">'GyX'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>mpuVal<span class="token punctuation">[</span><span class="token string">'GyY'</span><span class="token punctuation">]</span>\<span class="token punctuation">,</span>mpuVal<span class="token punctuation">[</span><span class="token string">'GyX'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mpuVal<span class="token punctuation">[</span><span class="token string">'GyZ'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"AX:&#123;:.1f&#125;/ AY:&#123;:.1f&#125;/ AZ:&#123;:.1f&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mpuVal<span class="token punctuation">[</span><span class="token string">'AcX'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\mpuVal<span class="token punctuation">[</span><span class="token string">'AcY'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mpuVal<span class="token punctuation">[</span><span class="token string">'AcZ'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">"GX:&#123;:.1f&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mpuVal<span class="token punctuation">[</span><span class="token string">'GyX'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">"GY:&#123;:.1f&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mpuVal<span class="token punctuation">[</span><span class="token string">'GyY'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">"GZ:&#123;:.1f&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mpuVal<span class="token punctuation">[</span><span class="token string">'GyZ'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">"AX:&#123;:.1f&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mpuVal<span class="token punctuation">[</span><span class="token string">'AcX'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">"AY:&#123;:.1f&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mpuVal<span class="token punctuation">[</span><span class="token string">'AcY'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">"AZ:&#123;:.1f&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mpuVal<span class="token punctuation">[</span><span class="token string">'AcZ'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>fill<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="çµæœ2"><a href="#çµæœ2" class="headerlink" title="çµæœ2"></a>çµæœ2</h2><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/7574901053087696690#"><img src="https://lh3.googleusercontent.com/-zOzUkgZHFA4/YTsNNLyBdQI/AAAAAAAAe6g/McELLZrF49kg6k-8iBojWybmlwAUcrteACNcBGAsYHQ/s1600/1631259935101215-0.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mpu6050 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MPU-6050åŠ é€Ÿåº¦-é™€èºå„€-æº«åº¦å‚³æ„Ÿå™¨-ESP32</title>
      <link href="/2021/09/10/mpu-6050-jia-su-du-tuo-luo-yi-wen-du-chuan-gan-qi-esp32/"/>
      <url>/2021/09/10/mpu-6050-jia-su-du-tuo-luo-yi-wen-du-chuan-gan-qi-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="MPU-6050åŠ é€Ÿåº¦-é™€èºå„€-æº«åº¦å‚³æ„Ÿå™¨-ESP32"><a href="#MPU-6050åŠ é€Ÿåº¦-é™€èºå„€-æº«åº¦å‚³æ„Ÿå™¨-ESP32" class="headerlink" title="MPU-6050åŠ é€Ÿåº¦-é™€èºå„€-æº«åº¦å‚³æ„Ÿå™¨-ESP32"></a>MPU-6050åŠ é€Ÿåº¦-é™€èºå„€-æº«åº¦å‚³æ„Ÿå™¨-ESP32</h1><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/9006409806488393795#"><img src="https://1.bp.blogspot.com/-vLDJAqcfOeU/YTrKHZdaKqI/AAAAAAAAe5g/kIY1BLNq_9Y7NrutJsQzYbPDZ02howdIgCNcBGAsYHQ/w406-h227/mpu6050.jpg"></a></p><h2 id="å¯¦é©—ç›®æ¨™"><a href="#å¯¦é©—ç›®æ¨™" class="headerlink" title="å¯¦é©—ç›®æ¨™:"></a>å¯¦é©—ç›®æ¨™:</h2><p>MPU-6050 IMUï¼ˆæ…£æ€§æ¸¬é‡å–®å…ƒï¼‰æ˜¯ä¸€å€‹ 3 è»¸åŠ é€Ÿåº¦è¨ˆå’Œ 3 è»¸é™€èºå„€å‚³æ„Ÿå™¨ã€‚åŠ é€Ÿåº¦è¨ˆæ¸¬é‡é‡åŠ›åŠ é€Ÿåº¦ï¼Œé™€èºå„€æ¸¬é‡æ—‹è½‰é€Ÿåº¦ã€‚æ­¤å¤–ï¼Œè©²æ¨¡å¡Šé‚„æ¸¬é‡æº«åº¦ã€‚è©²å‚³æ„Ÿå™¨éå¸¸é©åˆç¢ºå®šç§»å‹•ç‰©é«”çš„æ–¹å‘ã€‚</p><h2 id="MPU-6050ç°¡ä»‹"><a href="#MPU-6050ç°¡ä»‹" class="headerlink" title="MPU-6050ç°¡ä»‹"></a>MPU-6050ç°¡ä»‹</h2><p>MPU-6050 æ˜¯ä¸€å€‹å¸¶æœ‰ 3 è»¸åŠ é€Ÿåº¦è¨ˆå’Œ 3 è»¸é™€èºå„€çš„æ¨¡çµ„ã€‚</p><p><strong>é™€èºå„€</strong>-ç”¨æ–¼æ¸¬é‡æ—‹è½‰é€Ÿåº¦ (rad/s)ï¼Œé€™æ˜¯è§’åº¦ä½ç½®æ²¿ Xã€Y å’Œ Z è»¸ï¼ˆæ»¾å‹•ã€ä¿¯ä»°å’Œåèˆªï¼‰éš¨æ™‚é–“çš„è®ŠåŒ–ã€‚é€™ä½¿æˆ‘å€‘èƒ½å¤ ç¢ºå®šç‰©é«”çš„æ–¹å‘ã€‚</p><p><strong>åŠ é€Ÿåº¦è¨ˆ</strong>-æ¸¬é‡åŠ é€Ÿåº¦å®ƒå¯ä»¥æ„Ÿæ‡‰é‡åŠ› (9.8m/s2) ç­‰éœæ…‹åŠ›æˆ–æŒ¯å‹•æˆ–é‹å‹•ç­‰å‹•æ…‹åŠ›ã€‚Â </p><p>MPU-6050 æ¸¬é‡ Xã€Y å’Œ Z è»¸ä¸Šçš„åŠ é€Ÿåº¦ã€‚ç†æƒ³æƒ…æ³ä¸‹ï¼Œåœ¨éœæ…‹ç‰©é«”ä¸­ï¼ŒZ è»¸ä¸Šçš„åŠ é€Ÿåº¦ç­‰æ–¼é‡åŠ›ï¼Œä¸¦ä¸”åœ¨ X å’Œ Y è»¸ä¸Šæ‡‰ç‚ºé›¶ã€‚<br><strong>åŠ é€Ÿåº¦è¨ˆ</strong>-å¯ä»¥ä½¿ç”¨ä¸‰è§’æ³•è¨ˆç®—æ©«æ»¾è§’å’Œä¿¯ä»°è§’ã€‚ä½†ç„¡æ³•è¨ˆç®—åèˆªã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/9006409806488393795#"><img src="https://1.bp.blogspot.com/-u8-QyUWHTwI/YTrKgEmaSII/AAAAAAAAe5o/3EOJc0UTKPUQY1FE1LjaMLpJXF-WUeGJwCNcBGAsYHQ/w403-h368/MPU6050-Module-Gyroscope-Axis.jpg"></a></p><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/9006409806488393795#"><img src="https://1.bp.blogspot.com/-Jzy9JzxJVRI/YTrMxxtTrRI/AAAAAAAAe54/GM3Hk8tPHz0oT7ezO6IWl0iy3GS2xOh5gCNcBGAsYHQ/w1272-h481/MPU6050.jpg"></a></p><h2 id="é ˆåŒ¯å…¥çš„ç¨‹å¼åº«"><a href="#é ˆåŒ¯å…¥çš„ç¨‹å¼åº«" class="headerlink" title="é ˆåŒ¯å…¥çš„ç¨‹å¼åº«"></a>é ˆåŒ¯å…¥çš„ç¨‹å¼åº«</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/9006409806488393795#">Adafruit_MPU6050</a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/9006409806488393795#">Adafruit_Sensor</a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/9006409806488393795#">Adafruit_SSD1306</a>-å¾ŒåŠæ®µæœƒç”¨åˆ°</p><h2 id="ç¨‹å¼ç¢¼1"><a href="#ç¨‹å¼ç¢¼1" class="headerlink" title="ç¨‹å¼ç¢¼1"></a>ç¨‹å¼ç¢¼1</h2><h3 id="ä½¿ç”¨ç¯„ä¾‹ä¸¦ä¸Šå‚³"><a href="#ä½¿ç”¨ç¯„ä¾‹ä¸¦ä¸Šå‚³" class="headerlink" title="ä½¿ç”¨ç¯„ä¾‹ä¸¦ä¸Šå‚³"></a>ä½¿ç”¨ç¯„ä¾‹ä¸¦ä¸Šå‚³</h3><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;Arduino.h&gt;&#x2F;&#x2F;åŒ…å«Â MPU-6050Â å‚³æ„Ÿå™¨æ‰€éœ€çš„åº«ï¼šAdafruit_MPU6050Â å’ŒÂ Adafruit_Sensorã€‚#include &lt;Adafruit_MPU6050.h&gt;#include &lt;Adafruit_Sensor.h&gt;&#x2F;&#x2F;å‰µå»ºä¸€å€‹åç‚ºÂ mpuÂ çš„Â Adafruit_MPU6050Â å°è±¡ä¾†è™•ç†å‚³æ„Ÿå™¨ã€‚Adafruit_MPU6050Â mpu;voidÂ setup()Â &#123;Â Â Serial.begin(115200);Â Â &#x2F;&#x2F;åˆå§‹åŒ–Â MPU-6050Â å‚³æ„Ÿå™¨ã€‚Â Â ifÂ (!mpu.begin())Â &#123;Â Â Â Â Serial.println(&quot;SensorÂ initÂ failed&quot;);Â Â Â Â whileÂ (1)Â Â Â Â Â Â yield();Â Â &#125;Â Â Serial.println(&quot;FoundÂ aÂ MPU-6050Â sensor&quot;);&#125;voidÂ loop()Â &#123;Â Â &#x2F;&#x2F;ä½¿ç”¨ç•¶å‰è®€æ•¸ç²å–æ–°çš„å‚³æ„Ÿå™¨äº‹ä»¶ã€‚Â Â sensors_event_tÂ a,Â g,Â temp;Â Â mpu.getEvent(&amp;a,Â &amp;g,Â &amp;temp);Â Â &#x2F;&#x2F;åˆ—å‡ºåŠ é€Ÿåº¦å€¼Â Â Serial.print(&quot;AccelerometerÂ &quot;);Â Â Serial.print(&quot;X:Â &quot;);Â Â Serial.print(a.acceleration.x,Â 1);Â Â Serial.print(&quot;Â m&#x2F;s^2,Â &quot;);Â Â Serial.print(&quot;Y:Â &quot;);Â Â Serial.print(a.acceleration.y,Â 1);Â Â Serial.print(&quot;Â m&#x2F;s^2,Â &quot;);Â Â Serial.print(&quot;Z:Â &quot;);Â Â Serial.print(a.acceleration.z,Â 1);Â Â Serial.println(&quot;Â m&#x2F;s^2&quot;);Â Â &#x2F;&#x2F;åˆ—å‡ºé™€èºå„€å€¼Â Â Serial.print(&quot;GyroscopeÂ &quot;);Â Â Serial.print(&quot;X:Â &quot;);Â Â Serial.print(g.gyro.x,Â 1);Â Â Serial.print(&quot;Â rps,Â &quot;);Â Â Serial.print(&quot;Y:Â &quot;);Â Â Serial.print(g.gyro.y,Â 1);Â Â Serial.print(&quot;Â rps,Â &quot;);Â Â Serial.print(&quot;Z:Â &quot;);Â Â Serial.print(g.gyro.z,Â 1);Â Â Serial.println(&quot;Â rps&quot;);Â Â &#x2F;&#x2F;åˆ—å‡ºæº«åº¦å€¼Â Â Serial.print(&quot;TempertureÂ &quot;);Â Â Serial.print(temp.temperature);Â Â Serial.println(&quot;Â degC&quot;);Â Â delay(500);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="çµæœ1"><a href="#çµæœ1" class="headerlink" title="çµæœ1"></a>çµæœ1</h2><p>ç§»å‹•å‚³æ„Ÿå™¨å¯ä»¥å¾—åˆ°ä¸€é€£ä¸²çš„æ•¸å€¼</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/9006409806488393795#"><img src="https://1.bp.blogspot.com/-nwWOKArHvRs/YTrWSN3ubqI/AAAAAAAAe6A/67EVTgLVzyc1wwpcGPY6T3ogQRq99VECgCNcBGAsYHQ/w503-h242/1.jpg"></a></p><hr><h2 id="é‡æ¸¬æ•¸å€¼é¡¯ç¤ºæ–¼OLED"><a href="#é‡æ¸¬æ•¸å€¼é¡¯ç¤ºæ–¼OLED" class="headerlink" title="é‡æ¸¬æ•¸å€¼é¡¯ç¤ºæ–¼OLED"></a>é‡æ¸¬æ•¸å€¼é¡¯ç¤ºæ–¼OLED</h2><h3 id="åŒ¯å…¥Adafruit-SSD1306å‡½å¼åº«å¾Œ"><a href="#åŒ¯å…¥Adafruit-SSD1306å‡½å¼åº«å¾Œ" class="headerlink" title="åŒ¯å…¥Adafruit_SSD1306å‡½å¼åº«å¾Œ"></a>åŒ¯å…¥<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/9006409806488393795#">Adafruit_SSD1306</a>å‡½å¼åº«å¾Œ</h3><h2 id="ç¨‹å¼ç¢¼2"><a href="#ç¨‹å¼ç¢¼2" class="headerlink" title="ç¨‹å¼ç¢¼2"></a>ç¨‹å¼ç¢¼2</h2><h3 id="ä½¿ç”¨ç¯„ä¾‹ä¸¦ä¸Šå‚³-1"><a href="#ä½¿ç”¨ç¯„ä¾‹ä¸¦ä¸Šå‚³-1" class="headerlink" title="ä½¿ç”¨ç¯„ä¾‹ä¸¦ä¸Šå‚³"></a>ä½¿ç”¨ç¯„ä¾‹ä¸¦ä¸Šå‚³</h3><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;Arduino.h&gt;&#x2F;&#x2F;åŒ…å«Â MPU-6050Â å‚³æ„Ÿå™¨æ‰€éœ€çš„åº«ï¼šAdafruit_MPU6050Â å’ŒÂ Adafruit_Sensorã€‚#include &lt;Adafruit_MPU6050.h&gt;#include &lt;Adafruit_Sensor.h&gt;&#x2F;&#x2F;å¼•é€²SSD1306æ‰€é ˆä½¿ç”¨çš„å‡½å¼åº«#include &lt;Wire.h&gt;#include &lt;Adafruit_GFX.h&gt;#include &lt;Adafruit_SSD1306.h&gt;&#x2F;&#x2F;å‰µå»ºä¸€å€‹åç‚ºÂ mpuÂ çš„Â Adafruit_MPU6050Â å°è±¡ä¾†è™•ç†å‚³æ„Ÿå™¨ã€‚Adafruit_MPU6050Â mpu;&#x2F;&#x2F;è¨­å®šOLEDçš„å¯›é«˜#define SCREEN_WIDTH 128Â &#x2F;&#x2F;Â OLEDÂ displayÂ width,Â inÂ pixels#define SCREEN_HEIGHT 64Â &#x2F;&#x2F;Â OLEDÂ displayÂ height,Â inÂ pixels#define OLED_RESET -1Â &#x2F;&#x2F;Â ResetÂ pinÂ #Â (orÂ -1Â ifÂ sharingÂ ArduinoÂ resetÂ pin)#define SCREEN_ADDRESS 0x3CÂ &#x2F;&#x2F;&#x2F;&lt;Â SeeÂ datasheetÂ forÂ Address;Â 0x3DÂ forÂ 128x64,Â 0x3CÂ forÂ 128x32Adafruit_SSD1306Â display(SCREEN_WIDTH,Â SCREEN_HEIGHT,Â &amp;Wire,Â OLED_RESET);&#x2F;&#x2F;Â SSD1306_SWITCHCAPVCCÂ &#x3D;Â generateÂ displayÂ voltageÂ fromÂ 3.3VÂ internally  voidÂ setup()Â &#123;Â Â Serial.begin(115200);Â Â &#x2F;&#x2F;åˆå§‹åŒ–Â MPU-6050Â å‚³æ„Ÿå™¨ã€‚Â Â ifÂ (!mpu.begin())Â &#123;Â Â Â Â Serial.println(&quot;SensorÂ initÂ failed&quot;);Â Â Â Â whileÂ (1)Â Â Â Â Â Â yield();Â Â &#125;Â Â Serial.println(&quot;FoundÂ aÂ MPU-6050Â sensor&quot;);Â Â ifÂ (!display.begin(SSD1306_SWITCHCAPVCC,Â 0x3C))Â &#123;Â &#x2F;&#x2F;Â AddressÂ 0x3CÂ forÂ 128x32Â Â Serial.println(F(&quot;SSD1306Â allocationÂ failed&quot;));Â Â forÂ (;;)Â Â Â Â ;Â &#x2F;&#x2F;Â Don&#39;tÂ proceed,Â loopÂ foreverÂ Â &#125;Â Â display.display();Â Â &#x2F;&#x2F;è¨­ç½®é¡¯ç¤ºçš„å­—é«”å¤§å°å’Œé¡è‰²Â Â delay(500);Â &#x2F;&#x2F;Â PauseÂ forÂ 2Â secondsÂ Â display.setTextSize(1);Â Â display.setTextColor(WHITE);Â Â display.setRotation(0);&#125;voidÂ loop()Â &#123;Â Â &#x2F;&#x2F;ä½¿ç”¨ç•¶å‰è®€æ•¸ç²å–æ–°çš„å‚³æ„Ÿå™¨äº‹ä»¶ã€‚Â Â sensors_event_tÂ a,Â g,Â temp;Â Â mpu.getEvent(&amp;a,Â &amp;g,Â &amp;temp);Â Â &#x2F;&#x2F;åˆå§‹åŒ–å¾Œæ¸…å±Â Â display.clearDisplay();Â Â &#x2F;&#x2F;å°‡é¡¯ç¤ºå…‰æ¨™è¨­ç½®ç‚ºÂ (0,0)Â Â display.setCursor(0,Â 0);  Â Â &#x2F;&#x2F;åˆ—å‡ºåŠ é€Ÿåº¦å€¼Â Â Serial.print(&quot;AccelerometerÂ &quot;);Â Â Serial.print(&quot;X:Â &quot;);Â Â Serial.print(a.acceleration.x,Â 1);Â Â Serial.print(&quot;Â m&#x2F;s^2,Â &quot;);Â Â Serial.print(&quot;Y:Â &quot;);Â Â Serial.print(a.acceleration.y,Â 1);Â Â Serial.print(&quot;Â m&#x2F;s^2,Â &quot;);Â Â Serial.print(&quot;Z:Â &quot;);Â Â Serial.print(a.acceleration.z,Â 1);Â Â Serial.println(&quot;Â m&#x2F;s^2&quot;);  Â Â &#x2F;&#x2F;OLEDä¸Šé¡¯ç¤ºåŠ é€Ÿåº¦Â Â display.println(&quot;AccelerometerÂ -Â m&#x2F;s^2&quot;);Â Â display.print(a.acceleration.x,Â 1);Â Â display.print(&quot;,Â &quot;);Â Â display.print(a.acceleration.y,Â 1);Â Â display.print(&quot;,Â &quot;);Â Â display.print(a.acceleration.z,Â 1);Â Â display.println(&quot;&quot;);  Â Â &#x2F;&#x2F;åˆ—å‡ºé™€èºå„€å€¼Â Â Serial.print(&quot;GyroscopeÂ &quot;);Â Â Serial.print(&quot;X:Â &quot;);Â Â Serial.print(g.gyro.x,Â 1);Â Â Serial.print(&quot;Â rps,Â &quot;);Â Â Serial.print(&quot;Y:Â &quot;);Â Â Serial.print(g.gyro.y,Â 1);Â Â Serial.print(&quot;Â rps,Â &quot;);Â Â Serial.print(&quot;Z:Â &quot;);Â Â Serial.print(g.gyro.z,Â 1);Â Â Serial.println(&quot;Â rps&quot;);  Â Â &#x2F;&#x2F;OLEDä¸Šé¡¯ç¤ºé™€èºå„€Â Â display.println(&quot;GyroscopeÂ -Â rps&quot;);Â Â display.print(g.gyro.x,Â 1);Â Â display.print(&quot;,Â &quot;);Â Â display.print(g.gyro.y,Â 1);Â Â display.print(&quot;,Â &quot;);Â Â display.print(g.gyro.z,Â 1);Â Â display.println(&quot;&quot;);  Â Â display.display();Â Â &#x2F;&#x2F;åˆ—å‡ºæº«åº¦å€¼Â Â Serial.print(&quot;TempertureÂ &quot;);Â Â Serial.print(temp.temperature);Â Â Serial.println(&quot;Â degC&quot;);Â Â delay(500);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="çµæœ2"><a href="#çµæœ2" class="headerlink" title="çµæœ2"></a>çµæœ2</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/9006409806488393795#"><img src="https://lh3.googleusercontent.com/-KQTNRSGg3Ng/YTrulDcPSDI/AAAAAAAAe6I/AkdcixxEVEEvTr9S-74ttZ_6ckj9UiuJwCNcBGAsYHQ/w340-h718/1631252067181599-0.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mpu6050 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ESP-01Sç‡’éŒ„å›ºä»¶</title>
      <link href="/2021/09/09/esp-01s-shao-lu-gu-jian/"/>
      <url>/2021/09/09/esp-01s-shao-lu-gu-jian/</url>
      
        <content type="html"><![CDATA[<h1 id="ESP-01Sç‡’éŒ„å›ºä»¶"><a href="#ESP-01Sç‡’éŒ„å›ºä»¶" class="headerlink" title="ESP-01Sç‡’éŒ„å›ºä»¶"></a>ESP-01Sç‡’éŒ„å›ºä»¶</h1><h6 id="tags-esp8266-esp-01s"><a href="#tags-esp8266-esp-01s" class="headerlink" title="tags: esp8266 esp-01s"></a>tags: <code>esp8266</code> <code>esp-01s</code></h6><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><a href="https://lh3.googleusercontent.com/-F1HF0hnInPA/YHF7-0mNiDI/AAAAAAAAeEM/LdWcFx7K_u42Lxo56UDt4jPQj9hYi7nzQCNcBGAsYHQ/s1600/1618050040927051-0.png"><img src="https://lh3.googleusercontent.com/-F1HF0hnInPA/YHF7-0mNiDI/AAAAAAAAeEM/LdWcFx7K_u42Lxo56UDt4jPQj9hYi7nzQCNcBGAsYHQ/w180-h320/1618050040927051-0.png"></a></p><p><a href="https://lh3.googleusercontent.com/-_wOpaSEbZmQ/YHF79VmmpOI/AAAAAAAAeEE/b7hkFdVGLnARPBM5DmbKhieQ8FWbyXK8gCNcBGAsYHQ/s1600/1618050034996435-2.png"><img src="https://lh3.googleusercontent.com/-_wOpaSEbZmQ/YHF79VmmpOI/AAAAAAAAeEE/b7hkFdVGLnARPBM5DmbKhieQ8FWbyXK8gCNcBGAsYHQ/w173-h307/1618050034996435-2.png"></a><a href="https://lh3.googleusercontent.com/-0CbaIZH0aLo/YHF7-MaCTFI/AAAAAAAAeEI/78bL1qrM1NYdE0gf9jrW19zEYFwtCaw5wCNcBGAsYHQ/s1600/1618050038056312-1.png"><img src="https://lh3.googleusercontent.com/-0CbaIZH0aLo/YHF7-MaCTFI/AAAAAAAAeEI/78bL1qrM1NYdE0gf9jrW19zEYFwtCaw5wCNcBGAsYHQ/w177-h315/1618050038056312-1.png"></a>  </p><p>\</p><h2 id="1-ä¸‹è¼‰æ‰€é ˆè»Ÿä»¶"><a href="#1-ä¸‹è¼‰æ‰€é ˆè»Ÿä»¶" class="headerlink" title="1.ä¸‹è¼‰æ‰€é ˆè»Ÿä»¶"></a>1.ä¸‹è¼‰æ‰€é ˆè»Ÿä»¶</h2><p><a href="https://pan.baidu.com/s/14076XZTtSIxsHQ7HFq2NNA">https://pan.baidu.com/s/14076XZTtSIxsHQ7HFq2NNAÂ </a></p><p>æå–ç ï¼šszw4</p><h2 id="2-ç‡’éŒ„æ­¥é©Ÿ-è¦–é »"><a href="#2-ç‡’éŒ„æ­¥é©Ÿ-è¦–é »" class="headerlink" title="2.ç‡’éŒ„æ­¥é©Ÿ-è¦–é »"></a>2.ç‡’éŒ„æ­¥é©Ÿ-è¦–é »</h2><hr><h2 id="å¯¦é©—è¦–é »"><a href="#å¯¦é©—è¦–é »" class="headerlink" title="[å¯¦é©—è¦–é »] "></a>[å¯¦é©—è¦–é »] </h2><div class="video-container"><iframe src="https://www.youtube.com/embed/NDTrCgOkQDo" frameborder="0" loading="lazy" allowfullscreen></iframe></div>  <h2 id="3-é‡åˆ°ESP8266-DOWNOAD-TOOLæ‰“ä¸é–‹æ€éº¼è¾¦"><a href="#3-é‡åˆ°ESP8266-DOWNOAD-TOOLæ‰“ä¸é–‹æ€éº¼è¾¦" class="headerlink" title="3.é‡åˆ°ESP8266 DOWNOAD TOOLæ‰“ä¸é–‹æ€éº¼è¾¦"></a>3.é‡åˆ°ESP8266 DOWNOAD TOOLæ‰“ä¸é–‹æ€éº¼è¾¦</h2><h4 id="è«‹åˆ°-lt-é–‹å§‹-gt-â€“-lt-è¨­å®š-gt-â€“-lt-æ™‚é–“èˆ‡èªè¨€-gt-â€“-lt-åœ°å€-gt-â€“-lt-ç›¸é—œè¨­å®š-gt-â€“-lt-åœ°å€-gt-â€“-lt-ç³»çµ±ç®¡ç†-gt"><a href="#è«‹åˆ°-lt-é–‹å§‹-gt-â€“-lt-è¨­å®š-gt-â€“-lt-æ™‚é–“èˆ‡èªè¨€-gt-â€“-lt-åœ°å€-gt-â€“-lt-ç›¸é—œè¨­å®š-gt-â€“-lt-åœ°å€-gt-â€“-lt-ç³»çµ±ç®¡ç†-gt" class="headerlink" title="è«‹åˆ°&lt;é–‹å§‹&gt;â€“&lt;è¨­å®š&gt;â€“&lt;æ™‚é–“èˆ‡èªè¨€&gt;â€“&lt;åœ°å€&gt;â€“&lt;ç›¸é—œè¨­å®š&gt;â€“&lt;åœ°å€&gt;â€“&lt;ç³»çµ±ç®¡ç†&gt;"></a>è«‹åˆ°&lt;é–‹å§‹&gt;â€“&lt;è¨­å®š&gt;â€“&lt;æ™‚é–“èˆ‡èªè¨€&gt;â€“&lt;åœ°å€&gt;â€“&lt;ç›¸é—œè¨­å®š&gt;â€“&lt;åœ°å€&gt;â€“&lt;ç³»çµ±ç®¡ç†&gt;</h4><h4 id="â€“-lt-è®Šæ›´ç³»çµ±åœ°å€è¨­å®š-gt-â€“-lt-æ ¼å¼-gt-æ”¹æˆ-lt-ä¸­æ–‡-ç°¡é«”-ä¸­åœ‹-gt-å› ç‚ºé€™è»Ÿä»¶æ˜¯å¤§é™¸è£½"><a href="#â€“-lt-è®Šæ›´ç³»çµ±åœ°å€è¨­å®š-gt-â€“-lt-æ ¼å¼-gt-æ”¹æˆ-lt-ä¸­æ–‡-ç°¡é«”-ä¸­åœ‹-gt-å› ç‚ºé€™è»Ÿä»¶æ˜¯å¤§é™¸è£½" class="headerlink" title="â€“&lt;è®Šæ›´ç³»çµ±åœ°å€è¨­å®š&gt;â€“&lt;æ ¼å¼&gt;,æ”¹æˆ&lt;ä¸­æ–‡(ç°¡é«”,ä¸­åœ‹)&gt;å› ç‚ºé€™è»Ÿä»¶æ˜¯å¤§é™¸è£½"></a><strong>â€“&lt;è®Šæ›´ç³»çµ±åœ°å€è¨­å®š&gt;â€“&lt;æ ¼å¼&gt;,æ”¹æˆ&lt;ä¸­æ–‡(ç°¡é«”,ä¸­åœ‹)&gt;å› ç‚ºé€™è»Ÿä»¶æ˜¯å¤§é™¸è£½</strong></h4><p><strong>ä½œçš„ï¼Œæ‰€ä»¥å¿…é ˆæŠŠåœ°å€æ”¹ç‚ºä¸­åœ‹æ‰èƒ½é–‹å•“ã€‚</strong></p>]]></content>
      
      
      <categories>
          
          <category> esp8266 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ESP-01S </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WEMOS_D1_R2_WIFIæ¸¬è©¦WIFIåŠŸèƒ½</title>
      <link href="/2021/09/09/wemos-d1-r2-wifi-ce-shi-wifi-gong-neng/"/>
      <url>/2021/09/09/wemos-d1-r2-wifi-ce-shi-wifi-gong-neng/</url>
      
        <content type="html"><![CDATA[<h1 id="WEMOS-D1-R2-WIFIæ¸¬è©¦WIFIåŠŸèƒ½"><a href="#WEMOS-D1-R2-WIFIæ¸¬è©¦WIFIåŠŸèƒ½" class="headerlink" title="WEMOS_D1_R2_WIFIæ¸¬è©¦WIFIåŠŸèƒ½"></a>WEMOS_D1_R2_WIFIæ¸¬è©¦WIFIåŠŸèƒ½</h1><p><strong>WeMos D1 WiFi Arduino UNO é–‹ç™¼æ¿ESP8266 ç›´æ¥ç”¨Arduino IDE</strong></p><p><strong><a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/2012246015755250549#"><img src="https://lh3.googleusercontent.com/-RdB-26UI6H8/YJkQTnqUh6I/AAAAAAAAeIA/2rAjRsJoWKoPyLTOn09Ql2xhZIJJYQsCgCNcBGAsYHQ/s1600/1620643913270658-0.png"></a></strong></p><ol><li> <strong>WeMos D1 åŸºæ–¼ESP-8266EX</strong></li><li> <strong>Arduinoå…¼å®¹ï¼Œä½¿ç”¨Arduino IDEä¾†ç·¨ç¨‹</strong></li><li> <strong>11 x I/O å¼•è…³</strong></li><li> <strong>1 x ADC å¼•è…³ï¼ˆè¼¸å…¥ç¯„åœ0-3.3Vï¼‰</strong></li><li> <strong>æ”¯æŒOTAç„¡ç·šä¸Šå‚³</strong></li><li>**æ¿è¼‰5V 1Aé–‹é—œé›»æºï¼ˆæœ€é«˜è¼¸å…¥é›»å£“24V)<br> **</li></ol><p>ä¸Šé¢é‚£äº›æ˜¯é€™æ¬¾æ¿å­çš„ä¸»è¦ä»‹ç´¹ï¼Œå‰é™£å­åœ¨æ·˜%è²·äº†å…©å¡Šï¼Œå°±æ”¾è‘—æ²’å‹•ï¼Œ</p><p>ä»Šæ—©å¿ƒè¡€ä¾†æ½®ç¿»äº†ç¿»ç™¾å¯¶è¢‹ï¼Œæ±ºå®šæ‹¿ä¾†æŠŠç©ï¼Œå…¶å¯¦æœ‰é»æä¸æ‡‚ï¼Œå®ƒåˆ°åº•æ˜¯</p><p>esp8266é‚„æ˜¯Arduinoï¼Œçœ‹èµ·ä¾†å°±æ˜¯åƒæŠŠesp01é‘²åœ¨arduino unoçš„</p><p>æ¿å­ä¸Šå•Šâ€¦â€¦!!!!!ä¸ç®¡äº†ï¼Œåæ­£æ‹¿åˆ°å°±ç”¨å§ï¼</p><p><strong>ä¸€äº›ä»‹ç´¹å’Œè³£å ´ä¸Šéƒ½æœ‰ä¸‹é¢é€™å€‹æç¤º</strong></p><h2 id="WeMos-D1-å®‰è£æ•™å­¸"><a href="#WeMos-D1-å®‰è£æ•™å­¸" class="headerlink" title="WeMos D1 å®‰è£æ•™å­¸"></a>WeMos D1 å®‰è£æ•™å­¸</h2><p>åŸå» æŠ€è¡“æ–‡ä»¶èªªæ˜Â <a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/2012246015755250549#">https://www.wemos.cc/product/d1.html</a></p><p>Arduino å®‰è£èªªæ˜Â <a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/2012246015755250549#">https://www.wemos.cc/tutorial/get-started-arduino.html</a></p><p>NodeMCU å®‰è£èªªæ˜ Â <a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/2012246015755250549#">https://www.wemos.cc/tutorial/get-started-nodemcu.html</a></p><p>æ•™å­¸Â <a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/2012246015755250549#">http://www.instructables.com/id/Programming-the-WeMos-Using-Arduino-SoftwareIDE/</a></p><p>ç›¸é—œå…¥é–€ç¨‹å¼é–‹ç™¼èˆ‡èªªæ˜<a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/2012246015755250549#">Â https://github.com/wemos</a></p><p><strong>å®‰è£ç¡¬ä»¶åŒ…å¾Œï¼Œç›´æ¥ç”¨Arduino IDE é–‹ç™¼ï¼Œè·ŸArduino UNO ä¸€æ¨£æ“ä½œ****æœ€ä¾¿å®œçš„WiFi Arduino æ¿.</strong></p><hr><h2 id="å¦‚ä½•å®‰è£ç¨‹å¼åº«"><a href="#å¦‚ä½•å®‰è£ç¨‹å¼åº«" class="headerlink" title="å¦‚ä½•å®‰è£ç¨‹å¼åº«"></a>å¦‚ä½•å®‰è£ç¨‹å¼åº«</h2><h3 id="æ­¥é©Ÿ1"><a href="#æ­¥é©Ÿ1" class="headerlink" title="æ­¥é©Ÿ1:"></a>æ­¥é©Ÿ1:</h3><p><strong>åå¥½è¨­å®š,åœ¨ä¸‹æ–¹é¡å¤–çš„é–‹ç™¼æ¿ç®¡ç†å“¡ç¶²å€:è¼¸å…¥å¦‚ä¸‹ç¶²å€</strong></p><p><strong><a href="http://arduino.esp8266.com/stable/package/_esp8266com/_index.json">http://arduino.esp8266.com/stable/package\_esp8266com\_index.json</a></strong></p><p>**</p><p><a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/2012246015755250549#"><img src="https://1.bp.blogspot.com/-E96XTfrC1-w/YJopm1o80LI/AAAAAAAAeIM/kJ76QffnQ9YXwOOIPDKjsrbVEuPspJdnQCNcBGAsYHQ/w701-h394/1.jpg"></a></p><h3 id="æ­¥é©Ÿ2"><a href="#æ­¥é©Ÿ2" class="headerlink" title="æ­¥é©Ÿ2:"></a>æ­¥é©Ÿ2:</h3><p>åˆ°IDEçš„_å·¥å…·&gt;&gt;é–‹ç™¼æ¿&gt;&gt;é–‹ç™¼æ¿ç®¡ç†å“¡ æœå°‹è¼¸å…¥â€esp8266â€ä¸¦é¸æ“‡å®‰è£</p><p><a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/2012246015755250549#"><img src="https://1.bp.blogspot.com/-0AEyGgEnygE/YJoqh-kLB7I/AAAAAAAAeIU/hoaSoUkNMDYCmkmaMJBe8pLhY-7qNxXYgCNcBGAsYHQ/w650-h366/2.jpg"></a></p><p>_</p><h3 id="æ­¥é©Ÿ4"><a href="#æ­¥é©Ÿ4" class="headerlink" title="æ­¥é©Ÿ4:"></a>æ­¥é©Ÿ4:</h3><p>æŒ‰ç…§ä¸‹åœ–é¸æ“‡é–‹ç™¼æ¿é¡å‹Â å·¥å…·&gt;&gt;é–‹ç™¼æ¿&gt;&gt;é¸ WeMos D1 R2</p><p>**</p><p><a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/2012246015755250549#"><img src="https://1.bp.blogspot.com/-6GQ9ywhfmEc/YJorxTeMzsI/AAAAAAAAeIc/rVj4r-ryng4YoF-fas9sis4BtZtvb3yVwCNcBGAsYHQ/w723-h407/3.jpg"></a></p><p>_</p><hr><p>_</p><h3 id="æ­¥é©Ÿ5"><a href="#æ­¥é©Ÿ5" class="headerlink" title="æ­¥é©Ÿ5:"></a>æ­¥é©Ÿ5:</h3><p><strong>é¸æ“‡â€<em>WIFIScan</em>â€œç¯„ä¾‹ï¼Œå¯æœå°‹é™„è¿‘å¯ç”¨çš„WIFIï¼Œä¸¦é¡¯ç¤ºæ–¼â€<em>åºåˆ—åŸ ç›£æ§è¦–çª—</em>â€œ</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/2883052724878840475/2012246015755250549#"><img src="https://1.bp.blogspot.com/-xLmmThmFzxM/YJotsue9qnI/AAAAAAAAeIk/dXGmBeLU7Aw3gCNaQ6cDnFC4576QwSikACNcBGAsYHQ/w668-h376/4.jpg"></a></p><hr><p><strong>ä»¥ä¸‹æ˜¯æœå°‹é™„è¿‘å¯ç”¨WIFIçš„ç¯„ä¾‹</strong></p><div class="video-container"><iframe src="https://www.youtube.com/embed/T76myCMsjR0" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp8266 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wifi </tag>
            
            <tag> WEMOS_D1_R2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Sharpç´…å¤–ç·šæ¸¬è·æ¨¡çµ„-GP2Y0A02YK0F</title>
      <link href="/2021/09/08/sharp-hong-wai-xian-ce-ju-mo-zu-gp2y0a02yk0f/"/>
      <url>/2021/09/08/sharp-hong-wai-xian-ce-ju-mo-zu-gp2y0a02yk0f/</url>
      
        <content type="html"><![CDATA[<h1 id="Sharpç´…å¤–ç·šæ¸¬è·æ¨¡çµ„-GP2Y0A02YK0F"><a href="#Sharpç´…å¤–ç·šæ¸¬è·æ¨¡çµ„-GP2Y0A02YK0F" class="headerlink" title="Sharpç´…å¤–ç·šæ¸¬è·æ¨¡çµ„-GP2Y0A02YK0F"></a>Sharpç´…å¤–ç·šæ¸¬è·æ¨¡çµ„-GP2Y0A02YK0F</h1><hr><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/4207629859466699123#"><img src="https://1.bp.blogspot.com/-E27U2c45YTk/YF_zrDzLiBI/AAAAAAAAd9w/B35SPI2O59cx5HFVCSGC39ARIyicZ5LXQCNcBGAsYHQ/s320/infrared-proximity-sensor-long-range-sharp-gp2y0a02yk0f.jpg"></a></p><hr><p>ç´…å¤–ç·šæ¸¬è·æ¨¡çµ„ä¸€èˆ¬æœ‰é•·ä¸­çŸ­è·ï¼Œé€™æ˜¯Sharpå…¬å¸å‡ºçš„æ¨¡çµ„ï¼ŒåŒ…æ‹¬è¼ƒçŸ­è·é›¢ï¼ˆ2 â€“ 15å˜ç±³ï¼‰GP2Y0A51SK0Fï¼Œä¸­è·ï¼ˆ10 â€“ 80å˜ç±³ï¼‰GP2Y0A21YK0Få’Œé è·é›¢ï¼ˆ20 â€“ 150å˜ç±³ï¼‰GP2Y0A02YK0Fã€‚æˆ‘å€‘é‚„æ­è¼‰äº†æ–°æ¬¾å¤æ™®GP2Y0A60SZæ¨¡æ“¬è·é›¢å‚³æ„Ÿå™¨ï¼ˆ10 â€“ 150å˜ç±³ï¼‰ï¼Œæä¾›æœ€ä½çš„æœ€å°æ¢æ¸¬è·é›¢ï¼Œæœ€å¤§æ¢æ¸¬è·é›¢ï¼Œ3 Vå¯¬è¼¸å‡ºé›»å£“å·®ï¼Œé«˜60 Hzæ¡æ¨£é€Ÿç‡ï¼Œä½è‡³2.7 Vçš„æ“ä½œé›»å£“å’Œå¯é¸çš„ä½¿èƒ½æ§åˆ¶ï¼Œå…¨éƒ¨æ¡ç”¨æ›´å°çš„å°è£ï¼Œå¯ä»¥æ‹¿ä¾†åšç‚ºå»æ‰€è‡ªå‹•æ²–æ‰‹æ„Ÿæ‡‰ã€‚</p><hr><h2 id="æ¥ç·šæ–¹å¼"><a href="#æ¥ç·šæ–¹å¼" class="headerlink" title="æ¥ç·šæ–¹å¼"></a>æ¥ç·šæ–¹å¼</h2><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/4207629859466699123#"><img src="https://1.bp.blogspot.com/-Kte32mfT6jA/YF_1Sj0X1XI/AAAAAAAAd94/JyjyLXes3iYBpmgU_n79LQmMCPmZySNPQCNcBGAsYHQ/w463-h287/21402224929894_84.jpg"></a></p><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><p>ä¸‹è¼‰å‡½å¼åº«</p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/4207629859466699123#">https://gist.github.com/reefwing/6bb74409774d5152f904</a>  </p><p>ä¾ç…§æ¨¡çµ„å‹è™Ÿåœ¨ä¸‹æ–¹ç¨‹å¼è£¡çš„modelå¯«å…¥è¦å®šçš„å€¼,å¦å‰‡åŸ·è¡Œæ¸¬å‡ºçš„è·é›¢æœƒä¸æº–</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#includeÂ &lt;SharpIR.h&gt;#includeÂ &lt;Wire.h&gt;#defineÂ IRÂ A2Â &#x2F;&#x2F;Â defineÂ signalÂ pin#defineÂ model 20150Â &#x2F;&#x2F;Â usedÂ 1080Â becauseÂ modelÂ GP2Y0A21YK0FÂ isÂ used&#x2F;&#x2F;Â SharpÂ IRÂ codeÂ forÂ Robojax.com&#x2F;&#x2F;Â ir:Â theÂ pinÂ whereÂ yourÂ sensorÂ isÂ attached&#x2F;&#x2F;Â model:Â anÂ intÂ thatÂ determinesÂ yourÂ sensor:Â Â 1080Â forÂ GP2Y0A21Y&#x2F;&#x2F;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 20150Â forÂ GP2Y0A02Y&#x2F;&#x2F;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 430Â forÂ GP2Y0A41SKÂ Â Â &#x2F;*2Â toÂ 15Â cmÂ GP2Y0A51SK0FÂ Â useÂ 10804Â toÂ 30Â cmÂ GP2Y0A41SK0FÂ &#x2F;Â GP2Y0AF30Â seriesÂ Â useÂ 43010Â toÂ 80Â cmÂ GP2Y0A21YK0FÂ Â useÂ 108010Â toÂ 150Â cmÂ GP2Y0A60SZLFÂ useÂ 1015020Â toÂ 150Â cmÂ GP2Y0A02YK0FÂ useÂ 20150100Â toÂ 550Â cmÂ GP2Y0A710K0FÂ Â useÂ 100550Â *&#x2F; SharpIRÂ SharpIR(IR,Â model);voidÂ setup()Â &#123;Â Serial.begin(9600);Â Serial.println(&quot;RobojaxÂ SharpÂ IRÂ Â &quot;);&#125;voidÂ loop()Â &#123;Â Â delay(500);Â Â Â Â Â intÂ dis&#x3D;SharpIR.distance();Â Â &#x2F;&#x2F;Â thisÂ returnsÂ theÂ distanceÂ toÂ theÂ objectÂ you&#39;reÂ measuringÂ Â Serial.print(&quot;MeanÂ distance:Â &quot;);Â Â &#x2F;&#x2F;Â returnsÂ itÂ toÂ theÂ serialÂ monitorÂ Â Serial.println(dis);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/zyiol8Ugh8M" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> arduino </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sharpç´…å¤–ç·šæ¸¬è·æ¨¡çµ„ </tag>
            
            <tag> GP2Y0A02YK0F </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç”·å»å°ä¾¿æ± è‡ªå‹•æ„Ÿæ‡‰æ²–æ‰‹è¨­å‚™</title>
      <link href="/2021/09/08/nan-ce-xiao-bian-chi-zi-dong-gan-ying-chong-shou-she-bei/"/>
      <url>/2021/09/08/nan-ce-xiao-bian-chi-zi-dong-gan-ying-chong-shou-she-bei/</url>
      
        <content type="html"><![CDATA[<h1 id="ç”·å»å°ä¾¿æ± è‡ªå‹•æ„Ÿæ‡‰æ²–æ‰‹è¨­å‚™"><a href="#ç”·å»å°ä¾¿æ± è‡ªå‹•æ„Ÿæ‡‰æ²–æ‰‹è¨­å‚™" class="headerlink" title="ç”·å»å°ä¾¿æ± è‡ªå‹•æ„Ÿæ‡‰æ²–æ‰‹è¨­å‚™"></a>ç”·å»å°ä¾¿æ± è‡ªå‹•æ„Ÿæ‡‰æ²–æ‰‹è¨­å‚™</h1><p>ç¬¬ä¸€æ¬¡æ‡‰å¥³å‹æ‰€æ‰˜ï¼Œè¦åœ¨å…¬å¸çš„ç”·å»å°ä¾¿æ± å®‰è£ä¸€å€‹è‡ªå‹•æ„Ÿæ‡‰æ²–æ°´è¨­å‚™ä¸€èˆ¬æˆ‘å€‘åœ¨å¤–çš„å…¬å»ï¼Œå¾ˆå°‘äººæœƒåœ¨å°ä¾¿å¾Œä¸»å‹•å»æ²–æ°´ï¼Œå°¤å…¶æ˜¯ç”¨è€ƒå…‹ã€‚<br>åŸæœ¬æˆ‘çš„è€ƒé‡æ˜¯è²·ä¸€å€‹æ°´é–¥ç”¨arduino nanoæ§åˆ¶ï¼Œä½†ä»”ç´°è©•ä¼°å¾Œï¼Œç™¼ç¾æ°´ç®¡æ²’æœ‰åˆé©çš„æ°´é–¥å¯è£ï¼Œæƒ³äº†å¹¾å¤©å¾Œï¼Œæœ‰å€‹éˆæ„Ÿå‘Šè¨´æˆ‘ï¼Œå¯ä»¥ç”¨ä¼ºæœé¦¬é”åšå€‹é€£æ¡¿ä¾†æ¨æ‹‰è€ƒå…‹ï¼Œæ–¼æ˜¯æˆ‘å°±å¾ç¨‹å¼é–‹å§‹è‘—æ‰‹â€¦â€¦</p><h2 id="å…ˆä¸Šå®‰è£å¥½æ¸¬è©¦çš„è¦–é »ç§ç§"><a href="#å…ˆä¸Šå®‰è£å¥½æ¸¬è©¦çš„è¦–é »ç§ç§" class="headerlink" title="å…ˆä¸Šå®‰è£å¥½æ¸¬è©¦çš„è¦–é »ç§ç§"></a>å…ˆä¸Šå®‰è£å¥½æ¸¬è©¦çš„è¦–é »ç§ç§</h2><div class="video-container"><iframe src="https://www.youtube.com/embed/3aZeTEXXZ4k" frameborder="0" loading="lazy" allowfullscreen></iframe></div><h2 id="ææ–™"><a href="#ææ–™" class="headerlink" title="ææ–™"></a>ææ–™</h2><p><strong>MG996R x1</strong></p><p><strong>Arduino nano x1</strong></p><p><strong>Sharp ç´…å¤–ç·šæ¸¬è·æ¨¡çµ„ (GP2Y0A02YK0F) x1</strong></p><p><strong>pca9685 x1</strong></p><p><strong>3Dåˆ—å°å¤–æ®¼</strong></p><p><strong>ç›’-<a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2013353077496703013#">https://www.tinkercad.com/things/1khLTXx7P3h-irbox</a></strong></p><p><strong>è“‹-<a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2013353077496703013#">https://www.tinkercad.com/things/keXzxpyY8vK-ircover</a></strong></p><p>** ä¼ºæœé¦¬é”ç›’-<a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2013353077496703013#">https://www.tinkercad.com/things/7wSmGhsgi9x-servobracket-2</a>**</p><p><strong>æœé‚¦ç·š è‹¥å¹²</strong></p><p><strong>æ¥ç·š</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2013353077496703013#"><img src="https://lh3.googleusercontent.com/-y_FJdEKKTrI/YGRIihgeTwI/AAAAAAAAd-c/FrxbPjv1ReYcncDWJQRq2M0kgVxyKq-qgCNcBGAsYHQ/s1600/1617184891602974-0.png"></a></p><p>**</p><hr><h2 id="æ¸¬è©¦ç´…å¤–ç·šæ¸¬è·æ¨¡çµ„"><a href="#æ¸¬è©¦ç´…å¤–ç·šæ¸¬è·æ¨¡çµ„" class="headerlink" title="æ¸¬è©¦ç´…å¤–ç·šæ¸¬è·æ¨¡çµ„"></a>æ¸¬è©¦ç´…å¤–ç·šæ¸¬è·æ¨¡çµ„</h2><p>é¦–å…ˆå…ˆæ¸¬è©¦ç´…å¤–ç·šæ¨¡çµ„çš„è·é›¢ï¼Œé‡æ¸¬ç¾å ´ç’°å¢ƒè¦æ„Ÿæ‡‰çš„ç¯„åœ</p><p>å¥—ç”¨åœ¨ç¨‹å¼è£¡ã€‚</p><p>ç´…å¤–ç·šæ¨¡çµ„å¯åƒè€ƒæ­¤ç¯‡â€”<a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2013353077496703013#">Sharpç´…å¤–ç·šæ¨¡çµ„æ¸¬è©¦</a></p><p>æˆ–æ˜¯å¯åƒè€ƒé€™ç¯‡<a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2013353077496703013#">https://robojax.com/learn/arduino/?vid=robojax-sharp_IR</a></p><hr><h2 id="æ¢ä»¶åƒæ•¸è¨­å¥½ä¹‹å¾ŒåŠ å…¥ä¼ºæœé¦¬é”çš„å‹•ä½œè§’åº¦"><a href="#æ¢ä»¶åƒæ•¸è¨­å¥½ä¹‹å¾ŒåŠ å…¥ä¼ºæœé¦¬é”çš„å‹•ä½œè§’åº¦" class="headerlink" title="æ¢ä»¶åƒæ•¸è¨­å¥½ä¹‹å¾ŒåŠ å…¥ä¼ºæœé¦¬é”çš„å‹•ä½œè§’åº¦"></a>æ¢ä»¶åƒæ•¸è¨­å¥½ä¹‹å¾ŒåŠ å…¥ä¼ºæœé¦¬é”çš„å‹•ä½œè§’åº¦</h2><p>é€™è£¡å¿…é ˆé…åˆè¦è£çš„ç’°å¢ƒï¼Œä¿®æ­£ä¼ºæœé¦¬é”çš„é‹è½‰è§’åº¦</p><p>é¦–å…ˆè¦è¼‰å…¥pca9685èˆµæ§æ¿çš„åº«,é…åˆç´…å¤–æ¸¬è·æ¨¡çµ„çš„å‹•</p><p>ä½œå€é–“å€¼,ä½¿å…¶è½‰å‘è¨­å®šçš„è§’åº¦ã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2013353077496703013#"><img src="https://lh3.googleusercontent.com/-OlsGgcbPzvo/YGQmbimGBiI/AAAAAAAAd-Q/Sql6TpYatTEuwQgN9_o17tuWnuJVm5X7gCNcBGAsYHQ/s1600/1617176145655067-0.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2013353077496703013#"><img src="https://lh3.googleusercontent.com/-AM3GkPjLb4I/YGQmUbuW_LI/AAAAAAAAd-M/wtm4Us8lnWsnJlOVikMK-3cs7ccslLluQCNcBGAsYHQ/s1600/1617176089549530-1.png"></a></p><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#includeÂ &lt;SharpIR.h&gt;#includeÂ &lt;Wire.h&gt;#includeÂ &lt;Adafruit_PWMServoDriver.h&gt;  Adafruit_PWMServoDriverÂ pwmÂ &#x3D;Â Adafruit_PWMServoDriver();constÂ intÂ servomin&#x3D;150;constÂ intÂ servomax&#x3D;600;intÂ sensor;unsignedÂ longÂ time_old&#x3D;0;#defineÂ IRÂ A2Â &#x2F;&#x2F;Â defineÂ signalÂ pin#defineÂ model 20150Â &#x2F;&#x2F;Â usedÂ 1080Â becauseÂ modelÂ GP2Y0A21YK0FÂ isÂ used&#x2F;&#x2F;Â SharpÂ IRÂ codeÂ forÂ Robojax.com&#x2F;&#x2F;Â ir:Â theÂ pinÂ whereÂ yourÂ sensorÂ isÂ attached&#x2F;&#x2F;Â model:Â anÂ intÂ thatÂ determinesÂ yourÂ sensor:Â Â 1080Â forÂ GP2Y0A21Y&#x2F;&#x2F;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 20150Â forÂ GP2Y0A02Y&#x2F;&#x2F;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 430Â forÂ GP2Y0A41SKÂ Â Â &#x2F;*2Â toÂ 15Â cmÂ GP2Y0A51SK0FÂ Â useÂ 10804Â toÂ 30Â cmÂ GP2Y0A41SK0FÂ &#x2F;Â GP2Y0AF30Â seriesÂ Â useÂ 43010Â toÂ 80Â cmÂ GP2Y0A21YK0FÂ Â useÂ 108010Â toÂ 150Â cmÂ GP2Y0A60SZLFÂ useÂ 1015020Â toÂ 150Â cmÂ GP2Y0A02YK0FÂ useÂ 20150100Â toÂ 550Â cmÂ GP2Y0A710K0FÂ Â useÂ 100550Â *&#x2F;SharpIRÂ SharpIR(IR,Â model);voidÂ setup()Â &#123;Â Serial.begin(9600);Â Serial.println(&quot;RobojaxÂ SharpÂ IRÂ Â &quot;);Â pwm.begin();Â pwm.setOscillatorFrequency(27000000);Â pwm.setPWMFreq(60);Â pwm.setPWM(14,Â 0,Â 590);Â delay(10);&#125;voidÂ loop()Â &#123;Â Â delay(500);Â Â Â Â Â intÂ dis&#x3D;SharpIR.distance();Â Â &#x2F;&#x2F;Â thisÂ returnsÂ theÂ distanceÂ toÂ theÂ objectÂ you&#39;reÂ measuringÂ Â Serial.print(&quot;MeanÂ distance:Â &quot;);Â Â &#x2F;&#x2F;Â returnsÂ itÂ toÂ theÂ serialÂ monitorÂ Â Serial.println(dis);Â Â ifÂ (dis&lt;20)&#123;Â Â Â Â Serial.println(&quot;closeÂ sw&quot;);Â Â &#125;elseÂ if(dis&gt;&#x3D;20Â &amp;&amp;Â dis&lt;&#x3D;70)&#123;Â Â Â Â unsignedÂ longÂ time_now&#x3D;millis();Â Â Â Â ifÂ (time_now-time_old&gt;600)&#123;Â Â Â Â Â Â Serial.println(&quot;openÂ water&quot;);Â Â Â Â Â Â pwm.setPWM(14,Â 0,Â 300);Â Â Â Â Â Â delay(6000);Â Â Â Â Â Â pwm.setPWM(14,Â 0,Â 590);Â Â Â Â Â Â time_now&#x3D;time_old;Â Â Â Â &#125;Â Â &#125;Â Â &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> GP2Y0A02YK0F </tag>
            
            <tag> Sharpç´…å¤–ç·šæ¸¬è· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Blynkæ§åˆ¶adafrit_pixelsç‡ˆæ¢-ESP32</title>
      <link href="/2021/09/05/blynk-kong-zhi-adafrit-pixels-deng-tiao-esp32/"/>
      <url>/2021/09/05/blynk-kong-zhi-adafrit-pixels-deng-tiao-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="Blynkæ§åˆ¶adafrit-pixelsç‡ˆæ¢-ESP32"><a href="#Blynkæ§åˆ¶adafrit-pixelsç‡ˆæ¢-ESP32" class="headerlink" title="Blynkæ§åˆ¶adafrit_pixelsç‡ˆæ¢-ESP32"></a>Blynkæ§åˆ¶adafrit_pixelsç‡ˆæ¢-ESP32</h1><h6 id="tags-esp32-ws2812-adafruit-neopixels"><a href="#tags-esp32-ws2812-adafruit-neopixels" class="headerlink" title="tags: esp32 ws2812 adafruit_neopixels"></a>tags: <code>esp32</code> <code>ws2812</code> <code>adafruit_neopixels</code></h6><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5650765682937321909#"><img src="https://1.bp.blogspot.com/-dibi0v6AESo/YTSc8SBnN0I/AAAAAAAAe5E/z0aDdHCfKO4XEB69iZ9KKHQaws0sU_RtgCNcBGAsYHQ/w351-h468/20210905_153803.jpg"></a></p><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a><em>æ¥ç·š</em></h2><p><em>å°‡ RGB LED ç‡ˆæ¢é€£æ¥åˆ° ESP32 æˆ– ESP8266 éå¸¸ç°¡å–®ã€‚æ‚¨éœ€è¦å°‡ 5V æ–½åŠ åˆ°Â VCCÂ å¼•è…³ï¼ŒGNDÂ åˆ°Â GNDï¼Œä¸¦å°‡Â GPIO 5é€£æ¥åˆ°Â INï¼ˆæ•¸æ“šï¼‰å¼•è…³ã€‚æˆ‘å€‘å°‡æ•¸æ“šå¼•è…³é€£æ¥åˆ°Â GPIO 5ã€‚</em></p><p>_</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5650765682937321909#"><img src="https://1.bp.blogspot.com/-fUXQhZg0HFw/YRXRFihwvBI/AAAAAAAAey0/RH-qjp4k5YIGzTRQ_XXrT2rthb8xEnkLgCNcBGAsYHQ/w418-h314/image.png"></a></p><h2 id="Blynk-Appçš„è¨­ç½®"><a href="#Blynk-Appçš„è¨­ç½®" class="headerlink" title="Blynk Appçš„è¨­ç½®"></a><em>Blynk Appçš„è¨­ç½®</em></h2><p>Blynk æ˜¯ä¸€å€‹å¯ä»¥åœ¨ Android å’Œ IOS è¨­å‚™ä¸Šé‹è¡Œçš„æ‡‰ç”¨ç¨‹åºï¼Œä»¥ä½¿ç”¨æˆ‘å€‘çš„æ™ºèƒ½æ‰‹æ©Ÿæ§åˆ¶ä»»ä½•ç‰©è¯ç¶²è¨­å‚™ã€‚æˆ‘å€‘å¯ä»¥å‰µå»ºè‡ªå·±çš„åœ–å½¢ç”¨æˆ¶ç•Œé¢ä¾†è¨­è¨ˆ IoT æ‡‰ç”¨ç¨‹åº GUIã€‚æˆ‘å€‘ä¹‹å‰å°‡ Blynk èˆ‡ ESP32 ä¸€èµ·ä½¿ç”¨ï¼Œä¸¦ä½¿ç”¨ Blynk æ§‹å»ºäº†è¨±å¤šå…¶ä»–åŸºæ–¼ç‰©è¯ç¶²çš„é …ç›®ã€‚  </p><p>åœ¨è¨­ç½®ä¹‹å‰ï¼Œå¾ Google Play å•†åº—ä¸‹è¼‰ Blynk æ‡‰ç”¨ç¨‹åºï¼ˆIOS ç”¨æˆ¶å¯ä»¥å¾ Apple Store ä¸‹è¼‰ï¼‰ä¸¦ä½¿ç”¨æ‚¨çš„é›»å­éƒµä»¶ ID å’Œå¯†ç¢¼è¨»å†Šã€‚</p><h3 id="å‰µå»ºä¸€å€‹æ–°é …ç›®ï¼š"><a href="#å‰µå»ºä¸€å€‹æ–°é …ç›®ï¼š" class="headerlink" title="å‰µå»ºä¸€å€‹æ–°é …ç›®ï¼š"></a>å‰µå»ºä¸€å€‹æ–°é …ç›®ï¼š</h3><p>å®‰è£æˆåŠŸå¾Œï¼Œæ‰“é–‹æ‡‰ç”¨ç¨‹åºä¸¦å–®æ“Šâ€œæ–°å»ºé …ç›®â€ã€‚ç„¶å¾Œå®ƒæœƒå½ˆå‡ºä¸€å€‹æ–°çš„å±å¹•ï¼Œæˆ‘å€‘éœ€è¦åœ¨å…¶ä¸­è¨­ç½®é …ç›®åç¨±ã€é›»è·¯æ¿å’Œé€£æ¥é¡å‹ç­‰åƒæ•¸ã€‚å°æ–¼æ­¤é …ç›®ï¼Œé¸æ“‡è¨­å‚™ç‚ºâ€œESP32 Dev Boardâ€ï¼Œé€£æ¥é¡å‹ç‚º Wi-Fiï¼Œç„¶å¾Œå–®æ“Šâ€œå‰µå»ºâ€ã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5650765682937321909#"><img src="https://iotdesignpro.com/sites/default/files/inline-images/Blynk-Application-Setup.png"></a></p><p>_æˆåŠŸå‰µå»ºé …ç›®å¾Œï¼Œæˆ‘å€‘å°‡åœ¨è¨»å†Šéƒµä»¶ä¸­æ”¶åˆ°ä¸€å€‹ Authenticate IDã€‚ä¿å­˜èº«ä»½é©—è­‰ ID ä»¥ä¾›å°‡ä¾†åƒè€ƒã€‚</p><h3 id="å‰µå»ºåœ–å½¢ç”¨æˆ¶ç•Œé¢ï¼š"><a href="#å‰µå»ºåœ–å½¢ç”¨æˆ¶ç•Œé¢ï¼š" class="headerlink" title="å‰µå»ºåœ–å½¢ç”¨æˆ¶ç•Œé¢ï¼š"></a>å‰µå»ºåœ–å½¢ç”¨æˆ¶ç•Œé¢ï¼š</h3><p>åœ¨ Blynk ä¸­æ‰“é–‹é …ç›®ï¼Œå–®æ“Šâ€œ+â€è™Ÿï¼Œå®ƒå°‡é¡¯ç¤ºè¨±å¤šå°éƒ¨ä»¶ã€‚åœ¨æˆ‘å€‘çš„ä¾‹å­ä¸­ï¼Œæˆ‘å€‘éœ€è¦ä¸€å€‹è¢«åˆ—ç‚ºâ€œzeRGBaâ€çš„ RGB é¡è‰²é¸æ“‡å™¨å’Œä¸€å€‹ç”¨æ–¼æ”¹è®Š LED ç‡ˆæ¢æ“ä½œæ¨¡å¼çš„æŒ‰éˆ•ã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5650765682937321909#"><img src="https://iotdesignpro.com/sites/default/files/inline-images/Creating-GUI_0.png"></a></p><h3 id="åœ¨å°éƒ¨ä»¶ä¸­è¨­ç½®åƒæ•¸ï¼š"><a href="#åœ¨å°éƒ¨ä»¶ä¸­è¨­ç½®åƒæ•¸ï¼š" class="headerlink" title="åœ¨å°éƒ¨ä»¶ä¸­è¨­ç½®åƒæ•¸ï¼š"></a>åœ¨å°éƒ¨ä»¶ä¸­è¨­ç½®åƒæ•¸ï¼š</h3><p>å°‡å°éƒ¨ä»¶æ‹–å‹•åˆ°é …ç›®å¾Œï¼Œç¾åœ¨è¨­ç½®å…¶åƒæ•¸ï¼Œç”¨æ–¼å°‡æ§åˆ¶å€¼çš„é¡è‰²å’Œæ¨¡å¼ç™¼é€åˆ° ESP32ã€‚</p><p>é»æ“Š ZeRGBaï¼Œæˆ‘å€‘å°‡çœ‹åˆ°ä¸€å€‹åç‚º ZeRGBa è¨­ç½®çš„å±å¹•ã€‚ç„¶å¾Œå°‡è¼¸å‡ºé¸é …è¨­ç½®ç‚ºâ€œè™›æ“¬å¼•è…³â€ä¸¦å°‡å¼•è…³è¨­ç½®ç‚ºâ€œV2â€ï¼Œå¦‚ä¸‹åœ–æ‰€ç¤ºã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5650765682937321909#"><img src="https://1.bp.blogspot.com/-0LzJEeATXZg/YTSj1PJpeLI/AAAAAAAAe5M/TkbTfhzLzY8ylJOpJOqSsp6HBYZtQ0PSgCNcBGAsYHQ/w330-h530/Blynk-Application-Setup-for-Neopixel.jpg"></a></p><hr><h2 id="æ‰€é ˆçš„å‡½å¼åº«"><a href="#æ‰€é ˆçš„å‡½å¼åº«" class="headerlink" title="æ‰€é ˆçš„å‡½å¼åº«"></a>æ‰€é ˆçš„å‡½å¼åº«</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5650765682937321909#">blynk-library</a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5650765682937321909#">Adafruit_NeoPixel</a></p><h2 id="å®Œæ•´ç¨‹å¼ç¢¼"><a href="#å®Œæ•´ç¨‹å¼ç¢¼" class="headerlink" title="å®Œæ•´ç¨‹å¼ç¢¼"></a>å®Œæ•´ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;BlynkSimpleEsp32.h&gt;#include &lt;WiFi.h&gt;#include &lt;WiFiClient.h&gt;#include &lt;Adafruit_NeoPixel.h&gt;  &#x2F;&#x2F;ç‡ˆæ¢è…³ä½#define PIN 15&#x2F;&#x2F;å…±æœ‰é¡†led#define NUM 8&#x2F;&#x2F;è¨­å®šç‡ˆæ¢çš„ç›¸é—œç³»æ•¸Adafruit_NeoPixelÂ pixelsÂ &#x3D;Â Adafruit_NeoPixel(60,Â PIN,Â NEO_GRBÂ +Â NEO_KHZ800);intÂ data,r,g,b;&#x2F;&#x2F;blynkçš„ç¨ä¸€authcharÂ auth[]Â &#x3D;Â &quot;y79vpg_qnnPpaIGXhTUUnuy6sC6p6zq8&quot;;charÂ ssid[]Â &#x3D;Â &quot;---&quot;;charÂ password[]Â &#x3D;Â &quot;--------&quot;;  &#x2F;&#x2F;è¨­å®šç‡ˆæ¢æ¥æ”¶åˆ°çš„å€¼ä¸¦åæ‡‰åœ¨ç‡ˆæ¢ä¸ŠvoidÂ static1(intÂ r,Â intÂ g,Â intÂ b)&#123;Â Â for(intÂ i&#x3D;0;i&lt;&#x3D;NUM;i++)&#123;Â Â pixels.setPixelColor(i,Â pixels.Color(r,g,b));Â Â pixels.show();Â Â &#125;&#125;&#x2F;&#x2F;blynkå°éƒ¨ä»¶è¨­å®šè£¡çš„è™›æ“¬å¼•è…³  BLYNK_WRITE(V2)&#123;Â Â rÂ &#x3D;Â param[0].asInt();Â Â gÂ &#x3D;Â param[1].asInt();Â Â bÂ &#x3D;Â param[2].asInt();Â Â static1(r,g,b);&#125;  voidÂ setup()&#123;Â Â Serial.begin(115200);Â  &#x2F;&#x2F;blynkåˆå§‹åŒ–  Â Â Blynk.begin(auth,Â ssid,Â password);&#x2F;&#x2F;ç‡ˆæ¢åˆå§‹åŒ–Â Â pixels.begin();&#125;voidÂ loop()&#123;Â Â Blynk.run();&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/AMHgXyRRq10" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blynk </tag>
            
            <tag> ws2812 </tag>
            
            <tag> adafriut_neopixel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç´…å¤–ç·šé™æ§å™¨æ§åˆ¶LED-micropython</title>
      <link href="/2021/09/03/hong-wai-xian-yao-kong-qi-kong-zhi-led-micropython/"/>
      <url>/2021/09/03/hong-wai-xian-yao-kong-qi-kong-zhi-led-micropython/</url>
      
        <content type="html"><![CDATA[<h1 id="ç´…å¤–ç·šé™æ§æ¥æ”¶-micropython"><a href="#ç´…å¤–ç·šé™æ§æ¥æ”¶-micropython" class="headerlink" title="ç´…å¤–ç·šé™æ§æ¥æ”¶-micropython"></a>ç´…å¤–ç·šé™æ§æ¥æ”¶-micropython</h1><h6 id="tags-esp32-vs1838-micropython-ç´…å¤–ç·šé™æ§"><a href="#tags-esp32-vs1838-micropython-ç´…å¤–ç·šé™æ§" class="headerlink" title="tags: esp32 vs1838 micropython ç´…å¤–ç·šé™æ§"></a>tags: <code>esp32</code> <code>vs1838</code> <code>micropython</code> <code>ç´…å¤–ç·šé™æ§</code></h6><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/6224385154468238883#"><img src="https://lh3.googleusercontent.com/-A5q8iXLl2Qo/YTG-S-4KoBI/AAAAAAAAe4w/x_cUvOR-EAwYVEbDwSSF2XNk3Lxa-DEbQCNcBGAsYHQ/s1600/1630649917872814-0.png"></a></p><p>**ç´…å¤–æ¥æ”¶å™¨æ¨¡å¡Šä½¿ç”¨ VS1838 å…‰é›»äºŒæ¥µç®¡ç´…å¤–æ¥æ”¶å™¨ã€‚å®ƒæˆæœ¬ä½ä¸”æ˜“æ–¼ä½¿ç”¨ã€‚  </p><p>å¼•è…³ï¼š<br>å®ƒæœ‰ 3 å€‹å¼•è…³ï¼Œå³ï¼š<br>G - æ¥åœ°å¼•è…³ã€‚<br>V - é›»æºé›»å£“ã€‚<br>S - ç‚ºç´…å¤–æ¥æ”¶ä¿¡è™Ÿå¼•è…³ã€‚**</p><p><strong>ä¸Šå‚³</strong><strong><em>micropython_ir Library of Peter Hinchå‡½å¼åº«:</em></strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">#Â MITÂ License#Â #Â CopyrightÂ (c)Â 2020Â PeterÂ Hinch#Â #Â PermissionÂ isÂ herebyÂ granted,Â freeÂ ofÂ charge,Â toÂ anyÂ personÂ obtainingÂ aÂ copy#Â ofÂ thisÂ softwareÂ andÂ associatedÂ documentationÂ filesÂ (theÂ &quot;Software&quot;),Â toÂ deal#Â inÂ theÂ SoftwareÂ withoutÂ restriction,Â includingÂ withoutÂ limitationÂ theÂ rights#Â toÂ use,Â copy,Â modify,Â merge,Â publish,Â distribute,Â sublicense,Â and&#x2F;orÂ sell#Â copiesÂ ofÂ theÂ Software,Â andÂ toÂ permitÂ personsÂ toÂ whomÂ theÂ SoftwareÂ is#Â furnishedÂ toÂ doÂ so,Â subjectÂ toÂ theÂ followingÂ conditions:#Â #Â TheÂ aboveÂ copyrightÂ noticeÂ andÂ thisÂ permissionÂ noticeÂ shallÂ beÂ includedÂ inÂ all#Â copiesÂ orÂ substantialÂ portionsÂ ofÂ theÂ Software.#Â #Â THEÂ SOFTWAREÂ ISÂ PROVIDEDÂ &quot;ASÂ IS&quot;,Â WITHOUTÂ WARRANTYÂ OFÂ ANYÂ KIND,Â EXPRESSÂ OR#Â IMPLIED,Â INCLUDINGÂ BUTÂ NOTÂ LIMITEDÂ TOÂ THEÂ WARRANTIESÂ OFÂ MERCHANTABILITY,#Â FITNESSÂ FORÂ AÂ PARTICULARÂ PURPOSEÂ ANDÂ NONINFRINGEMENT.Â INÂ NOÂ EVENTÂ SHALLÂ THE#Â AUTHORSÂ ORÂ COPYRIGHTÂ HOLDERSÂ BEÂ LIABLEÂ FORÂ ANYÂ CLAIM,Â DAMAGESÂ ORÂ OTHER#Â LIABILITY,Â WHETHERÂ INÂ ANÂ ACTIONÂ OFÂ CONTRACT,Â TORTÂ ORÂ OTHERWISE,Â ARISINGÂ FROM,#Â OUTÂ OFÂ ORÂ INÂ CONNECTIONÂ WITHÂ THEÂ SOFTWAREÂ ORÂ THEÂ USEÂ ORÂ OTHERÂ DEALINGSÂ INÂ THE#Â SOFTWARE.  #Â Author:Â PeterÂ Hinch#Â CopyrightÂ PeterÂ HinchÂ 2020-2021Â ReleasedÂ underÂ theÂ MITÂ license#Â http:&#x2F;&#x2F;github.com&#x2F;peterhinch&#x2F;micropython_ir  fromÂ machineÂ importÂ PinfromÂ machineÂ importÂ TimerfromÂ arrayÂ importÂ arrayfromÂ utimeÂ importÂ ticks_usfromÂ utimeÂ importÂ ticks_diff  #Â SaveÂ RAM#Â fromÂ micropythonÂ importÂ alloc\_emergency\_exception_buf#Â alloc\_emergency\_exception_buf(100)    #Â OnÂ 1stÂ edgeÂ startÂ aÂ blockÂ timer.Â WhileÂ theÂ timerÂ isÂ running,Â recordÂ theÂ time#Â ofÂ eachÂ edge.Â WhenÂ theÂ timerÂ timesÂ outÂ decodeÂ theÂ data.Â DurationÂ mustÂ exceed#Â theÂ worstÂ caseÂ blockÂ transmissionÂ time,Â butÂ beÂ lessÂ thanÂ theÂ intervalÂ between#Â aÂ blockÂ startÂ andÂ aÂ repeatÂ codeÂ startÂ (~108msÂ dependingÂ onÂ protocol)  classÂ IR_RX():Â Â Â Â #Â Result&#x2F;errorÂ codesÂ Â Â Â #Â RepeatÂ buttonÂ codeÂ Â Â Â REPEATÂ &#x3D;Â -1Â Â Â Â #Â ErrorÂ codesÂ Â Â Â BADSTARTÂ &#x3D;Â -2Â Â Â Â BADBLOCKÂ &#x3D;Â -3Â Â Â Â BADREPÂ &#x3D;Â -4Â Â Â Â OVERRUNÂ &#x3D;Â -5Â Â Â Â BADDATAÂ &#x3D;Â -6Â Â Â Â BADADDRÂ &#x3D;Â -7  Â Â Â Â defÂ __init__(self,Â pin,Â nedges,Â tblock,Â callback,Â *args):Â Â #Â OptionalÂ argsÂ forÂ callbackÂ Â Â Â Â Â Â Â self._pinÂ &#x3D;Â pinÂ Â Â Â Â Â Â Â self._nedgesÂ &#x3D;Â nedgesÂ Â Â Â Â Â Â Â self._tblockÂ &#x3D;Â tblockÂ Â Â Â Â Â Â Â self.callbackÂ &#x3D;Â callbackÂ Â Â Â Â Â Â Â self.argsÂ &#x3D;Â argsÂ Â Â Â Â Â Â Â self._errfÂ &#x3D;Â lambdaÂ _Â :Â NoneÂ Â Â Â Â Â Â Â self.verboseÂ &#x3D;Â False  Â Â Â Â Â Â Â Â self._timesÂ &#x3D;Â array(&#39;i&#39;,Â Â (0Â forÂ _Â inÂ range(nedgesÂ +Â 1)))Â Â #Â +1Â forÂ overrunÂ Â Â Â Â Â Â Â pin.irq(handlerÂ &#x3D;Â self._cb_pin,Â triggerÂ &#x3D;Â (Pin.IRQ_FALLINGÂ |Â Pin.IRQ_RISING))Â Â Â Â Â Â Â Â self.edgeÂ &#x3D;Â 0Â Â Â Â Â Â Â Â self.timÂ &#x3D;Â Timer(-1)Â Â #Â SofwareÂ timerÂ Â Â Â Â Â Â Â self.cbÂ &#x3D;Â self.decode  Â Â Â Â #Â PinÂ interrupt.Â SaveÂ timeÂ ofÂ eachÂ edgeÂ forÂ laterÂ decode.Â Â Â Â defÂ _cb_pin(self,Â line):Â Â Â Â Â Â Â Â tÂ &#x3D;Â ticks_us()Â Â Â Â Â Â Â Â #Â OnÂ overrunÂ ignoreÂ pulsesÂ untilÂ softwareÂ timerÂ timesÂ outÂ Â Â Â Â Â Â Â ifÂ self.edgeÂ &lt;&#x3D;Â self._nedges:Â Â #Â AllowÂ 1Â extraÂ pulseÂ toÂ recordÂ overrunÂ Â Â Â Â Â Â Â Â Â Â Â ifÂ notÂ self.edge:Â Â #Â FirstÂ edgeÂ receivedÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â self.tim.init(period&#x3D;self._tblockÂ ,Â mode&#x3D;Timer.ONE_SHOT,Â callback&#x3D;self.cb)Â Â Â Â Â Â Â Â Â Â Â Â self._times[self.edge]Â &#x3D;Â tÂ Â Â Â Â Â Â Â Â Â Â Â self.edgeÂ +&#x3D;Â 1  Â Â Â Â defÂ do_callback(self,Â cmd,Â addr,Â ext,Â thresh&#x3D;0):Â Â Â Â Â Â Â Â self.edgeÂ &#x3D;Â 0Â Â Â Â Â Â Â Â ifÂ cmdÂ &gt;&#x3D;Â thresh:Â Â Â Â Â Â Â Â Â Â Â Â self.callback(cmd,Â addr,Â ext,Â *self.args)Â Â Â Â Â Â Â Â else:Â Â Â Â Â Â Â Â Â Â Â Â self._errf(cmd)  Â Â Â Â defÂ error_function(self,Â func):Â Â Â Â Â Â Â Â self._errfÂ &#x3D;Â func  Â Â Â Â defÂ close(self):Â Â Â Â Â Â Â Â self._pin.irq(handlerÂ &#x3D;Â None)Â Â Â Â Â Â Â Â self.tim.deinit()    classÂ NEC_ABC(IR_RX):Â Â Â Â defÂ __init__(self,Â pin,Â extended,Â callback,Â *args):Â Â Â Â Â Â Â Â #Â BlockÂ lastsÂ &lt;&#x3D;Â 80msÂ (extendedÂ mode)Â andÂ hasÂ 68Â edgesÂ Â Â Â Â Â Â Â super().__init__(pin,Â 68,Â 80,Â callback,Â *args)Â Â Â Â Â Â Â Â self._extendedÂ &#x3D;Â extendedÂ Â Â Â Â Â Â Â self._addrÂ &#x3D;Â 0  Â Â Â Â defÂ decode(self,Â _):Â Â Â Â Â Â Â Â try:Â Â Â Â Â Â Â Â Â Â Â Â ifÂ self.edgeÂ &gt;Â 68:Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â raiseÂ RuntimeError(self.OVERRUN)Â Â Â Â Â Â Â Â Â Â Â Â widthÂ &#x3D;Â ticks_diff(self._times[1],Â self._times[0])Â Â Â Â Â Â Â Â Â Â Â Â ifÂ widthÂ &lt;Â 4000:Â Â #Â 9msÂ leadingÂ markÂ forÂ allÂ validÂ dataÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â raiseÂ RuntimeError(self.BADSTART)Â Â Â Â Â Â Â Â Â Â Â Â widthÂ &#x3D;Â ticks_diff(self._times[2],Â self._times[1])Â Â Â Â Â Â Â Â Â Â Â Â ifÂ widthÂ &gt;Â 3000:Â Â #Â 4.5msÂ spaceÂ forÂ normalÂ dataÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ self.edgeÂ &lt;Â 68:Â Â #Â Haven&#39;tÂ receivedÂ theÂ correctÂ numberÂ ofÂ edgesÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â raiseÂ RuntimeError(self.BADBLOCK)Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â #Â TimeÂ spacesÂ onlyÂ (marksÂ areÂ alwaysÂ 562.5Âµs)Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â #Â SpaceÂ isÂ 1.6875msÂ (1)Â orÂ 562.5ÂµsÂ (0)Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â #Â SkipÂ lastÂ bitÂ whichÂ isÂ alwaysÂ 1Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â valÂ &#x3D;Â 0Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â forÂ edgeÂ inÂ range(3,Â 68Â -Â 2,Â 2):Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â valÂ &gt;&gt;&#x3D;Â 1Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ ticks_diff(self._times[edgeÂ +Â 1],Â self._times[edge])Â &gt;Â 1120:Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â valÂ &#x3D;Â 0x80000000Â Â Â Â Â Â Â Â Â Â Â Â elifÂ widthÂ &gt;Â 1700:Â #Â 2.5msÂ spaceÂ forÂ aÂ repeatÂ code.Â ShouldÂ haveÂ exactlyÂ 4Â edges.Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â raiseÂ RuntimeError(self.REPEATÂ ifÂ self.edgeÂ &#x3D;&#x3D;Â 4Â elseÂ self.BADREP)Â Â #Â TreatÂ REPEATÂ asÂ error.Â Â Â Â Â Â Â Â Â Â Â Â else:Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â raiseÂ RuntimeError(self.BADSTART)Â Â Â Â Â Â Â Â Â Â Â Â addrÂ &#x3D;Â valÂ &amp;Â 0xffÂ Â #Â 8Â bitÂ addrÂ Â Â Â Â Â Â Â Â Â Â Â cmdÂ &#x3D;Â (valÂ &gt;&gt;Â 16)Â &amp;Â 0xffÂ Â Â Â Â Â Â Â Â Â Â Â ifÂ cmdÂ !&#x3D;Â (valÂ &gt;&gt;Â 24)Â ^Â 0xff:Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â raiseÂ RuntimeError(self.BADDATA)Â Â Â Â Â Â Â Â Â Â Â Â ifÂ addrÂ !&#x3D;Â ((valÂ &gt;&gt;Â 8)Â ^Â 0xff)Â &amp;Â 0xff:Â Â #Â 8Â bitÂ addrÂ doesn&#39;tÂ matchÂ checkÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ notÂ self._extended:Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â raiseÂ RuntimeError(self.BADADDR)Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â addrÂ |&#x3D;Â valÂ &amp;Â 0xff00Â Â #Â passÂ assumedÂ 16Â bitÂ addressÂ toÂ callbackÂ Â Â Â Â Â Â Â Â Â Â Â self._addrÂ &#x3D;Â addrÂ Â Â Â Â Â Â Â exceptÂ RuntimeErrorÂ asÂ e:Â Â Â Â Â Â Â Â Â Â Â Â cmdÂ &#x3D;Â e.args[0]Â Â Â Â Â Â Â Â Â Â Â Â addrÂ &#x3D;Â self._addrÂ ifÂ cmdÂ &#x3D;&#x3D;Â self.REPEATÂ elseÂ 0Â Â #Â REPEATÂ usesÂ lastÂ addressÂ Â Â Â Â Â Â Â #Â SetÂ upÂ forÂ newÂ dataÂ burstÂ andÂ runÂ userÂ callbackÂ Â Â Â Â Â Â Â self.do_callback(cmd,Â addr,Â 0,Â self.REPEAT)  classÂ NEC_8(NEC_ABC):Â Â Â Â defÂ __init__(self,Â pin,Â callback,Â *args):Â Â Â Â Â Â Â Â super().__init__(pin,Â False,Â callback,Â *args)  classÂ NEC_16(NEC_ABC):Â Â Â Â defÂ __init__(self,Â pin,Â callback,Â *args):Â Â Â Â Â Â Â Â super().__init__(pin,Â True,Â callback,Â *args)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç¯„ä¾‹1"><a href="#ç¯„ä¾‹1" class="headerlink" title="ç¯„ä¾‹1"></a><strong>ç¯„ä¾‹1</strong></h2><h3 id="å¥—ç”¨ä»¥ä¸‹ç¯„ä¾‹ä¸¦è¨˜ä¸‹é™æ§å™¨æŒ‰éµçš„data"><a href="#å¥—ç”¨ä»¥ä¸‹ç¯„ä¾‹ä¸¦è¨˜ä¸‹é™æ§å™¨æŒ‰éµçš„data" class="headerlink" title="å¥—ç”¨ä»¥ä¸‹ç¯„ä¾‹ä¸¦è¨˜ä¸‹é™æ§å™¨æŒ‰éµçš„data"></a><strong><em>å¥—ç”¨ä»¥ä¸‹ç¯„ä¾‹ä¸¦è¨˜ä¸‹é™æ§å™¨æŒ‰éµçš„data</em></strong></h3><pre class="line-numbers language-none"><code class="language-none">fromÂ ir_rxÂ importÂ NEC_16fromÂ machineÂ importÂ TimerfromÂ machineÂ importÂ Pin  defÂ callBack(data,Â addr,Â ctrl):Â Â Â Â ifÂ dataÂ &gt;Â 0:Â Â Â Â Â Â Â Â print(&quot;data:Â &#123;:02x&#125;Â addr:Â &#123;:04x&#125;&quot;.format(data,Â addr))irÂ &#x3D;Â NEC_16(Pin(26,Â Pin.IN),Â callBack)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/Q6j2Im2r9hw" frameborder="0" loading="lazy" allowfullscreen></iframe></div><h2 id="ç¯„ä¾‹2"><a href="#ç¯„ä¾‹2" class="headerlink" title="ç¯„ä¾‹2:"></a>ç¯„ä¾‹2:</h2><p><strong><em>æœ‰äº†å°æ‡‰éµçš„16é€²åˆ¶,ä¸¦å­˜æ”¾åœ¨distè£¡,å°±å¯ä»¥æŠŠå®ƒå¥—ç”¨åœ¨callBack()å»ä½œæ¯”å°</em></strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">fromÂ ir_rxÂ importÂ NEC_16fromÂ machineÂ importÂ TimerfromÂ machineÂ importÂ Pin  defÂ callBack(data,Â addr,Â ctrl):Â Â Â Â ifÂ dataÂ &gt;Â 0:Â Â Â Â Â Â Â Â #Â print(&quot;data:Â &#123;:02x&#125;Â addr:Â &#123;:04x&#125;&quot;.format(data,Â addr))Â Â Â Â Â Â Â Â print(ir_key[data])irÂ &#x3D;Â NEC_16(Pin(26,Â Pin.IN),Â callBack)  ir_keyÂ &#x3D;Â &#123;Â Â Â Â 0x16Â :Â &#39;0&#39;,Â Â Â Â 0x0cÂ :Â &#39;1&#39;,Â Â Â Â 0x18Â :Â &#39;2&#39;,Â Â Â Â 0x5eÂ :Â &#39;3&#39;,Â Â Â Â 0x08Â :Â &#39;4&#39;,Â Â Â Â 0x1cÂ :Â &#39;5&#39;,Â Â Â Â 0x5aÂ :Â &#39;6&#39;,Â Â Â Â 0x42Â :Â &#39;7&#39;,Â Â Â Â 0x52Â :Â &#39;8&#39;,Â Â Â Â 0x4aÂ :Â &#39;9&#39;,Â Â Â Â 0x15Â :Â &#39;ok&#39;,Â Â Â Â 0x40Â :Â &#39;up&#39;,Â Â Â Â 0x19Â :Â &#39;down&#39;,Â Â Â Â 0x07Â :Â &#39;left&#39;,Â Â Â Â 0x09Â :Â &#39;right&#39;,Â Â Â Â 0x44Â :Â &#39;power&#39;,&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/Q6j2Im2r9hw" frameborder="0" loading="lazy" allowfullscreen></iframe></div><hr><h2 id="ç¯„ä¾‹3"><a href="#ç¯„ä¾‹3" class="headerlink" title="ç¯„ä¾‹3:"></a>ç¯„ä¾‹3:</h2><p><strong><em>ç¾åœ¨æœ‰äº†ç²¾ç¢ºçš„æ•¸å­—,å¯ä»¥é‹ç”¨åœ¨æ§åˆ¶æŸäº›ä¾‹å¦‚ç‡ˆå…·â€¦ç­‰ç­‰çš„ç‰©å“é€™è£¡ä½¿ç”¨ä¸€å€‹ç°¡å–®çš„ä¾‹å­,ç•¶æŒ‰ä¸‹â€1â€çš„éµæ™‚,æ‰“é–‹esp32çš„å…§éµç‡ˆ,ç•¶æŒ‰ä¸‹â€2â€æ™‚,é—œé–‰å…§éµç‡ˆã€‚</em></strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">fromÂ ir_rxÂ importÂ NEC_16fromÂ machineÂ importÂ TimerfromÂ machineÂ importÂ Pin  ledÂ &#x3D;Â Pin(2,Â Pin.OUT)defÂ callBack(data,Â addr,Â ctrl):Â Â Â Â globalÂ _data,Â _addrÂ Â Â Â _dataÂ &#x3D;Â ir_key[data]Â Â Â Â _addrÂ &#x3D;Â addrÂ Â Â Â ifÂ dataÂ &gt;Â 0:Â Â Â Â Â Â Â Â #Â print(&quot;data:Â &#123;:02x&#125;Â addr:Â &#123;:04x&#125;&quot;.format(data,Â addr))Â Â Â Â Â Â Â Â print(_data)irÂ &#x3D;Â NEC_16(Pin(26,Â Pin.IN),Â callBack)  ir_keyÂ &#x3D;Â &#123;Â Â Â Â 0x16Â :Â &#39;0&#39;,Â Â Â Â 0x0cÂ :Â &#39;1&#39;,Â Â Â Â 0x18Â :Â &#39;2&#39;,Â Â Â Â 0x5eÂ :Â &#39;3&#39;,Â Â Â Â 0x08Â :Â &#39;4&#39;,Â Â Â Â 0x1cÂ :Â &#39;5&#39;,Â Â Â Â 0x5aÂ :Â &#39;6&#39;,Â Â Â Â 0x42Â :Â &#39;7&#39;,Â Â Â Â 0x52Â :Â &#39;8&#39;,Â Â Â Â 0x4aÂ :Â &#39;9&#39;,Â Â Â Â 0x15Â :Â &#39;ok&#39;,Â Â Â Â 0x40Â :Â &#39;up&#39;,Â Â Â Â 0x19Â :Â &#39;down&#39;,Â Â Â Â 0x07Â :Â &#39;left&#39;,Â Â Â Â 0x09Â :Â &#39;right&#39;,Â Â Â Â 0x44Â :Â &#39;power&#39;,&#125;_dataÂ &#x3D;Â 0ifÂ _dataÂ &#x3D;&#x3D;Â &quot;1&quot;:Â Â Â Â led.on()elifÂ _dataÂ &#x3D;&#x3D;Â &quot;2&quot;:Â Â Â Â led.off()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/6t1xMAnKzS8" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
          <category> micropython </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vs1838 </tag>
            
            <tag> ç´…å¤–ç·šé™æ§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç´…å¤–ç·šé™æ§å™¨æ§åˆ¶LED-ESP3</title>
      <link href="/2021/09/03/hong-wai-xian-yao-kong-qi-kong-zhi-led-esp3/"/>
      <url>/2021/09/03/hong-wai-xian-yao-kong-qi-kong-zhi-led-esp3/</url>
      
        <content type="html"><![CDATA[<h1 id="ç´…å¤–ç·šé™æ§å™¨æ§åˆ¶LED-ESP3"><a href="#ç´…å¤–ç·šé™æ§å™¨æ§åˆ¶LED-ESP3" class="headerlink" title="ç´…å¤–ç·šé™æ§å™¨æ§åˆ¶LED-ESP3"></a>ç´…å¤–ç·šé™æ§å™¨æ§åˆ¶LED-ESP3</h1><h6 id="tags-esp32-vs1838-ç´…å¤–ç·šé™æ§"><a href="#tags-esp32-vs1838-ç´…å¤–ç·šé™æ§" class="headerlink" title="tags: esp32 vs1838 ç´…å¤–ç·šé™æ§"></a>tags: <code>esp32</code> <code>vs1838</code> <code>ç´…å¤–ç·šé™æ§</code></h6><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2182248290207799810#"><img src="https://lh3.googleusercontent.com/-AMwtHuHrueA/YTG-qYvDXVI/AAAAAAAAe44/V-Ue5wYV6JwFjK6VxTeu5cMWRw5h5CJVQCNcBGAsYHQ/s1600/1630649998922334-0.png"></a></p><p>**ç´…å¤–æ¥æ”¶å™¨æ¨¡å¡Šä½¿ç”¨ VS1838 å…‰é›»äºŒæ¥µç®¡ç´…å¤–æ¥æ”¶å™¨ã€‚å®ƒæˆæœ¬ä½ä¸”æ˜“æ–¼ä½¿ç”¨ã€‚  </p><p>å¼•è…³ï¼š<br>å®ƒæœ‰ 3 å€‹å¼•è…³ï¼Œå³ï¼š<br>G - æ¥åœ°å¼•è…³ã€‚<br>V - é›»æºé›»å£“ã€‚<br>Sâ€”â€”ç‚ºç´…å¤–æ¥æ”¶ä¿¡è™Ÿå¼•è…³ã€‚**</p><h2 id="å¯¦é©—1"><a href="#å¯¦é©—1" class="headerlink" title="å¯¦é©—1:"></a><strong>å¯¦é©—1:</strong></h2><p><strong>æ¥æ”¶æŒ‰éµå€¼</strong></p><p><strong>å…ˆåŒ¯å…¥</strong><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2182248290207799810#">IRremote.h</a></p><p><strong>ä¸Šå‚³æ­¤ç¯„ä¾‹</strong></p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;IRremote.h&gt;intÂ RECV_PINÂ &#x3D;Â 15;IRrecvÂ irrecv(RECV_PIN);decode_resultsÂ results;voidÂ setup()&#123;Â Â Â Â Serial.begin(115200);Â Â Â Â irrecv.enableIRIn();Â &#x2F;&#x2F;Â å•Ÿå‹•æ¥æ”¶å™¨&#125;voidÂ loop()Â &#123;Â Â Â Â ifÂ (irrecv.decode(&amp;results))Â &#123;Â Â Â Â Â Â Â Â Serial.println(results.value);Â Â Â Â Â Â Â Â irrecv.resume();Â &#x2F;&#x2F;Â æ¥æ•¸ä¸‹ä¸€å€‹æŒ‰éµå€¼Â Â Â Â &#125; delay(100);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/GrntTjzaFfk" frameborder="0" loading="lazy" allowfullscreen></iframe></div><hr><h2 id="å¯¦é©—2"><a href="#å¯¦é©—2" class="headerlink" title="å¯¦é©—2"></a><strong>å¯¦é©—2</strong></h2><p><strong>ä»¥ä¸Šç¨‹å¼æœƒè½‰æˆåé€²åˆ¶</strong></p><p><strong>æˆ‘é ˆè¦1å’Œ2çš„æŒ‰éµä¾†æ§åˆ¶ç‡ˆçš„æ˜æ»…</strong></p><p><strong>æ‰€ä»¥åˆ©ç”¨å‰›å‰›1å’Œ2çš„åé€²åˆ¶è™Ÿç¢¼é€²è¡Œè¨­åˆ¶</strong></p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;IRremote.h&gt;intÂ RECV_PINÂ &#x3D;Â 15;constÂ intÂ ledÂ &#x3D;Â LED_BUILTIN;IRrecvÂ irrecv(RECV_PIN);decode_resultsÂ results;voidÂ setup()&#123;Â Â Â Â Serial.begin(115200);Â Â Â Â irrecv.enableIRIn();Â &#x2F;&#x2F;Â å•Ÿå‹•æ¥æ”¶å™¨Â Â Â Â pinMode(led,Â OUTPUT);&#125;  voidÂ loop()Â &#123;Â Â Â Â ifÂ (irrecv.decode(&amp;results))Â &#123;Â Â Â Â Â Â Â Â Serial.println(results.value);Â Â Â Â Â Â Â Â irrecv.resume();Â &#x2F;&#x2F;Â æ¥æ•¸ä¸‹ä¸€å€‹æŒ‰éµå€¼Â Â Â Â &#125;Â Â Â Â delay(100);Â Â Â Â ifÂ (results.valueÂ &#x3D;&#x3D;Â 16724175)&#123;Â Â Â Â Â Â Â Â digitalWrite(led,Â HIGH);Â Â Â Â &#125;elseÂ ifÂ (results.valueÂ &#x3D;&#x3D;Â 16718055)&#123;Â Â Â Â Â Â Â Â digitalWrite(led,Â LOW);Â Â Â Â &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/6t1xMAnKzS8" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vs1838 </tag>
            
            <tag> ç´…å¤–ç·šé™æ§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœŸç‚®åˆ¶æ©Ÿæ¢°æ‰‹æŒ(Hand Robot)+å½æ›²å‚³æ„Ÿå™¨-Arduino</title>
      <link href="/2021/09/03/tu-pao-zhi-ji-jie-shou-zhang-hand-robot-wan-qu-chuan-gan-qi-arduino/"/>
      <url>/2021/09/03/tu-pao-zhi-ji-jie-shou-zhang-hand-robot-wan-qu-chuan-gan-qi-arduino/</url>
      
        <content type="html"><![CDATA[<h1 id="åœŸç‚®åˆ¶æ©Ÿæ¢°æ‰‹æŒ-Hand-Robot-å½æ›²å‚³æ„Ÿå™¨-Arduino"><a href="#åœŸç‚®åˆ¶æ©Ÿæ¢°æ‰‹æŒ-Hand-Robot-å½æ›²å‚³æ„Ÿå™¨-Arduino" class="headerlink" title="åœŸç‚®åˆ¶æ©Ÿæ¢°æ‰‹æŒ(Hand Robot)+å½æ›²å‚³æ„Ÿå™¨-Arduino"></a>åœŸç‚®åˆ¶æ©Ÿæ¢°æ‰‹æŒ(Hand Robot)+å½æ›²å‚³æ„Ÿå™¨-Arduino</h1><h6 id="tags-arduino-æ©Ÿæ¢°æ‰‹æŒ-hand-robot"><a href="#tags-arduino-æ©Ÿæ¢°æ‰‹æŒ-hand-robot" class="headerlink" title="tags: arduino æ©Ÿæ¢°æ‰‹æŒ hand robot"></a>tags: <code>arduino</code> <code>æ©Ÿæ¢°æ‰‹æŒ</code> <code>hand robot</code></h6><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/7905812487640359234#"><img src="https://lh3.googleusercontent.com/-8Jh_s3fPymc/YKtQv5ooyMI/AAAAAAAAeLk/mforclTeA1g9PMXHLWylim0iDYi7WlubwCNcBGAsYHQ/s1600/1621840029201670-0.png"></a></p><p><strong><em>æœ€è¿‘åœ¨å¾ˆå¤šå¹³å°ä¸Šçœ‹åˆ°æ©Ÿæ¢°æ‰‹æŒè¢«å»£ç¯„ä½¿ç”¨åœ¨ç¾©è‚¢ä¸Š,</em></strong><br><strong><em>ä½¿å¾—æœ‰é ˆæ±‚çš„äººå¾—åˆ°ä¸€å€‹å¾ˆå¥½çš„è¼”åŠ©åŠŸèƒ½,æˆ‘è‡ªå·±æœ¬èº«</em></strong><br><strong><em>ä¹Ÿæ˜¯æœ‰æ®˜ç¼ºçš„äºº,é›–ç„¶ä¸æ˜¯å››è‚¢ä¸Š,æ˜¯è½è¦ºæœ‰å•é¡Œ,æ‰€ä»¥èƒ½</em></strong><br><strong><em>æ„ŸåŒèº«å—,æˆ‘ç›¸ä¿¡æœªä¾†èƒ½ç™¼å±•åˆ°ä»»ä½•æ®˜ç¼ºéƒ½æœ‰èƒ½è¼”åŠ©çš„</em></strong><br><strong>_AIè¨­å‚™å¯ä½¿ç”¨ã€‚ç„¶å¾Œé€™å€‹å‹•æ©Ÿä½¿æˆ‘ä¹Ÿæƒ³åˆ©ç”¨Arduinoä¾†_</strong><br><strong><em>åšå€‹æ©Ÿæ¢°æ‰‹æŒ,äº†è§£ä¸€ä¸‹ç®‡ä¸­åŸç†ã€‚</em></strong><br><strong><em>æœ¬æƒ³ç”¨ï¼“ï¼¤åˆ—å°æ‰‹æŒå‡ºä¾†,ä½†æœ‰é»æ“”å¿ƒè¦çµåˆé—œç¯€æœ‰é›£åº¦</em></strong><br><strong><em>æ–¼æ˜¯å…ˆç”¨ç´™æ¿è£å‰ª,é€™è£¡è¦æ¯”è¼ƒç•™æ„çš„æ˜¯é—œç¯€è™•è¦æœ‰è¶³å¤ </em></strong><br><strong><em>çš„ç©ºé–“,æ‰èƒ½å½æ›²,ç”¨ç´™æ¿æ˜¯æœ€ç°¡æ˜“çš„ææ–™,å› ç‚ºç´™æ¿æŠ˜å½å¾Œ</em></strong><br><strong><em>æ”¾é–‹,æœƒè‡ªå‹•æ”¤å¹³,å…¶å¯¦ä¹Ÿå¯ä»¥ç”¨å¯¦å¿ƒçš„æµ·ç¶¿,æ•ˆæœæ‡‰è©²ä¸éŒ¯ã€‚</em></strong></p><h2 id="ææ–™"><a href="#ææ–™" class="headerlink" title="ææ–™"></a>ææ–™</h2><ul><li><strong>å¸ç®¡è‹¥å¹²æ”¯</strong></li><li><strong>ç´™ç®±ç´™æ¿</strong></li><li><strong>å°ç´°ç·šæˆ–å°¼é¾ç·š</strong></li><li><strong>ä¼ºæœé¦¬é” x5</strong></li><li><strong>PCA9685 x1</strong></li><li><strong>Arduino UNO x1</strong></li></ul><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/7905812487640359234#"><img src="https://lh3.googleusercontent.com/-XkV4ELfGyGQ/YKxYCPeN9KI/AAAAAAAAeMQ/s9qcYSHRNfsfx71ZvR3FmBT0xrgCgllYACNcBGAsYHQ/s1600/1621907440062420-0.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/7905812487640359234#"><img src="https://lh3.googleusercontent.com/-MGnyCZI74_Q/YKxX7tqt25I/AAAAAAAAeMI/LMTCpE02e-Im1LbuqXHsGW9FixFzXbMcQCNcBGAsYHQ/s1600/1621907418074666-1.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/7905812487640359234#"><img src="https://lh3.googleusercontent.com/-dldn-MG47AU/YKxX2UlpWZI/AAAAAAAAeMA/T7jhXD5fFtQNeUIXJwP9P7bZTjc341x0wCNcBGAsYHQ/s1600/1621907401475330-2.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/7905812487640359234#"><img src="https://lh3.googleusercontent.com/-1MQth4xwVrY/YKxXyLIoT2I/AAAAAAAAeL8/Zg2w7MBFpNAgvlaCxGcZ9e2NCAXV9MhegCNcBGAsYHQ/s1600/1621907376671852-3.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/7905812487640359234#"><img src="https://lh3.googleusercontent.com/-qKchUlzBnLk/YKxXritjNxI/AAAAAAAAeL0/9v786lhQG5oyCSWgBM7Z8VJgCc7TDpX9gCNcBGAsYHQ/s1600/1621907321750549-4.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/7905812487640359234#"><img src="https://lh3.googleusercontent.com/-YxadX-Hyu5I/YKxXeJ2fjuI/AAAAAAAAeLw/0ao8ucVi9z8aw14GWI8VYjvDaR86Kz7_wCNcBGAsYHQ/s1600/1621907297416560-5.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/7905812487640359234#"><img src="https://lh3.googleusercontent.com/-ASihZR1kTOk/YKxYeitOWkI/AAAAAAAAeMg/89XITznmL1AL18tWlT6gsWoml12c2hI6QCNcBGAsYHQ/s1600/1621907569418731-0.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/7905812487640359234#"><img src="https://lh3.googleusercontent.com/-YfUNpFuCBsQ/YKxYcH4NrFI/AAAAAAAAeMc/-KEdQQOFtR4RtSb8pezGLpcb4Ai_YvzzgCNcBGAsYHQ/s1600/1621907555196644-1.png"></a></p><p><strong>èˆµæ©Ÿå›ºå®šåœ¨é©ç•¶çš„ä½ç½®å¾Œå†ä¾†å°±å‰©ä¸‹ç¨‹å¼ç¢¼</strong></p><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;Wire.h&gt;#include &lt;Adafruit_PWMServoDriver.h&gt;#define SERVO_FREQ 60Â &#x2F;&#x2F;Â AnalogÂ servosÂ runÂ atÂ ~50Â HzÂ updates&#x2F;&#x2F;angleMax&#x3D;600&#x2F;&#x2F;angleMin&#x3D;150Adafruit_PWMServoDriverÂ pwmÂ &#x3D;Â Adafruit_PWMServoDriver();  intÂ val;voidÂ setup()&#123;Â Â Serial.begin(9600);Â Â pwm.begin();Â Â pwm.setOscillatorFrequency(27000000);Â Â pwm.setPWMFreq(SERVO_FREQ);Â Â &#x2F;&#x2F;Â AnalogÂ servosÂ runÂ atÂ ~50Â HzÂ updatesÂ Â delay(10);&#125;  voidÂ loop()&#123;Â Â forÂ (intÂ iÂ &#x3D;Â 500;Â iÂ &gt;Â 200;Â i-&#x3D;20)Â Â &#123;Â Â Â Â pwm.setPWM(1,Â 0Â ,Â i);Â Â Â Â delay(50);Â Â &#125;Â Â forÂ (intÂ iÂ &#x3D;Â 200;Â iÂ &lt;Â 500;Â i+&#x3D;20)Â Â &#123;Â Â Â Â pwm.setPWM(1,Â 0,Â i);Â Â Â Â delay(50);Â Â &#125;Â Â forÂ (intÂ iÂ &#x3D;Â 500;Â iÂ &gt;Â 200;Â i-&#x3D;20)Â Â &#123;Â Â Â Â pwm.setPWM(2,Â 0Â ,Â i);Â Â Â Â delay(50);Â Â &#125;Â Â forÂ (intÂ iÂ &#x3D;Â 200;Â iÂ &lt;Â 500;Â i+&#x3D;20)Â Â &#123;Â Â Â Â pwm.setPWM(2,Â 0,Â i);Â Â Â Â delay(50);Â Â &#125;  Â Â forÂ (intÂ iÂ &#x3D;Â 500;Â iÂ &gt;Â 200;Â i-&#x3D;20)Â Â &#123;Â Â Â Â pwm.setPWM(8,Â 0Â ,Â i);Â Â Â Â delay(50);Â Â &#125;Â Â forÂ (intÂ iÂ &#x3D;Â 200;Â iÂ &lt;Â 500;Â i+&#x3D;20)Â Â &#123;Â Â Â Â pwm.setPWM(8,Â 0,Â i);Â Â Â Â delay(50);Â Â &#125;  Â Â forÂ (intÂ iÂ &#x3D;Â 500;Â iÂ &gt;Â 200;Â i-&#x3D;20)Â Â &#123;Â Â Â Â pwm.setPWM(9,Â 0Â ,Â i);Â Â Â Â delay(50);Â Â &#125;Â Â forÂ (intÂ iÂ &#x3D;Â 200;Â iÂ &lt;Â 500;Â i+&#x3D;20)Â Â &#123;Â Â Â Â pwm.setPWM(9,Â 0,Â i);Â Â Â Â delay(50);Â Â &#125;  Â Â forÂ (intÂ iÂ &#x3D;Â 500;Â iÂ &gt;Â 200;Â i-&#x3D;20)Â Â &#123;Â Â Â Â pwm.setPWM(10,Â 0Â ,Â i);Â Â Â Â delay(50);Â Â &#125;Â Â forÂ (intÂ iÂ &#x3D;Â 200;Â iÂ &lt;Â 500;Â i+&#x3D;20)Â Â &#123;Â Â Â Â pwm.setPWM(10,Â 0,Â i);Â Â Â Â delay(50);Â Â &#125;Â Â forÂ (intÂ jÂ &#x3D;Â 500;Â jÂ &gt;Â 200;Â j-&#x3D;20)&#123;Â Â Â Â pwm.setPWM(1,Â 0,Â j);Â Â Â Â pwm.setPWM(2,Â 0,Â j);Â Â Â Â pwm.setPWM(8,Â 0,Â j);Â Â Â Â pwm.setPWM(9,Â 0,Â j);Â Â Â Â pwm.setPWM(10,Â 0,Â j);Â Â Â Â delay(50);Â Â &#125;Â Â forÂ (intÂ jÂ &#x3D;Â 200;Â jÂ &lt;Â 500;Â j+&#x3D;20)&#123;Â Â Â Â pwm.setPWM(1,Â 0,Â j);Â Â Â Â pwm.setPWM(2,Â 0,Â j);Â Â Â Â pwm.setPWM(8,Â 0,Â j);Â Â Â Â pwm.setPWM(9,Â 0,Â j);Â Â Â Â pwm.setPWM(10,Â 0,Â j);Â Â Â Â delay(50);Â Â &#125;Â Â forÂ (intÂ jÂ &#x3D;Â 500;Â jÂ &gt;Â 200;Â j-&#x3D;20)&#123;Â Â Â Â pwm.setPWM(1,Â 0,Â j);Â Â Â Â pwm.setPWM(8,Â 0,Â j);Â Â Â Â pwm.setPWM(9,Â 0,Â j);Â Â Â Â pwm.setPWM(10,Â 0,Â j);Â Â Â Â delay(50);Â Â &#125;Â Â delay(1000);Â Â forÂ (intÂ jÂ &#x3D;Â 200;Â jÂ &lt;Â 500;Â j+&#x3D;20)&#123;Â Â Â Â pwm.setPWM(1,Â 0,Â j);Â Â Â Â pwm.setPWM(8,Â 0,Â j);Â Â Â Â pwm.setPWM(9,Â 0,Â j);Â Â Â Â pwm.setPWM(10,Â 0,Â j);Â Â Â Â delay(50);Â Â &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><div class="video-container"><iframe src="https://www.youtube.com/embed/wTggtKVo-J0" frameborder="0" loading="lazy" allowfullscreen></iframe></div><p><strong>ä½¿ç”¨å½æ›²å‚³æ„Ÿå™¨æ§åˆ¶æ§åˆ¶æ©Ÿæ¢°æ‰‹æŒ</strong></p><p><strong>é¦–å…ˆè¦å…ˆè£½ä½œå½æ›²å‚³æ„Ÿå™¨ï¼Œç„¶å¾Œå¼„æˆæ‰‹å¥—ï¼Œå¯åƒè€ƒä¸‹ç¯‡</strong></p><p><strong>è‡ªåˆ¶å½æ›²å‚³æ„Ÿå™¨</strong>-<a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/7905812487640359234?hl=zh-TW#">https://blairandreamwork.blogspot.com/2021/06/blog-post.html</a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/7905812487640359234?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-D3lE7P9mMmw/YMBU9n19qnI/AAAAAAAAePg/HPT9v777qowytoJeRRA6KTseyVA99vZ3gCNcBGAsYHQ/s1600/1623217351043061-0.png"></a></p><hr><p><strong>åƒä¸Šåœ–å¼„å¥½ä»¥å¾Œï¼Œå…ˆæ¸¬é‡æ¯ä¸€å€‹æ„Ÿæ¸¬å™¨çš„æ•¸å€¼å€é–“ï¼Œæˆ‘ç™¼ç¾è‡ªåˆ¶çš„æ„Ÿæ¸¬å™¨æ²’æœ‰å¾ˆç©©å®šï¼Œæ•¸å€¼æœƒæœ‰é»äº‚è·³ï¼Œæ‰€ä»¥æˆ‘æŠŠæ„Ÿæ¸¬çš„æ™‚é–“èª¿é«˜ä¸€é»ï¼Œä¸è¦è®“å®ƒåµæ¸¬å¤ªé »ç¹ã€‚</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;Wire.h&gt;#include &lt;Adafruit_PWMServoDriver.h&gt;#define SERVO_FREQ 60Â &#x2F;&#x2F;Â AnalogÂ servosÂ runÂ atÂ ~50Â HzÂ updates&#x2F;&#x2F;angleMax&#x3D;600&#x2F;&#x2F;angleMin&#x3D;150Adafruit_PWMServoDriverÂ pwmÂ &#x3D;Â Adafruit_PWMServoDriver();  intÂ valOne;intÂ valTwo;intÂ valthree;intÂ valfour;intÂ valfive;intÂ sensor_One&#x3D;A0;intÂ sensor_Two&#x3D;A1;intÂ sensor_three&#x3D;A2;intÂ sensor_four&#x3D;A3;intÂ sensor_five&#x3D;A6;  voidÂ setup()&#123;Â Â Serial.begin(9600);Â Â pinMode(sensor_One,Â INPUT);Â Â pinMode(sensor_Two,Â INPUT);Â Â pinMode(sensor_three,Â INPUT);Â Â pinMode(sensor_four,Â INPUT);Â Â pinMode(sensor_five,Â INPUT);Â Â pwm.begin();Â Â pwm.setOscillatorFrequency(27000000);Â Â pwm.setPWMFreq(SERVO_FREQ);Â Â &#x2F;&#x2F;Â AnalogÂ servosÂ runÂ atÂ ~50Â HzÂ updatesÂ Â delay(10);&#125;voidÂ loop()&#123;Â Â valOne&#x3D;analogRead(sensor_One);Â Â valOne&#x3D;map(valOne,Â 90,Â 140,Â 200,Â 600);Â Â valTwo&#x3D;analogRead(sensor_Two);Â Â valTwo&#x3D;map(valTwo,Â 90,Â 140,Â 200,Â 600);Â Â valthree&#x3D;analogRead(sensor_three);Â Â valthree&#x3D;map(valthree,Â 90,Â 150,Â 200,Â 600);Â Â valfour&#x3D;analogRead(sensor_four);Â Â valfour&#x3D;map(valfour,Â 90,Â 150,Â 200,Â 600);Â Â valfive&#x3D;analogRead(sensor_five);Â Â valfive&#x3D;map(valfive,Â 90,Â 150,Â 200,Â 600);Â Â ifÂ (valOne&lt;200)&#123;Â Â Â Â valOne&#x3D;200;Â Â &#125;Â Â if(valOne&gt;600)&#123;Â Â Â Â valOne&#x3D;600;Â Â &#125;Â Â Serial.println(valOne);Â Â pwm.setPWM(1,Â 0,Â valOne);  Â Â ifÂ (valTwo&lt;200)&#123;Â Â Â Â valTwo&#x3D;200;Â Â &#125;Â Â if(valTwo&gt;600)&#123;Â Â Â Â valTwo&#x3D;600;Â Â &#125;Â Â Serial.println(valTwo);Â Â pwm.setPWM(2,Â 0Â ,valTwo);  Â Â ifÂ (valthree&lt;200)&#123;Â Â Â Â valthree&#x3D;200;Â Â &#125;Â Â if(valthree&gt;600)&#123;Â Â Â Â valthree&#x3D;600;Â Â &#125;Â Â Serial.println(valthree);Â Â pwm.setPWM(8,Â 0Â ,valthree);  Â Â ifÂ (valfour&lt;200)&#123;Â Â Â Â valfour&#x3D;200;Â Â &#125;Â Â if(valfour&gt;600)&#123;Â Â Â Â valfour&#x3D;600;Â Â &#125;Â Â Serial.println(valfour);Â Â pwm.setPWM(9,Â 0Â ,valfour);  Â Â ifÂ (valfive&lt;200)&#123;Â Â Â Â valfive&#x3D;200;Â Â &#125;Â Â if(valfive&gt;600)&#123;Â Â Â Â valfive&#x3D;600;Â Â &#125;Â Â Serial.println(valfive);Â Â pwm.setPWM(10,Â 0Â ,valfive);Â Â delay(400);Â Â Serial.println(&quot;------&quot;);&#125;  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p><strong>é›–ç„¶æ²’æœ‰å®Œç¾ï¼Œä½†æˆ‘æƒ³é–‹å§‹è‘—æ‰‹åšï¼“ï¼¤åˆ—å°çš„æ©Ÿæ¢°æ‰‹æŒï¼Œä¸¦ä½¿ç”¨å¸‚é¢ä¸Šçš„å½æ›²å‚³æ„Ÿå™¨è©¦è©¦ã€‚</strong></p><div class="video-container"><iframe src="https://www.youtube.com/embed/8QkrvWnMkRA" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> arduino </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hand robot </tag>
            
            <tag> å½æ›²å‚³æ„Ÿå™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è‡ªåˆ¶å½æ›²å‚³æ„Ÿå™¨</title>
      <link href="/2021/09/03/zi-zhi-wan-qu-chuan-gan-qi-arduino/"/>
      <url>/2021/09/03/zi-zhi-wan-qu-chuan-gan-qi-arduino/</url>
      
        <content type="html"><![CDATA[<h1 id="è‡ªåˆ¶å½æ›²å‚³æ„Ÿå™¨"><a href="#è‡ªåˆ¶å½æ›²å‚³æ„Ÿå™¨" class="headerlink" title="è‡ªåˆ¶å½æ›²å‚³æ„Ÿå™¨"></a>è‡ªåˆ¶å½æ›²å‚³æ„Ÿå™¨</h1><h6 id="tags-arduino-å½æ›²å‚³æ„Ÿå™¨-flex-sensor"><a href="#tags-arduino-å½æ›²å‚³æ„Ÿå™¨-flex-sensor" class="headerlink" title="tags: arduino å½æ›²å‚³æ„Ÿå™¨ flex_sensor"></a>tags: <code>arduino</code> <code>å½æ›²å‚³æ„Ÿå™¨</code> <code>flex_sensor</code></h6><p><em>å‰é™£å­çœ‹äº†å¹³å°ä¸Šä¸€ä½è€å¸«è©¦ç¯„è¶…ä½æˆæœ¬åˆ¶ä½œå½æ›²å‚³æ„Ÿå™¨</em><br><em>ä¸»è¦ä½¿ç”¨é‰›ç­†ç¢³ç²‰ç‚ºå°é«”åˆ¶ä½œå½æ›²å‚³æ„Ÿå™¨ï¼Œæ±ºå®šä¹Ÿä¾†è©¦è©¦</em><br><em>æ–¼æ˜¯è²·äº†å¿…é ˆçš„ææ–™ï¼Œä½†å¯èƒ½æˆ‘æ²’æŒæ¡å¥½æŠ€å·§ï¼Œåœ¨å¡—æ»¿ç¢³</em><br><em>ç²‰çš„ç´™ä¸Šå§‹çµ‚é‡ä¸åˆ°é˜»å€¼ï¼Œæ’ä¸ŠArduinoä¹Ÿç„¡æ³•è®€å–åˆ°æ•¸å€¼</em><br><em>ï¼Œæœ‰é»å¤±æœ›ä¹‹é¤˜ä½†ä¸æ”¾æ£„çš„ç¿»éç¶²è·¯è³‡æºï¼Œç™¼ç¾æœ‰ä¸€ç¨®å«</em><br><em>çŸ³å¢¨ç‰‡çš„æ±è¥¿ï¼Œä¸€èˆ¬æ˜¯æ‹¿ä¾†åšæ•£ç†±ç”¨çš„ï¼Œä½†å®ƒä¹Ÿå…¼å…·å°é›»</em><br><em>çš„ç‰¹æ€§ï¼Œæœ‰äººå°±æ‹¿å®ƒä¾†åšå½æ›²å‚³æ„Ÿå™¨ï¼Œæ–¼æ˜¯æˆ‘è¦çš®äº†äº”ç‰‡</em><br><em>ç´„200å…ƒï¼Œåˆ¶ä½œäº†ä¸€ç‰‡æˆåŠŸäº†ã€‚</em></p><div class="video-container"><iframe src="https://www.youtube.com/embed/8UyBq3EuvSg" frameborder="0" loading="lazy" allowfullscreen></iframe></div> <p><em>å› ç‚ºå‰ä¸€ç¯‡æœ‰ç´€éŒ„æˆ‘æ‰‹å·¥åšäº†HandRobotï¼Œä¹Ÿæƒ³åŠ å…¥å½æ›²å‚³æ„Ÿå™¨ä¾†æ§åˆ¶</em><br><em>ä¸€ç•ªï¼Œé€™ç¯‡å°±å…ˆç´€éŒ„å¦‚ä½•åˆ¶æˆå½æ›²å‚³æ„Ÿå™¨ã€‚</em></p><h2 id="æ‰€é ˆææ–™"><a href="#æ‰€é ˆææ–™" class="headerlink" title="æ‰€é ˆææ–™"></a>æ‰€é ˆææ–™</h2><ul><li>  <strong>çŸ³å¢¨ç‰‡</strong></li><li>  <strong>å¡‘è† ç‰‡</strong></li><li>  <strong>è»Ÿè³ªè³‡æ–™å¤¾</strong></li><li>  <strong>ç´™è† å¸¶</strong></li><li>  <strong>é€æ˜è† å¸¶</strong></li><li>  <strong>æœé‚¦ç·š</strong></li><li>  <strong>å‰ªåˆ€ï¼ç¾å·¥åˆ€</strong></li></ul><hr><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/9058503509549070481#"><img src="https://lh3.googleusercontent.com/-weHYIvYSE4w/YLcjjRvdUYI/AAAAAAAAePE/W1Fic7dVHiAjgg4ux7ObQgRW-dcE4eQ8gCNcBGAsYHQ/s1600/1622614901889734-0.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/9058503509549070481#"><img src="https://lh3.googleusercontent.com/--hUt9X9niNU/YLcjdW1qgGI/AAAAAAAAeO8/Pr88EuribcEUZptKjVplNNbAi-xWac6aQCNcBGAsYHQ/s1600/1622614881216679-1.png"></a></p><p><em>çŸ³å¢¨ç‰‡ä¾ç…§10.5å…¬åˆ†x1å…¬åˆ†è£åˆ‡ï¼Œå¡‘è† ç‰‡10.5x1.3cmè£åˆ‡</em></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/9058503509549070481#"><img src="https://lh3.googleusercontent.com/-VJC7QLGZdXs/YLcjYOh4QcI/AAAAAAAAeO0/P2mUyTpm-UA9c2WLRQiATPt7niU8A2WAgCNcBGAsYHQ/s1600/1622614859874661-2.png"></a></p><p><em>å°‡æœé‚¦ç·šæˆ–å¯¦å¿ƒå°ç·šå‰ç·šç´„10cmé»æ–¼ç´™è† å¸¶ä¸Š(ç´™è† å¸¶æœ€å¥½æ¯”çŸ³å¢¨ç‰‡é•·åº¦é•·ä¸€é»)</em></p><p>*<strong>å…©å°ç·šä¸è¦ç¢°è§¸åœ¨ä¸€èµ·</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/9058503509549070481#"><img src="https://lh3.googleusercontent.com/-xTDGNhvMLdI/YLcjS8bEPmI/AAAAAAAAeOs/RKc-b0OFIrM9a70QvNtTCkLbktUXJ3WjACNcBGAsYHQ/s1600/1622614842294395-3.png"></a></p><p>å°‡çŸ³å¢¨ç‰‡(å°é›»ç«¯)è¦†è“‹æ–¼å…©å°ç·šä¸Šï¼Œå°ç·šå¦ä¸€ç«¯ç´™è† å¸¶å¾€ä¸‹æ‘ºï¼Œå†å°‡å·¦é‚Šå¾€å³æ‘ºï¼Œå³é‚Šå¾€å·¦æ‘ºï¼Œå½¢æˆåŒ…è£ä½å°ç·šç‹€ï¼ˆè¦‹ä¸‹åœ–ï¼‰</p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/9058503509549070481#"><img src="https://lh3.googleusercontent.com/-AMYVzDf5de0/YLcjORW0uWI/AAAAAAAAeOo/SI7ptJRVgXA6z5UkUpcLM32blkKNwB53ACNcBGAsYHQ/s1600/1622614825498548-4.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/9058503509549070481#"><img src="https://lh3.googleusercontent.com/-s6Tw9eBSm_g/YLcjKFlzhSI/AAAAAAAAeOg/E1LRu73TdWIXUU_lyV9YLl8KF-MidzDMwCNcBGAsYHQ/s1600/1622614803703709-5.png"></a></p><p>ç„¶å¾Œå…©ç«¯ç”¨é€æ˜è† å¸¶é»ä½</p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/9058503509549070481#"><img src="https://lh3.googleusercontent.com/-QI6nCi-BjI8/YLcjEvasU3I/AAAAAAAAeOU/RUxZuvvVoQE6UMPBDY4zznDDE7Up8nZuwCNcBGAsYHQ/s1600/1622614778268390-6.png"></a></p><p>å°‡å‰›è£å¥½çš„å¡‘è† ç‰‡å’Œè³‡æ–™å¤¾å‰ªè·Ÿå¡‘è† ç‰‡ä¸€æ¨£é•·å¯›ï¼ŒæŠŠå°è£å¥½çš„çŸ³å¢¨ç‰‡åƒä¸‰æ˜æ²»é€™æ¨£å¤¾æ–¼ä¸­é–“</p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/9058503509549070481#"><img src="https://lh3.googleusercontent.com/-UKiFPpgQKfY/YLci-b1hq8I/AAAAAAAAeOM/lGoZ6GuyI78tLlrTjMnc-UtQEw3v8hbVgCNcBGAsYHQ/s1600/1622614761393534-7.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/9058503509549070481#"><img src="https://lh3.googleusercontent.com/-1R2fHZzB8cM/YLci6LlhuiI/AAAAAAAAeOI/kIz84JS-2pEcid2yfwfrfKe-6mMmUrRnQCNcBGAsYHQ/s1600/1622614744408843-8.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/9058503509549070481#"><img src="https://lh3.googleusercontent.com/-D23T5DFXP-g/YLci19YnQvI/AAAAAAAAeOE/JrprQbZPEYUl6Rv-AbYy1tFNEzD07mGMgCNcBGAsYHQ/s1600/1622614724811115-9.png"></a></p><p>å…©ç«¯å†ç”¨è† å¸¶å°ä½</p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/9058503509549070481#"><img src="https://lh3.googleusercontent.com/-E86mtiYdIr0/YLciw5O7V4I/AAAAAAAAeOA/ZHeGmGcxcLscXSVbAWJtQ1D6clpm5G6CQCNcBGAsYHQ/s1600/1622614701415792-10.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/9058503509549070481#"><img src="https://lh3.googleusercontent.com/-7iowwImDqLw/YLcirEQG1GI/AAAAAAAAeN8/hWY8kY14u4UbaxmqlN5XaM89R1FjLNjBgCNcBGAsYHQ/s1600/1622614674841483-11.png"></a></p><hr><h2 id="æ¥ç·šåœ–"><a href="#æ¥ç·šåœ–" class="headerlink" title="æ¥ç·šåœ–"></a>æ¥ç·šåœ–</h2><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/9058503509549070481#"><img src="https://1.bp.blogspot.com/-BO4fv-os1c0/YLcpnnCMLPI/AAAAAAAAePQ/yVp3vJkEEDU_Td9Sd1GvCxaZhbxmY4kwwCNcBGAsYHQ/w530-h247/%25E5%25BD%258E%25E6%259B%25B2%25E5%2582%25B3%25E6%2584%259F%25E5%2599%25A8%25E6%258E%25A5%25E7%25B7%259A%25E5%259C%2596.jpg"></a></p><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">intÂ val;intÂ sensor&#x3D;A0;voidÂ setup()&#123;Â Â Serial.begin(115200);Â Â pinMode(sensor,Â INPUT);&#125;voidÂ loop()Â &#123;Â Â val&#x3D;analogRead(sensor);Â Â Serial.println(val);Â Â delay(500);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŠ å…¥ä¼ºæœé¦¬é”</p><p>ï¼Šå½æ›²å‚³æ„Ÿå™¨é‡æ¸¬åˆ°çš„æ•¸å€¼ä¸ä¸€ï¼Œæ‰€ä»¥è¦è‡ªå·±æ¸¬é‡æœ€å¤§å’Œæœ€å°å€¼å†è½‰æ›å°æ‡‰è§’åº¦</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;Servo.h&gt;ServoÂ myservo;  intÂ sensor&#x3D;A0;intÂ val;  voidÂ setup()Â &#123;Â Â myservo.attach(9);Â Â myservo.write(170);Â Â Serial.begin(9600);&#125;voidÂ loop()Â &#123;Â Â val&#x3D;analogRead(sensor);Â Â val&#x3D;map(val,3,Â 20,Â 0,Â 180);Â Â ifÂ (val&gt;180)&#123;Â Â Â Â val&#x3D;180;Â Â &#125;Â Â ifÂ (val&lt;0)&#123;Â Â Â Â val&#x3D;0;Â Â &#125;Â Â myservo.write(val);Â Â Serial.println(val);Â Â delay(450);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><div class="video-container"><iframe src="https://www.youtube.com/embed/Hnzlbz5yTus" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> arduino </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å½æ›²å‚³æ„Ÿå™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è£½ä½œå…æŒç´…å¤–ç·šé«”æº«å™¨</title>
      <link href="/2021/09/03/zhi-zuo-mian-chi-hong-wai-xian-ti-wen-qi-arduino/"/>
      <url>/2021/09/03/zhi-zuo-mian-chi-hong-wai-xian-ti-wen-qi-arduino/</url>
      
        <content type="html"><![CDATA[<h1 id="è£½ä½œå…æŒç´…å¤–ç·šé«”æº«å™¨"><a href="#è£½ä½œå…æŒç´…å¤–ç·šé«”æº«å™¨" class="headerlink" title="è£½ä½œå…æŒç´…å¤–ç·šé«”æº«å™¨"></a>è£½ä½œå…æŒç´…å¤–ç·šé«”æº«å™¨</h1><h6 id="tags-arduino"><a href="#tags-arduino" class="headerlink" title="tags: arduino"></a>tags: <code>arduino</code></h6><p>æœ‰æ„Ÿæ–¼æ–°å† è‚ºç—…æ¯’çš„æ“´æ•£ï¼ŒåŸæœ¬èº«åœ¨å°ç£æ„Ÿè¦ºé‚„ç®—å®‰å…¨ï¼Œä½†éš¨è‘—æ™‚é–“å’Œæ”¿ç­–<br>ç—…æ¯’æ‚„ç„¶åœ¨å°ç£æ“´æ•£ï¼Œå¤§å®¶å‡ºé–€çš„åŸºæœ¬åŠŸå°±æ˜¯å£ç½©ï¼Œé…’ç²¾ï¼Œé«”æº«å™¨ã€‚èº«ç‚ºä¸€<br>å€‹å°å°ç­è‡ªç ”å‰µå®¢ï¼Œç•¶ç„¶è¦æŠŠè‡ªå·±åœ¨ç ”ç©¶çš„æ±è¥¿ç”¨æ–¼ç¾å¯¦ç”Ÿæ´»ä¸Šï¼Œå …æŒâ€ä¸åªæ˜¯ç©ç©ï¼‚çš„å¿ƒæ…‹ã€‚<br>æœ€è¿‘äºŒå€‹æœˆå…¬å¸ä¸€æ—©çš„æœæœƒéƒ½å›ºå®šè¦é‡é«”æº«ï¼Œç”¨æ‰‹æŒç´…å¤–ç·šæ¸¬æº«ï¼Œæ‰€ä»¥æˆ‘æƒ³<br>ç”¨ï¼“ï¼¤åˆ—å°å€‹å¤–æ®¼ï¼Œåšå€‹æ›å£å…æŒçš„ç´…å¤–ç·šé«”æº«å™¨çµ¦å…¬å¸åŒä»ä½¿ç”¨ã€‚</p><p>å› ç‚ºè¿‘æœŸç¶²è·¯ä¸Šå·²ç¶“å¾ˆå¤šå‰µå®¢å¤§å¤§åšå‡ºç›¸é—œæˆå“ï¼Œæˆ‘ä¹Ÿçœ‹ä¸­ä¸€å€‹â€åœ‹å¤–â€ä¸éŒ¯çš„å°ˆæ¡ˆ<br>æ‰€ä»¥æˆ‘å°±ç›´æ¥è½‰æˆä¸­æ–‡æŠŠé‡é»è½‰ç§»éä¾†ï¼Œç•¶å€‹å¯¦ä½œç´€éŒ„ã€‚</p><p>åƒè€ƒç¶²å€ï¼š<a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#">https://www.instructables.com/DIY-Non-Contact-IR-Thermometer/</a></p><p>ï¼ˆç”³æ˜ï¼šä»¥ä¸‹ç´€éŒ„å’Œåœ–ç‰‡æ˜¯åŸºæ–¼è½‰è²¼å¤§éƒ¨ä»½å’Œç¿»ç‚ºä¸­æ–‡ï¼Œæ–¹ä¾¿è‡ªå·±å­¸ç¿’ä½¿ç”¨</p><p>The following records are based on records and are convenient for self-learning, so use reposting most of the content and some picturesï¼‰</p><p>æ™®é€šçš„ç´…å¤–æº«åº¦è¨ˆå¯ä»¥æ¸¬é‡æ–°å† æ‚£è€…çš„é«”æº«ï¼Œä¹Ÿå¯èƒ½å‚³æ’­ç—…æ¯’ã€‚æ‰‹æŒå¼æº«åº¦è¨ˆçš„ä¸»è¦ç¼ºé»æ˜¯å…¶æ€§èƒ½å–æ±ºæ–¼æ“ä½œè€…å’Œåˆ°é¡é ­çš„è·é›¢ã€‚ç‚ºäº†è§£æ±ºé€™äº›å•é¡Œï¼Œè£½é€ äº†ä¸€ç¨®å¯ä»¥å®‰è£åœ¨ç‰†ä¸Šçš„è¨­å‚™ï¼Œç„¡éœ€æ“ä½œå“¡å³å¯åœ¨å…¬å…±å€åŸŸé€²è¡Œç™¼ç‡’ç¯©æŸ¥ã€‚ç•¶å‚³æ„Ÿå™¨èˆ‡é¡é ­ä¹‹é–“çš„è·é›¢è¶³å¤ æ™‚ï¼Œç¡¬ä»¶å¯ä»¥è‡ªå‹•æ¸¬é‡äººé«”æº«åº¦ã€‚</p><p><strong><em>æ‰€éœ€çµ„ä»¶</em></strong>  </p><p>1. Arduino Nano  </p><p>2. GY-906 æº«åº¦å‚³æ„Ÿå™¨  </p><p>3. OLED é¡¯ç¤ºå™¨  </p><p>4. IRç´…å¤–å‚³æ„Ÿå™¨  </p><p>5. TP4056 å……é›»å™¨æ¨¡å¡Š  </p><p>6. 18650 é›»æ±   </p><p>7. 18650 é›»æ± åº§  </p><p>8. 5 V DC-DC å‡å£“è½‰æ›å™¨ï¼ˆäºé¦¬éœï¼‰  </p><p>9. åˆ‡æ›é–‹é—œ -15 Ã— 21 æ¯«ç±³  </p><p>10. 5 æ¯«ç±³ç¶ è‰² LED  </p><p>11. 5 æ¯«ç±³ç´…è‰² LED  </p><p>12. 2 x 330 æ­å§†é›»é˜»å™¨  </p><p>13.å£“é›»èœ‚é³´å™¨  </p><p>14. Header Pins  </p><p>15. æœé‚¦ç·š  </p><p>16. è·³ç·š  </p><h2 id="ç¬¬-1-æ­¥ï¼šå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ"><a href="#ç¬¬-1-æ­¥ï¼šå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ" class="headerlink" title="ç¬¬ 1 æ­¥ï¼šå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ"></a>ç¬¬ 1 æ­¥ï¼šå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</h2><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://content.instructables.com/ORIG/FKN/640Y/KP9RKLKY/FKN640YKP9RKLKY.jpg?auto=webp&frame=1&width=933&fit=bounds&md=246ad4f70f666e246570b8147de4cdac"></a></p><p>å·¥ä½œåŸç†å¾ˆç°¡å–®ï¼Œç´…å¤–æ¸¬æº«å‚³æ„Ÿå™¨MLX90614åœ¨é¡é ­èˆ‡å‚³æ„Ÿå™¨ä¹‹é–“çš„è·é›¢ï¼ˆç”±ç´…å¤–å‚³æ„Ÿå™¨æ¸¬é‡ï¼‰åŒ¹é…è¨­å®šå€¼æ™‚è®€å–äººé«”æº«åº¦ã€‚å‚³æ„Ÿå™¨è®€æ•¸ç™¼é€åˆ° Arduino é€²è¡Œè™•ç†ï¼Œè™•ç†å¾Œçš„å€¼é¡¯ç¤ºåœ¨ 0.96â€™ OLED é¡¯ç¤ºå±ä¸Šã€‚  </p><p>é™¤äº† OLED é¡¯ç¤ºå±å¤–ï¼Œé‚„ä½¿ç”¨äº†å…©å€‹ LED å’Œä¸€å€‹èœ‚é³´å™¨ä¾†æŒ‡ç¤ºè¼¸å‡ºã€‚  </p><p>1ã€ç•¶é«”æº«æ­£å¸¸æ™‚ï¼Œç¶ è‰²LEDï¼ˆLED1ï¼‰äº®ï¼Œèœ‚é³´å™¨é³´å«ã€‚  </p><p>2. ç•¶é«”æº«é«˜æ–¼ 37.7æ”æ°åº¦æ™‚ï¼Œç´…è‰² LED ( LED2 ) æœƒäº®èµ·ï¼Œèœ‚é³´å™¨æœƒç™¼å‡ºè¼ƒé•·æ™‚é–“çš„å—¶å—¶è²ã€‚  </p><h2 id="ç¬¬-2-æ­¥ï¼šé›»æº"><a href="#ç¬¬-2-æ­¥ï¼šé›»æº" class="headerlink" title="ç¬¬ 2 æ­¥ï¼šé›»æº"></a>ç¬¬ 2 æ­¥ï¼šé›»æº</h2><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://content.instructables.com/ORIG/FL6/3XIC/KP9RKQ5O/FL63XICKP9RKQ5O.png?auto=webp&frame=1&width=989&fit=bounds&md=f4cb0be5029dc114271993894e131fd1"></a></p><p>æ•´å€‹é›»è·¯æ‰€éœ€çš„é›»æºç”±å…©ç¯€18650é›»æ± æä¾›ã€‚å…©å¡Šé›»æ± ä¸¦è¯é€£æ¥ä»¥è£½ä½œæ›´é«˜å®¹é‡çš„é›»æ± çµ„ä»¥ç²å¾—æ›´é•·çš„å‚™ä»½æ™‚é–“ã€‚é›»æ± çµ„ç”± TP4056 å……é›»å™¨æ¨¡å¡Šå……é›»ã€‚  </p><p>ä½¿ç”¨å‡å£“è½‰æ›å™¨æ¨¡å¡Šï¼ˆMT3608ï¼‰å°‡é›»æ± çµ„é›»å£“å‡è‡³7Vã€‚ç„¶å¾Œå‡å£“è½‰æ›å™¨çš„è¼¸å‡ºé€£æ¥åˆ° Arduino çš„ Vin å¼•è…³ã€‚  </p><p>ä¸€å€‹åˆ‡æ›é–‹é—œæ”¾ç½®åœ¨å……é›»å™¨æ¨¡å¡Š TP4056 è¼¸å‡ºå’Œå‡å£“è½‰æ›å™¨ä¹‹é–“ã€‚</p><h2 id="ç¬¬-3-æ­¥ï¼šæº–å‚™-Arduino-å’Œæº«åº¦å‚³æ„Ÿå™¨æ¿"><a href="#ç¬¬-3-æ­¥ï¼šæº–å‚™-Arduino-å’Œæº«åº¦å‚³æ„Ÿå™¨æ¿" class="headerlink" title="ç¬¬ 3 æ­¥ï¼šæº–å‚™ Arduino å’Œæº«åº¦å‚³æ„Ÿå™¨æ¿"></a>ç¬¬ 3 æ­¥ï¼šæº–å‚™ Arduino å’Œæº«åº¦å‚³æ„Ÿå™¨æ¿</h2><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://content.instructables.com/ORIG/F0O/VDDJ/KP9RKQAW/F0OVDDJKP9RKQAW.jpg?auto=webp&frame=1&width=799&height=1024&fit=bounds&md=d8cf21f11e1db08b6ca97c2d682405a8"></a></p><h2 id="ç¬¬-4-æ­¥ï¼šMLX90614-ç´…å¤–æº«åº¦å‚³æ„Ÿå™¨"><a href="#ç¬¬-4-æ­¥ï¼šMLX90614-ç´…å¤–æº«åº¦å‚³æ„Ÿå™¨" class="headerlink" title="ç¬¬ 4 æ­¥ï¼šMLX90614 ç´…å¤–æº«åº¦å‚³æ„Ÿå™¨"></a>ç¬¬ 4 æ­¥ï¼šMLX90614 ç´…å¤–æº«åº¦å‚³æ„Ÿå™¨</h2><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://content.instructables.com/ORIG/FP0/3KWQ/KP9RKQD4/FP03KWQKP9RKQD4.jpg?auto=webp&frame=1&width=591&fit=bounds&md=d887a37f17bfbfc3f1ca1a27ecac2001"></a></p><p>MLX90614 æ˜¯ä¸€æ¬¾ç”¨æ–¼éæ¥è§¸å¼æº«åº¦æ¸¬é‡çš„ç´…å¤–æ¸¬æº«å„€ï¼Œèƒ½å¤ æ¸¬é‡ -70 è‡³ 380Â°C ä¹‹é–“çš„æº«åº¦ã€‚è©²å‚³æ„Ÿå™¨æ¡ç”¨ç´…å¤–æ•æ„Ÿç†±é›»å †æ¢æ¸¬å™¨èŠ¯ç‰‡å’Œä¿¡è™Ÿèª¿ç¯€ASICé›†æˆåœ¨ä¸€å€‹èŠ¯ç‰‡ä¸­ã€‚å®ƒåŸºæ–¼ Stefan-Boltzmann å®šå¾‹å·¥ä½œï¼Œè©²å®šå¾‹æŒ‡å‡ºæ‰€æœ‰ç‰©é«”éƒ½æœƒç™¼å°„ IR èƒ½é‡ï¼Œä¸¦ä¸”è©²èƒ½é‡çš„å¼·åº¦å°‡èˆ‡è©²ç‰©é«”çš„æº«åº¦æˆæ­£æ¯”ã€‚å‚³æ„Ÿå™¨ä¸­çš„å‚³æ„Ÿå–®å…ƒæ¸¬é‡ç›®æ¨™ç‰©é«”ç™¼å°„äº†å¤šå°‘ç´…å¤–èƒ½é‡ï¼Œè¨ˆç®—å–®å…ƒä½¿ç”¨ 17 ä½å…§ç½® ADC å°‡å…¶è½‰æ›ç‚ºæº«åº¦å€¼ï¼Œä¸¦é€šé I2C é€šä¿¡å”è­°è¼¸å‡ºæ•¸æ“šã€‚  </p><p>å‚³æ„Ÿå™¨æ¸¬é‡ç‰©é«”æº«åº¦å’Œç’°å¢ƒæº«åº¦ä»¥æ ¡æº–ç‰©é«”æº«åº¦å€¼ã€‚ MLX 90614 å‚³æ„Ÿå™¨å¯ä»¥è®€å– -40 åˆ° 125 ËšCï¼ˆ-40 åˆ° 257 Â°Fï¼‰ç¯„åœå…§çš„ç’°å¢ƒæº«åº¦å’Œ -70 åˆ° 380 ËšCï¼ˆ-94 åˆ° 716 Â°Fï¼‰ç¯„åœå…§çš„ç‰©é«”æº«åº¦ã€‚  </p><p>ç´…å¤–æ¸¬æº«å„€èˆ‡ Arduino çš„é€£æ¥éå¸¸ç°¡å–®ï¼Œå› ç‚ºå®ƒåƒè¨±å¤šå…¶ä»–çµ„ä»¶ä¸€æ¨£ä½¿ç”¨ I2C é€šä¿¡æ¥å£ã€‚<br>MLX90614 æº«åº¦è¨ˆæœ‰ 4 å€‹å¼•è…³ï¼šVINã€GNDã€SCL å’Œ SDAã€‚  </p><p><strong><em>é€£æ¥æ‡‰å¦‚ä¸‹æ‰€ç¤ºï¼š</em></strong>  </p><p>Arduinoâ€”â€”MLX 90614  </p><p>5V â€” VIN  </p><p>GDNâ€”â€”GDN  </p><p>A5 â€”- SCL  </p><p>A4 â€”- SDA</p><h2 id="æ­¥é©Ÿ-5ï¼šæº–å‚™é›»æ± çµ„"><a href="#æ­¥é©Ÿ-5ï¼šæº–å‚™é›»æ± çµ„" class="headerlink" title="æ­¥é©Ÿ 5ï¼šæº–å‚™é›»æ± çµ„"></a>æ­¥é©Ÿ 5ï¼šæº–å‚™é›»æ± çµ„</h2><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://content.instructables.com/ORIG/FQQ/CP6E/KP9RKRBE/FQQCP6EKP9RKRBE.jpg?auto=webp&frame=1&width=410&height=1024&fit=bounds&md=6cdfd2f31060c20fac2ddff3133abb7f"></a></p><p>æˆ‘å€‘å¿…é ˆå°‡å…©å€‹ 18650 é›»æ± ä¸¦è¯ã€‚æˆ‘ç”¨éçš„é›»æ± æ§½æ˜¯ä¸€å€‹å…©æ§½åº§ï¼Œå¸¶æœ‰ç¨ç«‹çš„æ¥ç·šç«¯å­ç”¨æ–¼é€£æ¥ã€‚è¦é€²è¡Œä¸¦è¯ï¼Œè«‹ä½¿ç”¨ä¸€æ ¹é›»ç·šå°‡æ¯å´çš„å…©å€‹ç«¯å­é€£æ¥åœ¨ä¸€èµ·ã€‚  </p><p>é¦–å…ˆåœ¨ç«¯å­ä¸Šå¡—æŠ¹å°‘é‡åŠ©ç„ŠåŠ‘ï¼Œç„¶å¾Œä½¿ç”¨é›»ç·šå°‡å®ƒå€‘çŸ­è·¯ã€‚  </p><p>æ¥ä¸‹ä¾†å°‡ç´…è‰²å»¶é•·ç·šç„Šæ¥åˆ°æ­£æ¥µç«¯å­ï¼Œå°‡é»‘è‰²é›»ç·šç„Šæ¥åˆ°é›»æ± åº§çš„è² æ¥µç«¯å­ã€‚</p><h2 id="ç¬¬-6-æ­¥ï¼šç´…å¤–æ¥è¿‘å‚³æ„Ÿå™¨"><a href="#ç¬¬-6-æ­¥ï¼šç´…å¤–æ¥è¿‘å‚³æ„Ÿå™¨" class="headerlink" title="ç¬¬ 6 æ­¥ï¼šç´…å¤–æ¥è¿‘å‚³æ„Ÿå™¨"></a>ç¬¬ 6 æ­¥ï¼šç´…å¤–æ¥è¿‘å‚³æ„Ÿå™¨</h2><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://content.instructables.com/ORIG/FV6/ODYQ/KP9RKRHV/FV6ODYQKP9RKRHV.jpg?auto=webp&frame=1&width=594&height=1024&fit=bounds&md=9ac11bdb80f34156dfdadf41cf76f219"></a></p><p>ç›®å‰ï¼Œæ‰‹æŒé«”æº«è¨ˆåœ¨ç™¼ç‡’ç¯©æŸ¥æ–¹é¢éå¸¸æµè¡Œã€‚ä½†æ˜¯ï¼Œæ‰‹æŒå¼æº«åº¦è¨ˆçš„æ€§èƒ½å–æ±ºæ–¼æ“ä½œè€…å’Œåˆ°é¡é ­çš„è·é›¢ã€‚ç‚ºäº†å…‹æœé€™äº›å•é¡Œï¼Œä½¿ç”¨ç´…å¤–ç·šæ¥è¿‘å‚³æ„Ÿå™¨ä¾†æ¸¬é‡å‚³æ„Ÿå™¨èˆ‡é¡é ­ä¹‹é–“çš„è·é›¢ï¼Œç•¶è·é›¢è¶³å¤ æ™‚ï¼Œå°‡æ„Ÿæ‡‰ä¸¦é¡¯ç¤ºæº«åº¦è®€æ•¸ã€‚é€™æ¨£ï¼Œæé«˜äº†æ¸¬é‡çš„æº–ç¢ºåº¦ã€‚  </p><p>æ‚¨å¯ä»¥é€šéèª¿ç¯€å‚³æ„Ÿå™¨æ¨¡å¡Šä¸Šçš„é›»ä½å™¨ä¾†è¨­ç½®æ¥è¿‘å‚³æ„Ÿå™¨åˆ°ç‰©é«”çš„æª¢æ¸¬è·é›¢ã€‚é †æ™‚é‡æ—‹è½‰é›»ä½å™¨å°‡å¢åŠ æª¢æ¸¬è·é›¢ï¼Œé€†æ™‚é‡æ—‹è½‰å°‡æ¸›å°‘æª¢æ¸¬è·é›¢ã€‚æˆ‘å·²å°‡æ­¤è·é›¢è¨­ç½®ç‚ºå¤§ç´„ 50 æ¯«ç±³ã€‚  </p><p>é€£æ¥æ‡‰å¦‚ä¸‹æ‰€ç¤ºï¼š  </p><p>Arduinoâ€”â€”ç´…å¤–å‚³æ„Ÿå™¨</p><p>3.3V â€” VCC</p><p>GNDâ€”â€”GND  </p><p>D9 â€”- OUT</p><h2 id="ç¬¬7æ­¥-OLED-Display"><a href="#ç¬¬7æ­¥-OLED-Display" class="headerlink" title="ç¬¬7æ­¥: OLED Display"></a>ç¬¬7æ­¥: OLED Display</h2><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://content.instructables.com/ORIG/FJ4/OEI5/KP9RKQI6/FJ4OEI5KP9RKQI6.jpg?auto=webp&frame=1&width=611&fit=bounds&md=ed51004eeb0b79efc5b1e676c42c0378"></a></p><p>é«”æº«é¡¯ç¤ºæ¡ç”¨0.96â€™ OLEDé¡¯ç¤ºå±ï¼Œåˆ†è¾¨ç‡ç‚º128x64ï¼Œæ¡ç”¨I2Cç¸½ç·šèˆ‡Arduinoé€šä¿¡ã€‚Arduino Nannoä¸­çš„å…©å€‹å¼•è…³SCLï¼ˆA5ï¼‰ï¼ŒSDAï¼ˆA4ï¼‰ç”¨æ–¼é€šä¿¡ã€‚  </p><p>æˆ‘æ­£åœ¨ä½¿ç”¨ Adafruit_SSD1306 åº«ä¾†é¡¯ç¤ºåƒæ•¸ã€‚  </p><p>é¦–å…ˆï¼Œæ‚¨å¿…é ˆä¸‹è¼‰ Adafruit_SSD1306ã€‚ç„¶å¾Œå®‰è£å®ƒã€‚  </p><p><strong><em>é€£æ¥æ‡‰å¦‚ä¸‹æ‰€ç¤ºï¼š</em></strong>  </p><p>Arduinoâ€”â€”OLED  </p><p>5V â€” VCC  </p><p>GNDâ€”â€”GND  </p><p>A4â€”-SDA  </p><p>A5â€”-SCL</p><h2 id="ç¬¬8æ­¥-LEDæŒ‡ç¤ºç‡ˆ"><a href="#ç¬¬8æ­¥-LEDæŒ‡ç¤ºç‡ˆ" class="headerlink" title="ç¬¬8æ­¥: LEDæŒ‡ç¤ºç‡ˆ"></a>ç¬¬8æ­¥: LEDæŒ‡ç¤ºç‡ˆ</h2><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://content.instructables.com/ORIG/FMD/2M2F/KP9RKQLI/FMD2M2FKP9RKQLI.jpg?auto=webp&frame=1&width=785&height=1024&fit=bounds&md=dd1f9e844e5326f077b06fef485a751b"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://content.instructables.com/ORIG/F49/O0R3/KP9RKQLE/F49O0R3KP9RKQLE.jpg?auto=webp&frame=1&width=397&height=1024&fit=bounds&md=9e516072d26a901b53d46dbaa83856b5"></a></p><p>å…©å€‹LEDç”¨æ–¼æŒ‡ç¤ºé«”æº«æ˜¯æ­£å¸¸é‚„æ˜¯ç•°å¸¸ã€‚ç¶ è‰² LED æŒ‡ç¤ºé«”æº«æ­£å¸¸ï¼Œç´…è‰² LED æŒ‡ç¤ºç•°å¸¸æƒ…æ³ï¼ˆç•¶æº«åº¦é«˜æ–¼ 104 è¯æ°åº¦æ™‚ï¼‰</p><p>ç¶ è‰² LED ( LED1 ) é€£æ¥åˆ° Arduino æ•¸å­—å¼•è…³ D3ï¼Œç´…è‰² LED ( LED2 ) é€£æ¥åˆ° D5ã€‚ç‚ºäº†é™åˆ¶ LED çš„é›»æµï¼Œä½¿ç”¨äº†å…©å€‹ 330 Î© é›»é˜»å™¨ã€‚å°‡é›»é˜»ç„Šæ¥åˆ° LED çš„æ­£æ¥µç«¯å­ã€‚ LED è¼ƒé•·çš„è…³æŒ‡ç¤ºæ­£æ¥µç«¯å­ã€‚  </p><p>å¦‚ä¸Šåœ–æ‰€ç¤ºï¼Œå°‡ 4 æ ¹è·³ç·šé€£æ¥åˆ° LEDã€‚é€™è£¡æˆ‘å¿…é ˆä½¿ç”¨æ¯-</p><p>æ¯è·³ç·šï¼Œä»¥ä¾¿æ–¼é€£æ¥ã€‚</p><h2 id="ç¬¬-9-æ­¥ï¼šè­¦å ±èœ‚é³´å™¨"><a href="#ç¬¬-9-æ­¥ï¼šè­¦å ±èœ‚é³´å™¨" class="headerlink" title="ç¬¬ 9 æ­¥ï¼šè­¦å ±èœ‚é³´å™¨"></a>ç¬¬ 9 æ­¥ï¼šè­¦å ±èœ‚é³´å™¨</h2><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://content.instructables.com/ORIG/F4T/1EXH/KP9RL19X/F4T1EXHKP9RL19X.jpg?auto=webp&frame=1&width=779&fit=bounds&md=0c7ba48304149e42bcab06324eedf719"></a></p><p>ç‚ºäº†åœ¨äººé«”ç¯©æŸ¥æœŸé–“æä¾›è­¦å ±ï¼Œä½¿ç”¨äº†å£“é›»èœ‚é³´å™¨ã€‚èœ‚é³´å™¨æœ‰å…©å€‹ç«¯å­ï¼Œè¼ƒé•·çš„ä¸€ç«¯ç‚ºæ­£æ¥µï¼Œè¼ƒçŸ­çš„è…³ç‚ºè² æ¥µã€‚æ–°èœ‚é³´å™¨ä¸Šçš„è²¼ç´™ä¹Ÿæœ‰â€œ+â€æ¨™è¨˜ï¼Œè¡¨ç¤ºæ­£æ¥µç«¯å­ã€‚  </p><p>æ‚¨å¯ä»¥å°‡é›»ç·šç„Šæ¥åˆ°èœ‚é³´å™¨å¼•è…³ä¸Šï¼Œæˆ–è€…æ‚¨å¯ä»¥ä½¿ç”¨æˆ‘åœ¨é€™è£¡ä½¿ç”¨çš„æ¯è·³ç·šã€‚  </p><p>é€£æ¥æ‡‰å¦‚ä¸‹æ‰€ç¤ºï¼š  </p><p>Arduinoâ€”â€”èœ‚é³´å™¨  </p><p>D7 â€“ æ­£æ¥µç«¯å­  </p><p>GNDâ€”â€”è² æ¥µ</p><h2 id="ç¬¬-10-æ­¥ï¼šæº–å‚™æ“´å±•æ¿"><a href="#ç¬¬-10-æ­¥ï¼šæº–å‚™æ“´å±•æ¿" class="headerlink" title="ç¬¬ 10 æ­¥ï¼šæº–å‚™æ“´å±•æ¿"></a>ç¬¬ 10 æ­¥ï¼šæº–å‚™æ“´å±•æ¿</h2><p>å¦‚ä¸‹åœ–:å°‡5V, GND, SCL, SDAç”¨ç„Šæ¥æ“´å……</p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://content.instructables.com/ORIG/FZ2/TUB2/KP9RL3QL/FZ2TUB2KP9RL3QL.jpg?auto=webp&frame=1&width=812&fit=bounds&md=f2ac4545b47d3d7410da953e4786eb4a"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://content.instructables.com/ORIG/FNK/RFBV/KP9RL259/FNKRFBVKP9RL259.jpg?auto=webp&frame=1&width=384&fit=bounds&md=401b9a5b05849f2801dc8a0956309568"></a></p><h2 id="ç¬¬-11-æ­¥ï¼šè£½ä½œé›»è·¯"><a href="#ç¬¬-11-æ­¥ï¼šè£½ä½œé›»è·¯" class="headerlink" title="ç¬¬ 11 æ­¥ï¼šè£½ä½œé›»è·¯"></a>ç¬¬ 11 æ­¥ï¼šè£½ä½œé›»è·¯</h2><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://content.instructables.com/ORIG/FAS/I203/KP9RL1QL/FASI203KP9RL1QL.jpg?auto=webp&frame=1&crop=3:2&width=838&height=1024&fit=bounds&md=524128c12bfb3a5b0bb49ec4692f1d75"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://content.instructables.com/ORIG/FSG/V2EB/KP9RKQSZ/FSGV2EBKP9RKQSZ.png?auto=webp&frame=1&width=362&fit=bounds&md=e7e9a0092875544993b9be8d7072a3ce"></a></p><p> é¦–å…ˆï¼Œä¸‹è¼‰ Arduino è‰åœ–ä¸¦å®‰è£æ‰€æœ‰åº«ã€‚  </p><p>ä¸‹è¼‰ä¸¦å®‰è£ä»¥ä¸‹åº«ï¼š  </p><p>1. Adafruit-MLX90614-Libraryï¼š<a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#">https://github.com/adafruit/Adafruit-MLX90614-Libâ€¦</a>  </p><p>2. Adafruit_SSD1306 åº«ï¼š<a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#">https://github.com/adafruit/Adafruit_SSD1306</a>  </p><p>3.millisDelayï¼š<a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#">https://github.com/ansonhe97/millisDelay</a>  </p><p>ä½¿ç”¨æ‚¨çš„ç­†è¨˜æœ¬é›»è…¦æˆ–å°å¼é›»è…¦å°‡ USB é›»çºœæ’å…¥ Arduino Nanoã€‚  </p><p>è¨­ç½®æ­£ç¢ºçš„æ¿å­å’Œ COM ç«¯å£è™Ÿä¸¦å°‡ä»£ç¢¼ä¸Šå‚³åˆ° Arduinoã€‚</p><hr><p>é€™è£¡æˆ‘å…ˆå°‡ä¸»è¦çš„å‚³æ„Ÿå™¨åšæ¸¬è©¦ï¼Œç­‰å¾…åˆ—å°å¤–æ®¼å†åšçµ„è£</p><div class="video-container"><iframe src="https://www.youtube.com/embed/LAPAus2xMJ8" frameborder="0" loading="lazy" allowfullscreen></iframe></div><hr><p><strong>6/27</strong></p><p><strong>åˆ—å°å¤–æ®¼æ™‚é•·28å°æ™‚,ç•¶ç„¶æˆ‘æ˜¯å‰å¾Œè“‹åˆ†é–‹å°,å¾Œè“‹å°çš„é‚„ä¸éŒ¯,åœ¨åˆ—å‰è“‹æ™‚å‰©ä¸‹æœ€å¾Œ1%æ™‚å™´é ­çµ¦æˆ‘é˜»å¡,å¿ƒéƒ½æ¶¼äº†!!!åª½å‘€~~~~</strong></p><p><strong>7/1</strong></p><p><strong>ç•¶æˆ‘æŠŠæ¨¡çµ„å…¨éƒ¨è£ä¸Šæ©Ÿç›’æ™‚,ç™¼ç¾é–‹æ©Ÿå¾Œçš„å‹•ä½œæ€ªæ€ªçš„,è€Œç›´æ¥ä½¿ç”¨é›»æºæ¥åœ¨nanoä¸Šåˆæ­£å¸¸,å¾Œä¾†æŸ¥åˆ°æ˜¯å‡å£“æ¨¡çµ„é€²é›»å£“3.7væ²’æœ‰å‡å£“åˆ°7v,å¾Œä¾†æŸ¥ä¸€ä¸‹ç¶²è·¯,èªªå‡å£“æ¨¡çµ„çš„èª¿æ•´é–¥ä¸€æ‹¿åˆ°æœ€å¥½éƒ½å…ˆé€†æ™‚é‡è½‰20åœˆä»¥ä¸Š,å†é †æ™‚é‡èª¿æ•´,é›»å£“å°±èƒ½å¾€ä¸Š(èª¿æ•´æ™‚èª¿æ•´é–¥æœè‡ªå·±)ã€‚</strong></p><p><strong>7/3</strong></p><p><strong>ç™¼ç¾æœ‰å€‹ç¼ºé»,IRæ¨¡çµ„åœ¨å…‰ç·šå¼·çš„åœ°æ–¹æœƒä¸€ç›´è‡ªå·±å‹•ä½œ,èª¿äº†éˆæ•åº¦ä¹Ÿæ˜¯ä¸€æ¨£,ä¸çŸ¥æ˜¯å‚³æ„Ÿå™¨æœ‰å•é¡Œé‚„æ˜¯â€¦.,å…ˆè²·å¹¾å€‹æ›ä¸Šå†è©¦ã€‚</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://cf.shopee.tw/file/11e9c94f34a936a6d9aacd4893b9be91"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://lh3.googleusercontent.com/--GcWcr76wPw/YOAE5zttu_I/AAAAAAAAeZI/jc8EqqH4ap0udaNtBGp2dvoEWKSeFWqLACNcBGAsYHQ/s1600/1625294021588501-0.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/2369433296544109208#"><img src="https://lh3.googleusercontent.com/-nLsZ-SyOg40/YN7NHJBac_I/AAAAAAAAeYw/vCmjbHF7rsgIvZvQnUM3qXZKn_RYC-ACgCNcBGAsYHQ/s1600/1625214227181480-1.png"></a></p><div class="video-container"><iframe src="https://www.youtube.com/embed/b029HT_Jpnw" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> arduino </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GY-906 </tag>
            
            <tag> IRç´…å¤–å‚³æ„Ÿå™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQTT-Node-REDæ§åˆ¶äºŒè»¸äº‘å°-ESP32</title>
      <link href="/2021/09/02/mqtt-node-red-kong-zhi-er-zhou-yun-tai-esp32/"/>
      <url>/2021/09/02/mqtt-node-red-kong-zhi-er-zhou-yun-tai-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="MQTT-Node-REDæ§åˆ¶äºŒè»¸äº‘å°-ESP32"><a href="#MQTT-Node-REDæ§åˆ¶äºŒè»¸äº‘å°-ESP32" class="headerlink" title="MQTT-Node-REDæ§åˆ¶äºŒè»¸äº‘å°-ESP32"></a>MQTT-Node-REDæ§åˆ¶äºŒè»¸äº‘å°-ESP32</h1><h6 id="tags-esp32-servo-node-red-mqtt"><a href="#tags-esp32-servo-node-red-mqtt" class="headerlink" title="tags: esp32 servo node-red mqtt"></a>tags: <code>esp32</code> <code>servo</code> <code>node-red</code> <code>mqtt</code></h6><p><em>ä¼ºæœé¦¬é”å°æ–¼å¾®æ§æ¿ç©å®¶ä¸€å®šæ˜¯å†ç†Ÿæ‚‰ä¸éï¼Œä¹Ÿæ˜¯å…¥é–€å¿…å­¸çš„å…ƒä»¶ä¹‹ä¸€ï¼Œåªæ˜¯ç‰¹åˆ¥è¦æ³¨æ„å¦‚æœè¦æ§åˆ¶ï¼’å€‹ä»¥ä¸Šçš„ä¼ºæœé¦¬é”ï¼Œä¸€å®šè¦ä½¿ç”¨å¤–æ¥é›»æºæˆ–è€…PCA9685ã€‚</em></p><p><em>ä¼ºæœé¦¬é”æœ‰å¾ˆå¤šæ¬¾ï¼Œå°å‹å¸¸ç”¨çš„å°±å±¬SG-90ï¼Œå®ƒæ˜¯å¡‘è† é½’è¼ªï¼Œé‚„æœ‰ä¸€ç¨®æ˜¯é‡‘å±¬é½’è¼ª</em></p><h2 id="ä¼ºæœé¦¬é”çš„è¦æ ¼"><a href="#ä¼ºæœé¦¬é”çš„è¦æ ¼" class="headerlink" title="ä¼ºæœé¦¬é”çš„è¦æ ¼"></a>ä¼ºæœé¦¬é”çš„è¦æ ¼</h2><h3 id="SG-90è¦æ ¼"><a href="#SG-90è¦æ ¼" class="headerlink" title="SG-90è¦æ ¼"></a>SG-90è¦æ ¼</h3><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8073202486984569203?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-nxgapjbWx68/YSXYndzzCVI/AAAAAAAAe2s/qsMvSksBD3YRlIHAnQ1wzBKyuROmzx90wCNcBGAsYHQ/w233-h233/dc05cb93dcb58dbc3887b14f60cced9f.jpg"></a></p><ul><li>  å·¥ä½œé›»å£“ï¼š4.8V.</li><li>  è½‰çŸ©ï¼š1.8kg-cm</li><li>  é‹è½‰é€Ÿåº¦ï¼š0.1ç§’âˆ• 60åº¦</li><li>  è½‰å‹•è§’åº¦ï¼šæœ€å¤§90Â°</li><li>è„ˆè¡å¯¬åº¦ç¯„åœï¼š500~2400Âµs.</li></ul><h3 id="MG90Sè¦æ ¼"><a href="#MG90Sè¦æ ¼" class="headerlink" title="MG90Sè¦æ ¼"></a>MG90Sè¦æ ¼</h3><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8073202486984569203?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-ClUAItIjGJ4/YSXY8XrU1pI/AAAAAAAAe20/pIH_GpNA5Cgnlsx45QZJ1nlS6Uu6_xsdACNcBGAsYHQ/w273-h273/180303000000b-800x800.jpg"></a></p><ul><li>  é‡‘å±¬éŠ…é½’ã€ç©ºå¿ƒæ¯é›»æ©Ÿã€é›™æ»¾ç è»¸æ‰¿</li><li>  ç”¢å“å‹è™Ÿï¼š<strong>MG90s</strong>.</li><li>  æ‰­åŠ›ï¼š2.0kg(4.8v)</li><li>  é‹è½‰é€Ÿåº¦ï¼š0.11s(4.8v)</li><li>  è½‰å‹•è§’åº¦ï¼šæœ€å¤§90Â°/180Â°</li><li>èˆµæ©Ÿé¡å‹ï¼šæ•¸å­—èˆµæ©Ÿ</li></ul><ol><li> <em>æ­¤æ¬¡å¯¦é©—ä»¥MG-90ç‚ºä¸»</em></li><li> <em>è¦æ§åˆ¶ä¼ºæœé¦¬é”æœ‰å…©ç¨®æ–¹å¼ï¼Œä¸€ç¨®æ˜¯åˆ©ç”¨PWMï¼Œå¦ä¸€ç¨®æ˜¯ä½¿ç”¨ç¾æœ‰çš„åº«åŒ…ä¾†æ§åˆ¶ï¼Œæœ¬æ¬¡å¯¦é©—ä»¥åº«åŒ…ç‚ºä¸»</em></li></ol><h2 id="é¦–å…ˆå®‰è£"><a href="#é¦–å…ˆå®‰è£" class="headerlink" title="é¦–å…ˆå®‰è£"></a>é¦–å…ˆå®‰è£</h2><p> <a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8073202486984569203?hl=zh-TW#">ESP32 Arduino Servo Library</a></p><h2 id="æ¥ç·šæ–¹å¼"><a href="#æ¥ç·šæ–¹å¼" class="headerlink" title="æ¥ç·šæ–¹å¼"></a>æ¥ç·šæ–¹å¼</h2><ul><li>  GND -&gt; ESP32Â GNDÂ pin;</li><li>  Power -&gt; ESP32Â VINÂ pin;</li><li>Signal -&gt;Â GPIO 13Â (or any PWM pin).  <a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8073202486984569203?hl=zh-TW#"><img src="https://i1.wp.com/randomnerdtutorials.com/wp-content/uploads/2018/05/servo-esp32-schematic.png?w=750&quality=100&strip=all&ssl=1"></a></li></ul><h2 id="é€²è¡Œå¯¦é©—"><a href="#é€²è¡Œå¯¦é©—" class="headerlink" title="é€²è¡Œå¯¦é©—"></a>é€²è¡Œå¯¦é©—</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;ESP32Servo.h&gt;ServoÂ myservo;intÂ posÂ &#x3D;Â 20;constÂ intÂ pinÂ &#x3D;Â 12;voidÂ setup()&#123;Â Â Serial.begin(115200);Â Â myservo.attach(pin,Â 500,Â 2400);&#125;voidÂ loop()&#123;Â Â forÂ (pos&#x3D;20;Â pos&lt;&#x3D;160;Â pos+&#x3D;3)&#123;Â Â Â Â myservo.write(pos);Â Â Â Â delay(100);Â Â &#125;Â Â forÂ (pos&#x3D;160;Â pos&gt;&#x3D;20;Â pos-&#x3D;3)&#123;Â Â Â Â myservo.write(pos);Â Â Â Â delay(100);Â Â &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="å…ˆå‚™å¦¥æ¨¹è“æ´¾ä¸Šæ‰€é ˆçš„è»Ÿç¡¬é«”"><a href="#å…ˆå‚™å¦¥æ¨¹è“æ´¾ä¸Šæ‰€é ˆçš„è»Ÿç¡¬é«”" class="headerlink" title="å…ˆå‚™å¦¥æ¨¹è“æ´¾ä¸Šæ‰€é ˆçš„è»Ÿç¡¬é«”"></a><strong>å…ˆå‚™å¦¥æ¨¹è“æ´¾ä¸Šæ‰€é ˆçš„è»Ÿç¡¬é«”</strong></h2><ol><li> <strong><em>å®‰è£<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8073202486984569203?hl=zh-TW#">Mosquitto broker</a>(å¦‚æœæ²’ç©éæ¨¹è“æ´¾,è«‹é€£çµ<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8073202486984569203?hl=zh-TW#">é€™è£¡</a>å®‰è£æ¨¹è“æ´¾ç³»çµ±å’Œ<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8073202486984569203?hl=zh-TW#">å¦‚</a></em></strong></li><li> <strong><em><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8073202486984569203?hl=zh-TW#">ä½•ä½¿ç”¨SSHå’ŒVNCé¡åƒ</a>)</em></strong></li><li> <strong><em>å®‰è£ <a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8073202486984569203?hl=zh-TW#">Node-RED installed</a>Â Â å’ŒÂ <a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8073202486984569203?hl=zh-TW#">Node-RED Dashboard</a>åœ¨æ¨¹è“æ´¾ä¸Šã€‚</em></strong></li><li> <strong>_å‚™è¨»:å®‰è£Node-REDæ™‚è‹¥å‡ºç¾éŒ¯èª¤è¨Šæ¯æ”¹ç”¨ä¸‹é¢æ‰€é™„ä¸‹è¼‰ _****<em>bash &lt;(curl -sL <a href="https://raw.githubusercontent.com/node-red/linux-installers/master/deb/update-nodejs-and-nodered">https://raw.githubusercontent.com/node-red/linux-installers/master/deb/update-nodejs-and-nodered</a>)</em></strong></li></ol><hr><h2 id="å¸ƒç½²Node-RED"><a href="#å¸ƒç½²Node-RED" class="headerlink" title="å¸ƒç½²Node-RED"></a>å¸ƒç½²Node-RED</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8073202486984569203?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-GksKBPZ26_o/YSpWJWFmwhI/AAAAAAAAe4E/6peztH_jPDgTVkrbfKGBriWMdPbxcnCyACNcBGAsYHQ/w731-h411/3.jpg"></a></p><p><a href="https://1.bp.blogspot.com/-bIpsZvvgG6Y/YSpVzj9SmhI/AAAAAAAAe34/-V-RirefCUETcVru84SLRomgYX3EzNOnQCNcBGAsYHQ/s661/1.jpg"><img src="https://1.bp.blogspot.com/-bIpsZvvgG6Y/YSpVzj9SmhI/AAAAAAAAe34/-V-RirefCUETcVru84SLRomgYX3EzNOnQCNcBGAsYHQ/w793-h444/1.jpg"></a></p><p><a href="https://1.bp.blogspot.com/-AS8DJhdGX5Q/YSpV8K4e0hI/AAAAAAAAe38/1h6rhTpCw1wwJ_hmA4QAZDDkU-6MBBANwCNcBGAsYHQ/s654/2.jpg"><img src="https://1.bp.blogspot.com/-AS8DJhdGX5Q/YSpV8K4e0hI/AAAAAAAAe38/1h6rhTpCw1wwJ_hmA4QAZDDkU-6MBBANwCNcBGAsYHQ/w761-h428/2.jpg"></a></p><hr><p><em><strong>é ˆåŒ¯å…¥<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8073202486984569203?hl=zh-TW#">ESP32Servo.h</a>å’Œ<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8073202486984569203?hl=zh-TW#">PubSubClient.h</a></strong></em></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;ESP32Servo.h&gt;#include &lt;WiFi.h&gt;#include &lt;PubSubClient.h&gt;  &#x2F;&#x2F;ä¼ºæœé¦¬é”åˆå§‹åŒ–ServoÂ myservoPan,Â myservoTilt;constÂ intÂ panÂ &#x3D;Â 12;constÂ intÂ tiltÂ &#x3D;Â 13;  constÂ charÂ *ssidÂ &#x3D;Â &quot;---&quot;;constÂ charÂ *passwordÂ &#x3D;Â &quot;----&quot;;constÂ charÂ *mqttServerÂ &#x3D;Â &quot;192.168.--.--&quot;;&#x2F;&#x2F;wifiå®¢æˆ¶ç«¯åŠMQTTå®¢æˆ¶ç«¯ä»£æ•¸WiFiClientÂ espClient;PubSubClientÂ client(espClient);  &#x2F;&#x2F;wifié€£ç·švoidÂ wifiConn()&#123;Â Â WiFi.begin(ssid,Â password);Â Â whileÂ (WiFi.status()Â !&#x3D;Â WL_CONNECTED)&#123;Â Â Â Â Serial.print(&quot;.&quot;);Â Â Â Â delay(500);Â Â &#125;Â Â Serial.println(&quot;ConnectedÂ successful!&quot;);Â Â &#x2F;&#x2F;Â Serial.print(&quot;IP:Â &quot;);Â Â &#x2F;&#x2F;Â Serial.println(WiFi.localIP());&#125;    voidÂ callBack(charÂ *topic,Â byteÂ *message,Â unsignedÂ intÂ length)&#123;Â Â &#x2F;&#x2F;åˆ—å‡ºmqttæ¥æ”¶åˆ°çš„ä¸»é¡Œå’Œå­—å…ƒÂ Â StringÂ msgPan,Â msgTilt;Â Â Serial.print(&quot;topic:Â &quot;);Â Â Serial.println(topic);Â Â Serial.print(&quot;message:Â &quot;);Â Â forÂ (intÂ iÂ &#x3D;Â 0;Â iÂ &lt;Â length;Â i++)&#123;Â Â Â Â Serial.print(char(message[i]));Â Â Â Â msgPanÂ +&#x3D;Â char(message[i]);Â Â Â Â msgTiltÂ +&#x3D;Â char(message[i]);Â Â &#125;Â Â Serial.println();Â Â &#x2F;&#x2F;æ¥æ”¶åˆ°çš„å­—å…ƒå¦‚æœç¬¦åˆå°±åŸ·è¡Œç›¸æ‡‰çš„å‹•ä½œÂ Â ifÂ (String(topic)Â &#x3D;&#x3D;Â &quot;esp32&#x2F;servoPan&quot;)&#123;Â Â Â Â myservoPan.write(msgPan.toInt());Â Â Â Â delay(100);Â Â &#125;elseÂ ifÂ (String(topic)Â &#x3D;&#x3D;Â &quot;esp32&#x2F;servoTilt&quot;)&#123;Â Â Â Â myservoTilt.write(msgTilt.toInt());Â Â Â Â delay(100);Â Â &#125;&#125;  &#x2F;&#x2F;è¬ä¸€é€£ä¸ä¸Šmqttå°±é‡æ–°é€£ç·švoidÂ reconnMqtt()&#123;Â Â whileÂ (!Â client.connected())&#123;Â Â Â Â Serial.println(&quot;åšè©¦é€£ç·šMQTT...&quot;);Â Â Â Â ifÂ (client.connect(&quot;esp32Client&quot;))&#123;Â Â Â Â Â Â Serial.print(&quot;å·²é€£ç·š&quot;);Â Â Â Â Â Â client.subscribe(&quot;esp32&#x2F;servoPan&quot;);Â Â Â Â Â Â client.subscribe(&quot;esp32&#x2F;servoTilt&quot;);Â Â Â Â &#125;elseÂ &#123;Â Â Â Â Â Â Serial.print(&quot;ç„¡æ³•é€£ç·šçš„åŸå› æ˜¯:Â &quot;);Â Â Â Â Â Â Serial.print(client.state());Â Â Â Â Â Â delay(2000);Â Â Â Â &#125;Â Â &#125;&#125;  voidÂ setup()&#123;Â Â Serial.begin(115200);Â Â &#x2F;&#x2F;ä¼ºæœé¦¬é”è…³ä½å’Œç¯„åœÂ Â myservoPan.attach(pan,Â 500,Â 2400);Â Â myservoTilt.attach(tilt,Â 500,Â 2400);Â Â wifiConn();Â Â &#x2F;&#x2F;mqttåˆå§‹åŒ–Â Â client.setServer(mqttServer,Â 1883);Â Â &#x2F;&#x2F;ç›£è½è¨‚é–±å‚³ä¾†çš„è¨Šæ¯Â Â client.setCallback(callBack);&#125;voidÂ loop()&#123;Â Â ifÂ (!Â client.connected())&#123;Â Â Â Â reconnMqtt();Â Â &#125;Â Â client.loop();&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/eP2EA1m7cPw" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mqtt </tag>
            
            <tag> node-red </tag>
            
            <tag> äºŒè»¸äº‘å° </tag>
            
            <tag> servo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQTT&amp;node-REDæ§åˆ¶äºŒè»¸äº‘å°-mpython</title>
      <link href="/2021/08/31/mqtt-node-red-kong-zhi-er-zhou-yun-tai-mpython-1/"/>
      <url>/2021/08/31/mqtt-node-red-kong-zhi-er-zhou-yun-tai-mpython-1/</url>
      
        <content type="html"><![CDATA[<h1 id="MQTT-amp-node-REDæ§åˆ¶äºŒè»¸äº‘å°-mpython"><a href="#MQTT-amp-node-REDæ§åˆ¶äºŒè»¸äº‘å°-mpython" class="headerlink" title="MQTT&amp;node-REDæ§åˆ¶äºŒè»¸äº‘å°-mpython"></a>MQTT&amp;node-REDæ§åˆ¶äºŒè»¸äº‘å°-mpython</h1><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/4999901201185761586?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-sqJOZzdBnks/YSjK1HOEkWI/AAAAAAAAe3o/ShJX8l8V20cmENfwoL0iij0uZm_wHfwaQCNcBGAsYHQ/w208-h349/1630063309993121-0.png"></a></p><p><em><strong>æ‰¿æ¥<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/4999901201185761586?hl=zh-TW#">ä½¿ç”¨PWMæ§åˆ¶ä¼ºæœé¦¬é”-micropython</a>é€™ç¯‡ï¼Œé€énode-redåŠ å…¥mqttè¨‚é–±ä¸»é¡Œæ§åˆ¶äºŒè»¸äº‘å°</strong></em></p><p><em><strong>æœ‰ä¸€äº›æ„Ÿæƒ³ç´€éŒ„ä¸‹ä¾†ï¼Œæˆ‘ç™¼ç¾å…¶å¯¦åƒmqttæˆ–è€…wifié€£ç¶²ï¼Œå¤§éƒ½æ˜¯å›ºå®šä¸€å€‹å¯«æ³•ï¼Œå…¶å®ƒä¸åŒçš„æ¨¡çµ„åˆ†ç‚ºè®€å–æ•¸å€¼æˆ–ç”¨æ•¸å€¼å—æ§åˆ¶çš„å…ƒä»¶ï¼Œåªè¦å¥—ç”¨ä¸Šå»å°±å¯ä»¥ã€‚</strong></em></p><p><em><strong>é¦–å…ˆä¸»è¦æ˜¯è¢«æ§åˆ¶çš„ä¼ºæœé¦¬é”ï¼Œæ‰€ä»¥å…ˆæŠŠå®ƒæ¸¬è©¦ä¸€ä¸‹ï¼Œåƒè€ƒé€™ç¯‡ï¼ˆ<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/4999901201185761586?hl=zh-TW#">é»æˆ‘</a>ï¼‰</strong></em></p><p><em><strong>æ¸¬è©¦å¥½ä¹‹å¾Œï¼Œå°±å¯ä»¥é–‹å§‹åŠ å…¥wifiå’Œmqttäº†ï¼Œä½†å› ç‚ºæˆ‘ç”¨çš„æ˜¯æ¨¹è“æ´¾å»ºç«‹çš„ï¼­QTTï¼Œæ‰€ä»¥é€™é™ªåˆ†å‰ææ˜¯è¦æœ‰æ¨¹è‹ºæ´¾ï¼Œå¦‚ä½•åœ¨æ¨¹è‹ºæ´¾ä¸Šå»ºç«‹ï¼®ode-REDå’ŒMQTTï¼Œå¯ä»¥åƒè€ƒé€™ç¯‡ï¼ˆ<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/4999901201185761586?hl=zh-TW#">é»æˆ‘</a>ï¼‰ã€‚</strong></em></p><hr><h2 id="Node-REDè¨­å®š"><a href="#Node-REDè¨­å®š" class="headerlink" title="Node-REDè¨­å®š"></a>Node-REDè¨­å®š</h2><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/4999901201185761586?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-GksKBPZ26_o/YSpWJWFmwhI/AAAAAAAAe4E/6peztH_jPDgTVkrbfKGBriWMdPbxcnCyACNcBGAsYHQ/w654-h368/3.jpg"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/4999901201185761586?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-bIpsZvvgG6Y/YSpVzj9SmhI/AAAAAAAAe34/-V-RirefCUETcVru84SLRomgYX3EzNOnQCNcBGAsYHQ/w661-h370/1.jpg"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/4999901201185761586?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-AS8DJhdGX5Q/YSpV8K4e0hI/AAAAAAAAe38/1h6rhTpCw1wwJ_hmA4QAZDDkU-6MBBANwCNcBGAsYHQ/w654-h368/2.jpg"></a></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">from</span> machine <span class="token keyword">import</span> SLEEP<span class="token punctuation">,</span> Pin<span class="token punctuation">,</span> PWM<span class="token punctuation">,</span> freq    <span class="token keyword">from</span> time <span class="token keyword">import</span> sleep    <span class="token keyword">from</span> umqtttsimple <span class="token keyword">import</span> MQTTClient    <span class="token keyword">import</span> binascii<span class="token punctuation">,</span> micropython<span class="token punctuation">,</span> network<span class="token punctuation">,</span> time<span class="token punctuation">,</span> socket<span class="token punctuation">,</span> machine    ssid <span class="token operator">=</span> <span class="token string">"------------"</span>    password <span class="token operator">=</span> <span class="token string">"-------"</span>    mqtt_server <span class="token operator">=</span> <span class="token string">"192.168.210.22"</span>    <span class="token comment">#å°‡å®¢æˆ¶ç«¯IDè½‰æ›ç‚º16é€²ä½,ä»¥ä¾¿MQTTä¼ºæœç«¯è®€å–</span>    mqtt_id <span class="token operator">=</span> binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>machine<span class="token punctuation">.</span>unique_id<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">#å’ŒNord-REDä¸Šçš„ä¸»é¡Œä¸€è‡´</span>    client_servoPan <span class="token operator">=</span> <span class="token string">b'esp32/servoPan'</span>    client_servoTilt <span class="token operator">=</span> <span class="token string">b'esp32/servoTilt'</span>    servo_pan <span class="token operator">=</span> PWM<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>    servo_tilt <span class="token operator">=</span> PWM<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>    <span class="token comment">#wifié€£ç·š</span>    <span class="token keyword">def</span> <span class="token function">wifiConn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        wifi <span class="token operator">=</span> network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>        wifi<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>        wifi<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span>        <span class="token keyword">while</span> wifi<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span>           <span class="token keyword">pass</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Connected successful!"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IP: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>wifi<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">#æ¨¹è“æ´¾ä¸Šçš„mqttå›æ‡‰è¨‚é–±</span>    <span class="token comment"># Duty å°±ç‚º 2.5ï¼…ã€7.25ï¼…ã€12ï¼…ï¼Œä¸¦ x1024 å¾Œå¯ä»¥è½‰æ›æˆ PWM Dutyå¡«å…¥çš„æ•¸å€¼</span>    <span class="token keyword">def</span> <span class="token function">callBack</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">:</span>       ang0 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">1023</span><span class="token operator">*</span><span class="token number">0.025</span><span class="token punctuation">)</span>       ang90 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">1023</span><span class="token operator">*</span><span class="token number">0.0725</span><span class="token punctuation">)</span>       ang180 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">1023</span><span class="token operator">*</span><span class="token number">0.12</span><span class="token punctuation">)</span>       <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">)</span>       <span class="token keyword">if</span> topic <span class="token operator">==</span> client_servoPan<span class="token punctuation">:</span>            servo_pan<span class="token punctuation">.</span>duty<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span>            sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>        <span class="token keyword">elif</span> topic <span class="token operator">==</span> client_servoTilt<span class="token punctuation">:</span>            servo_tilt<span class="token punctuation">.</span>duty<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span>            sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>    <span class="token comment">#é€£ç·šMQTT,é€£ç·šæˆåŠŸå¾Œè¨‚é–±ä¸»é¡Œ</span>    <span class="token keyword">def</span> <span class="token function">connToMqtt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            client <span class="token operator">=</span> MQTTClient<span class="token punctuation">(</span>mqtt_id<span class="token punctuation">,</span> mqtt_server<span class="token punctuation">)</span>            client<span class="token punctuation">.</span>set_callback<span class="token punctuation">(</span>callBack<span class="token punctuation">)</span>            client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>            client<span class="token punctuation">.</span>subscribe<span class="token punctuation">(</span>client_servoPan<span class="token punctuation">)</span>            client<span class="token punctuation">.</span>subscribe<span class="token punctuation">(</span>client_servoTilt<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connect to %s"</span><span class="token operator">%</span>mqtt_server<span class="token punctuation">)</span>            <span class="token keyword">return</span> client            <span class="token comment">#å¦‚æœç„¡æ³•é€£ç·šé‡æ–°é€£ç·š</span>        <span class="token keyword">except</span> OSError <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"not to connected for MQTT server!"</span><span class="token punctuation">)</span>            machine<span class="token punctuation">.</span>reset<span class="token punctuation">(</span><span class="token punctuation">)</span>        wifiConn<span class="token punctuation">(</span><span class="token punctuation">)</span>        client <span class="token operator">=</span> connToMqtt<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            <span class="token comment">#æª¢æŸ¥æœ‰ç„¡é€²ä¾†çš„è¨Šæ¯</span>            client<span class="token punctuation">.</span>check_msg<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>èª¿éç­‰å¾…æ™‚é–“é‚„æ˜¯æœƒå¶çˆ¾æŠ–å‹•ï¼Œé›–ç„¶ä¸çŸ¥é“æŠ–å‹•åŸåœ¨å“ªï¼Œå…ˆé€™æ¨£å¥½äº†ï¼Œä¸‹æ¬¡å†ä¾†æŠ“åŸå› ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mqtt </tag>
            
            <tag> node-red </tag>
            
            <tag> äºŒè»¸äº‘å° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨PWMæ§åˆ¶ä¼ºæœé¦¬é”-micropython</title>
      <link href="/2021/08/31/shi-yong-pwm-kong-zhi-si-fu-ma-da-micropython/"/>
      <url>/2021/08/31/shi-yong-pwm-kong-zhi-si-fu-ma-da-micropython/</url>
      
        <content type="html"><![CDATA[<h1 id="ä½¿ç”¨PWMæ§åˆ¶ä¼ºæœé¦¬é”-micropython"><a href="#ä½¿ç”¨PWMæ§åˆ¶ä¼ºæœé¦¬é”-micropython" class="headerlink" title="ä½¿ç”¨PWMæ§åˆ¶ä¼ºæœé¦¬é”-micropython"></a>ä½¿ç”¨PWMæ§åˆ¶ä¼ºæœé¦¬é”-micropython</h1><h6 id="tags-micropython-servo-pwm"><a href="#tags-micropython-servo-pwm" class="headerlink" title="tags: micropython servo pwm"></a>tags: <code>micropython</code> <code>servo</code> <code>pwm</code></h6><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5335469614801919559?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-nxgapjbWx68/YSXYndzzCVI/AAAAAAAAe2s/qsMvSksBD3YRlIHAnQ1wzBKyuROmzx90wCNcBGAsYHQ/w233-h233/dc05cb93dcb58dbc3887b14f60cced9f.jpg"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5335469614801919559?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-KvFNc38Zvsw/YSc_jvO-Z-I/AAAAAAAAe3E/Xf2ZHTfM3HMVetVEdGSkgsNEtmL5KNx9wCNcBGAsYHQ/w450-h329/image.png"></a></p><p><em>ä¼ºæœé›»æ©Ÿå¯ä»¥å¾ 0 åº¦æ—‹è½‰åˆ° 180 åº¦ï¼Œä½†æœ€å¤šå¯ä»¥æ—‹è½‰ 210 åº¦ï¼Œå…·é«”å–æ±ºæ–¼è£½é€ ã€‚å¯ä»¥é€šéå°‡é©ç•¶å¯¬åº¦çš„é›»è„ˆè¡æ‡‰ç”¨åˆ°å…¶æ§åˆ¶å¼•è…³ä¾†æ§åˆ¶é€™ç¨®æ—‹è½‰ç¨‹åº¦ã€‚ä¼ºæœæ¯ 20 æ¯«ç§’æª¢æŸ¥ä¸€æ¬¡è„ˆè¡ã€‚ 1 msï¼ˆ1æ¯«ç§’ï¼‰å¯¬åº¦çš„è„ˆè¡å¯ä»¥å°‡ä¼ºæœæ—‹è½‰åˆ°0åº¦ï¼Œ1.5mså¯ä»¥æ—‹è½‰åˆ°90åº¦ï¼ˆä¸­ä½ï¼‰ï¼Œ2 msè„ˆè¡å¯ä»¥å°‡å…¶æ—‹è½‰åˆ°180åº¦ã€‚</em></p><h3 id="æ¥ç·šæ–¹å¼"><a href="#æ¥ç·šæ–¹å¼" class="headerlink" title="æ¥ç·šæ–¹å¼"></a>æ¥ç·šæ–¹å¼</h3><pre class="line-numbers language-none"><code class="language-none">-   GND -&gt; ESP32Â GNDÂ pin;-   Power -&gt; ESP32Â VINÂ pin;-   Signal -&gt;Â GPIO 13Â (or any PWM pin).<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5335469614801919559?hl=zh-TW#"><img src="https://i1.wp.com/randomnerdtutorials.com/wp-content/uploads/2018/05/servo-esp32-schematic.png?w=750&quality=100&strip=all&ssl=1"></a></p><hr><p>å°‡é »ç‡è¨­ç½®ç‚º 50Hzï¼ˆæ¯ 20ms ä¸€å€‹é€±æœŸï¼‰ï¼Œä¸¦å°‡ä½”ç©ºå€¼è¨­ç½®åœ¨ 18ï¼ˆ18/1023 * 20ms = 0.35msï¼‰å’Œ 115ï¼ˆ115/1023 * 20ms = 2.24msï¼‰ä¹‹é–“ã€‚ä½”ç©ºæ¯”å¯ä»¥ä»‹æ–¼ 0 å’Œ 1023 ä¹‹é–“ï¼ˆåŒ…æ‹¬ 0 å’Œ 1023ï¼‰ã€‚</p><h3 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h3><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">from</span>   machine   <span class="token keyword">import</span> Pin<span class="token punctuation">,</span> PWM<span class="token punctuation">,</span> freq <span class="token keyword">from</span>   time   <span class="token keyword">import</span> sleepservo <span class="token operator">=</span> PWM<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">while</span>   <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token keyword">for</span> i <span class="token keyword">in</span>   <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">115</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    servo<span class="token punctuation">.</span>duty<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span>   <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    servo<span class="token punctuation">.</span>duty<span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/RYo2gCq5bHs" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¼ºæœé¦¬é” </tag>
            
            <tag> pwm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨AdafriutIO-dashboardsæ§åˆ¶Neopixelç‡ˆæ¢-mpython</title>
      <link href="/2021/08/31/shi-yong-adafriutio-dashboards-kong-zhi-neopixel-deng-tiao-mpython/"/>
      <url>/2021/08/31/shi-yong-adafriutio-dashboards-kong-zhi-neopixel-deng-tiao-mpython/</url>
      
        <content type="html"><![CDATA[<h1 id="ä½¿ç”¨AdafriutIO-dashboardsæ§åˆ¶Neopixelç‡ˆæ¢â€”mpython"><a href="#ä½¿ç”¨AdafriutIO-dashboardsæ§åˆ¶Neopixelç‡ˆæ¢â€”mpython" class="headerlink" title="ä½¿ç”¨AdafriutIO-dashboardsæ§åˆ¶Neopixelç‡ˆæ¢â€”mpythonÂ "></a>ä½¿ç”¨AdafriutIO-dashboardsæ§åˆ¶Neopixelç‡ˆæ¢â€”mpythonÂ </h1><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/9124050194814696260?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-cVHwv_2MP58/YSIGKZsNVcI/AAAAAAAAe1w/BSS8S2Djsdw_1SEMWfJY1uIktxKS1z32QCNcBGAsYHQ/s1600/1629619750586415-0.png"></a></p><p>åŸæœ¬æ˜¯æ‰“ç®—ä½¿ç”¨Nord-REDæˆ–ç›´æ¥ç¶²é æ§åˆ¶ï¼Œä½†é‚„æ²’æçš„å¾ˆæ‡‚å°¤å…¶å¯«ç¶²é çš„éƒ¨ä»½ï¼Œå¶ç„¶åœ¨ç¶²è·¯ä¸Šæœåˆ°åŸä¾†Adafruitä¹Ÿæœ‰å‡ºDashboardsä½†æ˜¯å¥½åƒåªèƒ½è©¦ç”¨30å¤©,ä½†æ˜¯æ²’é—œä¿‚,å¤šèªè­˜ä¸€é»ä¸åŒçš„å¹³å°ä¹Ÿå¾ˆå¥½</p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/9124050194814696260?hl=zh-TW#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEjlieYsbPBn1UuHG6PZ97RRYbs6KEvN2HxI72y-LJD7L6Ic3sO2YhDqITLgXaCdjXXHJon9tcwguGwpMkfvfWw78X159s06LidRU3hnkIKKUCXSl4vykxg_VeVnMx4P53soBogM859XkN0aIM2llnLBIdDgUNSf8KOgvF7829RFXvZTT5jpS3GoNfuV=w756-h340"></a></p><h2 id="è¨»å†Šæ–¹æ³•"><a href="#è¨»å†Šæ–¹æ³•" class="headerlink" title="è¨»å†Šæ–¹æ³•"></a>è¨»å†Šæ–¹æ³•</h2><p>å…ˆåˆ°é€™è£¡è¨»å†Š-<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/9124050194814696260?hl=zh-TW#">https://io.adafruit.com/</a></p><p><strong>æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘åœ¨ Adafruit IO ä¸­ç‚º NeoPixels çš„é¡è‰²å‰µå»º</strong></p><p><strong>ä¸‰å€‹â€œç´…è‰²â€ã€â€œè—è‰²â€å’Œâ€œç¶ è‰²â€ã€‚</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/9124050194814696260?hl=zh-TW#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEhetlOMC0TagcGwntqDqn7FKiERvA5huakDm1IdKahfIP3bYvvryKTyug_RtOVMlTOcRGiZYj5t4RTiuSdgpWJXtQOTU42LOcYWpGGvtaMfsQJwvLSdSzX8XKZpxKR6F0ftzjHS7_r3tjGgXCqfbD7vrLIYSuCk_giv67Rc1I5ctxClSfiUeiuLgtEt=w705-h396"></a></p><p><strong>ç„¶å¾Œé»é€²å»å‰›å‰µå»ºå¥½çš„ç¾¤çµ„è£¡,æ¥è‘—ä¸‹å€‹æ­¥é©Ÿ</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/9124050194814696260?hl=zh-TW#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEj6RG-m_TeWeKqicaJpz9bcBigSrZAfK-WJw5ZbWenwVs1L3juy6DgQQXkuihzYT1-69ahMSWl3Gc28vk_moDEnWlSr6otX3LD7UexOLqfBNkYVg3bBdPs0qD_RhYZtlZj2UmPPFLOaVtNJE9NbilZbm-ooDcZCmiUnIybvd7-immAFtTMgPPgf2CWG=w706-h397"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/9124050194814696260?hl=zh-TW#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEijTp10Lu54QE-xSs5jJfuj77jPINW04CsWA5rRaz9TPUTMC9hojaAJ-fy_7zdeVH1qxsFz6CmPiSQDZ9_I2asrxeC68gexCQPw9-sxcq31s71dOfaDJBN2gOPdlFQXycNKXNlW3iwgMP732kfwdDXYla_7Tch0bnhOPGTNjhxFoybgqQD4SBvFERAN=w717-h346"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/9124050194814696260?hl=zh-TW#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEjzFLj2w4H2uC0NBX5VZhcDqocyQQaipI5FZvp2DE9jz3t4g1fWxNDbYKtEWDGE9UaLyMikn8735cUqoO485LQXvtN8-253MuGS0DlfDTcKQpEGo8hu-jW_FRnJWVxBfmytXIVo_za-xY9zB7wyoDm7UH3Azsxtn8pWJeB6lhastTx1pz3HG7DHKESP=w638-h321"></a></p><p>æœ€å¾Œï¼Œæˆ‘å€‘èª¿æ•´å¡Šçš„è¨­ç½®ã€‚æ¯å€‹ RGB å€¼éƒ½æ˜¯ä¸€å€‹å¾ 0 åˆ° 255 çš„æ•´æ•¸ã€‚æˆ‘å€‘ç›¸æ‡‰åœ°é…ç½®æ»‘å¡Šã€‚å®Œæˆå¾Œï¼Œé»æ“Šâ€œCREATEÂ  BLOCKâ€ã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/9124050194814696260?hl=zh-TW#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEhPkZQjS1KUFI0BHw_U53DbxNnecF1yVmoN53ywLBHutePItXyFDDkFawQSuJSqg9LXwyRul9xTBSaKBjUPkag3O6N73NYW7xLVdHGdvxARhmd6MX20m_JX1DehXJmjSLsUcrLgLTe0tlyNbvU-5zG5OOKOioVsbel8Wg5U9qzD9PIhhrFF13QHUkur=w578-h577"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/9124050194814696260?hl=zh-TW#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEipULTiF0bUIzSpuS9rBT74qs50-5AwD-znuzTZenklfN-IUt8xFDlwlEmi6T0Sv3R_C07FevYUug1WhXx0wIoLSGzoKwwYnygOqOBq0hH3KoGjeh9oTL4JYuPM9NCPmxmLKHy_F9oCDKBomsi4UwXRbRt5py0-R-Rh8F0cdgNw-5bNy__xoh82TOA7=w580-h270"></a></p><h2 id="APIçš„keyå’Œusername"><a href="#APIçš„keyå’Œusername" class="headerlink" title="APIçš„keyå’Œusername"></a>APIçš„keyå’Œusername</h2><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/9124050194814696260?hl=zh-TW#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEj1e_X33v_8Ph1NqUBt6mxZcJmITGm_8lqSrh-juRffRbcAGzULrQxlpdcsziaTXxu-SaypAufAknZWhR2EohZuiyZMHQxCFAZOXVxsxFF4Sh1NnYgO8W5JIKjDU9ZJ-8qXMFVfeM34uTjC3bdGNCNDzR-cDV2Sv6Ua9nMl9DvbQAPCe9c4FfCs0nov=w721-h349"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/9124050194814696260?hl=zh-TW#"><img src="https://blogger.googleusercontent.com/img/a/AVvXsEj0PmRpwogxOdAAC38TA7jiyH4cIcHQmowD8YSHVMBT4ZKsnTXGvjzcExOR8NpUODB3K_D3mMQdV3of2bDlnH9q1orXb6AxbJgz5hXAhFJITGC9LtrN2SWlvVVAsLjuQGFKNKKX7TXdvzIR8_RkgZrn7aC73Qq5wWCzRMUnBD-lyAEHCdIWCSokv7Tf=w735-h356"></a></p><h2 id="ç¨‹å¼çš„éƒ¨ä»½"><a href="#ç¨‹å¼çš„éƒ¨ä»½" class="headerlink" title="ç¨‹å¼çš„éƒ¨ä»½"></a>ç¨‹å¼çš„éƒ¨ä»½</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token keyword">from</span> neopixel <span class="token keyword">import</span> NeoPixel<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">import</span> network<span class="token keyword">import</span> urequests <span class="token keyword">as</span> requests<span class="token keyword">import</span> ujson  <span class="token comment"># Wifi credentials</span>wifi_ssid <span class="token operator">=</span> <span class="token string">"C--"</span>wifi_password <span class="token operator">=</span> <span class="token string">"c----------"</span>  <span class="token comment"># Adafruit IO authentication</span>aio_key <span class="token operator">=</span> <span class="token string">"aio_iaRV12GqVjk*************"</span>username <span class="token operator">=</span> <span class="token string">"bl-----"</span>headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'X-AIO-Key'</span><span class="token punctuation">:</span> aio_key<span class="token punctuation">,</span> <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">&#125;</span>  <span class="token comment"># Don't forget the NeoPixels!</span>np <span class="token operator">=</span> NeoPixel<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>feed_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'green'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">]</span>rgb_values <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'red'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'green'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">&#125;</span>  <span class="token comment"># Connect to Wifi</span><span class="token keyword">def</span> wifiConn<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  wifi <span class="token operator">=</span> network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>  wifi<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>  wifi<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>wifi_ssid<span class="token punctuation">,</span> wifi_password<span class="token punctuation">)</span>  <span class="token keyword">while</span> wifi<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span>      <span class="token keyword">pass</span>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Conn successful!"</span><span class="token punctuation">)</span><span class="token keyword">def</span> create_URL<span class="token punctuation">(</span>feedname<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> <span class="token string">"https://io.adafruit.com/api/v2/"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"feeds"</span> <span class="token operator">+</span> feedname <span class="token operator">+</span> <span class="token string">"data/last"</span>    <span class="token keyword">return</span> url  wifiConn<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>  <span class="token keyword">for</span> colors <span class="token keyword">in</span> feed_names<span class="token punctuation">:</span>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>create_URL<span class="token punctuation">(</span>colors<span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>    json <span class="token operator">=</span> ujson<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span>    rgb_values<span class="token punctuation">[</span>colors<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>json<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>rgb_values<span class="token punctuation">[</span>colors<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>      np<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>rgb_values<span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rgb_values<span class="token punctuation">[</span><span class="token string">'green'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rgb_values<span class="token punctuation">[</span><span class="token string">'blue'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>      np<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p>**æ•¸çµ„ feed_names åŒ…å«æˆ‘å€‘åœ¨ Adafruit IO ä¸­å‰µå»ºçš„æè¦çš„åç¨±ï¼Œå­—å…¸ rgb_values ç”¨æ–¼å­˜å„²å¾ Adafruit IO ä¸‹è¼‰çš„å€¼ã€‚  </p><p>ç”±æ–¼æˆ‘å€‘éœ€è¦ç²å–ä¸‰å€‹æè¦çš„å€¼ï¼Œä¸¦ä¸”æ¯å€‹æè¦éƒ½æœ‰è‡ªå·±çš„ URLï¼Œå› æ­¤æˆ‘å€‘å‰µå»ºäº†ä¸€å€‹å‡½æ•¸ä¾†ç”Ÿæˆæ‰€éœ€çš„ URLã€‚**</p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">def</span> <span class="token function">create_URL</span><span class="token punctuation">(</span>feedname<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> <span class="token string">"https://io.adafruit.com/api/v2/"</span> <span class="token operator">+</span> username <span class="token operator">+</span>  <span class="token string">"feeds"</span> <span class="token operator">+</span> feedname <span class="token operator">+</span> <span class="token string">"data/last"</span>    <span class="token keyword">return</span> url<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>åœ¨ä¸»å¾ªç’°ä¸­ï¼Œå°æ–¼æ¯å€‹æè¦â€œç´…è‰²â€ã€â€œç¶ è‰²â€å’Œâ€œè—è‰²â€ï¼Œæˆ‘å€‘å‘ Adafruit IO ç™¼é€ä¸€å€‹ HTTP GET è«‹æ±‚ï¼Œå…¶ä¸­åŒ…å«ç”± create_URL å‡½æ•¸å’Œæ¨™é ­å­—å…¸ç”Ÿæˆçš„ URLã€‚</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>create_URL<span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>ç„¶å¾Œï¼Œæˆ‘å€‘ä½¿ç”¨ ujson åº«ä¸­çš„åŠ è¼‰å‡½æ•¸å°‡å¾ Adafruit IO æ¥æ”¶åˆ°çš„ JSON æ–‡æœ¬è½‰æ›ç‚º Python å­—å…¸ã€‚é€™ç¨®è½‰æ›ç¨±ç‚ºè§£æã€‚</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">parsed <span class="token operator">=</span> ujson<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å¾è§£æçš„ Python å­—å…¸ä¸­ï¼Œæˆ‘å€‘å¾—åˆ°æè¦çš„æœ€æ–°å€¼ï¼ˆå®ƒæ˜¯ä¸€å€‹å­—ç¬¦ä¸²ï¼‰ä¸¦å°‡å…¶è½‰æ›ç‚ºæ•´æ•¸ã€‚</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">value <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>parsed<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å°‡æ‰€æœ‰ RGB å€¼ä¿å­˜åˆ°å­—å…¸ rgb_values å¾Œï¼Œæˆ‘å€‘å¯ä»¥ç›¸æ‡‰åœ°è¨­ç½® NeoPixels çš„é¡è‰²ã€‚</strong></p><div class="video-container"><iframe src="https://www.youtube.com/embed/C0Zg5kyytOs" frameborder="0" loading="lazy" allowfullscreen></iframe></div><p><strong><em>åƒè€ƒ</em></strong></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/9124050194814696260?hl=zh-TW#">https://gpiocc.github.io/learn/micropython/esp/2020/05/30/martin-ku-control-neopixels-over-the-internet-with-esp32-and-micropython.html</a></p><p>example-<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/9124050194814696260?hl=zh-TW#">https://github.com/martin-ku-hku/control-neopixels-over-the-internet-with-esp32-and-micropython/blob/master/neopixel_on_off.py</a></p>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AdafriutIO </tag>
            
            <tag> Neopixel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WS2812Bç‡ˆæ¢å¯¦ä½œ-miropython</title>
      <link href="/2021/08/31/ws2812b-deng-tiao-shi-zuo-miropython/"/>
      <url>/2021/08/31/ws2812b-deng-tiao-shi-zuo-miropython/</url>
      
        <content type="html"><![CDATA[<h1 id="WS2812Bç‡ˆæ¢å¯¦ä½œ-miropython"><a href="#WS2812Bç‡ˆæ¢å¯¦ä½œ-miropython" class="headerlink" title="WS2812Bç‡ˆæ¢å¯¦ä½œ-miropython"></a>WS2812Bç‡ˆæ¢å¯¦ä½œ-miropython</h1><p>åœ¨miropythonæœ‰ä¸€å€‹å…§å»ºçš„RGBç‡ˆæ¢çš„ç¨‹å¼åº«ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„æ‹¿ä¾†é‹ç”¨<br>ä½†æˆ‘ç™¼ç¾æˆ‘çŒæœ€è¿‘æ–°çš„mpythonç³»çµ±æ™‚ï¼Œæ²’æœ‰æ”¯æ´äº†ï¼Œä¸éæ²’é—œä¿‚ï¼Œå¯ä»¥æ‰¾ä¸€ä¸‹é€™å€‹åº«æŠŠå®ƒæ‰‹å‹•ä¸Šå‚³åˆ°æ¿å­ä¸Šã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/322977569325795009?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-Us7c722XoqM/YRXSivbTxcI/AAAAAAAAey8/h3Lamsa2HT0RB2NZUNh0pajwCl2NkzCCACNcBGAsYHQ/s1600/1628820075297015-0.png"></a></p><h2 id="neopixel-pyç¨‹å¼åº«åœ¨æ­¤ä¸‹è¼‰-neopixel-py"><a href="#neopixel-pyç¨‹å¼åº«åœ¨æ­¤ä¸‹è¼‰-neopixel-py" class="headerlink" title="neopixel.pyç¨‹å¼åº«åœ¨æ­¤ä¸‹è¼‰-neopixel.py"></a>neopixel.pyç¨‹å¼åº«åœ¨æ­¤ä¸‹è¼‰-<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/322977569325795009?hl=zh-TW#">neopixel.py</a></h2><p>ä¸¦ä¸Šå‚³åˆ°æ¿å­å¾Œ</p><p>å°‡ RGB LED ç‡ˆæ¢é€£æ¥åˆ° ESP32 æˆ– ESP8266 éå¸¸ç°¡å–®ã€‚æ‚¨éœ€è¦å°‡ 5V æ–½åŠ åˆ° VCC å¼•è…³ï¼ŒGND åˆ° GNDï¼Œä¸¦å°‡ GPIO 5é€£æ¥åˆ° INï¼ˆæ•¸æ“šï¼‰å¼•è…³ã€‚æˆ‘å€‘å°‡æ•¸æ“šå¼•è…³é€£æ¥åˆ° GPIO 5ã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/322977569325795009?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-fUXQhZg0HFw/YRXRFihwvBI/AAAAAAAAey0/RH-qjp4k5YIGzTRQ_XXrT2rthb8xEnkLgCNcBGAsYHQ/w503-h378/image.png"></a></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token punctuation">,</span> sleep<span class="token keyword">import</span> neopixel<span class="token keyword">import</span> timen <span class="token operator">=</span> <span class="token number">8</span> <span class="token comment">#ç‡ˆæ¢æ•¸</span>p <span class="token operator">=</span> <span class="token number">5</span> <span class="token comment">#GPIO</span>  np <span class="token operator">=</span> neopixel<span class="token punctuation">.</span>NeoPixel<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    np<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep_ms<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>    np<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    np<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">130</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep_ms<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span>    np<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>      np<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>      time<span class="token punctuation">.</span>sleep_ms<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>      np<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WS2812B </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQTT-Node-REDé¡¯ç¤ºè¶…éŸ³æ³¢æ¸¬è·æ•¸æ“š+æ§åˆ¶LED-micropython</title>
      <link href="/2021/08/31/mqtt-node-red-xian-shi-chao-yin-bo-ce-ju-shu-ju-kong-zhi-led-micropython/"/>
      <url>/2021/08/31/mqtt-node-red-xian-shi-chao-yin-bo-ce-ju-shu-ju-kong-zhi-led-micropython/</url>
      
        <content type="html"><![CDATA[<h2 id="MQTT-Node-REDé¡¯ç¤ºè¶…éŸ³æ³¢æ¸¬è·æ•¸æ“š-æ§åˆ¶LED-mpython"><a href="#MQTT-Node-REDé¡¯ç¤ºè¶…éŸ³æ³¢æ¸¬è·æ•¸æ“š-æ§åˆ¶LED-mpython" class="headerlink" title="MQTT-Node-REDé¡¯ç¤ºè¶…éŸ³æ³¢æ¸¬è·æ•¸æ“š+æ§åˆ¶LED-mpython"></a>MQTT-Node-REDé¡¯ç¤ºè¶…éŸ³æ³¢æ¸¬è·æ•¸æ“š+æ§åˆ¶LED-mpython</h2><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/737350702666477851?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-jBbqvNqoP68/YQ3-rDZ6tgI/AAAAAAAAeuE/9Cuxom8DbF0mmuBtbd83q_qh8ykGt98GwCNcBGAsYHQ/w282-h320/2.jpg"></a></p><hr><p>è¶…éŸ³æ³¢æ¸¬è·(SC-SR04)å¯¦é©—å›é¡§-<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/737350702666477851?hl=zh-TW#">é»æˆ‘å›é¡§</a></p><p>æ¨¹è“æ´¾ä¸Šè£MQTTå’ŒNord-REDå›é¡§<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/737350702666477851?hl=zh-TW#">-é»æˆ‘å›é¡§</a></p><hr><p>ä¸Šè¿°å…©å€‹éƒ½æ¸¬è©¦å¥½ä¹‹å¾Œå°±é€²å…¥ä¸»ç¨‹å¼éƒ¨ä»½</p><h2 id="ç¨‹å¼"><a href="#ç¨‹å¼" class="headerlink" title="ç¨‹å¼"></a>ç¨‹å¼</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token punctuation">,</span> ADC<span class="token punctuation">,</span> reset<span class="token keyword">from</span> umqtttsimple <span class="token keyword">import</span> MQTTClient<span class="token keyword">import</span> binascii<span class="token punctuation">,</span> micropython<span class="token punctuation">,</span> network<span class="token punctuation">,</span> time<span class="token punctuation">,</span> socket<span class="token punctuation">,</span> machinessid <span class="token operator">=</span> <span class="token string">"---"</span>password <span class="token operator">=</span> <span class="token string">"---------"</span>mqtt_server <span class="token operator">=</span> <span class="token string">"192.168.--.--"</span><span class="token comment">#å°‡å®¢æˆ¶ç«¯IDè½‰æ›ç‚º16é€²ä½,ä»¥ä¾¿MQTTä¼ºæœç«¯è®€å–</span>client_id <span class="token operator">=</span> binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>machine<span class="token punctuation">.</span>unique_id<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#å’ŒNord-REDä¸Šçš„ä¸»é¡Œä¸€è‡´</span>client_adc <span class="token operator">=</span> <span class="token string">b'esp32/value'</span>client_led <span class="token operator">=</span> <span class="token string">b'esp32/output'</span>  led <span class="token operator">=</span> Pin<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> Pin<span class="token punctuation">.</span>OUT<span class="token punctuation">)</span>lastTime <span class="token operator">=</span> <span class="token number">0</span>currentTime <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#wifié€£ç·š</span><span class="token keyword">def</span> connectWifi<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> ssid<span class="token punctuation">,</span> password    wifi <span class="token operator">=</span> network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>    wifi<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>    wifi<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span>    <span class="token keyword">while</span> wifi<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span>            <span class="token keyword">pass</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Connected successful!"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IP: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>wifi<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#æ¨¹è“æ´¾ä¸Šçš„mqttå›æ‡‰è¨‚é–±</span><span class="token keyword">def</span> sub_backCall<span class="token punctuation">(</span>topic<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> led    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> msg <span class="token operator">==</span> <span class="token string">b"on"</span><span class="token punctuation">:</span>        led<span class="token punctuation">.</span>on<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> msg <span class="token operator">==</span> <span class="token string">b'off'</span><span class="token punctuation">:</span>        led<span class="token punctuation">.</span>off<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#é€£ç·šMQTT,é€£ç·šæˆåŠŸå¾Œè¨‚é–±ä¸»é¡Œ</span><span class="token keyword">def</span> connToMqtt<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        client <span class="token operator">=</span> MQTTClient<span class="token punctuation">(</span>client_id<span class="token punctuation">,</span> mqtt_server<span class="token punctuation">)</span>        client<span class="token punctuation">.</span>set_callback<span class="token punctuation">(</span>sub_backCall<span class="token punctuation">)</span>        client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>        client<span class="token punctuation">.</span>subscribe<span class="token punctuation">(</span>client_led<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connect to %s"</span><span class="token operator">%</span>mqtt_server<span class="token punctuation">)</span>        <span class="token keyword">return</span> client    <span class="token comment">#å¦‚æœç„¡æ³•é€£ç·šé‡æ–°é€£ç·š</span>    <span class="token keyword">except</span> OSError <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"not to connected for MQTT server!"</span><span class="token punctuation">)</span>        machine<span class="token punctuation">.</span>reset<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#è®€å–ADCæ•¸å€¼</span><span class="token keyword">def</span> readVal<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    adc <span class="token operator">=</span> ADC<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    adc<span class="token punctuation">.</span>atten<span class="token punctuation">(</span>ADC<span class="token punctuation">.</span>ATTN_11DB<span class="token punctuation">)</span>    ADC<span class="token punctuation">.</span>width<span class="token punctuation">(</span>ADC<span class="token punctuation">.</span>WIDTH_10BIT<span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        val <span class="token operator">=</span>adc<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> valconnectWifi<span class="token punctuation">(</span><span class="token punctuation">)</span>client <span class="token operator">=</span> connToMqtt<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token comment">#æª¢æŸ¥æœ‰ç„¡é€²ä¾†çš„è¨Šæ¯</span>    client<span class="token punctuation">.</span>check_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>    value <span class="token operator">=</span> readVal<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'val = &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">#ç™¼é€å¯èª¿é›»é˜»å€¼åˆ°MQTT</span>    client<span class="token punctuation">.</span>publish<span class="token punctuation">(</span>client_adc<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="Nord-REDå¸ƒç½²"><a href="#Nord-REDå¸ƒç½²" class="headerlink" title="Nord-REDå¸ƒç½²"></a>Nord-REDå¸ƒç½²</h2><p>ç´«è‰²å€å¡Šçš„ä¸»é¡Œè¦å’Œç¨‹å¼ä¸€è‡´</p><pre class="line-numbers language-py" data-language="py"><code class="language-py">client_adc <span class="token operator">=</span> <span class="token string">b'esp32/value'</span>client_led <span class="token operator">=</span> <span class="token string">b'esp32/output'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/737350702666477851?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-UjNJIpcEfoQ/YQ4d5YMNiGI/AAAAAAAAeuM/eymlbVArKiUocFLOe4-azPYExKe4Lw6EwCNcBGAsYHQ/w787-h394/12.jpg"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/737350702666477851?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-OqrVh3vHd_g/YQ4e3FAOw8I/AAAAAAAAeuU/qYfEIm7BhegO4SJzdJm7vF5yxX07zbLcACNcBGAsYHQ/w722-h361/11.jpg"></a></p><p>é–‹é—œPayloadè¦å’Œç¨‹å¼æ¥æ”¶åˆ°çš„msgä¸€è‡´</p><p>#æ¨¹è“æ´¾ä¸Šçš„mqttå›æ‡‰è¨‚é–±</p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">def</span> sub_backCall<span class="token punctuation">(</span>topic<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> led    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> msg <span class="token operator">==</span> <span class="token string">b"on"</span><span class="token punctuation">:</span>        led<span class="token punctuation">.</span>on<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> msg <span class="token operator">==</span> <span class="token string">b'off'</span><span class="token punctuation">:</span> led<span class="token punctuation">.</span>off<span class="token punctuation">(</span><span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/737350702666477851?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-GVF0J3-IZjM/YQ4ftmGvlxI/AAAAAAAAeuk/RnerKZrrD348hK5tn-J2zykWTVhv1WLWgCNcBGAsYHQ/w788-h394/13.jpg"></a></p><hr><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/737350702666477851?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-cN8ezhaa6NQ/YQ4gHA57I5I/AAAAAAAAeus/NVh-r4x2VhMFcoUlEP35jIxhxWlcV4dmgCNcBGAsYHQ/w822-h393/1.jpg"></a></p>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> led </tag>
            
            <tag> hc-sr04 </tag>
            
            <tag> mqtt </tag>
            
            <tag> node-red </tag>
            
            <tag> è¶…éŸ³æ³¢æ¨¡çµ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DCç›´æµé¦¬é”æ¸¬è©¦-micropython</title>
      <link href="/2021/08/31/dc-zhi-liu-ma-da-ce-shi-micropython/"/>
      <url>/2021/08/31/dc-zhi-liu-ma-da-ce-shi-micropython/</url>
      
        <content type="html"><![CDATA[<h1 id="ESP32-DCç›´æµé¦¬é”æ¸¬è©¦"><a href="#ESP32-DCç›´æµé¦¬é”æ¸¬è©¦" class="headerlink" title="ESP32-DCç›´æµé¦¬é”æ¸¬è©¦"></a>ESP32-DCç›´æµé¦¬é”æ¸¬è©¦</h1><h6 id="tags-micropython-dc-moto"><a href="#tags-micropython-dc-moto" class="headerlink" title="tags: micropython dc_moto"></a>tags: <code>micropython</code> <code>dc_moto</code></h6><p><strong>ç›´æµé¦¬é”æ˜¯å¾®æ§æ¿å¸¸å¸¸åœ¨ç”¨çš„å…ƒä»¶ï¼Œæœ€å¸¸æ­é…çš„æ˜¯L298N</strong></p><p><strong>é©…å‹•è£ç½®ï¼Œå› ç‚ºå¦‚æœæŠŠé¦¬é”ç›´æ¥æ¥ä¸Šå¾®æ§æ¿æœƒå°è‡´ç‡’æ‰</strong></p><p>======================================================================</p><h2 id="L298Né©…å‹•æ¿"><a href="#L298Né©…å‹•æ¿" class="headerlink" title="L298Né©…å‹•æ¿"></a>L298Né©…å‹•æ¿</h2><p>OUT1ï¼šç›´æµé›»æ©ŸA+ç«¯å­<br>OUT2ï¼šç›´æµé›»æ©Ÿ A â€“ ç«¯å­<br>OUT3ï¼šç›´æµé›»æ©ŸB+ç«¯å­<br>OUT4ï¼šç›´æµé›»æ©Ÿ B â€“ ç«¯å­</p><p>é€™è£¡è¦ç‰¹åˆ¥æ³¨æ„çš„åœ°æ–¹</p><p>åœ¨åº•éƒ¨ï¼Œæ‚¨æœ‰ä¸€å€‹å¸¶æœ‰ +12Vã€GND å’Œ +5V çš„ä¸‰æ¥ç·šç«¯å­ã€‚Â </p><p>ä¸€èˆ¬ç”¨18650é›»æ± äºŒ~ä¸‰é¡†ä¾›é›»çš„è©±æ¥+12Vå’ŒGNDï¼Œå¦‚æœè¦</p><p>é¡å¤–æ¥å¾®æ§æ¿ä¾‹å¦‚esp32æˆ–arduinoï¼Œåœ¨+5Vå’ŒGNDå°±æ˜¯å¾€å¤–</p><p>ä¾›é›»çµ¦å¾®æ§æ¿çš„5Vã€‚</p><p>æ³¨æ„ï¼šå¦‚æœä¾›é›»è¶…é12Vï¼Œéœ€è¦å»æ‰è·³ç·šï¼Œçµ¦+5Vç«¯ä¾›é›»5Vã€‚</p><p>ä½¿èƒ½(Enble)å¼•è…³  </p><p>å¦‚æœæ‚¨å‘ä½¿èƒ½ A å¼•è…³ç™¼é€ HIGH ä¿¡è™Ÿï¼Œå‰‡é›»æ©Ÿ A å·²æº–å‚™å¥½ä»¥æœ€å¤§é€Ÿåº¦é€²è¡Œæ§åˆ¶ï¼›<br>å¦‚æœå‘ä½¿èƒ½ A å¼•è…³ç™¼é€ LOW ä¿¡è™Ÿï¼Œå‰‡é›»æ©Ÿ A é—œé–‰ï¼›<br>å¦‚æœç™¼é€PWMä¿¡è™Ÿï¼Œå‰‡å¯ä»¥æ§åˆ¶é›»æ©Ÿçš„é€Ÿåº¦ã€‚é›»æ©Ÿé€Ÿåº¦èˆ‡å ç©ºæ¯”æˆæ­£æ¯”ã€‚ä½†æ˜¯ï¼Œ</p><p>è«‹æ³¨æ„ï¼Œ<strong>å°æ–¼å°å ç©ºæ¯”ï¼Œé›»æ©Ÿå¯èƒ½ä¸æœƒæ—‹è½‰</strong>ï¼Œä¸¦ç™¼å‡ºæŒçºŒçš„å—¡å—¡è²ã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/4739341746141337289?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-P-j3FW8Xbpw/YQdexXM61HI/AAAAAAAAemw/Eg9w-rqfbS8KUP7etV1xL1O6CC0g457VwCNcBGAsYHQ/w541-h475/L298N-label.jpg"></a></p><hr><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><strong>ï¼Šè¨˜å¾—L298Nçš„GNDè¦æ‹‰ä¸€æ¢åˆ°ESP32çš„GNDï¼Œå¦å‰‡é¦¬é”ä¸æœƒå‹•ä½œ</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/4739341746141337289?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-emtD7l8K7IE/YQdpsc_-zqI/AAAAAAAAem8/bIDZQ1CeGIUjmlgIgJlSfQI3DE1emAINQCNcBGAsYHQ/w534-h701/ESP32_1_DC_Motor_bb.png"></a></p><hr><h2 id="ç¨‹å¼"><a href="#ç¨‹å¼" class="headerlink" title="ç¨‹å¼"></a>ç¨‹å¼</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py">fromÂ machineÂ importÂ Pin,Â PWM,Â freqfromÂ timeÂ importÂ sleep  classÂ L298N():Â Â Â Â defÂ __init__(self):Â Â Â Â Â Â Â Â self.in1Â &#x3D;Â Pin(26,Â Pin.OUT)Â Â Â Â Â Â Â Â self.in2Â &#x3D;Â Pin(27,Â Pin.OUT)Â Â Â Â Â Â Â Â self.enbleÂ &#x3D;Â PWM(Pin(14),Â freqÂ &#x3D;Â 5000)Â Â Â Â defÂ forward(self,speed):Â Â Â Â Â Â Â Â self.speed(speed)Â Â Â Â Â Â Â Â self.in1.on()Â Â Â Â Â Â Â Â self.in2.off()Â Â Â Â Â Â Â Â print(&quot;forward&quot;)Â Â Â Â defÂ back(self,Â speed):Â Â Â Â Â Â Â Â self.speed(speed)Â Â Â Â Â Â Â Â self.in1.off()Â Â Â Â Â Â Â Â self.in2.on()Â Â Â Â Â Â Â Â print(&quot;back&quot;)Â Â Â Â defÂ stop(self):Â Â Â Â Â Â Â Â self.in1.off()Â Â Â Â Â Â Â Â self.in2.off()Â Â Â Â Â Â Â Â print(&quot;stop&quot;)Â Â Â Â defÂ speed(self,speed):Â Â Â Â Â Â Â Â self.enble.duty(speed)ifÂ __name__Â &#x3D;&#x3D;Â &quot;__main__&quot;:Â Â Â Â l298nÂ &#x3D;Â L298N()Â Â Â Â l298n.forward(800)Â Â Â Â sleep(3)Â Â Â Â l298n.back(600)Â Â Â Â sleep(3)Â Â Â Â l298n.stop()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dc_moto </tag>
            
            <tag> ç›´æµé¦¬é” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQTT+Publish+Node-RED+BMP280-micropython</title>
      <link href="/2021/08/31/mqtt-publish-node-red-bmp280-micropython/"/>
      <url>/2021/08/31/mqtt-publish-node-red-bmp280-micropython/</url>
      
        <content type="html"><![CDATA[<h1 id="MQTT-Publish-Node-RED-BMP280"><a href="#MQTT-Publish-Node-RED-BMP280" class="headerlink" title="MQTT Publish + Node-RED + BMP280"></a>MQTT Publish + Node-RED + BMP280</h1><h6 id="tags-micropython-node-red-bmp280-mqtt"><a href="#tags-micropython-node-red-bmp280-mqtt" class="headerlink" title="tags: micropython node-red bmp280 mqtt"></a>tags: <code>micropython</code> <code>node-red</code> <code>bmp280</code> <code>mqtt</code></h6><p>åƒè€ƒæ–‡ç»-<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/3007345750551778636#">https://randomnerdtutorials.com/micropython-mqtt-publish-bme280-esp32-esp8266/</a></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/3007345750551778636#"><img src="https://lh3.googleusercontent.com/-StQSf00mTdE/YQSTDWUtKTI/AAAAAAAAelU/mlW0TXVWxsYcf_RxakpnuT_LbaXrYk3TACNcBGAsYHQ/w567-h443/image.png"></a></p><p>é€™æ¬¡å¯¦ä½œæ˜¯ä½¿ç”¨MQTTç™¼é€BMP280çš„æ•¸æ“šåˆ°æ¨¹è“æ´¾ä¸Šçš„Node-REDå„€éŒ¶ç‰ˆä¸Š</p><p>æˆ‘æ˜¯åƒè€ƒé€™ç¯‡æ–‡ç« -<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/3007345750551778636#">https://randomnerdtutorials.com/esp32-mqtt-publish-subscribe-arduino-ide/</a></p><p>æ‰€ä»¥æœƒä½¿ç”¨é¡ä¼¼çš„ç¨‹å¼ç¢¼æ‰‹æ³•ä¾†å®Œæˆé …ç›®ã€‚<br>é–‹å§‹ä¹‹å‰å…ˆå‚™å¦¥æ¨¹è“æ´¾ä¸Šæ‰€é ˆçš„è»Ÿç¡¬é«”</p><hr><h2 id="å®‰è£é †åº"><a href="#å®‰è£é †åº" class="headerlink" title="å®‰è£é †åº"></a>å®‰è£é †åº</h2><ol><li><p><strong><em>å®‰è£<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/3007345750551778636#">Mosquitto broker</a>(å¦‚æœæ²’ç©éæ¨¹è“æ´¾,è«‹é€£çµ<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/3007345750551778636#">é€™è£¡</a>å®‰è£æ¨¹è“æ´¾ç³»çµ±</em></strong></p></li><li><p> <strong><em><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/3007345750551778636#">å¦‚ä½•ä½¿ç”¨SSHå’ŒVNCé¡åƒ</a></em></strong></p></li><li><p> <strong><em>å®‰è£ <a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/3007345750551778636#">Node-RED installed</a>Â Â å’ŒÂ <a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/3007345750551778636#">Node-RED Dashboard</a>åœ¨æ¨¹è“æ´¾ä¸Šã€‚</em></strong></p></li><li><p> <strong>_å‚™è¨»:å®‰è£Node-REDæ™‚è‹¥å‡ºç¾éŒ¯èª¤è¨Šæ¯æ”¹ç”¨ä¸‹é¢æ‰€é™„ä¸‹è¼‰ _****<em>bash &lt;(curl -sL <a href="https://raw.githubusercontent.com/node-red/linux-installers/master/deb/update-nodejs-and-nodered">https://raw.githubusercontent.com/node-red/linux-installers/master/deb/update-nodejs-and-nodered</a>)</em></strong></p></li><li><p><strong><em>æ¥ä¸‹ä¾†å…ˆæ¸¬è©¦BMP280æ˜¯å¦å¯æ­£å¸¸æ¸¬æº«åº¦å’Œå£“åŠ›-è«‹åƒè€ƒä¹‹å‰çš„ç´€éŒ„(<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/3007345750551778636#">é»æˆ‘å‚³é€</a>)ã€‚</em></strong></p></li></ol><p>å…ˆä¾†çœ‹ä¸€ä¸‹æ•´å€‹ç™¼é€åŸç†æ¯”è¼ƒå®¹æ˜“ç†è§£è‡ªå·±è¦å­¸çš„é‡é»åœ¨å“ªè£¡</p><p>æ­¤æ¬¡å¯¦é©—æˆ‘åªå¯«å¾ESP32ç™¼é€æ•¸æ“šåˆ°æ¨¹è“æ´¾çš„Mosquittoä»£ç†æ¥æ”¶/ç™¼é€</p><p>ç„¶å¾Œé€šéMQTTé€šä¿¡å”è­°å»æ§åˆ¶ESP32ç™¼é€æ•¸æ“šåˆ°Node-RED,å…¶å¯¦æˆ‘è¦º</p><p>å¾—å’ŒThingSpeakå¾ˆé¡ä¼¼,åªæ˜¯ä½¿ç”¨Node-REDæ›´èƒ½å®¢è£½åŒ–ã€‚</p><p>çœ‹ä¸€ä¸‹é€™å¼µåœ–(æ­¤æ¬¡æˆ‘æ‰€åšçš„å¯¦é©—æ˜¯ä¸‹åœ–çš„ä¸‹æ–¹é‚£å€‹ESP32ç™¼é€çš„éƒ¨ä»½)</p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/3007345750551778636#"><img src="https://lh3.googleusercontent.com/-dbEK49_w9_A/YQP1Mii2utI/AAAAAAAAelI/zvaBPu6JqXIcyeXVPyqIHhOt6CVSYkCrgCNcBGAsYHQ/w642-h341/image.png"></a></p><hr><p>çŸ¥é“åŸç†å¾Œå°±æ˜¯é–‹å§‹é€²å…¥å¯«ç¨‹å¼çš„ä¸»è»¸</p><p>é¦–å…ˆè¦æœ‰ç¶²è·¯å¯ä»¥é€£åˆ°æ•¸è“æ´¾å’ŒESP32ï¼Œç„¶å¾Œåˆ¤æ–·æ˜¯å¦å·²ç¶“é€£ç·š</p><p>å¦‚æœé€£ä¸ä¸Šå°±å†è‡ªå‹•é‡é€£ï¼Œé€£ä¸Šå¾Œå°å‡ºIPï¼Œé€£ä¸Šç¶²è·¯å¾Œï¼Œå°±æ˜¯</p><p>è¦å»å’Œæ¨¹è“æ´¾çš„Mosquitto Brokeré€£ç·šï¼Œä¸€æ¨£å°±æ˜¯åˆ¤æ–·æ˜¯å¦æˆåŠŸ</p><p>é€£ç·šåšå‡ºå°æ‡‰çš„å‹•ä½œã€‚WiFiå’ŒMosquitto Brokeréƒ½é€£ç·šä¹‹å¾Œï¼Œå°±é–‹</p><p>å§‹å¾ESP32å®¢æˆ¶ç«¯ç™¼é€æº«åº¦å’Œå£“åŠ›çš„æ•¸æ“šåˆ°Node-REDçš„ä»‹é¢ä¸Šã€‚</p><hr><h2 id="umqtttsimple-pyä¸Šå‚³åˆ°ESP32"><a href="#umqtttsimple-pyä¸Šå‚³åˆ°ESP32" class="headerlink" title="umqtttsimple.pyä¸Šå‚³åˆ°ESP32"></a>umqtttsimple.pyä¸Šå‚³åˆ°ESP32</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">try</span><span class="token punctuation">:</span>    <span class="token keyword">import</span> usocket <span class="token keyword">as</span> socket<span class="token keyword">except</span><span class="token punctuation">:</span>    <span class="token keyword">import</span> socket<span class="token keyword">import</span> ustruct <span class="token keyword">as</span> struct<span class="token keyword">from</span> ubinascii <span class="token keyword">import</span> hexlify<span class="token keyword">class</span> <span class="token class-name">MQTTException</span><span class="token punctuation">(</span>Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">class</span> <span class="token class-name">MQTTClient</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> client_id<span class="token punctuation">,</span> server<span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> keepalive<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>                 ssl<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> ssl_params<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> port <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            port <span class="token operator">=</span> <span class="token number">8883</span> <span class="token keyword">if</span> ssl <span class="token keyword">else</span> <span class="token number">1883</span>        self<span class="token punctuation">.</span>client_id <span class="token operator">=</span> client_id        self<span class="token punctuation">.</span>sock <span class="token operator">=</span> <span class="token boolean">None</span>        self<span class="token punctuation">.</span>server <span class="token operator">=</span> server        self<span class="token punctuation">.</span>port <span class="token operator">=</span> port        self<span class="token punctuation">.</span>ssl <span class="token operator">=</span> ssl        self<span class="token punctuation">.</span>ssl_params <span class="token operator">=</span> ssl_params        self<span class="token punctuation">.</span>pid <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>cb <span class="token operator">=</span> <span class="token boolean">None</span>        self<span class="token punctuation">.</span>user <span class="token operator">=</span> user        self<span class="token punctuation">.</span>pswd <span class="token operator">=</span> password        self<span class="token punctuation">.</span>keepalive <span class="token operator">=</span> keepalive        self<span class="token punctuation">.</span>lw_topic <span class="token operator">=</span> <span class="token boolean">None</span>        self<span class="token punctuation">.</span>lw_msg <span class="token operator">=</span> <span class="token boolean">None</span>        self<span class="token punctuation">.</span>lw_qos <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>lw_retain <span class="token operator">=</span> <span class="token boolean">False</span>    <span class="token keyword">def</span> <span class="token function">_send_str</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>write<span class="token punctuation">(</span>struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"!H"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>write<span class="token punctuation">(</span>s<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_recv_len</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        n <span class="token operator">=</span> <span class="token number">0</span>        sh <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>            b <span class="token operator">=</span> self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            n <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span>b <span class="token operator">&amp;</span> <span class="token number">0x7f</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> sh            <span class="token keyword">if</span> <span class="token keyword">not</span> b <span class="token operator">&amp;</span> <span class="token number">0x80</span><span class="token punctuation">:</span>                <span class="token keyword">return</span> n            sh <span class="token operator">+=</span> <span class="token number">7</span>    <span class="token keyword">def</span> <span class="token function">set_callback</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>cb <span class="token operator">=</span> f    <span class="token keyword">def</span> <span class="token function">set_last_will</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> topic<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> retain<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> qos<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">assert</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> qos <span class="token operator">&lt;=</span> <span class="token number">2</span>        <span class="token keyword">assert</span> topic        self<span class="token punctuation">.</span>lw_topic <span class="token operator">=</span> topic        self<span class="token punctuation">.</span>lw_msg <span class="token operator">=</span> msg        self<span class="token punctuation">.</span>lw_qos <span class="token operator">=</span> qos        self<span class="token punctuation">.</span>lw_retain <span class="token operator">=</span> retain    <span class="token keyword">def</span> <span class="token function">connect</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> clean_session<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>sock <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span><span class="token punctuation">)</span>        addr <span class="token operator">=</span> socket<span class="token punctuation">.</span>getaddrinfo<span class="token punctuation">(</span>self<span class="token punctuation">.</span>server<span class="token punctuation">,</span> self<span class="token punctuation">.</span>port<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>addr<span class="token punctuation">)</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>ssl<span class="token punctuation">:</span>            <span class="token keyword">import</span> ussl            self<span class="token punctuation">.</span>sock <span class="token operator">=</span> ussl<span class="token punctuation">.</span>wrap_socket<span class="token punctuation">(</span>self<span class="token punctuation">.</span>sock<span class="token punctuation">,</span> <span class="token operator">**</span>self<span class="token punctuation">.</span>ssl_params<span class="token punctuation">)</span>        premsg <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token string">b"\x10\0\0\0\0\0"</span><span class="token punctuation">)</span>        msg <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token string">b"\x04MQTT\x04\x02\0\0"</span><span class="token punctuation">)</span>        sz <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>client_id<span class="token punctuation">)</span>        msg<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> clean_session <span class="token operator">&lt;&lt;</span> <span class="token number">1</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>user <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            sz <span class="token operator">+=</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>user<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>pswd<span class="token punctuation">)</span>            msg<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token number">0xC0</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>keepalive<span class="token punctuation">:</span>            <span class="token keyword">assert</span> self<span class="token punctuation">.</span>keepalive <span class="token operator">&lt;</span> <span class="token number">65536</span>            msg<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">=</span> self<span class="token punctuation">.</span>keepalive <span class="token operator">>></span> <span class="token number">8</span>            msg<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">=</span> self<span class="token punctuation">.</span>keepalive <span class="token operator">&amp;</span> <span class="token number">0x00FF</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>lw_topic<span class="token punctuation">:</span>            sz <span class="token operator">+=</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lw_topic<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lw_msg<span class="token punctuation">)</span>            msg<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token number">0x4</span> <span class="token operator">|</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>lw_qos <span class="token operator">&amp;</span> <span class="token number">0x1</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">3</span> <span class="token operator">|</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>lw_qos <span class="token operator">&amp;</span> <span class="token number">0x2</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">3</span>            msg<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">=</span> self<span class="token punctuation">.</span>lw_retain <span class="token operator">&lt;&lt;</span> <span class="token number">5</span>        i <span class="token operator">=</span> <span class="token number">1</span>        <span class="token keyword">while</span> sz <span class="token operator">></span> <span class="token number">0x7f</span><span class="token punctuation">:</span>            premsg<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>sz <span class="token operator">&amp;</span> <span class="token number">0x7f</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0x80</span>            sz <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">7</span>            i <span class="token operator">+=</span> <span class="token number">1</span>        premsg<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> sz        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>write<span class="token punctuation">(</span>premsg<span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>write<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>        <span class="token comment">#print(hex(len(msg)), hexlify(msg, ":"))</span>        self<span class="token punctuation">.</span>_send_str<span class="token punctuation">(</span>self<span class="token punctuation">.</span>client_id<span class="token punctuation">)</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>lw_topic<span class="token punctuation">:</span>            self<span class="token punctuation">.</span>_send_str<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lw_topic<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>_send_str<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lw_msg<span class="token punctuation">)</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>user <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>_send_str<span class="token punctuation">(</span>self<span class="token punctuation">.</span>user<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>_send_str<span class="token punctuation">(</span>self<span class="token punctuation">.</span>pswd<span class="token punctuation">)</span>        resp <span class="token operator">=</span> self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>        <span class="token keyword">assert</span> resp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x20</span> <span class="token keyword">and</span> resp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x02</span>        <span class="token keyword">if</span> resp<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">raise</span> MQTTException<span class="token punctuation">(</span>resp<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> resp<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">1</span>    <span class="token keyword">def</span> <span class="token function">disconnect</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"\xe0\0"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">ping</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"\xc0\0"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">publish</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> topic<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> retain<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> qos<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        pkt <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token string">b"\x30\0\0\0"</span><span class="token punctuation">)</span>        pkt<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">=</span> qos <span class="token operator">&lt;&lt;</span> <span class="token number">1</span> <span class="token operator">|</span> retain        sz <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>topic<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>        <span class="token keyword">if</span> qos <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>            sz <span class="token operator">+=</span> <span class="token number">2</span>        <span class="token keyword">assert</span> sz <span class="token operator">&lt;</span> <span class="token number">2097152</span>        i <span class="token operator">=</span> <span class="token number">1</span>        <span class="token keyword">while</span> sz <span class="token operator">></span> <span class="token number">0x7f</span><span class="token punctuation">:</span>            pkt<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>sz <span class="token operator">&amp;</span> <span class="token number">0x7f</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0x80</span>            sz <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">7</span>            i <span class="token operator">+=</span> <span class="token number">1</span>        pkt<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> sz        <span class="token comment">#print(hex(len(pkt)), hexlify(pkt, ":"))</span>        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>write<span class="token punctuation">(</span>pkt<span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_send_str<span class="token punctuation">(</span>topic<span class="token punctuation">)</span>        <span class="token keyword">if</span> qos <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>pid <span class="token operator">+=</span> <span class="token number">1</span>            pid <span class="token operator">=</span> self<span class="token punctuation">.</span>pid            struct<span class="token punctuation">.</span>pack_into<span class="token punctuation">(</span><span class="token string">"!H"</span><span class="token punctuation">,</span> pkt<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> pid<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>write<span class="token punctuation">(</span>pkt<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>write<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>        <span class="token keyword">if</span> qos <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>            <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>                op <span class="token operator">=</span> self<span class="token punctuation">.</span>wait_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> op <span class="token operator">==</span> <span class="token number">0x40</span><span class="token punctuation">:</span>                    sz <span class="token operator">=</span> self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>                    <span class="token keyword">assert</span> sz <span class="token operator">==</span> <span class="token string">b"\x02"</span>                    rcv_pid <span class="token operator">=</span> self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>                    rcv_pid <span class="token operator">=</span> rcv_pid<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span> <span class="token operator">|</span> rcv_pid<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>                    <span class="token keyword">if</span> pid <span class="token operator">==</span> rcv_pid<span class="token punctuation">:</span>                        <span class="token keyword">return</span>        <span class="token keyword">elif</span> qos <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>            <span class="token keyword">assert</span> <span class="token number">0</span>    <span class="token keyword">def</span> <span class="token function">subscribe</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> topic<span class="token punctuation">,</span> qos<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">assert</span> self<span class="token punctuation">.</span>cb <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">"Subscribe callback is not set"</span>        pkt <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token string">b"\x82\0\0\0"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pid <span class="token operator">+=</span> <span class="token number">1</span>        struct<span class="token punctuation">.</span>pack_into<span class="token punctuation">(</span><span class="token string">"!BH"</span><span class="token punctuation">,</span> pkt<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>topic<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>pid<span class="token punctuation">)</span>        <span class="token comment">#print(hex(len(pkt)), hexlify(pkt, ":"))</span>        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>write<span class="token punctuation">(</span>pkt<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_send_str<span class="token punctuation">(</span>topic<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>write<span class="token punctuation">(</span>qos<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"little"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>            op <span class="token operator">=</span> self<span class="token punctuation">.</span>wait_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> op <span class="token operator">==</span> <span class="token number">0x90</span><span class="token punctuation">:</span>                resp <span class="token operator">=</span> self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>                <span class="token comment">#print(resp)</span>                <span class="token keyword">assert</span> resp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> pkt<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token keyword">and</span> resp<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> pkt<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>                <span class="token keyword">if</span> resp<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x80</span><span class="token punctuation">:</span>                    <span class="token keyword">raise</span> MQTTException<span class="token punctuation">(</span>resp<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token keyword">return</span>    <span class="token comment"># Wait for a single incoming MQTT message and process it.</span>    <span class="token comment"># Subscribed messages are delivered to a callback previously</span>    <span class="token comment"># set by .set_callback() method. Other (internal) MQTT</span>    <span class="token comment"># messages processed internally.</span>    <span class="token keyword">def</span> <span class="token function">wait_msg</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        res <span class="token operator">=</span> self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>setblocking<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> res <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token boolean">None</span>        <span class="token keyword">if</span> res <span class="token operator">==</span> <span class="token string">b""</span><span class="token punctuation">:</span>            <span class="token keyword">raise</span> OSError<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> res <span class="token operator">==</span> <span class="token string">b"\xd0"</span><span class="token punctuation">:</span>  <span class="token comment"># PINGRESP</span>            sz <span class="token operator">=</span> self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            <span class="token keyword">assert</span> sz <span class="token operator">==</span> <span class="token number">0</span>            <span class="token keyword">return</span> <span class="token boolean">None</span>        op <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> op <span class="token operator">&amp;</span> <span class="token number">0xf0</span> <span class="token operator">!=</span> <span class="token number">0x30</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> op        sz <span class="token operator">=</span> self<span class="token punctuation">.</span>_recv_len<span class="token punctuation">(</span><span class="token punctuation">)</span>        topic_len <span class="token operator">=</span> self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>        topic_len <span class="token operator">=</span> <span class="token punctuation">(</span>topic_len<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> topic_len<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        topic <span class="token operator">=</span> self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>read<span class="token punctuation">(</span>topic_len<span class="token punctuation">)</span>        sz <span class="token operator">-=</span> topic_len <span class="token operator">+</span> <span class="token number">2</span>        <span class="token keyword">if</span> op <span class="token operator">&amp;</span> <span class="token number">6</span><span class="token punctuation">:</span>            pid <span class="token operator">=</span> self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>            pid <span class="token operator">=</span> pid<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span> <span class="token operator">|</span> pid<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>            sz <span class="token operator">-=</span> <span class="token number">2</span>        msg <span class="token operator">=</span> self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>read<span class="token punctuation">(</span>sz<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>cb<span class="token punctuation">(</span>topic<span class="token punctuation">,</span> msg<span class="token punctuation">)</span>        <span class="token keyword">if</span> op <span class="token operator">&amp;</span> <span class="token number">6</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>            pkt <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token string">b"\x40\x02\0\0"</span><span class="token punctuation">)</span>            struct<span class="token punctuation">.</span>pack_into<span class="token punctuation">(</span><span class="token string">"!H"</span><span class="token punctuation">,</span> pkt<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> pid<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>write<span class="token punctuation">(</span>pkt<span class="token punctuation">)</span>        <span class="token keyword">elif</span> op <span class="token operator">&amp;</span> <span class="token number">6</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span>            <span class="token keyword">assert</span> <span class="token number">0</span>    <span class="token comment"># Checks whether a pending message from server is available.</span>    <span class="token comment"># If not, returns immediately with None. Otherwise, does</span>    <span class="token comment"># the same processing as wait_msg.</span>    <span class="token keyword">def</span> <span class="token function">check_msg</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>setblocking<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>wait_msg<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å°‡BME280-pyä¸Šå‚³åˆ°ESP32"><a href="#å°‡BME280-pyä¸Šå‚³åˆ°ESP32" class="headerlink" title="å°‡BME280.pyä¸Šå‚³åˆ°ESP32"></a>å°‡BME280.pyä¸Šå‚³åˆ°ESP32</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> machine <span class="token keyword">import</span> I2C<span class="token keyword">import</span> time<span class="token comment"># BME280 default address.</span>BME280_I2CADDR <span class="token operator">=</span> <span class="token number">0x76</span><span class="token comment"># Operating Modes</span>BME280_OSAMPLE_1 <span class="token operator">=</span> <span class="token number">1</span>BME280_OSAMPLE_2 <span class="token operator">=</span> <span class="token number">2</span>BME280_OSAMPLE_4 <span class="token operator">=</span> <span class="token number">3</span>BME280_OSAMPLE_8 <span class="token operator">=</span> <span class="token number">4</span>BME280_OSAMPLE_16 <span class="token operator">=</span> <span class="token number">5</span><span class="token comment"># BME280 Registers</span>BME280_REGISTER_DIG_T1 <span class="token operator">=</span> <span class="token number">0x88</span>  <span class="token comment"># Trimming parameter registers</span>BME280_REGISTER_DIG_T2 <span class="token operator">=</span> <span class="token number">0x8A</span>BME280_REGISTER_DIG_T3 <span class="token operator">=</span> <span class="token number">0x8C</span>BME280_REGISTER_DIG_P1 <span class="token operator">=</span> <span class="token number">0x8E</span>BME280_REGISTER_DIG_P2 <span class="token operator">=</span> <span class="token number">0x90</span>BME280_REGISTER_DIG_P3 <span class="token operator">=</span> <span class="token number">0x92</span>BME280_REGISTER_DIG_P4 <span class="token operator">=</span> <span class="token number">0x94</span>BME280_REGISTER_DIG_P5 <span class="token operator">=</span> <span class="token number">0x96</span>BME280_REGISTER_DIG_P6 <span class="token operator">=</span> <span class="token number">0x98</span>BME280_REGISTER_DIG_P7 <span class="token operator">=</span> <span class="token number">0x9A</span>BME280_REGISTER_DIG_P8 <span class="token operator">=</span> <span class="token number">0x9C</span>BME280_REGISTER_DIG_P9 <span class="token operator">=</span> <span class="token number">0x9E</span>BME280_REGISTER_DIG_H1 <span class="token operator">=</span> <span class="token number">0xA1</span>BME280_REGISTER_DIG_H2 <span class="token operator">=</span> <span class="token number">0xE1</span>BME280_REGISTER_DIG_H3 <span class="token operator">=</span> <span class="token number">0xE3</span>BME280_REGISTER_DIG_H4 <span class="token operator">=</span> <span class="token number">0xE4</span>BME280_REGISTER_DIG_H5 <span class="token operator">=</span> <span class="token number">0xE5</span>BME280_REGISTER_DIG_H6 <span class="token operator">=</span> <span class="token number">0xE6</span>BME280_REGISTER_DIG_H7 <span class="token operator">=</span> <span class="token number">0xE7</span>BME280_REGISTER_CHIPID <span class="token operator">=</span> <span class="token number">0xD0</span>BME280_REGISTER_VERSION <span class="token operator">=</span> <span class="token number">0xD1</span>BME280_REGISTER_SOFTRESET <span class="token operator">=</span> <span class="token number">0xE0</span>BME280_REGISTER_CONTROL_HUM <span class="token operator">=</span> <span class="token number">0xF2</span>BME280_REGISTER_CONTROL <span class="token operator">=</span> <span class="token number">0xF4</span>BME280_REGISTER_CONFIG <span class="token operator">=</span> <span class="token number">0xF5</span>BME280_REGISTER_PRESSURE_DATA <span class="token operator">=</span> <span class="token number">0xF7</span>BME280_REGISTER_TEMP_DATA <span class="token operator">=</span> <span class="token number">0xFA</span>BME280_REGISTER_HUMIDITY_DATA <span class="token operator">=</span> <span class="token number">0xFD</span><span class="token keyword">class</span> <span class="token class-name">Device</span><span class="token punctuation">:</span>  <span class="token triple-quoted-string string">"""Class for communicating with an I2C device.  Allows reading and writing 8-bit, 16-bit, and byte array values to  registers on the device."""</span>  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> address<span class="token punctuation">,</span> i2c<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Create an instance of the I2C device at the specified address using    the specified I2C interface object."""</span>    self<span class="token punctuation">.</span>_address <span class="token operator">=</span> address    self<span class="token punctuation">.</span>_i2c <span class="token operator">=</span> i2c  <span class="token keyword">def</span> <span class="token function">writeRaw8</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Write an 8-bit value on the bus (without register)."""</span>    value <span class="token operator">=</span> value <span class="token operator">&amp;</span> <span class="token number">0xFF</span>    self<span class="token punctuation">.</span>_i2c<span class="token punctuation">.</span>writeto<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_address<span class="token punctuation">,</span> value<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">write8</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> register<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Write an 8-bit value to the specified register."""</span>    b<span class="token operator">=</span><span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>value <span class="token operator">&amp;</span> <span class="token number">0xFF</span>    self<span class="token punctuation">.</span>_i2c<span class="token punctuation">.</span>writeto_mem<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_address<span class="token punctuation">,</span> register<span class="token punctuation">,</span> b<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">write16</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> register<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Write a 16-bit value to the specified register."""</span>    value <span class="token operator">=</span> value <span class="token operator">&amp;</span> <span class="token number">0xFFFF</span>    b<span class="token operator">=</span><span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span> value <span class="token operator">&amp;</span> <span class="token number">0xFF</span>    b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token punctuation">(</span>value<span class="token operator">>></span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span>    self<span class="token punctuation">.</span>i2c<span class="token punctuation">.</span>writeto_mem<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_address<span class="token punctuation">,</span> register<span class="token punctuation">,</span> value<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">readRaw8</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Read an 8-bit value on the bus (without register)."""</span>    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_i2c<span class="token punctuation">.</span>readfrom<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_address<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'little'</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span>  <span class="token keyword">def</span> <span class="token function">readU8</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> register<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Read an unsigned byte from the specified register."""</span>    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>        self<span class="token punctuation">.</span>_i2c<span class="token punctuation">.</span>readfrom_mem<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_address<span class="token punctuation">,</span> register<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'little'</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span>  <span class="token keyword">def</span> <span class="token function">readS8</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> register<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Read a signed byte from the specified register."""</span>    result <span class="token operator">=</span> self<span class="token punctuation">.</span>readU8<span class="token punctuation">(</span>register<span class="token punctuation">)</span>    <span class="token keyword">if</span> result <span class="token operator">></span> <span class="token number">127</span><span class="token punctuation">:</span>      result <span class="token operator">-=</span> <span class="token number">256</span>    <span class="token keyword">return</span> result  <span class="token keyword">def</span> <span class="token function">readU16</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> register<span class="token punctuation">,</span> little_endian<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Read an unsigned 16-bit value from the specified register, with the    specified endianness (default little endian, or least significant byte    first)."""</span>    result <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>        self<span class="token punctuation">.</span>_i2c<span class="token punctuation">.</span>readfrom_mem<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_address<span class="token punctuation">,</span> register<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'little'</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFFFF</span>    <span class="token keyword">if</span> <span class="token keyword">not</span> little_endian<span class="token punctuation">:</span>      result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>result <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF00</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>result <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> result  <span class="token keyword">def</span> <span class="token function">readS16</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> register<span class="token punctuation">,</span> little_endian<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Read a signed 16-bit value from the specified register, with the    specified endianness (default little endian, or least significant byte    first)."""</span>    result <span class="token operator">=</span> self<span class="token punctuation">.</span>readU16<span class="token punctuation">(</span>register<span class="token punctuation">,</span> little_endian<span class="token punctuation">)</span>    <span class="token keyword">if</span> result <span class="token operator">></span> <span class="token number">32767</span><span class="token punctuation">:</span>      result <span class="token operator">-=</span> <span class="token number">65536</span>    <span class="token keyword">return</span> result  <span class="token keyword">def</span> <span class="token function">readU16LE</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> register<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Read an unsigned 16-bit value from the specified register, in little    endian byte order."""</span>    <span class="token keyword">return</span> self<span class="token punctuation">.</span>readU16<span class="token punctuation">(</span>register<span class="token punctuation">,</span> little_endian<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">readU16BE</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> register<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Read an unsigned 16-bit value from the specified register, in big    endian byte order."""</span>    <span class="token keyword">return</span> self<span class="token punctuation">.</span>readU16<span class="token punctuation">(</span>register<span class="token punctuation">,</span> little_endian<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">readS16LE</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> register<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Read a signed 16-bit value from the specified register, in little    endian byte order."""</span>    <span class="token keyword">return</span> self<span class="token punctuation">.</span>readS16<span class="token punctuation">(</span>register<span class="token punctuation">,</span> little_endian<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">readS16BE</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> register<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Read a signed 16-bit value from the specified register, in big    endian byte order."""</span>    <span class="token keyword">return</span> self<span class="token punctuation">.</span>readS16<span class="token punctuation">(</span>register<span class="token punctuation">,</span> little_endian<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">BME280</span><span class="token punctuation">:</span>  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mode<span class="token operator">=</span>BME280_OSAMPLE_1<span class="token punctuation">,</span> address<span class="token operator">=</span>BME280_I2CADDR<span class="token punctuation">,</span> i2c<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>               <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># Check that mode is valid.</span>    <span class="token keyword">if</span> mode <span class="token keyword">not</span> <span class="token keyword">in</span> <span class="token punctuation">[</span>BME280_OSAMPLE_1<span class="token punctuation">,</span> BME280_OSAMPLE_2<span class="token punctuation">,</span> BME280_OSAMPLE_4<span class="token punctuation">,</span>                    BME280_OSAMPLE_8<span class="token punctuation">,</span> BME280_OSAMPLE_16<span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span>            <span class="token string">'Unexpected mode value &#123;0&#125;. Set mode to one of '</span>            <span class="token string">'BME280_ULTRALOWPOWER, BME280_STANDARD, BME280_HIGHRES, or '</span>            <span class="token string">'BME280_ULTRAHIGHRES'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mode<span class="token punctuation">)</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>_mode <span class="token operator">=</span> mode    <span class="token comment"># Create I2C device.</span>    <span class="token keyword">if</span> i2c <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>      <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">'An I2C object is required.'</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>_device <span class="token operator">=</span> Device<span class="token punctuation">(</span>address<span class="token punctuation">,</span> i2c<span class="token punctuation">)</span>    <span class="token comment"># Load calibration values.</span>    self<span class="token punctuation">.</span>_load_calibration<span class="token punctuation">(</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>write8<span class="token punctuation">(</span>BME280_REGISTER_CONTROL<span class="token punctuation">,</span> <span class="token number">0x3F</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>t_fine <span class="token operator">=</span> <span class="token number">0</span>  <span class="token keyword">def</span> <span class="token function">_load_calibration</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>dig_T1 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readU16LE<span class="token punctuation">(</span>BME280_REGISTER_DIG_T1<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dig_T2 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readS16LE<span class="token punctuation">(</span>BME280_REGISTER_DIG_T2<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dig_T3 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readS16LE<span class="token punctuation">(</span>BME280_REGISTER_DIG_T3<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dig_P1 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readU16LE<span class="token punctuation">(</span>BME280_REGISTER_DIG_P1<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dig_P2 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readS16LE<span class="token punctuation">(</span>BME280_REGISTER_DIG_P2<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dig_P3 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readS16LE<span class="token punctuation">(</span>BME280_REGISTER_DIG_P3<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dig_P4 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readS16LE<span class="token punctuation">(</span>BME280_REGISTER_DIG_P4<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dig_P5 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readS16LE<span class="token punctuation">(</span>BME280_REGISTER_DIG_P5<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dig_P6 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readS16LE<span class="token punctuation">(</span>BME280_REGISTER_DIG_P6<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dig_P7 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readS16LE<span class="token punctuation">(</span>BME280_REGISTER_DIG_P7<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dig_P8 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readS16LE<span class="token punctuation">(</span>BME280_REGISTER_DIG_P8<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dig_P9 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readS16LE<span class="token punctuation">(</span>BME280_REGISTER_DIG_P9<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dig_H1 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readU8<span class="token punctuation">(</span>BME280_REGISTER_DIG_H1<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dig_H2 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readS16LE<span class="token punctuation">(</span>BME280_REGISTER_DIG_H2<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dig_H3 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readU8<span class="token punctuation">(</span>BME280_REGISTER_DIG_H3<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dig_H6 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readS8<span class="token punctuation">(</span>BME280_REGISTER_DIG_H7<span class="token punctuation">)</span>    h4 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readS8<span class="token punctuation">(</span>BME280_REGISTER_DIG_H4<span class="token punctuation">)</span>    h4 <span class="token operator">=</span> <span class="token punctuation">(</span>h4 <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">20</span>    self<span class="token punctuation">.</span>dig_H4 <span class="token operator">=</span> h4 <span class="token operator">|</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readU8<span class="token punctuation">(</span>BME280_REGISTER_DIG_H5<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0F</span><span class="token punctuation">)</span>    h5 <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readS8<span class="token punctuation">(</span>BME280_REGISTER_DIG_H6<span class="token punctuation">)</span>    h5 <span class="token operator">=</span> <span class="token punctuation">(</span>h5 <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">20</span>    self<span class="token punctuation">.</span>dig_H5 <span class="token operator">=</span> h5 <span class="token operator">|</span> <span class="token punctuation">(</span>        self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readU8<span class="token punctuation">(</span>BME280_REGISTER_DIG_H5<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span> <span class="token operator">&amp;</span> <span class="token number">0x0F</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">read_raw_temp</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Reads the raw (uncompensated) temperature from the sensor."""</span>    meas <span class="token operator">=</span> self<span class="token punctuation">.</span>_mode    self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>write8<span class="token punctuation">(</span>BME280_REGISTER_CONTROL_HUM<span class="token punctuation">,</span> meas<span class="token punctuation">)</span>    meas <span class="token operator">=</span> self<span class="token punctuation">.</span>_mode <span class="token operator">&lt;&lt;</span> <span class="token number">5</span> <span class="token operator">|</span> self<span class="token punctuation">.</span>_mode <span class="token operator">&lt;&lt;</span> <span class="token number">2</span> <span class="token operator">|</span> <span class="token number">1</span>    self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>write8<span class="token punctuation">(</span>BME280_REGISTER_CONTROL<span class="token punctuation">,</span> meas<span class="token punctuation">)</span>    sleep_time <span class="token operator">=</span> <span class="token number">1250</span> <span class="token operator">+</span> <span class="token number">2300</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> self<span class="token punctuation">.</span>_mode<span class="token punctuation">)</span>    sleep_time <span class="token operator">=</span> sleep_time <span class="token operator">+</span> <span class="token number">2300</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> self<span class="token punctuation">.</span>_mode<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">575</span>    sleep_time <span class="token operator">=</span> sleep_time <span class="token operator">+</span> <span class="token number">2300</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> self<span class="token punctuation">.</span>_mode<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">575</span>    time<span class="token punctuation">.</span>sleep_us<span class="token punctuation">(</span>sleep_time<span class="token punctuation">)</span>  <span class="token comment"># Wait the required time</span>    msb <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readU8<span class="token punctuation">(</span>BME280_REGISTER_TEMP_DATA<span class="token punctuation">)</span>    lsb <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readU8<span class="token punctuation">(</span>BME280_REGISTER_TEMP_DATA <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>    xlsb <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readU8<span class="token punctuation">(</span>BME280_REGISTER_TEMP_DATA <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>    raw <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>msb <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>lsb <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> xlsb<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span>    <span class="token keyword">return</span> raw  <span class="token keyword">def</span> <span class="token function">read_raw_pressure</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Reads the raw (uncompensated) pressure level from the sensor."""</span>    <span class="token triple-quoted-string string">"""Assumes that the temperature has already been read """</span>    <span class="token triple-quoted-string string">"""i.e. that enough delay has been provided"""</span>    msb <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readU8<span class="token punctuation">(</span>BME280_REGISTER_PRESSURE_DATA<span class="token punctuation">)</span>    lsb <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readU8<span class="token punctuation">(</span>BME280_REGISTER_PRESSURE_DATA <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>    xlsb <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readU8<span class="token punctuation">(</span>BME280_REGISTER_PRESSURE_DATA <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>    raw <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>msb <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>lsb <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> xlsb<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span>    <span class="token keyword">return</span> raw  <span class="token keyword">def</span> <span class="token function">read_raw_humidity</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Assumes that the temperature has already been read """</span>    <span class="token triple-quoted-string string">"""i.e. that enough delay has been provided"""</span>    msb <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readU8<span class="token punctuation">(</span>BME280_REGISTER_HUMIDITY_DATA<span class="token punctuation">)</span>    lsb <span class="token operator">=</span> self<span class="token punctuation">.</span>_device<span class="token punctuation">.</span>readU8<span class="token punctuation">(</span>BME280_REGISTER_HUMIDITY_DATA <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>    raw <span class="token operator">=</span> <span class="token punctuation">(</span>msb <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> lsb    <span class="token keyword">return</span> raw  <span class="token keyword">def</span> <span class="token function">read_temperature</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Get the compensated temperature in 0.01 of a degree celsius."""</span>    adc <span class="token operator">=</span> self<span class="token punctuation">.</span>read_raw_temp<span class="token punctuation">(</span><span class="token punctuation">)</span>    var1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>adc <span class="token operator">>></span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>dig_T1 <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>dig_T2 <span class="token operator">>></span> <span class="token number">11</span><span class="token punctuation">)</span>    var2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>adc <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>dig_T1<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>adc <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>dig_T1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">*</span>        self<span class="token punctuation">.</span>dig_T3<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">14</span>    self<span class="token punctuation">.</span>t_fine <span class="token operator">=</span> var1 <span class="token operator">+</span> var2    <span class="token keyword">return</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>t_fine <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">8</span>  <span class="token keyword">def</span> <span class="token function">read_pressure</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Gets the compensated pressure in Pascals."""</span>    adc <span class="token operator">=</span> self<span class="token punctuation">.</span>read_raw_pressure<span class="token punctuation">(</span><span class="token punctuation">)</span>    var1 <span class="token operator">=</span> self<span class="token punctuation">.</span>t_fine <span class="token operator">-</span> <span class="token number">128000</span>    var2 <span class="token operator">=</span> var1 <span class="token operator">*</span> var1 <span class="token operator">*</span> self<span class="token punctuation">.</span>dig_P6    var2 <span class="token operator">=</span> var2 <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>var1 <span class="token operator">*</span> self<span class="token punctuation">.</span>dig_P5<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">17</span><span class="token punctuation">)</span>    var2 <span class="token operator">=</span> var2 <span class="token operator">+</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>dig_P4 <span class="token operator">&lt;&lt;</span> <span class="token number">35</span><span class="token punctuation">)</span>    var1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>var1 <span class="token operator">*</span> var1 <span class="token operator">*</span> self<span class="token punctuation">.</span>dig_P3<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span>            <span class="token punctuation">(</span><span class="token punctuation">(</span>var1 <span class="token operator">*</span> self<span class="token punctuation">.</span>dig_P2<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    var1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">47</span><span class="token punctuation">)</span> <span class="token operator">+</span> var1<span class="token punctuation">)</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>dig_P1<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">33</span>    <span class="token keyword">if</span> var1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>      <span class="token keyword">return</span> <span class="token number">0</span>    p <span class="token operator">=</span> <span class="token number">1048576</span> <span class="token operator">-</span> adc    p <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">&lt;&lt;</span> <span class="token number">31</span><span class="token punctuation">)</span> <span class="token operator">-</span> var2<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3125</span><span class="token punctuation">)</span> <span class="token operator">//</span> var1    var1 <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>dig_P9 <span class="token operator">*</span> <span class="token punctuation">(</span>p <span class="token operator">>></span> <span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p <span class="token operator">>></span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">25</span>    var2 <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>dig_P8 <span class="token operator">*</span> p<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">19</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">+</span> var1 <span class="token operator">+</span> var2<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>dig_P7 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">read_humidity</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    adc <span class="token operator">=</span> self<span class="token punctuation">.</span>read_raw_humidity<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># print 'Raw humidity = &#123;0:d&#125;'.format (adc)</span>    h <span class="token operator">=</span> self<span class="token punctuation">.</span>t_fine <span class="token operator">-</span> <span class="token number">76800</span>    h <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>adc <span class="token operator">&lt;&lt;</span> <span class="token number">14</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>dig_H4 <span class="token operator">&lt;&lt;</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>dig_H5 <span class="token operator">*</span> h<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>         <span class="token number">16384</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>h <span class="token operator">*</span> self<span class="token punctuation">.</span>dig_H6<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>h <span class="token operator">*</span>                          self<span class="token punctuation">.</span>dig_H3<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">32768</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2097152</span><span class="token punctuation">)</span> <span class="token operator">*</span>                          self<span class="token punctuation">.</span>dig_H2 <span class="token operator">+</span> <span class="token number">8192</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    h <span class="token operator">=</span> h <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>h <span class="token operator">>></span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>h <span class="token operator">>></span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>dig_H1<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span>    h <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">if</span> h <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token keyword">else</span> h    h <span class="token operator">=</span> <span class="token number">419430400</span> <span class="token keyword">if</span> h <span class="token operator">></span> <span class="token number">419430400</span> <span class="token keyword">else</span> h    <span class="token keyword">return</span> h <span class="token operator">>></span> <span class="token number">12</span>  <span class="token decorator annotation punctuation">@property</span>  <span class="token keyword">def</span> <span class="token function">temperature</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token string">"Return the temperature in degrees."</span>    t <span class="token operator">=</span> self<span class="token punctuation">.</span>read_temperature<span class="token punctuation">(</span><span class="token punctuation">)</span>    ti <span class="token operator">=</span> t <span class="token operator">//</span> <span class="token number">100</span>    td <span class="token operator">=</span> t <span class="token operator">-</span> ti <span class="token operator">*</span> <span class="token number">100</span>    <span class="token keyword">return</span> <span class="token string">"&#123;&#125;.&#123;:02d&#125;C"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ti<span class="token punctuation">,</span> td<span class="token punctuation">)</span>  <span class="token decorator annotation punctuation">@property</span>  <span class="token keyword">def</span> <span class="token function">pressure</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token string">"Return the temperature in hPa."</span>    p <span class="token operator">=</span> self<span class="token punctuation">.</span>read_pressure<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">256</span>    pi <span class="token operator">=</span> p <span class="token operator">//</span> <span class="token number">100</span>    pd <span class="token operator">=</span> p <span class="token operator">-</span> pi <span class="token operator">*</span> <span class="token number">100</span>    <span class="token keyword">return</span> <span class="token string">"&#123;&#125;.&#123;:02d&#125;hPa"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>pi<span class="token punctuation">,</span> pd<span class="token punctuation">)</span>  <span class="token decorator annotation punctuation">@property</span>  <span class="token keyword">def</span> <span class="token function">humidity</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token string">"Return the humidity in percent."</span>    h <span class="token operator">=</span> self<span class="token punctuation">.</span>read_humidity<span class="token punctuation">(</span><span class="token punctuation">)</span>    hi <span class="token operator">=</span> h <span class="token operator">//</span> <span class="token number">1024</span>    hd <span class="token operator">=</span> h <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">//</span> <span class="token number">1024</span> <span class="token operator">-</span> hi <span class="token operator">*</span> <span class="token number">100</span>    <span class="token keyword">return</span> <span class="token string">"&#123;&#125;.&#123;:02d&#125;%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>hi<span class="token punctuation">,</span> hd<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="è©¦é©—BMP280"><a href="#è©¦é©—BMP280" class="headerlink" title="è©¦é©—BMP280"></a>è©¦é©—BMP280</h2><h3 id="å…ˆè©¦é©—BMP280æ˜¯å¦æ­£å¸¸é‹ä½œ-å¦‚æœOKå°±å¯åŠ å…¥WiFiå’ŒMQTTå”å®š"><a href="#å…ˆè©¦é©—BMP280æ˜¯å¦æ­£å¸¸é‹ä½œ-å¦‚æœOKå°±å¯åŠ å…¥WiFiå’ŒMQTTå”å®š" class="headerlink" title="å…ˆè©¦é©—BMP280æ˜¯å¦æ­£å¸¸é‹ä½œ,å¦‚æœOKå°±å¯åŠ å…¥WiFiå’ŒMQTTå”å®š"></a>å…ˆè©¦é©—BMP280æ˜¯å¦æ­£å¸¸é‹ä½œ,å¦‚æœOKå°±å¯åŠ å…¥WiFiå’ŒMQTTå”å®š</h3><p>å¦‚æœè¦æ¸¬è©¦bmp280</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token punctuation">,</span> SoftI2C<span class="token punctuation">,</span> reset<span class="token keyword">from</span> bmp280 <span class="token keyword">import</span> BMP280<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">from</span> umqttsimple <span class="token keyword">import</span> MQTTClient<span class="token keyword">import</span> ubinascii<span class="token punctuation">,</span> micropython<span class="token punctuation">,</span> network<span class="token punctuation">,</span> time<span class="token keyword">import</span> machine<span class="token punctuation">,</span> socketi2c <span class="token operator">=</span> SoftI2C<span class="token punctuation">(</span>sda <span class="token operator">=</span> Pin<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">,</span> scl <span class="token operator">=</span> Pin<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">def</span> read_bmp280<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    bmp <span class="token operator">=</span> BMP280<span class="token punctuation">(</span>i2c<span class="token punctuation">)</span>    temp <span class="token operator">=</span> bmp<span class="token punctuation">.</span>temperature    humi <span class="token operator">=</span> <span class="token number">1.8</span> <span class="token operator">*</span> temp <span class="token operator">+</span> <span class="token number">32</span>    pressure <span class="token operator">=</span> bmp<span class="token punctuation">.</span>pressure    <span class="token keyword">return</span> temp<span class="token punctuation">,</span> humi<span class="token punctuation">,</span> pressure<span class="token keyword">print</span><span class="token punctuation">(</span>read_bmp280<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="å¸ƒç½²Node-RED"><a href="#å¸ƒç½²Node-RED" class="headerlink" title="å¸ƒç½²Node-RED"></a>å¸ƒç½²Node-RED</h2><div class="video-container"><iframe src="https://www.youtube.com/embed/IHebAHN_E50" frameborder="0" loading="lazy" allowfullscreen></iframe></div><h2 id="å®Œæ•´ç¨‹å¼ç¢¼"><a href="#å®Œæ•´ç¨‹å¼ç¢¼" class="headerlink" title="å®Œæ•´ç¨‹å¼ç¢¼"></a>å®Œæ•´ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token punctuation">,</span> SoftI2C<span class="token punctuation">,</span> reset<span class="token keyword">from</span> bmp280 <span class="token keyword">import</span> BMP280<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">from</span> umqttsimple <span class="token keyword">import</span> MQTTClient<span class="token keyword">import</span> ubinascii<span class="token punctuation">,</span> micropython<span class="token punctuation">,</span> network<span class="token punctuation">,</span> time<span class="token keyword">import</span> machine<span class="token punctuation">,</span> socket  ssid <span class="token operator">=</span> <span class="token string">"---"</span>password <span class="token operator">=</span> <span class="token string">"---"</span>mqtt_server <span class="token operator">=</span> <span class="token string">"---.---.--.--"</span><span class="token comment">#è½‰æˆç¨ç†±ç¢¼</span>clinet_id <span class="token operator">=</span> ubinascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>machine<span class="token punctuation">.</span>unique_id<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>client_temp <span class="token operator">=</span> <span class="token string">b'esp32/temp'</span>clinet_humi <span class="token operator">=</span> <span class="token string">b'esp32/humi'</span>clinet_pressure <span class="token operator">=</span> <span class="token string">b'esp32/pressure'</span>lastTime <span class="token operator">=</span> <span class="token number">0</span>currentTime <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> connectWifi<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    wifi <span class="token operator">=</span> network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>    wifi<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>    wifi<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span>    <span class="token keyword">while</span> wifi<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span>            <span class="token keyword">pass</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connected successful"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IP: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>wifi<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> conn_mqtt<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> mqtt_server<span class="token punctuation">,</span> clinet_id    <span class="token keyword">try</span><span class="token punctuation">:</span>        client <span class="token operator">=</span> MQTTClient<span class="token punctuation">(</span>clinet_id<span class="token punctuation">,</span> mqtt_server<span class="token punctuation">,</span> <span class="token number">1883</span><span class="token punctuation">)</span>        client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connected to %s"</span><span class="token operator">%</span>mqtt_server<span class="token punctuation">)</span>        <span class="token keyword">return</span> client    <span class="token keyword">except</span> OSError <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"fialed connected MQTT!"</span><span class="token punctuation">)</span>        machine<span class="token punctuation">.</span>reset<span class="token punctuation">(</span><span class="token punctuation">)</span>i2c <span class="token operator">=</span> SoftI2C<span class="token punctuation">(</span>sda <span class="token operator">=</span> Pin<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">,</span> scl <span class="token operator">=</span> Pin<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">def</span> read_bmp280<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    bmp <span class="token operator">=</span> BMP280<span class="token punctuation">(</span>i2c<span class="token punctuation">)</span>    temp <span class="token operator">=</span> bmp<span class="token punctuation">.</span>temperature    humi <span class="token operator">=</span> <span class="token number">1.8</span> <span class="token operator">*</span> temp <span class="token operator">+</span> <span class="token number">32</span>    pressure <span class="token operator">=</span> bmp<span class="token punctuation">.</span>pressure    <span class="token keyword">return</span> temp<span class="token punctuation">,</span> humi<span class="token punctuation">,</span> pressure  connectWifi<span class="token punctuation">(</span><span class="token punctuation">)</span>client <span class="token operator">=</span> conn_mqtt<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    temp<span class="token punctuation">,</span> humi<span class="token punctuation">,</span> pressure <span class="token operator">=</span> read_bmp280<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> humi<span class="token punctuation">,</span> pressure<span class="token punctuation">)</span>    client<span class="token punctuation">.</span>publish<span class="token punctuation">(</span>client_temp<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span>    client<span class="token punctuation">.</span>publish<span class="token punctuation">(</span>clinet_humi<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>humi<span class="token punctuation">)</span><span class="token punctuation">)</span>    client<span class="token punctuation">.</span>publish<span class="token punctuation">(</span>clinet_pressure<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>pressure<span class="token punctuation">)</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><p>åŒ¯å…¥æ‰€é ˆçš„ç¨‹å¼åº«</p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token punctuation">,</span> SoftI2C<span class="token punctuation">,</span> reset<span class="token keyword">from</span> bmp280 <span class="token keyword">import</span> BMP280<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">from</span> umqttsimple <span class="token keyword">import</span> MQTTClient<span class="token keyword">import</span> ubinascii<span class="token punctuation">,</span> micropython<span class="token punctuation">,</span> network<span class="token punctuation">,</span> time<span class="token keyword">import</span> machine<span class="token punctuation">,</span> socket<span class="token comment">#è¨­å®šåŸºåœ°å°åç¨±å’Œå¯†ç¢¼</span><span class="token comment">#mqtt_serverçš„ip(ä¹Ÿå°±æ˜¯æ¨¹è‹ºæ´¾çš„ip)</span>ssid <span class="token operator">=</span> <span class="token string">"---"</span>password <span class="token operator">=</span> <span class="token string">"---"</span>mqtt_server <span class="token operator">=</span> <span class="token string">"192.168.--.--"</span><span class="token comment">#è½‰æˆç¨ç†±ç¢¼</span>clinet_id <span class="token operator">=</span> ubinascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>machine<span class="token punctuation">.</span>unique_id<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#å’ŒNord-REDä¸Šçš„æ¨™ç°½åç¨±ä¸€è‡´</span>client_temp <span class="token operator">=</span> <span class="token string">b'esp32/temp'</span>clinet_humi <span class="token operator">=</span> <span class="token string">b'esp32/humi'</span>clinet_pressure <span class="token operator">=</span> <span class="token string">b'esp32/pressure'</span><span class="token comment">#WIFIé€£çµ</span><span class="token keyword">def</span> connectWifi<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    wifi <span class="token operator">=</span> network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>    wifi<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>    wifi<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span>    <span class="token keyword">while</span> wifi<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span>            <span class="token keyword">pass</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connected successful"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IP: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>wifi<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#MQTTä¼ºæœå™¨é€£çµ</span><span class="token keyword">def</span> conn_mqtt<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> mqtt_server<span class="token punctuation">,</span> clinet_id    <span class="token keyword">try</span><span class="token punctuation">:</span>        client <span class="token operator">=</span> MQTTClient<span class="token punctuation">(</span>clinet_id<span class="token punctuation">,</span> mqtt_server<span class="token punctuation">,</span> <span class="token number">1883</span><span class="token punctuation">)</span>        client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connected to %s"</span><span class="token operator">%</span>mqtt_server<span class="token punctuation">)</span>        <span class="token keyword">return</span> client    <span class="token keyword">except</span> OSError <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"fialed connected MQTT!"</span><span class="token punctuation">)</span>        machine<span class="token punctuation">.</span>reset<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#BMP280åµæ¸¬       </span>i2c <span class="token operator">=</span> SoftI2C<span class="token punctuation">(</span>sda <span class="token operator">=</span> Pin<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">,</span> scl <span class="token operator">=</span> Pin<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">def</span> read_bmp280<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    bmp <span class="token operator">=</span> BMP280<span class="token punctuation">(</span>i2c<span class="token punctuation">)</span>    temp <span class="token operator">=</span> bmp<span class="token punctuation">.</span>temperature    humi <span class="token operator">=</span> <span class="token number">1.8</span> <span class="token operator">*</span> temp <span class="token operator">+</span> <span class="token number">32</span>    pressure <span class="token operator">=</span> bmp<span class="token punctuation">.</span>pressure    <span class="token keyword">return</span> temp<span class="token punctuation">,</span> humi<span class="token punctuation">,</span> pressureconnectWifi<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#WIFIé€£çµå‡½å¼</span>client <span class="token operator">=</span> conn_mqtt<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#åµæ¸¬åˆ°çš„æ•¸æ“šé€éMQTTç™¼é€åˆ°Nord-RED</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    temp<span class="token punctuation">,</span> humi<span class="token punctuation">,</span> pressure <span class="token operator">=</span> read_bmp280<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> humi<span class="token punctuation">,</span> pressure<span class="token punctuation">)</span>    client<span class="token punctuation">.</span>publish<span class="token punctuation">(</span>client_temp<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span>    client<span class="token punctuation">.</span>publish<span class="token punctuation">(</span>clinet_humi<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>humi<span class="token punctuation">)</span><span class="token punctuation">)</span>    client<span class="token punctuation">.</span>publish<span class="token punctuation">(</span>clinet_pressure<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>pressure<span class="token punctuation">)</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://i.imgur.com/neAbxPw.png"></p>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bmp280 </tag>
            
            <tag> mqtt </tag>
            
            <tag> node-red </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webserveræ§åˆ¶ä¼ºæœé¦¬é”-ESP32</title>
      <link href="/2021/08/30/webserver-kong-zhi-si-fu-ma-da-esp32/"/>
      <url>/2021/08/30/webserver-kong-zhi-si-fu-ma-da-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="webserveræ§åˆ¶ä¼ºæœé¦¬é”-ESP32"><a href="#webserveræ§åˆ¶ä¼ºæœé¦¬é”-ESP32" class="headerlink" title="webserveræ§åˆ¶ä¼ºæœé¦¬é”-ESP32"></a>webserveræ§åˆ¶ä¼ºæœé¦¬é”-ESP32</h1><p><em>ä¼ºæœé¦¬é”å°æ–¼å¾®æ§æ¿ç©å®¶ä¸€å®šæ˜¯å†ç†Ÿæ‚‰ä¸éï¼Œä¹Ÿæ˜¯å…¥é–€å¿…å­¸çš„å…ƒä»¶ä¹‹ä¸€ï¼Œåªæ˜¯ç‰¹åˆ¥è¦æ³¨æ„å¦‚æœè¦æ§åˆ¶ï¼’å€‹ä»¥ä¸Šçš„ä¼ºæœé¦¬é”ï¼Œä¸€å®šè¦ä½¿ç”¨å¤–æ¥é›»æºæˆ–è€…PCA9685ã€‚</em></p><p><em>ä¼ºæœé¦¬é”æœ‰å¾ˆå¤šæ¬¾ï¼Œå°å‹å¸¸ç”¨çš„å°±å±¬SG-90ï¼Œå®ƒæ˜¯å¡‘è† é½’è¼ªï¼Œé‚„æœ‰ä¸€ç¨®æ˜¯é‡‘å±¬é½’è¼ª</em></p><h2 id="ä¼ºæœé¦¬é”è¦æ ¼"><a href="#ä¼ºæœé¦¬é”è¦æ ¼" class="headerlink" title="ä¼ºæœé¦¬é”è¦æ ¼"></a>ä¼ºæœé¦¬é”è¦æ ¼</h2><h3 id="SG-90è¦æ ¼"><a href="#SG-90è¦æ ¼" class="headerlink" title="SG-90è¦æ ¼"></a>SG-90è¦æ ¼</h3><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/3986922455798592262?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-nxgapjbWx68/YSXYndzzCVI/AAAAAAAAe2s/qsMvSksBD3YRlIHAnQ1wzBKyuROmzx90wCNcBGAsYHQ/w233-h233/dc05cb93dcb58dbc3887b14f60cced9f.jpg"></a></p><ul><li>  å·¥ä½œé›»å£“ï¼š4.8V.</li><li>  è½‰çŸ©ï¼š1.8kg-cm</li><li>  é‹è½‰é€Ÿåº¦ï¼š0.1ç§’âˆ• 60åº¦</li><li>  è½‰å‹•è§’åº¦ï¼šæœ€å¤§90Â°</li><li>è„ˆè¡å¯¬åº¦ç¯„åœï¼š500~2400Âµs.</li></ul><h3 id="MG90Sè¦æ ¼"><a href="#MG90Sè¦æ ¼" class="headerlink" title="MG90Sè¦æ ¼"></a>MG90Sè¦æ ¼</h3><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/3986922455798592262?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-ClUAItIjGJ4/YSXY8XrU1pI/AAAAAAAAe20/pIH_GpNA5Cgnlsx45QZJ1nlS6Uu6_xsdACNcBGAsYHQ/w273-h273/180303000000b-800x800.jpg"></a></p><ul><li>  é‡‘å±¬éŠ…é½’ã€ç©ºå¿ƒæ¯é›»æ©Ÿã€é›™æ»¾ç è»¸æ‰¿</li><li>  ç”¢å“å‹è™Ÿï¼š<strong>MG90s</strong>.</li><li>  æ‰­åŠ›ï¼š2.0kg(4.8v)</li><li>  é‹è½‰é€Ÿåº¦ï¼š0.11s(4.8v)</li><li>  è½‰å‹•è§’åº¦ï¼šæœ€å¤§90Â°/180Â°</li><li>èˆµæ©Ÿé¡å‹ï¼šæ•¸å­—èˆµæ©Ÿ</li></ul><hr><ol><li> <em>æ­¤æ¬¡å¯¦é©—ä»¥MG-90ç‚ºä¸»</em></li><li> <em>è¦æ§åˆ¶ä¼ºæœé¦¬é”æœ‰å…©ç¨®æ–¹å¼ï¼Œä¸€ç¨®æ˜¯åˆ©ç”¨PWMï¼Œå¦ä¸€ç¨®æ˜¯ä½¿ç”¨ç¾æœ‰çš„åº«åŒ…ä¾†æ§åˆ¶ï¼Œæœ¬æ¬¡å¯¦é©—ä»¥åº«åŒ…ç‚ºä¸»</em></li></ol><h2 id="é¦–å…ˆå®‰è£"><a href="#é¦–å…ˆå®‰è£" class="headerlink" title="é¦–å…ˆå®‰è£"></a>é¦–å…ˆå®‰è£</h2><p> <a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/3986922455798592262?hl=zh-TW#">ESP32 Arduino Servo Library</a></p><h2 id="æ¥ç·šæ–¹å¼"><a href="#æ¥ç·šæ–¹å¼" class="headerlink" title="æ¥ç·šæ–¹å¼"></a>æ¥ç·šæ–¹å¼</h2><ul><li><p>  GND -&gt; ESP32Â GNDÂ pin;</p></li><li><p>  Power -&gt; ESP32Â VINÂ pin;</p></li><li><p>Signal -&gt;Â GPIO 13Â (or any PWM pin).</p><p>  <a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/3986922455798592262?hl=zh-TW#"><img src="https://i1.wp.com/randomnerdtutorials.com/wp-content/uploads/2018/05/servo-esp32-schematic.png?w=750&quality=100&strip=all&ssl=1"></a></p></li></ul><h2 id="é€²è¡Œå¯¦é©—"><a href="#é€²è¡Œå¯¦é©—" class="headerlink" title="é€²è¡Œå¯¦é©—"></a>é€²è¡Œå¯¦é©—</h2><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ESP32Servo.h></span></span> Servo myservo<span class="token punctuation">;</span> <span class="token keyword">int</span> pos <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">int</span> pin <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span> <span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  Serial<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token number">115200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  myservo<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>pin<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">2400</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">void</span> <span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span>pos<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span> pos<span class="token operator">&lt;=</span><span class="token number">160</span><span class="token punctuation">;</span> pos<span class="token operator">+=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    myservo<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span>pos<span class="token operator">=</span><span class="token number">160</span><span class="token punctuation">;</span> pos<span class="token operator">>=</span><span class="token number">20</span><span class="token punctuation">;</span> pos<span class="token operator">-=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    myservo<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ESP32ç¶²é ä¼ºæœå™¨"><a href="#ESP32ç¶²é ä¼ºæœå™¨" class="headerlink" title="ESP32ç¶²é ä¼ºæœå™¨"></a>ESP32ç¶²é ä¼ºæœå™¨</h2><p><em>ä¸Šé¢ä¼ºæœé¦¬é”ç°¡å–®çš„æ¸¬è©¦å®Œæˆå¾Œï¼Œå°±å¯ä»¥ç´å…¥ç¶²é ä¼ºæœå™¨ä¾†æ§åˆ¶ä¼ºæœé¦¬é”ï¼Œé€™è£¡æˆ‘è¦ºå¾—æœ‰é»é›£åº¦çš„æ˜¯ç¶²é çš„ç·¨å¯«ï¼Œå› ç‚ºå¯«HTML+CSSæˆ‘æ²’å­¸éï¼Œæ‰€ä»¥åƒè€ƒç¶²è·¯ä¸Šæ•™å­¸æ–‡çš„ç¶²é ç¯„ä¾‹ã€‚</em></p><p><em>é€™æ˜¯æˆ‘åƒè€ƒæ•™å­¸ç¶²ç«™ä¸Šçš„ç¶²é ç¯„ä¾‹</em></p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>icon<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>data:,<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">    <span class="token selector">body</span> <span class="token punctuation">&#123;</span>        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>        <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">"Trebuchet MS"</span><span class="token punctuation">,</span> Arial<span class="token punctuation">;</span>        <span class="token property">margin-left</span><span class="token punctuation">:</span>auto<span class="token punctuation">;</span>        <span class="token property">margin-right</span><span class="token punctuation">:</span>auto<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token selector">.slider</span> <span class="token punctuation">&#123;</span>        <span class="token property">width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>ESP32 with Servo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Position: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>servoPos<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>range<span class="token punctuation">"</span></span> <span class="token attr-name">min</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>180<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>slider<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>servoSlider<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">servo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">var</span> slider <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"servoSlider"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> servoP <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"servoPos"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    servoP<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> slider<span class="token punctuation">.</span>value<span class="token punctuation">;</span>    slider<span class="token punctuation">.</span><span class="token function-variable function">oninput</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        slider<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>        servoP<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    $<span class="token punctuation">.</span><span class="token function">ajaxSetup</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>timeout<span class="token operator">:</span><span class="token number">1000</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">servo</span><span class="token punctuation">(</span><span class="token parameter">pos</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        $<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/?value="</span> <span class="token operator">+</span> pos <span class="token operator">+</span> <span class="token string">"&amp;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#123;</span>Connection<span class="token operator">:</span> close<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p><em>ä½¿ç”¨ script å’Œ /script æ¨™ç±¤å°‡ä¸€äº› JavaScript ä»£ç¢¼æ·»åŠ åˆ°æ‚¨çš„ HTML æ–‡ä»¶ä¸­ã€‚æ­¤ä»£ç¢¼ç‰‡æ®µä½¿ç”¨ç•¶å‰æ»‘å¡Šä½ç½®æ›´æ–°ç¶²é </em></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">var slider <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"servoSlider"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var servoP <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"servoPos"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>servoP<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> slider<span class="token punctuation">.</span>value<span class="token punctuation">;</span>slider<span class="token punctuation">.</span>oninput <span class="token operator">=</span> <span class="token function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    slider<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>    servoP<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ä¸‹ä¾†çš„å¹¾è¡Œåœ¨æ­¤ç‰¹å®š URL è·¯å¾‘ /?value\u003d[SLIDER_POSITION]&amp; ä¸­çš„ ESP IP åœ°å€ä¸Šç™¼å‡º HTTP GET è«‹æ±‚ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">$<span class="token punctuation">.</span><span class="token function">ajaxSetup</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>timeout<span class="token operator">:</span><span class="token number">1000</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>function <span class="token function">servo</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    $<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/?value="</span> <span class="token operator">+</span> pos <span class="token operator">+</span> <span class="token string">"&amp;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#123;</span>Connection<span class="token operator">:</span> close<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¾‹å¦‚ï¼Œç•¶æ»‘å¡Šä½æ–¼ 0 æ™‚ï¼Œæ‚¨åœ¨ä»¥ä¸‹ URL ä¸Šç™¼å‡º HTTP GET è«‹æ±‚ï¼š</p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;192.168.1.135&#x2F;?value&#x3D;0&amp;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="å®Œæ•´ç¨‹å¼ç¢¼"><a href="#å®Œæ•´ç¨‹å¼ç¢¼" class="headerlink" title="å®Œæ•´ç¨‹å¼ç¢¼"></a>å®Œæ•´ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ESP32Servo.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;WiFi.h></span></span> <span class="token comment">//å®šç¾©ä¼ºæœé¦¬é”</span>Servo myservo<span class="token punctuation">;</span> <span class="token comment">//ä¼ºæœé¦¬é”çš„èµ·å§‹å€¼å’Œè…³ä½</span><span class="token keyword">int</span> pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">int</span> servoPin <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span> <span class="token comment">//WIFI</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>ssid <span class="token operator">=</span> <span class="token string">"---"</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>password <span class="token operator">=</span> <span class="token string">"-----"</span><span class="token punctuation">;</span><span class="token comment">//å°‡ Web æœå‹™å™¨ç«¯å£è™Ÿè¨­ç½®ç‚º 80</span>WiFiServer <span class="token function">server</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ç”¨æ–¼å­˜å„² HTTP è«‹æ±‚çš„è®Šé‡</span>String header<span class="token punctuation">;</span> <span class="token comment">//è§£ç¢¼ HTTP GET å€¼</span>String valueString <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> pos1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> pos2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// ç•¶ä¸‹çš„æ™‚é–“</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> currentTime <span class="token operator">=</span> <span class="token function">millis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ä¹‹å‰çš„æ™‚é–“</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> previousTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// è¶…æ™‚</span><span class="token keyword">const</span> <span class="token keyword">long</span> timeoutTime <span class="token operator">=</span> <span class="token number">2000</span><span class="token punctuation">;</span> <span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  Serial<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token number">115200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//æŒ‡å®šä¼ºæœå™¨ä¸Šçš„pin</span>  myservo<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>servoPin<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">2400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//é€£æ¥wifi</span>  WiFi<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">while</span> <span class="token punctuation">(</span>WiFi<span class="token punctuation">.</span><span class="token function">isConnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Connected successful!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"IP: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>WiFi<span class="token punctuation">.</span><span class="token function">localIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//é€£æ¥ä¼ºæœå™¨</span>  server<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">void</span> <span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token comment">//ç›£è½å®¢æˆ¶ç«¯å‚³å…¥çš„è³‡æ–™</span>  WiFiClient client <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//å¦‚æœæœ‰æ–°å®¢æˆ¶ç«¯é€£æ¥é€²ä¾†,</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    currentTime <span class="token operator">=</span> <span class="token function">millis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    previousTime <span class="token operator">=</span> currentTime<span class="token punctuation">;</span>    Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"New Client."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">//è£½ä½œä¸€å€‹å­—ç¬¦ä¸²ä¾†ä¿å­˜ä¾†è‡ªå®¢æˆ¶ç«¯çš„å‚³å…¥æ•¸æ“š</span>    String currentLine <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>client<span class="token punctuation">.</span><span class="token function">connected</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>currentTime <span class="token operator">-</span> previousTime <span class="token operator">&lt;=</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      currentTime <span class="token operator">=</span> <span class="token function">millis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>client<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">//å¦‚æœæœ‰å­—ç¯€è¦å¾å®¢æˆ¶ç«¯è®€å–ï¼Œ</span>        <span class="token keyword">char</span> c <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®€å–å­—ç¯€</span>        Serial<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å°åˆ°åºåˆ—ç›£æ¸¬çª—å£</span>        header <span class="token operator">+=</span> c<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">//å¦‚æœå­—ç¯€æ˜¯æ›è¡Œç¬¦ //å¦‚æœç•¶å‰è¡Œç‚ºç©ºï¼Œå‰‡è¡¨ç¤ºä¸€è¡Œä¸­æœ‰å…©å€‹æ›è¡Œç¬¦ã€‚</span>          <span class="token comment">//é€™æ˜¯å®¢æˆ¶ç«¯ HTTP è«‹æ±‚çš„çµæŸï¼Œå› æ­¤ç™¼é€éŸ¿æ‡‰ï¼š</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>currentLine<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"HTTP/1.1 200 OK"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Content-type:text/html; charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Connection: close"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//æ¥ä¸‹ä¾†å°±æ˜¯é¡¯ç¤ºç¶²é </span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;!DOCTYPE html>&lt;html>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;head>&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;link rel=\"icon\" href=\"data:,\">"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;style>body &#123; text-align: center; font-family: \"Trebuchet MS\", Arial; margin-left:auto; margin-right:auto;&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">".slider &#123; width: 300px; &#125;&lt;/style>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js\">&lt;/script>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                 <span class="token comment">// Web Page</span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;/head>&lt;body>&lt;h1>ESP32 æ§åˆ¶ä¼ºæœé¦¬é”ç·´ç¿’&lt;/h1>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;p>Position: &lt;span id=\"servoPos\">&lt;/span>&lt;/p>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;input type=\"range\" min=\"0\" max=\"180\" class=\"slider\" id=\"servoSlider\" onchange=\"servo(this.value)\" value=\""</span><span class="token operator">+</span>valueString<span class="token operator">+</span><span class="token string">"\"/>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;script>var slider = document.getElementById(\"servoSlider\");"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"var servoP = document.getElementById(\"servoPos\"); servoP.innerHTML = slider.value;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"slider.oninput = function() &#123; slider.value = this.value; servoP.innerHTML = this.value; &#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"$.ajaxSetup(&#123;timeout:1000&#125;); function servo(pos) &#123; "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"$.get(\"/?value=\" \+ pos + \"&amp;\"); &#123;Connection: close&#125;;&#125;&lt;/script>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                       client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;/body>&lt;/html>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//GET /?value=180&amp; HTTP/1.1</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>header<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"GET /?value="</span><span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              pos1 <span class="token operator">=</span> header<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              pos2 <span class="token operator">=</span> header<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">//å–å¾—=å’Œ&amp;ä¹‹ä¸­çš„å­—ç¯€</span>              valueString <span class="token operator">=</span> header<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>pos1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> pos2<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token comment">//è½‰æ›æˆæ•´æ•¸å¾Œå‚³å…¥ä¼ºæœé¦¬é”ä»¤å…¶å‹•ä½œ</span>              myservo<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>valueString<span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>valueString<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>                     <span class="token comment">// The HTTP response ends with another blank line</span>            client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">//å¦‚æœæœ‰ä¸€å€‹æ›è¡Œç¬¦ï¼Œå°±æ¸…é™¤ currentLine</span>            currentLine <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">!=</span> <span class="token string">'\r'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">//å¦å‰‡å¦‚æœé™¤äº†enterä»¥å¤–é‚„æœ‰åˆ¥çš„å­—ä¸²,æŠŠå®ƒåŠ å…¥currentLineæœ«ç«¯</span>          currentLine <span class="token operator">+=</span> c<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// å°‡headeræ¸…ç©º</span>    header <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token comment">// é—œé–‰é€£çµ</span>    client<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Client disconnected."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/noDl7zL7hIM" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webserver </tag>
            
            <tag> servo </tag>
            
            <tag> ä¼ºæœé¦¬é” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webServeræ§åˆ¶neopixelç‡ˆæ¢-ESP32</title>
      <link href="/2021/08/30/webserver-kong-zhi-neopixel-deng-tiao-esp32/"/>
      <url>/2021/08/30/webserver-kong-zhi-neopixel-deng-tiao-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="webServeræ§åˆ¶RGB-LED-ESP32"><a href="#webServeræ§åˆ¶RGB-LED-ESP32" class="headerlink" title="webServeræ§åˆ¶RGB_LED-ESP32"></a>webServeræ§åˆ¶RGB_LED-ESP32</h1><h6 id="tags-esp32-rbg-webserver"><a href="#tags-esp32-rbg-webserver" class="headerlink" title="tags: esp32 rbg webserver"></a>tags: <code>esp32</code> <code>rbg</code> <code>webserver</code></h6><p><strong>é€™å€‹é …ç›®é‚„æœ‰é»æ¨¡ç³Š,ä½†å°±æˆ‘çš„ç†è§£é‚„æ˜¯å…ˆç´€éŒ„ä¸‹ä¾†</strong></p><p>**</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7721744657667049248?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-EGRdbV6myKU/YSMGxtZ4WBI/AAAAAAAAe2I/kzc_LU3nZIQf1s_6QrPwHXVFcsKIayS5wCNcBGAsYHQ/s1600/1629685406049224-0.png"></a></p><p>**</p><p><strong>åƒè€ƒ-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7721744657667049248?hl=zh-TW#">https://randomnerdtutorials.com/esp32-esp8266-rgb-led-strip-web-server/</a></strong></p><h2 id="æ§åˆ¶æµç¨‹"><a href="#æ§åˆ¶æµç¨‹" class="headerlink" title="æ§åˆ¶æµç¨‹"></a>æ§åˆ¶æµç¨‹</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7721744657667049248?hl=zh-TW#"><img src="https://i1.wp.com/randomnerdtutorials.com/wp-content/uploads/2019/03/color-picker-overview.png?w=750&quality=100&strip=all&ssl=1"></a></p><p><em><strong>ESP32ç¶²çµ¡æœå‹™å™¨é¡¯ç¤ºä¸€å€‹é¡è‰²é¸æ“‡å™¨ã€‚<br>é¸æ“‡é¡è‰²å¾Œï¼Œç€è¦½å™¨æœƒå‘åŒ…å«æ‰€é¸é¡è‰²çš„ Rã€G å’Œ B åƒæ•¸çš„ URL ç™¼å‡ºè«‹æ±‚ã€‚<br>ESP32æ¥æ”¶è«‹æ±‚ä¸¦æ‹†åˆ†æ¯å€‹é¡è‰²åƒæ•¸çš„å€¼ã€‚<br>ç„¶å¾Œï¼Œå®ƒå‘æ§åˆ¶æ¢å¸¶çš„ GPIO ç™¼é€å…·æœ‰ç›¸æ‡‰å€¼çš„ PWM ä¿¡è™Ÿã€‚</strong></em></p><p> <strong>å¦‚æœç‡ˆæ¢æ˜¯ä½¿ç”¨8é¡†LEDä»¥ä¸Š,è¦å¦å¤–åŠ 5Vé›»æºç¨ç«‹ä¾›é›»</strong></p><p>**</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7721744657667049248?hl=zh-TW#"><img src="https://i0.wp.com/randomnerdtutorials.com/wp-content/uploads/2019/03/ESP32-LED-strip-schematic_f.png?w=445&quality=100&strip=all&ssl=1"></a></p><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;WiFi.h></span></span><span class="token comment">//è¨­å®šwifiå¸³å¯†</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> ssid <span class="token operator">=</span> <span class="token string">"---"</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> password <span class="token operator">=</span> <span class="token string">"----------"</span><span class="token punctuation">;</span><span class="token comment">//è¨­å®šç¶²è·¯ä¼ºæœå™¨çš„port</span>WiFiServer <span class="token function">server</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//rgbçš„å°æ‡‰åˆ°ç¶²è·¯çš„åˆå§‹å€¼</span>String redString <span class="token operator">=</span> <span class="token string">"0"</span><span class="token punctuation">;</span>String greenString <span class="token operator">=</span> <span class="token string">"0"</span><span class="token punctuation">;</span>String blueString <span class="token operator">=</span> <span class="token string">"0"</span><span class="token punctuation">;</span><span class="token keyword">int</span> pos1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> pos2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> pos3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> pos4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//å„²å­˜httpè«‹æ±‚çš„è®Šé‡</span>String header<span class="token punctuation">;</span>  <span class="token comment">//RGBçš„PIN</span><span class="token keyword">const</span> <span class="token keyword">int</span> Rpin <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">int</span> Gpin <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">int</span> Bpin <span class="token operator">=</span> <span class="token number">14</span><span class="token punctuation">;</span><span class="token comment">//è¨­å®šæ™‚é–“</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> previousTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> currenTime <span class="token operator">=</span> <span class="token function">millis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Serial<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token number">115200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//é…ç½® LED PWM åŠŸèƒ½</span>    <span class="token function">ledcSetup</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">ledcSetup</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">ledcSetup</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">ledcAttachPin</span><span class="token punctuation">(</span>Rpin<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">ledcAttachPin</span><span class="token punctuation">(</span>Gpin<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">ledcAttachPin</span><span class="token punctuation">(</span>Bpin<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å¸¶å…¥ç¶²è·¯é€£ç·š</span>    WiFi<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>WiFi<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> WL_CONNECTED<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"WiFi connceted success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>WiFi<span class="token punctuation">.</span><span class="token function">localIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    server<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  <span class="token keyword">void</span> <span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    WiFiClient client <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        currenTime <span class="token operator">=</span> <span class="token function">millis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        previousTime <span class="token operator">=</span> currenTime<span class="token punctuation">;</span>        String currentLine <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>         <span class="token keyword">while</span> <span class="token punctuation">(</span>client<span class="token punctuation">.</span><span class="token function">connected</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> currenTime <span class="token operator">-</span> previousTime <span class="token operator">&lt;=</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            currenTime <span class="token operator">=</span> <span class="token function">millis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>client<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">char</span> c <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                Serial<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>                header <span class="token operator">+=</span> c<span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token string">'\\n'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token comment">//å¦‚æœå­—ä¸²ç­‰æ–¼0è¡¨ç¤ºæ¥æ”¶å®Œæˆ</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>currentLine<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"HTTP/1.1 200 OK"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Content-type:text/html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Connection: close"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">// ä»¥ä¸‹ç¶²é çš„éƒ¨ä»½ç›®å‰å°æˆ‘ä¾†èªªé›£åº¦æœ‰é»é«˜,å°¤å…¶èª¿è‰²éƒ¨ä»½,æš«å€Ÿç”¨å­¸ç¿’å°è±¡çš„ç¯„ä¾‹</span>                        <span class="token comment">// Display the HTML web page</span>                        client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;!DOCTYPE html>&lt;html>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;head>&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;link rel=\"icon\" href=\"data:,\">"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;link rel=\"stylesheet\" href=\"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css\">"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/jscolor/2.0.4/jscolor.min.js\">&lt;/script>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;/head>&lt;body>&lt;div class=\"container\">&lt;div class=\"row\">&lt;h1>ESP Color Picker&lt;/h1>&lt;/div>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;a class=\"btn btn-primary btn-lg\" href=\"#\" id=\"change_color\" role=\"button\">Change Color&lt;/a> "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;input class=\"jscolor &#123;onFineChange:'update(this)'&#125;\" id=\"rgb\">&lt;/div>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&lt;script>function update(picker) &#123;document.getElementById('rgb').innerHTML = Math.round(picker.rgb[0]) + ', ' +  Math.round(picker.rgb[1]) + ', ' + Math.round(picker.rgb[2]);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"document.getElementById(\\"</span>change_color\\<span class="token string">").href=\\"</span><span class="token operator">?</span>r\\<span class="token string">" + Math.round(picker.rgb[0]) + \"g\" +  Math.round(picker.rgb[1]) + \"b\" + Math.round(picker.rgb[2]) + \"&amp;\";&#125;&lt;/script>&lt;/body>&lt;/html>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">// The HTTP response ends with another blank line</span>                        client<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">// Request sample: /?r201g32b255&amp;</span>                        <span class="token comment">// Red = 201 | Green = 32 | Blue = 255</span>                        <span class="token comment">//æœå°‹å­—ä¸²è£¡çš„é—œéµå­—,å¦‚æœæœ‰çš„è©±å°±å°‡å®ƒä¸²æ¥åœ¨ä¸€èµ·</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>header<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"GET /?r"</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                            pos1 <span class="token operator">=</span> header<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            pos2 <span class="token operator">=</span> header<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            pos3 <span class="token operator">=</span> header<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            pos4 <span class="token operator">=</span> header<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            redString <span class="token operator">=</span> header<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>pos1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> pos2<span class="token punctuation">)</span><span class="token punctuation">;</span>                            greenString <span class="token operator">=</span> header<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>pos2<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> pos3<span class="token punctuation">)</span><span class="token punctuation">;</span>                            blueString <span class="token operator">=</span> header<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>pos3<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> pos4<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token function">ledcWrite</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> redString<span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token function">ledcWrite</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> greenString<span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token function">ledcWrite</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> blueString<span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span>                        <span class="token keyword">break</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                        <span class="token comment">//å¦å‰‡ç•¶å‰çš„è¡Œç‚ºç©º</span>                        currentLine <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token comment">//å¦‚æœcç‚ºç©ºè¡Œ,å‰‡cåŠ å…¥ç•¶å‰è¡Œ</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">!=</span> <span class="token string">'\\r'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    currentLine <span class="token operator">+=</span> c<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        header <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>        client<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Client disconnected."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>**</p><div class="video-container"><iframe src="https://www.youtube.com/embed/MwvuwqJcddI" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> neopixel </tag>
            
            <tag> webServer </tag>
            
            <tag> rgb </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½åŠŸè€—è—èŠ½-BLE-ESP32</title>
      <link href="/2021/08/30/di-gong-hao-lan-ya-ble-esp32/"/>
      <url>/2021/08/30/di-gong-hao-lan-ya-ble-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="ä½åŠŸè€—è—èŠ½-BLE-ESP32"><a href="#ä½åŠŸè€—è—èŠ½-BLE-ESP32" class="headerlink" title="ä½åŠŸè€—è—èŠ½-BLE-ESP32"></a>ä½åŠŸè€—è—èŠ½-BLE-ESP32</h1><h6 id="tags-esp32-BLE"><a href="#tags-esp32-BLE" class="headerlink" title="tags: esp32 BLE"></a>tags: <code>esp32</code> <code>BLE</code></h6><h2 id="ä»€éº¼æ˜¯ä½åŠŸè€—è—ç‰™ï¼Ÿ"><a href="#ä»€éº¼æ˜¯ä½åŠŸè€—è—ç‰™ï¼Ÿ" class="headerlink" title="ä»€éº¼æ˜¯ä½åŠŸè€—è—ç‰™ï¼Ÿ"></a>ä»€éº¼æ˜¯ä½åŠŸè€—è—ç‰™ï¼Ÿ</h2><p>ä½åŠŸè€—è—ç‰™ï¼Œç°¡ç¨± BLEï¼Œæ˜¯è—ç‰™çš„ä¸€ç¨®ç¯€èƒ½è®Šé«”ã€‚ BLE çš„ä¸»è¦æ‡‰ç”¨æ˜¯çŸ­è·é›¢å‚³è¼¸å°‘é‡æ•¸æ“šï¼ˆä½å¸¶å¯¬ï¼‰ã€‚èˆ‡å§‹çµ‚é–‹å•Ÿçš„è—ç‰™ä¸åŒï¼ŒBLE å§‹çµ‚è™•æ–¼ç¡çœ æ¨¡å¼ï¼Œé™¤éç™¼èµ·é€£æ¥ã€‚  </p><p>é€™ä½¿å¾—å®ƒæ¶ˆè€—éå¸¸ä½çš„åŠŸç‡ã€‚ BLE çš„åŠŸè€—æ¯”è—ç‰™ä½ç´„ 100 å€ï¼ˆå–æ±ºæ–¼ç”¨ä¾‹ï¼‰ã€‚</p><p>ç”±æ–¼å…¶ç‰¹æ€§ï¼ŒBLE é©ç”¨æ–¼éœ€è¦äº¤æ›åœ¨éˆ•æ‰£é›»æ± ä¸Šå®šæœŸé‹è¡Œçš„å°‘é‡æ•¸æ“šçš„æ‡‰ç”¨ç¨‹åºã€‚ä¾‹å¦‚ï¼ŒBLE åœ¨é†«ç™‚ä¿å¥ã€å¥èº«ã€è·Ÿè¸ªã€ä¿¡æ¨™ã€å®‰å…¨å’Œå®¶åº­è‡ªå‹•åŒ–è¡Œæ¥­ä¸­éå¸¸æœ‰ç”¨ã€‚  </p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2973515378701882623?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-FOhL0dvy_Mg/YRNcMNCTl7I/AAAAAAAAexI/5l6KJtkQbNg7C3UMQyF4Y6WHJaVhg0KSwCNcBGAsYHQ/w478-h145/image.png"></a></p><h2 id="BLE-Serverå’ŒClient"><a href="#BLE-Serverå’ŒClient" class="headerlink" title="BLE-Serverå’ŒClient"></a>BLE-Serverå’ŒClient</h2><p>ä½¿ç”¨ä½åŠŸè€—è—ç‰™ï¼Œæœ‰å…©ç¨®é¡å‹çš„è¨­å‚™ï¼šæœå‹™å™¨å’Œå®¢æˆ¶ç«¯ã€‚ ESP32 æ—¢å¯ä»¥ä½œç‚ºå®¢æˆ¶ç«¯ï¼Œä¹Ÿå¯ä»¥ä½œç‚ºæœå‹™å™¨ã€‚  </p><p>æœå‹™å™¨é€šå‘Šå®ƒçš„å­˜åœ¨ï¼Œå› æ­¤å®ƒå¯ä»¥è¢«å…¶ä»–è¨­å‚™ç™¼ç¾ï¼Œä¸¦ä¸”åŒ…å«å®¢æˆ¶ç«¯å¯ä»¥è®€å–çš„æ•¸æ“šã€‚å®¢æˆ¶ç«¯æƒæé™„è¿‘çš„è¨­å‚™ï¼Œç•¶å®ƒæ‰¾åˆ°å®ƒæ­£åœ¨å°‹æ‰¾çš„æœå‹™å™¨æ™‚ï¼Œå®ƒæœƒå»ºç«‹ä¸€å€‹é€£æ¥ä¸¦ç›£è½å‚³å…¥çš„æ•¸æ“šã€‚é€™ç¨±ç‚ºé»å°é»é€šä¿¡ã€‚</p><p>å¦‚å‰æ‰€è¿°ï¼ŒBLE é‚„æ”¯æŒå»£æ’­æ¨¡å¼å’Œç¶²ç‹€ç¶²çµ¡ï¼š  </p><p>å»£æ’­æ¨¡å¼ï¼šæœå‹™å™¨å‘å¤šå€‹é€£æ¥çš„å®¢æˆ¶ç«¯å‚³è¼¸æ•¸æ“šï¼›<br>ç¶²ç‹€ç¶²çµ¡ï¼šæ‰€æœ‰è¨­å‚™éƒ½é€£æ¥èµ·ä¾†ï¼Œé€™æ˜¯ä¸€å€‹å¤šå°å¤šçš„é€£æ¥ã€‚<br>å„˜ç®¡å¯ä»¥å¯¦ç¾å»£æ’­å’Œç¶²ç‹€ç¶²çµ¡è¨­ç½®ï¼Œä½†å®ƒå€‘æ˜¯æœ€è¿‘é–‹ç™¼çš„ï¼Œå› æ­¤ç›®å‰ç‚º ESP32 å¯¦ç¾çš„ç¤ºä¾‹ä¸¦ä¸å¤šã€‚</p><h2 id="GATT"><a href="#GATT" class="headerlink" title="GATT"></a>GATT</h2><p>GATT ä»£è¡¨é€šç”¨å±¬æ€§ï¼Œå®ƒå®šç¾©äº†æš´éœ²çµ¦é€£æ¥çš„ BLE è¨­å‚™çš„åˆ†å±¤æ•¸æ“šçµæ§‹ã€‚é€™æ„å‘³è‘— GATT å®šç¾©äº†å…©å€‹ BLE è¨­å‚™ç™¼é€å’Œæ¥æ”¶æ¨™æº–æ¶ˆæ¯çš„æ–¹å¼ã€‚äº†è§£æ­¤å±¤æ¬¡çµæ§‹å¾ˆé‡è¦ï¼Œå› ç‚ºé€™æ¨£å¯ä»¥æ›´è¼•é¬†åœ°äº†è§£å¦‚ä½•ä½¿ç”¨ BLE å’Œç·¨å¯«æ‡‰ç”¨ç¨‹åºã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2973515378701882623?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-9tSApqWf14Y/YRNdWbNFB9I/AAAAAAAAexQ/ZkpScOpDK1kfVzgbtLfvPqT0-hwTleFvACNcBGAsYHQ/w565-h318/image.png"></a></p><hr><p>é€™äº›å±¬æ€§æè¿°ç­å¦‚ä½•èˆ‡ç‰¹å¾µå€¼äº¤äº’ã€‚åŸºæœ¬ä¸Šï¼Œå®ƒåŒ…å«å¯ä»¥èˆ‡ç‰¹å¾µä¸€èµ·ä½¿ç”¨çš„æ“ä½œå’Œéç¨‹ï¼š</p><p>æ’­é€<br>è®€<br>å¯«ç„¡éŸ¿æ‡‰<br>å¯«<br>é€šçŸ¥<br>è¡¨æ˜<br>ç¶“éèº«ä»½é©—è­‰çš„ç°½åå¯«å…¥<br>æ“´å±•å±¬æ€§</p><hr><h2 id="ä½¿ç”¨ç¯„ä¾‹æª”çš„â€å¯«å…¥â€"><a href="#ä½¿ç”¨ç¯„ä¾‹æª”çš„â€å¯«å…¥â€" class="headerlink" title="ä½¿ç”¨ç¯„ä¾‹æª”çš„â€å¯«å…¥â€"></a>ä½¿ç”¨ç¯„ä¾‹æª”çš„â€å¯«å…¥â€</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2973515378701882623?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-Oy14eF3dwdY/YRSQAYKtDBI/AAAAAAAAexc/22G5NNCu4kAgtGlxMQOpAHJWCf6zPcaBwCNcBGAsYHQ/w895-h504/1.jpg"></a></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">/*    Based on Neil Kolban example for IDF: https://github.com/nkolban/esp32-snippets/blob/master/cpp_utils/tests/BLE%20Tests/SampleWrite.cpp    Ported to Arduino ESP32 by Evandro Copercini*/</span>  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;BLEDevice.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;BLEUtils.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;BLEServer.h></span></span>  <span class="token comment">// See the following for generating UUIDs:</span><span class="token comment">// https://www.uuidgenerator.net/</span>  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SERVICE_UUID</span> <span class="token string">"4fafc201-1fb5-459e-8fcc-c5c9c331914b"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CHARACTERISTIC_UUID</span> <span class="token string">"beb5483e-36e1-4688-b7f5-ea07361b26a8"</span></span><span class="token keyword">class</span> <span class="token class-name">MyCallbacks</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">BLECharacteristicCallbacks</span></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">void</span> <span class="token function">onWrite</span><span class="token punctuation">(</span>BLECharacteristic <span class="token operator">*</span>pCharacteristic<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      std<span class="token double-colon punctuation">::</span>string value <span class="token operator">=</span> pCharacteristic<span class="token operator">-></span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"*********"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"New value: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> value<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>          Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>value\<span class="token punctuation">[</span>i\<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"*********"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  Serial<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token number">115200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"1- Download and install an BLE scanner app in your phone"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"2- Scan for BLE devices in the app"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"3- Connect to MyESP32"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"4- Go to CUSTOM CHARACTERISTIC in CUSTOM SERVICE and write something"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"5- See the magic =)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token class-name">BLEDevice</span><span class="token double-colon punctuation">::</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token string">"MyESP32"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  BLEServer <span class="token operator">*</span>pServer <span class="token operator">=</span> <span class="token class-name">BLEDevice</span><span class="token double-colon punctuation">::</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  BLEService <span class="token operator">*</span>pService <span class="token operator">=</span> pServer<span class="token operator">-></span><span class="token function">createService</span><span class="token punctuation">(</span>SERVICE_UUID<span class="token punctuation">)</span><span class="token punctuation">;</span>  BLECharacteristic <span class="token operator">*</span>pCharacteristic <span class="token operator">=</span> pService<span class="token operator">-></span><span class="token function">createCharacteristic</span><span class="token punctuation">(</span>                                         CHARACTERISTIC_UUID<span class="token punctuation">,</span>                                         BLECharacteristic<span class="token double-colon punctuation">::</span>PROPERTY_READ <span class="token operator">|</span>                                         BLECharacteristic<span class="token double-colon punctuation">::</span>PROPERTY_WRITE                                       <span class="token punctuation">)</span><span class="token punctuation">;</span>  pCharacteristic<span class="token operator">-></span><span class="token function">setCallbacks</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">MyCallbacks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  pCharacteristic<span class="token operator">-></span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">"Hello World"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  pService<span class="token operator">-></span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  BLEAdvertising <span class="token operator">*</span>pAdvertising <span class="token operator">=</span> pServer<span class="token operator">-></span><span class="token function">getAdvertising</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  pAdvertising<span class="token operator">-></span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// put your main code here, to run repeatedly:</span>  <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><p><strong>é¦–å…ˆå°å…¥ BLE åŠŸèƒ½æ‰€éœ€çš„åº«</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;BLEDevice.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;BLEUtils.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;BLEServer.h></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ç„¶å¾Œï¼Œæ‚¨éœ€è¦ç‚º Service å’Œ Characteristic å®šç¾©ä¸€å€‹ UUID,ä¹Ÿå¯ä»¥æµç”¨å…§è¨‚çš„UUID</strong></p><p><strong>æˆ–è¦è‡ªå·±å‰µå»ºè‡ªå·±çš„UUIDå¯ä»¥åˆ°é€™å€‹ç¶²ç«™<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2973515378701882623?hl=zh-TW#">https://www.uuidgenerator.net/</a></strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SERVICE_UUID</span> <span class="token string">"4fafc201-1fb5-459e-8fcc-c5c9c331914b"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CHARACTERISTIC_UUID</span> <span class="token string">"beb5483e-36e1-4688-b7f5-ea07361b26a8"</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>æ¥æ”¶å­—ä¸²çš„é¡</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">MyCallbacks</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">BLECharacteristicCallbacks</span></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">void</span> <span class="token function">onWrite</span><span class="token punctuation">(</span>BLECharacteristic <span class="token operator">*</span>pCharacteristic<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      std<span class="token double-colon punctuation">::</span>string value <span class="token operator">=</span> pCharacteristic<span class="token operator">-></span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"*********"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"New value: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> value<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>          Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>value\<span class="token punctuation">[</span>i\<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"*********"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token operator">*</span><span class="token operator">*</span>åœ¨ <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> ä¸­ï¼Œå®ƒä»¥ <span class="token number">115200</span> çš„æ³¢ç‰¹ç‡å•Ÿå‹•ä¸²è¡Œé€šä¿¡<span class="token operator">*</span><span class="token operator">*</span>```cpp Serial<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token number">115200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å‰µå»ºä¸€å€‹åç‚ºâ€œMyESP32â€çš„ BLE è¨­å‚™ã€‚æ‚¨å¯ä»¥å°‡æ­¤åç¨±æ›´æ”¹ç‚ºæ‚¨å–œæ­¡çš„ä»»ä½•åç¨±ã€‚</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token class-name">BLEDevice</span><span class="token double-colon punctuation">::</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token string">"MyESP32"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>åœ¨ä»¥ä¸‹è¡Œä¸­ï¼Œæ‚¨å°‡ BLE è¨­å‚™è¨­ç½®ç‚ºæœå‹™å™¨ã€‚</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">BLEServer <span class="token operator">*</span>pServer <span class="token operator">=</span> <span class="token class-name">BLEDevice</span><span class="token double-colon punctuation">::</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>åœ¨é€™ä¹‹å¾Œï¼Œä½ çš„BLEæœå‹™å™¨å‰µå»ºçš„UUIDå‰é¢å®šç¾©çš„æœå‹™ã€‚</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">BLEService <span class="token operator">*</span>pService <span class="token operator">=</span> pServer<span class="token operator">-></span><span class="token function">createService</span><span class="token punctuation">(</span>SERVICE_UUID<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>è¨­ç½®è©²æœå‹™çš„ç‰¹å¾µã€‚å¦‚æ‚¨æ‰€è¦‹ï¼Œæ‚¨é‚„ä½¿ç”¨äº†ä¹‹å‰å®šç¾©çš„ UUIDï¼Œæ‚¨éœ€è¦å°‡ç‰¹å¾µçš„å±¬æ€§ä½œç‚ºåƒæ•¸å‚³éã€‚åœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œå®ƒæ˜¯ï¼šè®€å’Œå¯«ã€‚</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">BLECharacteristic <span class="token operator">*</span>pCharacteristic <span class="token operator">=</span> pService<span class="token operator">-></span><span class="token function">createCharacteristic</span><span class="token punctuation">(</span>                                         CHARACTERISTIC_UUID<span class="token punctuation">,</span>                                         BLECharacteristic<span class="token double-colon punctuation">::</span>PROPERTY_READ <span class="token operator">|</span>                                         BLECharacteristic<span class="token double-colon punctuation">::</span>PROPERTY_WRITE                                       <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å‰µå»ºsetCallbacks() æ–¹æ³•æ¥æ”¶å‚³ä¾†çš„å€¼æˆ–å­—ä¸²</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">pCharacteristic<span class="token operator">-></span><span class="token function">setCallbacks</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">MyCallbacks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å‰µå»ºç‰¹å¾µå¾Œï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ setValue() æ–¹æ³•è¨­ç½®å…¶å€¼ã€‚</strong></p><p><strong>æˆ‘å€‘å°‡å€¼è¨­ç½®ç‚ºæ–‡æœ¬â€œHello World èªª Neilâ€ã€‚æ‚¨å¯ä»¥å°‡æ­¤æ–‡æœ¬æ›´æ”¹ç‚ºæ‚¨å–œæ­¡çš„ä»»ä½•å…§å®¹ã€‚ä¾‹å¦‚ï¼Œåœ¨æœªä¾†çš„é …ç›®ä¸­ï¼Œè©²æ–‡æœ¬å¯ä»¥æ˜¯å‚³æ„Ÿå™¨è®€æ•¸æˆ–ç‡ˆçš„ç‹€æ…‹ã€‚</strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">pCharacteristic<span class="token operator">-></span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">"Hello World"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>``<span class="token operator">*</span><span class="token operator">*</span>æœ€å¾Œï¼Œæ‚¨å¯ä»¥å•Ÿå‹•æœå‹™ï¼Œä¸¦é€²è¡Œå»£å‘Šï¼Œä»¥ä¾¿å…¶ä»– BLE è¨­å‚™å¯ä»¥æƒæä¸¦æ‰¾åˆ°æ­¤ BLE è¨­å‚™<span class="token operator">*</span><span class="token operator">*</span>  ```cppBLEAdvertising <span class="token operator">*</span>pAdvertising <span class="token operator">=</span> pServer<span class="token operator">-></span><span class="token function">getAdvertising</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  pAdvertising<span class="token operator">-></span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p><strong>ä¸Šå‚³å®Œæˆä¹‹å¾Œ,æ‰“é–‹ç›£æ¸¬çª—å£,æŒ‰ä¸€ä¸‹ESP32çš„RESET,æœƒå‡ºç¾ä»¥ä¸‹ç•«é¢</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2973515378701882623?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-5jO95-XvQu0/YRSSPJ9F-AI/AAAAAAAAexw/nz3F5DWsJ9oNFZmLf8xf-z7AsQZglJ_-wCNcBGAsYHQ/w767-h432/2.jpg"></a></p><p><strong>ä¸‹è¼‰æ‰‹æ©ŸAPP <a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2973515378701882623?hl=zh-TW#">nRF Connect</a>Â ä¸¦é–‹å•“APP</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2973515378701882623?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-qlUi7497sg4/YRSTXZb1f-I/AAAAAAAAeyE/LbzEQbE2hvs3MFDjERCYdpcVf4fDohQsACNcBGAsYHQ/s1600/1628738390279946-0.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2973515378701882623?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-Nf9DHYKj3AM/YRSTVOlwm6I/AAAAAAAAeyA/pKUuFBbdjZo_8FGJdX2MmLcHL1c1hPLhwCNcBGAsYHQ/s1600/1628738380362595-1.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2973515378701882623?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-1JkgS9GGNVs/YRSTS3iQbwI/AAAAAAAAex8/RXyTRNwbU58Qrr1PPOv3KNTTaf5Dj68JQCNcBGAsYHQ/s1600/1628738377493328-2.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2973515378701882623?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-9WgHaxVf2FI/YRSTSLnMzvI/AAAAAAAAex4/Gye9ZeTj3eMmdO9UEjNMTS95IOFWJOblgCNcBGAsYHQ/s1600/1628738372129606-3.png"></a></p><p><strong>æŒ‰ä¸‹SENDå¾Œ</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2973515378701882623?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-qFsywMyHNCE/YRSToPLpGQI/AAAAAAAAeyU/WeOP7MtlzeMjBweA6cIOJIYuwvZE93XowCNcBGAsYHQ/w879-h495/3.jpg"></a></p><p>åƒè€ƒ-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2973515378701882623?hl=zh-TW#">https://randomnerdtutorials.com/esp32-bluetooth-low-energy-ble-arduino-ide/</a></p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BLE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQTT-Nord-REDé¡¯ç¤ºè¶…éŸ³æ³¢æ¸¬è·æ•¸æ“š+æ§åˆ¶LED</title>
      <link href="/2021/08/30/mqtt-nord-red-xian-shi-chao-yin-bo-ce-ju-shu-ju-kong-zhi-led/"/>
      <url>/2021/08/30/mqtt-nord-red-xian-shi-chao-yin-bo-ce-ju-shu-ju-kong-zhi-led/</url>
      
        <content type="html"><![CDATA[<h2 id="MQTT-Nord-REDé¡¯ç¤ºè¶…éŸ³æ³¢æ¸¬è·æ•¸æ“š-æ§åˆ¶LED"><a href="#MQTT-Nord-REDé¡¯ç¤ºè¶…éŸ³æ³¢æ¸¬è·æ•¸æ“š-æ§åˆ¶LED" class="headerlink" title="MQTT-Nord-REDé¡¯ç¤ºè¶…éŸ³æ³¢æ¸¬è·æ•¸æ“š+æ§åˆ¶LED"></a>MQTT-Nord-REDé¡¯ç¤ºè¶…éŸ³æ³¢æ¸¬è·æ•¸æ“š+æ§åˆ¶LED</h2><h2 id="è¶…éŸ³æ³¢æ¨¡çµ„-HC-SC04-æ¸¬è©¦å›é¡§-é»æˆ‘å›é¡§"><a href="#è¶…éŸ³æ³¢æ¨¡çµ„-HC-SC04-æ¸¬è©¦å›é¡§-é»æˆ‘å›é¡§" class="headerlink" title="è¶…éŸ³æ³¢æ¨¡çµ„(HC-SC04)æ¸¬è©¦å›é¡§-é»æˆ‘å›é¡§"></a>è¶…éŸ³æ³¢æ¨¡çµ„(HC-SC04)æ¸¬è©¦å›é¡§-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/3385819142688987744?hl=zh-TW#">é»æˆ‘å›é¡§</a></h2><h2 id="MQTTç›¸é—œå¸ƒæš‘-é»æˆ‘å›é¡§"><a href="#MQTTç›¸é—œå¸ƒæš‘-é»æˆ‘å›é¡§" class="headerlink" title="MQTTç›¸é—œå¸ƒæš‘-é»æˆ‘å›é¡§"></a>MQTTç›¸é—œå¸ƒæš‘-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/3385819142688987744?hl=zh-TW#">é»æˆ‘å›é¡§</a></h2><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;Ultrasonic.h&gt;#include &lt;WiFi.h&gt;#include &lt;PubSubClient.h&gt;UltrasonicÂ ultrasonic(32,Â 33);constÂ char*Â ssidÂ &#x3D;Â &quot;---&quot;;constÂ char*Â passwordÂ &#x3D;Â &quot;-----&quot;;constÂ char*Â mqttServerÂ &#x3D;Â &quot;192.168.67.22&quot;;&#x2F;&#x2F;wifiå®¢æˆ¶ç«¯åŠMQTTå®¢æˆ¶ç«¯ä»£æ•¸WiFiClientÂ espClient;PubSubClientÂ client(espClient);&#x2F;&#x2F;è¨­å®šwifivoidÂ wifiConn()&#123;Â Â WiFi.begin(ssid,Â password);Â Â whileÂ (WiFi.status()Â !&#x3D;Â WL_CONNECTED)&#123;Â Â Â Â Serial.print(&quot;.&quot;);Â Â Â Â delay(50);Â Â &#125;Â Â Serial.println(&quot;ConnectedÂ successful!&quot;);Â Â Serial.println(WiFi.localIP());&#125;  &#x2F;&#x2F;æª¢æŸ¥è¨‚é–±çš„å­—ä¸²æ˜¯å¦å«æœ‰onå’Œoff,å¦‚æœæ¯”å°ä¸‹ä¾†æ˜¯&#x2F;&#x2F;nord-redè£¡çš„æ¨™é ­ä¸€æ¨£,è€Œä¸”åŒ…å«onå°±é–‹ç‡ˆ,offå°±é—œç‡ˆvoidÂ callback(charÂ *topic,Â byteÂ *message,Â unsignedÂ intÂ length)&#123;Â Â StringÂ messageDist;Â Â Serial.print(&quot;MessageÂ arrivedÂ onÂ topic:Â &quot;);Â Â Serial.print(topic);Â Â Serial.print(&quot;.Â Message:Â &quot;);Â Â forÂ (intÂ iÂ &#x3D;Â 0;Â iÂ &lt;Â length;Â i++)Â Â &#123;Â Â Â Â Serial.print(char(message\[i\]));Â Â Â Â messageDistÂ +&#x3D;Â char(message\[i\]);Â Â &#125;Â Â Serial.println();Â Â ifÂ (String(topic)Â &#x3D;&#x3D;Â &quot;esp32&#x2F;output&quot;)&#123;Â Â Â Â ifÂ (messageDistÂ &#x3D;&#x3D;Â &quot;on&quot;)&#123;Â Â Â Â Â Â Serial.print(&quot;on&quot;);Â Â Â Â Â Â digitalWrite(LED_BUILTIN,Â HIGH);Â Â Â Â &#125;elseÂ ifÂ (messageDistÂ &#x3D;&#x3D;Â &quot;off&quot;)&#123;Â Â Â Â Â Â Serial.print(&quot;off&quot;);Â Â Â Â Â Â digitalWrite(LED_BUILTIN,Â LOW);Â Â Â Â &#125;Â Â &#125;&#125;&#x2F;&#x2F;è¬ä¸€é€£ä¸ä¸Šmqttå°±é‡æ–°é€£ç·švoidÂ reconnect()&#123;Â Â whileÂ (!Â client.connected())&#123;Â Â Â Â Serial.print(&quot;AttemptingÂ MQTTÂ connection...&quot;);Â Â Â Â ifÂ (client.connect(&quot;esp32Client&quot;))&#123;Â Â Â Â Â Â Serial.println(&quot;connected&quot;);Â Â Â Â Â Â client.subscribe(&quot;esp32&#x2F;output&quot;);Â Â Â Â &#125;elseÂ &#123;Â Â Â Â Â Â Serial.print(&quot;failedÂ connectedÂ isÂ :Â &quot;);Â Â Â Â Â Â Serial.println(client.state());Â Â Â Â Â Â delay(2000);Â Â Â Â &#125;Â Â &#125;&#125;voidÂ setup()Â &#123;Â Â Serial.begin(115200);Â Â wifiConn();Â Â client.setServer(mqttServer,Â 1883);Â Â client.setCallback(callback);Â Â pinMode(LED_BUILTIN,Â OUTPUT);&#125;voidÂ loop()Â &#123;Â Â Â Â ifÂ (!Â client.connected())&#123;Â Â Â Â Â Â reconnect();Â Â Â Â &#125;Â Â Â Â client.loop();Â Â Â Â longÂ lastTimeÂ &#x3D;Â 0;Â Â Â Â longÂ currentTimeÂ &#x3D;Â millis();Â Â Â Â floatÂ distanceÂ &#x3D;Â 0;Â Â Â Â ifÂ (currentTimeÂ -Â lastTimeÂ &gt;Â 3000)&#123;Â Â Â Â Â Â lastTimeÂ &#x3D;Â currentTime;Â Â Â Â Â Â distanceÂ &#x3D;Â ultrasonic.read(CM);Â Â Â Â Â Â Serial.println(distance);Â Â Â Â Â Â charÂ distStr[8]Â &#x3D;Â &quot;&quot;;Â Â Â Â Â Â dtostrf(distance,Â 1,Â 2,Â distStr);Â Â Â Â Â Â Serial.print(&quot;Distance:Â &quot;);Â Â Â Â Â Â Serial.print(distance);Â Â Â Â Â Â Serial.println(&quot;CM&quot;);Â Â Â Â Â Â client.publish(&quot;esp32&#x2F;distanceRead&quot;,Â distStr);Â Â Â Â Â Â delay(500);Â Â Â Â &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/3385819142688987744?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-rw-XPPQUrZQ/YQylpvMqgMI/AAAAAAAAeq4/AOgDSHZxzNgssqLlrKNTHm1Vxks8qHaMwCNcBGAsYHQ/w505-h1005/1628218778514172-0.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hc-sr04 </tag>
            
            <tag> mqtt </tag>
            
            <tag> nord-red </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ESP32-DCç›´æµé¦¬é”æ¸¬è©¦</title>
      <link href="/2021/08/29/esp32-dc-zhi-liu-ma-da-ce-shi/"/>
      <url>/2021/08/29/esp32-dc-zhi-liu-ma-da-ce-shi/</url>
      
        <content type="html"><![CDATA[<h1 id="ESP32-DCç›´æµé¦¬é”æ¸¬è©¦"><a href="#ESP32-DCç›´æµé¦¬é”æ¸¬è©¦" class="headerlink" title="ESP32-DCç›´æµé¦¬é”æ¸¬è©¦"></a>ESP32-DCç›´æµé¦¬é”æ¸¬è©¦</h1><h6 id="tags-esp32-dc-moto-l298n"><a href="#tags-esp32-dc-moto-l298n" class="headerlink" title="tags: esp32 dc moto l298n"></a>tags: <code>esp32</code> <code>dc moto</code> <code>l298n</code></h6><p><strong>ç›´æµé¦¬é”æ˜¯å¾®æ§æ¿å¸¸å¸¸åœ¨ç”¨çš„å…ƒä»¶ï¼Œæœ€å¸¸æ­é…çš„æ˜¯L298N</strong></p><p><strong>é©…å‹•è£ç½®ï¼Œå› ç‚ºå¦‚æœæŠŠé¦¬é”ç›´æ¥æ¥ä¸Šå¾®æ§æ¿æœƒå°è‡´ç‡’æ‰</strong></p><h2 id="L298Né©…å‹•æ¿"><a href="#L298Né©…å‹•æ¿" class="headerlink" title="L298Né©…å‹•æ¿"></a>L298Né©…å‹•æ¿</h2><p>OUT1ï¼šç›´æµé›»æ©ŸA+ç«¯å­<br>OUT2ï¼šç›´æµé›»æ©Ÿ A â€“ ç«¯å­<br>OUT3ï¼šç›´æµé›»æ©ŸB+ç«¯å­<br>OUT4ï¼šç›´æµé›»æ©Ÿ B â€“ ç«¯å­</p><p>é€™è£¡è¦ç‰¹åˆ¥æ³¨æ„çš„åœ°æ–¹</p><p>åœ¨åº•éƒ¨ï¼Œæ‚¨æœ‰ä¸€å€‹å¸¶æœ‰ +12Vã€GND å’Œ +5V çš„ä¸‰æ¥ç·šç«¯å­ã€‚Â </p><p>ä¸€èˆ¬ç”¨18650é›»æ± äºŒ~ä¸‰é¡†ä¾›é›»çš„è©±æ¥+12Vå’ŒGNDï¼Œå¦‚æœè¦</p><p>é¡å¤–æ¥å¾®æ§æ¿ä¾‹å¦‚esp32æˆ–arduinoï¼Œåœ¨+5Vå’ŒGNDå°±æ˜¯å¾€å¤–</p><p>ä¾›é›»çµ¦å¾®æ§æ¿çš„5Vã€‚</p><p>æ³¨æ„ï¼šå¦‚æœä¾›é›»è¶…é12Vï¼Œéœ€è¦å»æ‰è·³ç·šï¼Œçµ¦+5Vç«¯ä¾›é›»5Vã€‚</p><p>ä½¿èƒ½(Enble)å¼•è…³  </p><p>å¦‚æœæ‚¨å‘ä½¿èƒ½ A å¼•è…³ç™¼é€ HIGH ä¿¡è™Ÿï¼Œå‰‡é›»æ©Ÿ A å·²æº–å‚™å¥½ä»¥æœ€å¤§é€Ÿåº¦é€²è¡Œæ§åˆ¶ï¼›<br>å¦‚æœå‘ä½¿èƒ½ A å¼•è…³ç™¼é€ LOW ä¿¡è™Ÿï¼Œå‰‡é›»æ©Ÿ A é—œé–‰ï¼›<br>å¦‚æœç™¼é€PWMä¿¡è™Ÿï¼Œå‰‡å¯ä»¥æ§åˆ¶é›»æ©Ÿçš„é€Ÿåº¦ã€‚é›»æ©Ÿé€Ÿåº¦èˆ‡å ç©ºæ¯”æˆæ­£æ¯”ã€‚ä½†æ˜¯ï¼Œ</p><p>è«‹æ³¨æ„ï¼Œ<strong>å°æ–¼å°å ç©ºæ¯”ï¼Œé›»æ©Ÿå¯èƒ½ä¸æœƒæ—‹è½‰</strong>ï¼Œä¸¦ç™¼å‡ºæŒçºŒçš„å—¡å—¡è²ã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7079589207275388404?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-P-j3FW8Xbpw/YQdexXM61HI/AAAAAAAAemw/Eg9w-rqfbS8KUP7etV1xL1O6CC0g457VwCNcBGAsYHQ/w541-h475/L298N-label.jpg"></a></p><hr><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><strong>ï¼Šè¨˜å¾—L298Nçš„GNDè¦æ‹‰ä¸€æ¢åˆ°ESP32çš„GNDï¼Œå¦å‰‡é¦¬é”ä¸æœƒå‹•ä½œ</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7079589207275388404?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-emtD7l8K7IE/YQdpsc_-zqI/AAAAAAAAem8/bIDZQ1CeGIUjmlgIgJlSfQI3DE1emAINQCNcBGAsYHQ/w534-h701/ESP32_1_DC_Motor_bb.png"></a></p><hr><h2 id="ç¨‹å¼"><a href="#ç¨‹å¼" class="headerlink" title="ç¨‹å¼"></a>ç¨‹å¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">intÂ M1Â &#x3D;Â 27;intÂ M2Â &#x3D;Â 26;intÂ enbÂ &#x3D;Â 14;intÂ dutyÂ &#x3D;Â 150;voidÂ setup()Â &#123;Â Â Serial.begin(115200);Â Â pinMode(M1,Â OUTPUT);Â Â pinMode(M2,Â OUTPUT);Â Â pinMode(enb,Â OUTPUT);  Â Â ledcSetup(0,Â 3000,Â 8);Â Â ledcAttachPin(enb,Â 0);&#125;  voidÂ loop()Â &#123;Â Â &#x2F;&#x2F;forwardÂ Â Serial.println(&quot;forward&quot;);Â Â digitalWrite(M1,Â LOW);Â Â digitalWrite(M2,Â HIGH);Â Â delay(2000);Â Â &#x2F;&#x2F;stopÂ Â Serial.println(&quot;stop&quot;);Â Â digitalWrite(M1,Â LOW);Â Â digitalWrite(M2,Â LOW);Â Â delay(2000);Â Â &#x2F;&#x2F;backÂ Â Serial.println(&quot;back&quot;);Â Â digitalWrite(M1,Â HIGH);Â Â digitalWrite(M2,Â LOW);Â Â delay(2000);Â Â &#x2F;&#x2F;stopÂ Â Serial.println(&quot;stop&quot;);Â Â digitalWrite(M1,Â LOW);Â Â digitalWrite(M2,Â LOW);Â Â delay(2000);Â Â &#x2F;&#x2F;pwmÂ forwardÂ Â Serial.println(&quot;forward&quot;);Â Â digitalWrite(M1,Â LOW);Â Â digitalWrite(M2,Â HIGH);Â Â delay(2000);Â Â whileÂ (dutyÂ &lt;&#x3D;Â 255)&#123;Â Â Â Â Serial.println(duty);Â Â Â Â ledcWrite(0,Â duty);Â Â Â Â dutyÂ +&#x3D;Â 5;Â Â Â Â delay(500);Â Â &#125;Â Â delay(2000);Â Â dutyÂ &#x3D;Â 150;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">&#x2F;&#x2F;é¦¬é”1çš„æ­£åè½‰è…³ä½intÂ M1_IN1Â &#x3D;Â 27;intÂ M1_IN2Â &#x3D;Â 26;intÂ enbÂ &#x3D;Â 14;Â &#x2F;&#x2F;ä½¿èƒ½æ§åˆ¶è…³ä½intÂ dutyÂ &#x3D;Â 150;Â &#x2F;&#x2F;PWMçš„dutyclcyleé è¨­150,ä¸èƒ½å¤ªå°,å€¼å¤ªå°é¦¬é”ä¸æœƒè½‰  voidÂ setup()Â &#123;Â Â Serial.begin(115200);Â Â pinMode(M1_IN1,Â OUTPUT);Â Â pinMode(M1_IN2,Â OUTPUT);Â Â pinMode(enb,Â OUTPUT);Â Â &#x2F;&#x2F;é »é“0,Â é »ç‡3000,Â è§£æåº¦8Â Â ledcSetup(0,Â 3000,Â 8);Â Â Â &#x2F;&#x2F;enblePin,Â é€šé“Â Â ledcAttachPin(enb,Â 0);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>loopè£¡é¢æœ€å¾Œæœ‰while(),å› ç‚ºdutyæœ€å¤§å€¼åˆ°255,æ‰€ä»¥è¦è®“å®ƒå¾150æ¼¸å¢åˆ°255</strong></p><p><strong>ä¾†è§€å¯Ÿpwmçš„å‹•ä½œ</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">voidÂ loop()Â &#123;Â Â &#x2F;&#x2F;forwardÂ Â Serial.println(&quot;forward&quot;);Â Â digitalWrite(M1_IN1,Â LOW);Â Â digitalWrite(M1_IN2,Â HIGH);Â Â delay(2000);Â Â &#x2F;&#x2F;stopÂ Â Serial.println(&quot;stop&quot;);Â Â digitalWrite(M1_IN1,Â LOW);Â Â digitalWrite(M1_IN2,Â LOW);Â Â delay(2000);Â Â &#x2F;&#x2F;backÂ Â Serial.println(&quot;back&quot;);Â Â digitalWrite(M1,Â HIGH);Â Â digitalWrite(M2,Â LOW);Â Â delay(2000);Â Â &#x2F;&#x2F;stopÂ Â Serial.println(&quot;stop&quot;);Â Â digitalWrite(M1_IN1,Â LOW);Â Â digitalWrite(M1_IN2,Â LOW);Â Â delay(2000);Â Â &#x2F;&#x2F;pwmÂ forwardÂ Â Serial.println(&quot;forward&quot;);Â Â digitalWrite(M1_IN1,Â LOW);Â Â digitalWrite(M1_IN2,Â HIGH);Â Â delay(2000);Â Â whileÂ (dutyÂ &lt;&#x3D;Â 255)&#123;Â Â Â Â Serial.println(duty);Â Â Â Â ledcWrite(0,Â duty);Â Â Â Â dutyÂ +&#x3D;Â 5;Â Â Â Â delay(500);Â Â &#125;Â Â delay(2000);Â Â dutyÂ &#x3D;Â 150;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><div class="video-container"><iframe src="https://www.youtube.com/embed/J5Chbzcz3jY" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dc moto </tag>
            
            <tag> L298N </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQTT-Publish-Node-RED-BMP280</title>
      <link href="/2021/08/29/esp32-mqtt-publish-node-red-bmp280/"/>
      <url>/2021/08/29/esp32-mqtt-publish-node-red-bmp280/</url>
      
        <content type="html"><![CDATA[<h1 id="MQTT-Publish-Node-RED-BMP280"><a href="#MQTT-Publish-Node-RED-BMP280" class="headerlink" title="MQTT-Publish-Node-RED-BMP280"></a>MQTT-Publish-Node-RED-BMP280</h1><p><strong>åƒè€ƒæ–‡ç»-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5842507104876900238?hl=zh-TW#">https://randomnerdtutorials.com/esp32-mqtt-publish-subscribe-arduino-ide/</a></strong></p><p><strong>é€™æ¬¡å¯¦ä½œæ˜¯ä½¿ç”¨MQTTç™¼é€BMP280çš„æ•¸æ“šåˆ°æ¨¹è“æ´¾ä¸Šçš„Node-REDå„€éŒ¶ç‰ˆä¸Š</strong></p><p><strong>æˆ‘æ˜¯åƒè€ƒé€™ç¯‡æ–‡ç« -<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5842507104876900238?hl=zh-TW#">https://randomnerdtutorials.com/esp32-mqtt-publish-subscribe-arduino-ide/</a></strong></p><p><strong>æ‰€ä»¥æœƒä½¿ç”¨é¡ä¼¼çš„ç¨‹å¼ç¢¼æ‰‹æ³•ä¾†å®Œæˆé …ç›®ã€‚</strong></p><p><strong>é–‹å§‹ä¹‹å‰å…ˆå‚™å¦¥æ¨¹è“æ´¾ä¸Šæ‰€é ˆçš„è»Ÿç¡¬é«”</strong></p><ol><li> <strong><em>å®‰è£<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5842507104876900238?hl=zh-TW#">Mosquitto broker</a>(å¦‚æœæ²’ç©éæ¨¹è“æ´¾,è«‹é€£çµ<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5842507104876900238?hl=zh-TW#">é€™è£¡</a>å®‰è£æ¨¹è“æ´¾ç³»çµ±å’Œ<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5842507104876900238?hl=zh-TW#">å¦‚</a></em></strong></li><li> <strong><em><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5842507104876900238?hl=zh-TW#">ä½•ä½¿ç”¨SSHå’ŒVNCé¡åƒ</a>)</em></strong></li><li> <strong><em>å®‰è£ <a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5842507104876900238?hl=zh-TW#">Node-RED installed</a> Â å’ŒÂ <a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5842507104876900238?hl=zh-TW#">Node-RED Dashboard</a>åœ¨æ¨¹è“æ´¾ä¸Šã€‚</em></strong></li><li> <strong>_å‚™è¨»:å®‰è£Node-REDæ™‚è‹¥å‡ºç¾éŒ¯èª¤è¨Šæ¯æ”¹ç”¨ä¸‹é¢æ‰€é™„ä¸‹è¼‰ _****<em>bash &lt;(curl -sL <a href="https://raw.githubusercontent.com/node-red/linux-installers/master/deb/update-nodejs-and-nodered">https://raw.githubusercontent.com/node-red/linux-installers/master/deb/update-nodejs-and-nodered</a>)</em></strong></li><li><strong><em>æ¥ä¸‹ä¾†å…ˆæ¸¬è©¦BMP280æ˜¯å¦å¯æ­£å¸¸æ¸¬æº«åº¦å’Œå£“åŠ›-è«‹åƒè€ƒä¹‹å‰çš„ç´€éŒ„(<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5842507104876900238?hl=zh-TW#">é»æˆ‘å‚³é€</a>)ã€‚</em></strong></li></ol><p><em><strong>å…ˆä¾†çœ‹ä¸€ä¸‹æ•´å€‹ç™¼é€åŸç†æ¯”è¼ƒå®¹æ˜“ç†è§£è‡ªå·±è¦å­¸çš„é‡é»åœ¨å“ªè£¡</strong></em></p><p><em><strong>æ­¤æ¬¡å¯¦é©—æˆ‘åªå¯«å¾ESP32ç™¼é€æ•¸æ“šåˆ°æ¨¹è“æ´¾çš„Mosquittoä»£ç†æ¥æ”¶/ç™¼é€</strong></em></p><p><em><strong>ç„¶å¾Œé€šéMQTTé€šä¿¡å”è­°å»æ§åˆ¶ESP32ç™¼é€æ•¸æ“šåˆ°Node-RED,å…¶å¯¦æˆ‘è¦º</strong></em></p><p><em><strong>å¾—å’ŒThingSpeakå¾ˆé¡ä¼¼,åªæ˜¯ä½¿ç”¨Node-REDæ›´èƒ½å®¢è£½åŒ–ã€‚</strong></em></p><p><em><strong>çœ‹ä¸€ä¸‹é€™å¼µåœ–</strong></em></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5842507104876900238?hl=zh-TW#"><strong><img src="https://lh3.googleusercontent.com/-dbEK49_w9_A/YQP1Mii2utI/AAAAAAAAelI/zvaBPu6JqXIcyeXVPyqIHhOt6CVSYkCrgCNcBGAsYHQ/w642-h341/image.png"></strong></a></p><hr><p><strong><em>çŸ¥é“åŸç†å¾Œå°±æ˜¯é–‹å§‹é€²å…¥å¯«ç¨‹å¼çš„ä¸»è»¸</em></strong></p><p><strong><em>é¦–å…ˆè¦æœ‰ç¶²è·¯å¯ä»¥é€£åˆ°æ•¸è“æ´¾å’ŒESP32ï¼Œç„¶å¾Œåˆ¤æ–·æ˜¯å¦å·²ç¶“é€£ç·š</em></strong></p><p><strong><em>å¦‚æœé€£ä¸ä¸Šå°±å†è‡ªå‹•é‡é€£ï¼Œé€£ä¸Šå¾Œå°å‡ºIPï¼Œé€£ä¸Šç¶²è·¯å¾Œï¼Œå°±æ˜¯</em></strong></p><p><strong><em>è¦å»å’Œæ¨¹è“æ´¾çš„Mosquitto Brokeré€£ç·šï¼Œä¸€æ¨£å°±æ˜¯åˆ¤æ–·æ˜¯å¦æˆåŠŸ</em></strong></p><p><strong><em>é€£ç·šåšå‡ºå°æ‡‰çš„å‹•ä½œã€‚WiFiå’ŒMosquitto Brokeréƒ½é€£ç·šä¹‹å¾Œï¼Œå°±é–‹</em></strong></p><p><strong><em>å§‹å¾ESP32å®¢æˆ¶ç«¯ç™¼é€æº«åº¦å’Œå£“åŠ›çš„æ•¸æ“šåˆ°Node-REDçš„ä»‹é¢ä¸Šã€‚</em></strong></p><hr><h2 id="å¸ƒç½²Node-RED"><a href="#å¸ƒç½²Node-RED" class="headerlink" title="å¸ƒç½²Node-RED"></a>å¸ƒç½²Node-RED</h2><div class="video-container"><iframe src="https://www.youtube.com/embed/IHebAHN_E50" frameborder="0" loading="lazy" allowfullscreen></iframe></div><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;WiFi.h&gt;#include &lt;PubSubClient.h&gt;#include &lt;Adafruit_BMP280.h&gt;#include &lt;Adafruit_Sensor.h&gt;#include &lt;Wire.h&gt;Adafruit_BMP280Â bmp;Â &#x2F;&#x2F;Â I2C  WiFiClientÂ espClient;PubSubClientÂ client(espClient);&#x2F;&#x2F;wifiå¸³å¯†constÂ char*Â ssidÂ &#x3D;Â &quot;---&quot;;constÂ char*Â passwordÂ &#x3D;Â &quot;------&quot;;&#x2F;&#x2F;mqttServerconstÂ char*Â mqttServerÂ &#x3D;Â &quot;---.---.---.--&quot;;  &#x2F;&#x2F;è¨­å®šwifivoidÂ setupWifi()&#123;Â Â WiFi.begin(ssid,Â password);Â Â whileÂ (WiFi.status()Â !&#x3D;Â WL_CONNECTED)&#123;Â Â Â Â delay(50);Â Â Â Â Serial.print(&quot;.&quot;);Â Â &#125;Â Â Serial.println(&quot;connectedÂ successful&quot;);Â Â Serial.println(WiFi.localIP());Â Â &#125;    voidÂ reconnect()&#123;Â Â whileÂ (!Â client.connected())&#123;Â Â Â Â Serial.print(&quot;AttemptingÂ MQTTÂ connection...&quot;);Â Â Â Â ifÂ (client.connect(&quot;esp32Client&quot;))&#123;Â Â Â Â Â Â Serial.println(&quot;connected&quot;);Â Â Â Â &#125;elseÂ &#123;Â Â Â Â Â Â Serial.print(&quot;failedÂ connectedÂ isÂ :Â &quot;);Â Â Â Â Â Â Serial.println(client.state());Â Â Â Â Â Â delay(2000);Â Â Â Â &#125;Â Â &#125;&#125;  voidÂ setup()Â &#123;Â Â Serial.begin(115200);Â Â Serial.println(F(&quot;BMP280Â test&quot;));Â Â setupWifi();Â Â client.setServer(mqttServer,Â 1883);Â Â ifÂ (!bmp.begin())Â &#123;Â Â Â Â Serial.println(F(&quot;CouldÂ notÂ findÂ aÂ validÂ BMP280Â sensor,Â checkÂ wiringÂ orÂ &quot;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &quot;tryÂ aÂ differentÂ address!&quot;));Â Â Â Â whileÂ (1)Â delay(10);Â Â &#125;&#125;voidÂ loop()Â &#123;Â Â Â Â ifÂ (!Â client.connected())&#123;Â Â Â Â Â Â reconnect();Â Â Â Â &#125;Â Â Â Â client.loop();Â Â Â Â longÂ lastTimeÂ &#x3D;Â 0;Â Â Â Â longÂ currentTimeÂ &#x3D;Â millis();Â Â Â Â floatÂ tempÂ &#x3D;Â 0;Â Â Â Â floatÂ pressureÂ &#x3D;Â 0;Â Â Â Â floatÂ humiÂ &#x3D;Â 0;Â Â Â Â ifÂ (currentTimeÂ -Â lastTimeÂ &gt;Â 5000)&#123;Â Â Â Â Â Â lastTimeÂ &#x3D;Â currentTime;Â Â Â Â Â Â tempÂ &#x3D;Â bmp.readTemperature();Â Â Â Â Â Â humiÂ &#x3D;Â 1.8Â *Â tempÂ +Â 32;Â Â Â Â Â Â pressureÂ &#x3D;Â bmp.readPressure();Â Â Â Â Â Â charÂ tempStr\[8\]Â &#x3D;Â &quot;&quot;;Â Â Â Â Â Â charÂ pressStr\[24\]Â &#x3D;Â &quot;&quot;;Â Â Â Â Â Â charÂ humiStr\[8\]Â &#x3D;Â &quot;&quot;;Â Â Â Â Â Â dtostrf(temp,Â 1,Â 2,Â tempStr);Â Â Â Â Â Â dtostrf(pressure,Â 1,Â 2,Â pressStr);Â Â Â Â Â Â dtostrf(humi,Â 1,Â 2,Â humiStr);Â Â Â Â Â Â Serial.print(&quot;Temp:Â &quot;);Â Â Â Â Â Â Serial.println(tempStr);Â Â Â Â Â Â Serial.print(&quot;humi:Â &quot;);Â Â Â Â Â Â Serial.println(humiStr);Â Â Â Â Â Â Serial.print(&quot;Pressure:Â &quot;);Â Â Â Â Â Â Serial.println(pressStr);Â Â Â Â Â Â client.publish(&quot;esp32&#x2F;temp&quot;,Â tempStr);Â Â Â Â Â Â client.publish(&quot;esp32&#x2F;pressure&quot;,Â pressStr);Â Â Â Â Â Â client.publish(&quot;esp32&#x2F;humi&quot;,Â humiStr);Â Â Â Â Â Â delay(1000);Â Â Â Â &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><p><strong>åŒ¯å…¥æ‰€é ˆçš„ç¨‹å¼åº«</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;WiFi.h&gt;#include &lt;PubSubClient.h&gt;#include &lt;Adafruit_BMP280.h&gt;#include &lt;Adafruit_Sensor.h&gt;#include &lt;Wire.h&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å»ºç«‹bmp280ï¼Œwifiå®¢æˆ¶ç«¯åŠMQTTå®¢æˆ¶ç«¯ä»£æ•¸</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Adafruit_BMP280Â bmp;Â &#x2F;&#x2F;Â I2CWiFiClientÂ espClient;PubSubClientÂ client(espClient);  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>MQTTserverçš„IPå³æ˜¯æ¨¹è“æ´¾çš„IP</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">&#x2F;&#x2F;wifiå¸³å¯†constÂ char*Â ssidÂ &#x3D;Â &quot;---&quot;;constÂ char*Â passwordÂ &#x3D;Â &quot;------&quot;;&#x2F;&#x2F;mqttServerconstÂ char*Â mqttServerÂ &#x3D;Â &quot;---.---.---.---&quot;;  &#x2F;&#x2F;è¨­å®šwifivoidÂ setupWifi()&#123;Â Â WiFi.begin(ssid,Â password);Â Â whileÂ (WiFi.status()Â !&#x3D;Â WL_CONNECTED)&#123;Â Â Â Â delay(50);Â Â Â Â Serial.print(&quot;.&quot;);Â Â &#125;Â Â Serial.println(&quot;connectedÂ successful&quot;);Â Â Serial.println(WiFi.localIP());Â Â &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>é€£ç·šè‡³MQTTä¼ºæœå™¨æˆåŠŸèˆ‡ç„¡æ³•é€£ç·šçš„å°æ‡‰å‹•ä½œ</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">voidÂ reconnect()&#123;Â Â whileÂ (!Â client.connected())&#123;Â Â Â Â Serial.print(&quot;AttemptingÂ MQTTÂ connection...&quot;);Â Â Â Â ifÂ (client.connect(&quot;esp32Client&quot;))&#123;Â Â Â Â Â Â Serial.println(&quot;connected&quot;);Â Â Â Â &#125;elseÂ &#123;Â Â Â Â Â Â Serial.print(&quot;failedÂ connectedÂ isÂ :Â &quot;);Â Â Â Â Â Â Serial.println(client.state());Â Â Â Â Â Â delay(2000);Â Â Â Â &#125;Â Â &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>void setup(){}è£¡é¢çš„ä¸€äº›å¿…è¦åˆå§‹åŒ–</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">voidÂ setup()Â &#123;Â Â Serial.begin(115200);Â Â Serial.println(F(&quot;BMP280Â test&quot;));Â Â setupWifi();Â Â client.setServer(mqttServer,Â 1883);Â Â ifÂ (!bmp.begin())Â &#123;Â Â Â Â Serial.println(F(&quot;CouldÂ notÂ findÂ aÂ validÂ BMP280Â sensor,Â checkÂ wiringÂ orÂ &quot;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &quot;tryÂ aÂ differentÂ address!&quot;));Â Â Â Â whileÂ (1)Â delay(10);Â Â &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>void loop(){}è£¡</strong></p><p><strong>ç„¡æ³•é€£ç·šå°±é‡è¤‡é€£ç·š</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">ifÂ (!Â client.connected())&#123;Â Â Â Â Â Â reconnect();Â Â Â Â &#125;Â Â Â Â client.loop();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>é—œæ–¼æ•¸å€¼è½‰å­—å…ƒçš„å‡½å¼</em></strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">char* dtostrf(double _val,signed char _width, unsigned char prec, char* _s)  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¼•æ•¸èªªæ˜ï¼š<br>_val:è¦è½‰æ›çš„floatæˆ–è€…doubleå€¼ã€‚</p><p>_width:è½‰æ›å¾Œæ•´æ•¸éƒ¨åˆ†é•·åº¦ã€‚</p><p>_precï¼šè½‰æ›å¾Œå°æ•¸éƒ¨åˆ†é•·åº¦ã€‚</p><p>_s:å„²å­˜åˆ°è©²charé™£åˆ—ä¸­ã€‚</p><p><strong><em>å…¶ä¸­é€™å€‹æ˜¯è½‰æˆå°æ‡‰çš„å­—å…ƒ</em></strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">charÂ tempStr[8]Â &#x3D;Â &quot;&quot;;charÂ pressStr[24]Â &#x3D;Â &quot;&quot;;charÂ humiStr[8]Â &#x3D;Â &quot;&quot;;dtostrf(temp,Â 1,Â 2,Â tempStr);dtostrf(pressure,Â 1,Â 2,Â pressStr);dtostrf(humi,Â 1,Â 2,Â humiStr);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å–å¾—æº«åº¦/å£“åŠ›æ•¸å€¼å¾Œæ¯5ç§’ç™¼é€åˆ°MQTTçš„Node-RED</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">ifÂ (currentTimeÂ -Â lastTimeÂ &gt;Â 5000)&#123;Â Â Â Â Â Â lastTimeÂ &#x3D;Â currentTime;Â Â Â Â Â Â tempÂ &#x3D;Â bmp.readTemperature();Â Â Â Â Â Â humiÂ &#x3D;Â 1.8Â *Â tempÂ +Â 32;Â Â Â Â Â Â pressureÂ &#x3D;Â bmp.readPressure();Â Â Â Â Â Â charÂ tempStr[8]Â &#x3D;Â &quot;&quot;;Â Â Â Â Â Â charÂ pressStr[24]Â &#x3D;Â &quot;&quot;;Â Â Â Â Â Â charÂ humiStr[8]Â &#x3D;Â &quot;&quot;;Â Â Â Â Â Â dtostrf(temp,Â 1,Â 2,Â tempStr);Â Â Â Â Â Â dtostrf(pressure,Â 1,Â 2,Â pressStr);Â Â Â Â Â Â dtostrf(humi,Â 1,Â 2,Â humiStr);Â Â Â Â Â Â Serial.print(&quot;Temp:Â &quot;);Â Â Â Â Â Â Serial.println(tempStr);Â Â Â Â Â Â Serial.print(&quot;humi:Â &quot;);Â Â Â Â Â Â Serial.println(humiStr);Â Â Â Â Â Â Serial.print(&quot;Pressure:Â &quot;);Â Â Â Â Â Â Serial.println(pressStr);Â Â Â Â Â Â client.publish(&quot;esp32&#x2F;temp&quot;,Â tempStr);Â Â Â Â Â Â client.publish(&quot;esp32&#x2F;pressure&quot;,Â pressStr);Â Â Â Â Â Â client.publish(&quot;esp32&#x2F;humi&quot;,Â humiStr);Â Â Â Â Â Â delay(1000);Â Â Â Â &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> <a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5842507104876900238?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-ysEI3JQaSG4/YQYUjIdUS-I/AAAAAAAAemY/eaOvIOCh2Zkcz5SrWboitrz4Ji02B7hegCNcBGAsYHQ/s1600/1627788424761991-0.png"></a> </p><hr>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bmp280 </tag>
            
            <tag> mqtt </tag>
            
            <tag> node-red </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DHT11/12ç¶²è·¯ç›£æ¸¬æº«æ¿•åº¦è¨ˆ-micropython</title>
      <link href="/2021/08/29/dht11-12-wang-lu-jian-ce-wen-shi-du-ji-micropython-1/"/>
      <url>/2021/08/29/dht11-12-wang-lu-jian-ce-wen-shi-du-ji-micropython-1/</url>
      
        <content type="html"><![CDATA[<h1 id="DHT11-12ç¶²è·¯ç›£æ¸¬æº«æ¿•åº¦è¨ˆ-micropython"><a href="#DHT11-12ç¶²è·¯ç›£æ¸¬æº«æ¿•åº¦è¨ˆ-micropython" class="headerlink" title="DHT11/12ç¶²è·¯ç›£æ¸¬æº«æ¿•åº¦è¨ˆ-micropython"></a>DHT11/12ç¶²è·¯ç›£æ¸¬æº«æ¿•åº¦è¨ˆ-micropython</h1><h6 id="tags-micropython-dht11-12-webserver"><a href="#tags-micropython-dht11-12-webserver" class="headerlink" title="tags: micropython dht11/12 webserver"></a>tags: <code>micropython</code> <code>dht11/12 webserver</code></h6><hr><p><strong><em>DHT11/12å–®ç´”æ¸¬è©¦åƒè€ƒé é¢-</em></strong></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5661741645243406963?hl=zh-TW#">https://blairan-esp32-micropython.blogspot.com/2021/07/dht11dht12-micropython.html</a></p><p><em><strong>WiFiè¯ç¶²åƒè€ƒ-</strong></em><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5661741645243406963?hl=zh-TW#">https://blairan-esp32-micropython.blogspot.com/2021/07/wifi.html</a></p><hr><h2 id="å®Œæ•´ç¨‹å¼ç¢¼"><a href="#å®Œæ•´ç¨‹å¼ç¢¼" class="headerlink" title="å®Œæ•´ç¨‹å¼ç¢¼"></a>å®Œæ•´ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py">importÂ dhtimportÂ network,Â socketfromÂ machineÂ importÂ PinfromÂ timeÂ importÂ sleep  ssid&#x3D;&quot;---&quot;password&#x3D;&quot;------&quot;STA&#x3D;network.WLAN(network.STA_IF)STA.active(True)STA.connect(ssid,Â password)whileÂ STA.isconnected()&#x3D;&#x3D;False:Â Â Â Â passprint(&quot;TheÂ connectedÂ successful!&quot;)print(&quot;IP:Â Â &#123;&#125;&quot;.format(STA.ifconfig()))defÂ readTempAndHumi():Â Â Â Â globalÂ temp,Â humiÂ Â Â Â try:Â Â Â Â Â Â Â Â sensor&#x3D;dht.DHT11(Pin(4))Â Â Â Â Â Â Â Â sensor.measure()Â Â Â Â Â Â Â Â temp&#x3D;sensor.temperature()Â Â Â Â Â Â Â Â humi&#x3D;sensor.humidity()Â Â Â Â Â Â Â Â ifÂ (isinstance(temp,Â float)Â andÂ isinstance(humi,Â float))Â orÂ (isinstance(temp,Â int)Â andÂ isinstance(humi,Â int)):Â Â Â Â Â Â Â Â Â Â measureResult&#x3D;&quot;&#123;&#125;,&#123;&#125;&quot;.format(temp,Â humi)Â Â Â Â Â Â Â Â Â Â returnÂ measureResultÂ Â Â Â Â Â Â Â else:Â Â Â Â Â Â Â Â Â Â returnÂ (&quot;--&quot;)Â Â Â Â exceptÂ OSErrorÂ asÂ o:Â Â Â Â Â Â Â Â print(&quot;--&quot;)defÂ Htmlpage():Â Â html&#x3D;Â &quot;&quot;&quot;Â Â Â Â Â Â Â Â &lt;html&gt;Â Â Â Â &lt;head&gt;Â Â Â Â Â Â &lt;metaÂ charset&#x3D;&quot;utf-8&quot;Â &#x2F;&gt;Â Â Â Â Â Â &lt;metaÂ name&#x3D;&quot;viewport&quot;Â content&#x3D;&quot;width&#x3D;device-width,Â initial-scale&#x3D;1.0&quot;Â &#x2F;&gt;Â Â Â Â Â Â &lt;style&gt;Â Â Â Â Â Â Â Â h1Â Â &#123;text-align:Â center;Â background-color:Â orange;Â margin-right:5px;&#125;Â Â Â Â Â Â Â Â dlÂ &#123;Â width:Â 320px;Â margin:Â 12pxÂ auto;Â &#125;Â Â Â Â Â Â Â Â dtÂ &#123;Â Â Â Â Â Â Â Â Â Â Â font-size:Â 20pt;Â color:Â #444;Â background-color:Â #ddd;Â Â Â Â Â Â Â Â Â Â margin:Â 6ptÂ 0;Â padding:Â 6ptÂ 12pt;Â Â Â Â Â Â Â Â &#125;Â Â Â Â Â Â Â Â ddÂ &#123;Â Â Â Â Â Â Â Â Â Â text-align:Â right;Â padding-right:Â 6pt;Â Â Â Â Â Â Â Â &#125;Â Â Â Â Â Â Â Â .numÂ &#123;Â font-size:Â 36pt;Â color:Â dodgerblue;Â &#125;Â Â Â Â Â Â &lt;&#x2F;style&gt;Â Â Â Â Â Â &lt;&#x2F;head&gt;Â Â Â Â &lt;body&gt;Â Â Â Â Â Â &lt;p&gt;&lt;h1&gt;ESP32Â DHT11&#x2F;12&lt;&#x2F;h1&gt;&lt;&#x2F;p&gt;Â Â Â Â Â Â &lt;dl&gt;Â Â Â Â Â Â Â Â &lt;dt&gt;Temp&lt;&#x2F;dt&gt;Â Â Â Â Â Â Â Â &lt;ddÂ class&#x3D;num&gt;&quot;&quot;&quot;+str(temp)+&quot;&quot;&quot;Â°C&lt;&#x2F;dd&gt;Â Â Â Â Â Â Â Â &lt;dt&gt;Humi&lt;&#x2F;dt&gt;Â Â Â Â Â Â Â Â &lt;ddÂ class&#x3D;num&gt;&quot;&quot;&quot;+str(humi)+&quot;&quot;&quot;Â %&lt;&#x2F;dd&gt;Â Â Â Â Â Â &lt;&#x2F;dl&gt;Â Â Â Â &lt;&#x2F;body&gt;Â Â Â Â &lt;&#x2F;html&gt;Â Â Â Â &quot;&quot;&quot;Â Â returnÂ html  s&#x3D;socket.socket(socket.AF_INET,Â socket.SOCK_STREAM)s.bind((&#39;&#39;,Â 80))s.listen(5)  whileÂ True:Â Â Â Â conn,Â addrÂ &#x3D;Â s.accept()Â Â Â Â print(&#39;GotÂ aÂ connectionÂ fromÂ %s&#39;Â %Â str(addr))Â Â Â Â reqÂ &#x3D;Â conn.recv(1024)Â Â Â Â print(&#39;ContentÂ &#x3D;Â %s&#39;Â %Â str(req))Â Â Â Â sensor_readingÂ &#x3D;Â readTempAndHumi()Â Â Â Â print(sensor_reading)Â Â Â Â responeÂ &#x3D;Â Htmlpage()Â Â Â Â conn.send(&quot;http&#x2F;1.1Â 200Â OK\n&quot;)Â Â Â Â conn.send(&quot;Content-Type:Â text&#x2F;html;Â charset&#x3D;&#39;utf-8&#39;\n&quot;)Â Â Â Â conn.send(&quot;Connection:Â close\n\n&quot;)Â Â Â Â conn.sendall(respone)Â Â Â Â conn.close()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py">**_è¼‰å…¥dht,wifi,ç«¯å£,pinå’Œæ™‚é–“æ¨¡çµ„_**importÂ dhtimportÂ network,Â socketfromÂ machineÂ importÂ PinfromÂ timeÂ importÂ sleep<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>é€™å€‹éƒ¨ä»½æ˜¯è¨­åˆ¶WiFiçš„æµç¨‹</em></strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">ssid&#x3D;&quot;åŸºåœ°å°åç¨±&quot;password&#x3D;&quot;åŸºåœ°å°å¯†ç¢¼&quot;  STA&#x3D;network.WLAN(network.STA_IF)STA.active(True)STA.connect(ssid,Â password)  whileÂ STA.isconnected()&#x3D;&#x3D;False:Â Â Â Â passprint(&quot;TheÂ connectedÂ successful!&quot;)print(&quot;IP:Â Â &#123;&#125;&quot;.format(STA.ifconfig()))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>è®€å–æº«æº¼åº¦çš„å‡½å¼</em></strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">defÂ readTempAndHumi():Â Â Â Â globalÂ temp,Â humiÂ Â Â Â try:Â Â Â Â Â Â Â Â sensor&#x3D;dht.DHT11(Pin(4))Â Â Â Â Â Â Â Â sensor.measure()Â Â Â Â Â Â Â Â temp&#x3D;sensor.temperature()Â Â Â Â Â Â Â Â humi&#x3D;sensor.humidity()Â Â Â Â Â Â Â Â ifÂ (isinstance(temp,Â float)Â andÂ isinstance(humi,Â float))Â orÂ (isinstance(temp,Â int)Â andÂ isinstance(humi,Â int)):Â Â Â Â Â Â Â Â Â Â measureResult&#x3D;&quot;&#123;&#125;,&#123;&#125;&quot;.format(temp,Â humi)Â Â Â Â Â Â Â Â Â Â returnÂ measureResultÂ Â Â Â Â Â Â Â else:Â Â Â Â Â Â Â Â Â Â returnÂ (&quot;--&quot;)Â Â Â Â exceptÂ OSErrorÂ asÂ o:Â Â Â Â Â Â Â Â print(&quot;--&quot;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ç¶²é å‰ç«¯çš„å¸ƒç½®,è¨˜å¾—è¦è®“å…¶è®€å–æ™‚å¯è¿”å›(return)</strong></p><p><strong>å…¶ä¸­é ˆæ³¨æ„çš„æ˜¯è®“æº«æº¼åº¦çš„å€¼å¯ä»¥æ­£é¡¯ç¤ºè¦ä½¿ç”¨</strong>â€œâ€â€+str(æº«/æº¼åº¦è®Šæ•¸)+â€â€â€</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">def Htmlpage():  html= """        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">        <span class="token selector">h1</span>  <span class="token punctuation">&#123;</span><span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span> background-color<span class="token punctuation">:</span> orange<span class="token punctuation">;</span> margin-right<span class="token punctuation">:</span>5px<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>        <span class="token selector">dl</span> <span class="token punctuation">&#123;</span> width<span class="token punctuation">:</span> 320px<span class="token punctuation">;</span> margin<span class="token punctuation">:</span> 12px auto<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>        <span class="token selector">dt</span> <span class="token punctuation">&#123;</span>           font-size<span class="token punctuation">:</span> 20pt<span class="token punctuation">;</span> color<span class="token punctuation">:</span> #444<span class="token punctuation">;</span> background-color<span class="token punctuation">:</span> #ddd<span class="token punctuation">;</span>          margin<span class="token punctuation">:</span> 6pt 0<span class="token punctuation">;</span> padding<span class="token punctuation">:</span> 6pt 12pt<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">dd</span> <span class="token punctuation">&#123;</span>          text-align<span class="token punctuation">:</span> right<span class="token punctuation">;</span> padding-right<span class="token punctuation">:</span> 6pt<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.num</span> <span class="token punctuation">&#123;</span> font-size<span class="token punctuation">:</span> 36pt<span class="token punctuation">;</span> color<span class="token punctuation">:</span> dodgerblue<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>      </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>ESP32 DHT11/12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dl</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dt</span><span class="token punctuation">></span></span>Temp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dt</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dd</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>num</span><span class="token punctuation">></span></span>"""+str(temp)+"""Â°C<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dd</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dt</span><span class="token punctuation">></span></span>Humi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dt</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dd</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>num</span><span class="token punctuation">></span></span>"""+str(humi)+""" %<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dd</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dl</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>    """  return html<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>è¨­åˆ¶ç›£è½å¥—æ¥ç«¯å£</em></strong></p><p><strong><em>å‡½å¼åƒè€ƒ-</em></strong><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5661741645243406963?hl=zh-TW#">æˆ‘çš„micropythonå‡½å¼ç­†è¨˜</a></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">s&#x3D;socket.socket(socket.AF_INET,Â socket.SOCK_STREAM)s.bind((&#39;&#39;,Â 80))s.listen(5)whileÂ True:Â Â Â Â conn,Â addrÂ &#x3D;Â s.accept()Â Â Â Â print(&#39;GotÂ aÂ connectionÂ fromÂ %s&#39;Â %Â str(addr))Â Â Â Â reqÂ &#x3D;Â conn.recv(1024)Â Â Â Â print(&#39;ContentÂ &#x3D;Â %s&#39;Â %Â str(req))Â Â Â Â sensor_readingÂ &#x3D;Â readTempAndHumi()Â Â Â Â print(sensor_reading)Â Â Â Â responeÂ &#x3D;Â Htmlpage()Â Â Â Â conn.send(&quot;http&#x2F;1.1Â 200Â OK\n&quot;)Â Â Â Â conn.send(&quot;Content-Type:Â text&#x2F;html;Â charset&#x3D;&#39;utf-8&#39;\n&quot;)Â Â Â Â conn.send(&quot;Connection:Â close\n\n&quot;)Â Â Â Â conn.sendall(respone)Â Â Â Â conn.close()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5661741645243406963?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-stu-h6hdsgc/YOaaTDfLfOI/AAAAAAAAeaQ/NiNjk1xHXl0YOU_J8btvb9Qd3isHo6ZvwCNcBGAsYHQ/s1600/1625725506698515-0.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dht11/dht12 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DS1306å¯¦æ™‚æ™‚é˜æ¨¡çµ„-micropython</title>
      <link href="/2021/08/29/ds1306-shi-shi-shi-zhong-mo-zu-micropython/"/>
      <url>/2021/08/29/ds1306-shi-shi-shi-zhong-mo-zu-micropython/</url>
      
        <content type="html"><![CDATA[<h1 id="DS1306å¯¦æ™‚æ™‚é˜æ¨¡çµ„-micropython"><a href="#DS1306å¯¦æ™‚æ™‚é˜æ¨¡çµ„-micropython" class="headerlink" title="DS1306å¯¦æ™‚æ™‚é˜æ¨¡çµ„-micropython"></a>DS1306å¯¦æ™‚æ™‚é˜æ¨¡çµ„-micropython</h1><h6 id="tags-micropython-ds1302"><a href="#tags-micropython-ds1302" class="headerlink" title="tags: micropython ds1302"></a>tags: <code>micropython</code> <code>ds1302</code></h6><p>é€™æ˜¯å»£è¯é›»å­ä¸Šçš„ä»‹ç´¹<br>â— æ™‚é˜å…·æœ‰èƒ½è¨ˆç®—2100 å¹´ä¹‹å‰çš„ç§’ã€åˆ†ã€æ™‚ã€æ—¥ã€æ˜ŸæœŸã€æœˆã€å¹´çš„èƒ½åŠ›ï¼Œé‚„æœ‰é–å¹´èª¿æ•´çš„èƒ½åŠ›<br>â— 31 8 ä½æš«å­˜æ•¸æ“šå­˜å„²RAM<br>â— ä¸²è¡Œ I/O å£æ–¹å¼ä½¿å¾—ç®¡è…³æ•¸é‡æœ€å°‘<br>â— å¯¬ç¯„åœå·¥ä½œé›»å£“2.0 5.5V<br>â— å·¥ä½œé›»æµ 2.0V æ™‚,å°æ–¼300nA<br>â— è®€ / å¯«æ™‚é˜æˆ–RAM æ•¸æ“šæ™‚æœ‰å…©ç¨®å‚³é€æ–¹å¼å–®å­—ç¯€å‚³é€å’Œå¤šå­—ç¯€å‚³é€å­—ç¬¦çµ„æ–¹å¼<br>â— 8 è…³DIP å°è£æˆ–å¯é¸çš„8 è…³SOIC å°è£æ ¹æ“šè¡¨é¢è£é…<br>â— ç°¡å–® 3 ç·šæ¥å£<br>â— èˆ‡ TTL ç›¸å®¹Vcc=5V<br>â— é›™é›»æºç®¡ç”¨æ–¼ä¸»é›»æºå’Œå‚™ä»½é›»æºä¾›æ‡‰<br>â— é›»æ± ï¼šCR2032 é›»å£“3Vï¼Œé›»æµ260mAh<br>â— æ™¶æŒ¯32.768KHzï¼ŒåŒ¹é…é›»å®¹ç‚º6pF<br>â— DS1302ç‚º8è…³ç›´æ’å¤§æ™¶ç‰‡ï¼Œæ™¶ç‰‡ä¸‹é¢æœ‰ICåº§ï¼Œæ–¹ä¾¿æ›´æ›åŠæ’æ‹”ç‰‡<br>6.æ¨¡å¡Šå·¥ä½œé›»å£“å…¼å®¹3.3V/5Vï¼Œå¯èˆ‡5VåŠ3.3Vå–®ç‰‡æ©Ÿé€£æ¥<br>â—å¸¶4å€‹å®šä½å­”ï¼Œç›´å¾‘3.1mm<br>â—å·¥ä½œæº«åº¦ï¼š0Â°ï½70Â°</p><p>â— å®‰è£æ³¨æ„!<br>1.VCCèˆ‡GNDåƒè¬ä¸è¦æ¥åï¼Œä»¥å…ç‡’å£æ™¶ç‰‡<br>2.51ç³»åˆ—å–®æ™¶ç‰‡P0æ¥è…³éœ€è¦é€£æ¥ä¸Šæ‹‰é›»é˜»ï¼Œå¦‚æœå–®æ™¶ç‰‡æ²’æœ‰é€£æ¥ä¸Šæ‹‰é›»é˜»ï¼Œå¯ä»¥å°‡æ•¸æ“šç·šæ¥åˆ°å…¶ä»–æ¥è…³</p><h2 id="æ­¥é©Ÿ1"><a href="#æ­¥é©Ÿ1" class="headerlink" title="æ­¥é©Ÿ1:"></a>æ­¥é©Ÿ1:</h2><p>ä¸‹è¼‰sd1306.pyä¸¦ä¸Šå‚³åˆ°å¾®æ§æ¿ä¸Š<br><a href="https://github.com/omarbenhamid/micropython-ds1302-rtc">https://github.com/omarbenhamid/micropython-ds1302-rtc</a></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">from</span> machine <span class="token keyword">import</span> PinDS1302_REG_SECOND <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0x80</span><span class="token punctuation">)</span>DS1302_REG_MINUTE <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0x82</span><span class="token punctuation">)</span>DS1302_REG_HOUR   <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0x84</span><span class="token punctuation">)</span>DS1302_REG_DAY    <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0x86</span><span class="token punctuation">)</span>DS1302_REG_MONTH  <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0x88</span><span class="token punctuation">)</span>DS1302_REG_WEEKDAY<span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0x8A</span><span class="token punctuation">)</span>DS1302_REG_YEAR   <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0x8C</span><span class="token punctuation">)</span>DS1302_REG_WP     <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0x8E</span><span class="token punctuation">)</span>DS1302_REG_CTRL   <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0x90</span><span class="token punctuation">)</span>DS1302_REG_RAM    <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0xC0</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">DS1302</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> clk<span class="token punctuation">,</span> dio<span class="token punctuation">,</span> cs<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>clk <span class="token operator">=</span> clk        self<span class="token punctuation">.</span>dio <span class="token operator">=</span> dio        self<span class="token punctuation">.</span>cs <span class="token operator">=</span> cs        self<span class="token punctuation">.</span>clk<span class="token punctuation">.</span>init<span class="token punctuation">(</span>Pin<span class="token punctuation">.</span>OUT<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>cs<span class="token punctuation">.</span>init<span class="token punctuation">(</span>Pin<span class="token punctuation">.</span>OUT<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_dec2hex</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dat<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>dat<span class="token operator">//</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">16</span> <span class="token operator">+</span> <span class="token punctuation">(</span>dat <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_hex2dec</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dat<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>dat<span class="token operator">//</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token punctuation">(</span>dat <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_write_byte</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dat<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>dio<span class="token punctuation">.</span>init<span class="token punctuation">(</span>Pin<span class="token punctuation">.</span>OUT<span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>dio<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token punctuation">(</span>dat <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>clk<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>clk<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_read_byte</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        d <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>dio<span class="token punctuation">.</span>init<span class="token punctuation">(</span>Pin<span class="token punctuation">.</span>IN<span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            d <span class="token operator">=</span> d <span class="token operator">|</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>dio<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>clk<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>clk<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> d    <span class="token keyword">def</span> <span class="token function">_get_reg</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> reg<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>cs<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_write_byte<span class="token punctuation">(</span>reg<span class="token punctuation">)</span>        t <span class="token operator">=</span> self<span class="token punctuation">.</span>_read_byte<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>cs<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> t    <span class="token keyword">def</span> <span class="token function">_set_reg</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> reg<span class="token punctuation">,</span> dat<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>cs<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_write_byte<span class="token punctuation">(</span>reg<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_write_byte<span class="token punctuation">(</span>dat<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>cs<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_wr</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> reg<span class="token punctuation">,</span> dat<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>_set_reg<span class="token punctuation">(</span>DS1302_REG_WP<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_set_reg<span class="token punctuation">(</span>reg<span class="token punctuation">,</span> dat<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_set_reg<span class="token punctuation">(</span>DS1302_REG_WP<span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">start</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        t <span class="token operator">=</span> self<span class="token punctuation">.</span>_get_reg<span class="token punctuation">(</span>DS1302_REG_SECOND <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_wr<span class="token punctuation">(</span>DS1302_REG_SECOND<span class="token punctuation">,</span> t <span class="token operator">&amp;</span> <span class="token number">0x7f</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">stop</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        t <span class="token operator">=</span> self<span class="token punctuation">.</span>_get_reg<span class="token punctuation">(</span>DS1302_REG_SECOND <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_wr<span class="token punctuation">(</span>DS1302_REG_SECOND<span class="token punctuation">,</span> t <span class="token operator">|</span> <span class="token number">0x80</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">second</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> second<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> second <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_hex2dec<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_get_reg<span class="token punctuation">(</span>DS1302_REG_SECOND<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">60</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>_wr<span class="token punctuation">(</span>DS1302_REG_SECOND<span class="token punctuation">,</span> self<span class="token punctuation">.</span>_dec2hex<span class="token punctuation">(</span>second <span class="token operator">%</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">minute</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> minute<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> minute <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_hex2dec<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_get_reg<span class="token punctuation">(</span>DS1302_REG_MINUTE<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>_wr<span class="token punctuation">(</span>DS1302_REG_MINUTE<span class="token punctuation">,</span> self<span class="token punctuation">.</span>_dec2hex<span class="token punctuation">(</span>minute <span class="token operator">%</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">hour</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> hour<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> hour <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_hex2dec<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_get_reg<span class="token punctuation">(</span>DS1302_REG_HOUR<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>_wr<span class="token punctuation">(</span>DS1302_REG_HOUR<span class="token punctuation">,</span> self<span class="token punctuation">.</span>_dec2hex<span class="token punctuation">(</span>hour <span class="token operator">%</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">weekday</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> weekday<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> weekday <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_hex2dec<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_get_reg<span class="token punctuation">(</span>DS1302_REG_WEEKDAY<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>_wr<span class="token punctuation">(</span>DS1302_REG_WEEKDAY<span class="token punctuation">,</span> self<span class="token punctuation">.</span>_dec2hex<span class="token punctuation">(</span>weekday <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">day</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> day<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> day <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_hex2dec<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_get_reg<span class="token punctuation">(</span>DS1302_REG_DAY<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>_wr<span class="token punctuation">(</span>DS1302_REG_DAY<span class="token punctuation">,</span> self<span class="token punctuation">.</span>_dec2hex<span class="token punctuation">(</span>day <span class="token operator">%</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">month</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> month<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> month <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_hex2dec<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_get_reg<span class="token punctuation">(</span>DS1302_REG_MONTH<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>_wr<span class="token punctuation">(</span>DS1302_REG_MONTH<span class="token punctuation">,</span> self<span class="token punctuation">.</span>_dec2hex<span class="token punctuation">(</span>month <span class="token operator">%</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">year</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> year<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> year <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_hex2dec<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_get_reg<span class="token punctuation">(</span>DS1302_REG_YEAR<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2000</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>_wr<span class="token punctuation">(</span>DS1302_REG_YEAR<span class="token punctuation">,</span> self<span class="token punctuation">.</span>_dec2hex<span class="token punctuation">(</span>year <span class="token operator">%</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">date_time</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dat<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> dat <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>year<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>month<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>day<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>weekday<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>hour<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>minute<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>second<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>year<span class="token punctuation">(</span>dat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>month<span class="token punctuation">(</span>dat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>day<span class="token punctuation">(</span>dat<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>weekday<span class="token punctuation">(</span>dat<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>hour<span class="token punctuation">(</span>dat<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>minute<span class="token punctuation">(</span>dat<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>second<span class="token punctuation">(</span>dat<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">ram</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> reg<span class="token punctuation">,</span> dat<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> dat <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_get_reg<span class="token punctuation">(</span>DS1302_REG_RAM <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span>reg <span class="token operator">%</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>_wr<span class="token punctuation">(</span>DS1302_REG_RAM <span class="token operator">+</span> <span class="token punctuation">(</span>reg <span class="token operator">%</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">,</span> dat<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ­¥é©Ÿ2"><a href="#æ­¥é©Ÿ2" class="headerlink" title="æ­¥é©Ÿ2:"></a>æ­¥é©Ÿ2:</h2><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; DS1302 CLK&#x2F;SCLK --&gt;  5&#x2F;&#x2F; DS1302 DAT&#x2F;IO --&gt;  4&#x2F;&#x2F; DS1302 RST&#x2F;CE --&gt;  2&#x2F;&#x2F; DS1302 VCC --&gt;  3.3v - 5v&#x2F;&#x2F; DS1302 GND --&gt;  GND<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ­¥é©Ÿ3"><a href="#æ­¥é©Ÿ3" class="headerlink" title="æ­¥é©Ÿ3:"></a>æ­¥é©Ÿ3:</h2><p>ä¸Šå‚³ç¨‹å¼ç¢¼</p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">import</span> ds1302<span class="token keyword">from</span> machine <span class="token keyword">import</span> PIN_WAKE<span class="token punctuation">,</span> Pin<span class="token keyword">import</span> timeds <span class="token operator">=</span> ds1302<span class="token punctuation">.</span>DS1302<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Pin<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Pin<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Today is &#123;&#125;/&#123;&#125;/&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ds<span class="token punctuation">.</span>year<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ds<span class="token punctuation">.</span>month<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ds<span class="token punctuation">.</span>day<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Time: &#123;&#125;:&#123;&#125;:&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ds<span class="token punctuation">.</span>hour<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ds<span class="token punctuation">.</span>minute<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ds<span class="token punctuation">.</span>second<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"="</span><span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">Today is 2021&#x2F;7&#x2F;28Time: 12:19:18&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Today is 2021&#x2F;7&#x2F;28Time: 12:19:19&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Today is 2021&#x2F;7&#x2F;28Time: 12:19:20&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Today is 2021&#x2F;7&#x2F;28Time: 12:19:21&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ­¥é©Ÿ4"><a href="#æ­¥é©Ÿ4" class="headerlink" title="æ­¥é©Ÿ4:"></a>æ­¥é©Ÿ4:</h2><p>å†å°‡ssd1306.pyä¸‹è¼‰å¾Œä¸¦ä¸Šå‚³åˆ°å¾®æ§æ¿</p><h2 id="æ­¥é©Ÿ5"><a href="#æ­¥é©Ÿ5" class="headerlink" title="æ­¥é©Ÿ5:"></a>æ­¥é©Ÿ5:</h2><p>oledæ¥ç·š</p><h2 id="æ­¥é©Ÿ6"><a href="#æ­¥é©Ÿ6" class="headerlink" title="æ­¥é©Ÿ6:"></a>æ­¥é©Ÿ6:</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">import</span> ds1302<span class="token punctuation">,</span> ssd1306<span class="token keyword">from</span> machine <span class="token keyword">import</span> PIN_WAKE<span class="token punctuation">,</span> Pin<span class="token keyword">from</span> machine <span class="token keyword">import</span> SoftI2C<span class="token keyword">import</span> timewidth <span class="token operator">=</span> <span class="token number">128</span>height <span class="token operator">=</span> <span class="token number">64</span>i2c <span class="token operator">=</span> SoftI2C<span class="token punctuation">(</span>scl<span class="token operator">=</span>Pin<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sda<span class="token operator">=</span>Pin<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span>oled <span class="token operator">=</span> ssd1306<span class="token punctuation">.</span>SSD1306_I2C<span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> i2c<span class="token punctuation">)</span>ds <span class="token operator">=</span> ds1302<span class="token punctuation">.</span>DS1302<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Pin<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Pin<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>ds<span class="token punctuation">.</span>year<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>ds<span class="token punctuation">.</span>month<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>ds<span class="token punctuation">.</span>day<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>        oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>ds<span class="token punctuation">.</span>hour<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>ds<span class="token punctuation">.</span>minute<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>ds<span class="token punctuation">.</span>second<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/HnIFDhD1DxY" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ds1306 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DS18B20æº«åº¦æ„Ÿæ‡‰æ¨¡çµ„+é¡¯ç¤ºç¶²é -micropython</title>
      <link href="/2021/08/29/ds18b20-wen-du-gan-ying-mo-zu-xian-shi-wang-ye-micropython/"/>
      <url>/2021/08/29/ds18b20-wen-du-gan-ying-mo-zu-xian-shi-wang-ye-micropython/</url>
      
        <content type="html"><![CDATA[<h1 id="DS18B20æº«åº¦æ„Ÿæ‡‰æ¨¡çµ„-é¡¯ç¤ºç¶²é -micropython"><a href="#DS18B20æº«åº¦æ„Ÿæ‡‰æ¨¡çµ„-é¡¯ç¤ºç¶²é -micropython" class="headerlink" title="DS18B20æº«åº¦æ„Ÿæ‡‰æ¨¡çµ„+é¡¯ç¤ºç¶²é -micropython"></a>DS18B20æº«åº¦æ„Ÿæ‡‰æ¨¡çµ„+é¡¯ç¤ºç¶²é -micropython</h1><h6 id="tags-micropython-ds18b20"><a href="#tags-micropython-ds18b20" class="headerlink" title="tags: micropython ds18b20"></a>tags: <code>micropython</code> ds18b20</h6><hr><p>DS18B20 æº«åº¦å‚³æ„Ÿå™¨æ˜¯ä¸€ç¨®å–®ç·šæ•¸å­—æº«åº¦å‚³æ„Ÿå™¨ã€‚é€™æ„å‘³è‘—å®ƒåªéœ€è¦ä¸€æ ¹æ•¸æ“šç·šï¼ˆå’Œ GNDï¼‰å³å¯èˆ‡æ‚¨çš„ ESP32 æˆ– ESP8266 é€šä¿¡ã€‚ </p><p>å®ƒå¯ä»¥ç”±å¤–éƒ¨é›»æºä¾›é›»ï¼Œä¹Ÿå¯ä»¥å¾æ•¸æ“šç·šç²å–é›»æºï¼ˆç¨±ç‚ºâ€œå¯„ç”Ÿæ¨¡å¼â€ï¼‰ï¼Œå¾è€Œç„¡éœ€å¤–éƒ¨é›»æºã€‚</p><p>ä»¥ä¸‹æ˜¯ DS18B20 æº«åº¦å‚³æ„Ÿå™¨æœ€ç›¸é—œè¦æ ¼çš„æ‘˜è¦ï¼š </p><p>é€šéå–®ç·šç¸½ç·šé€šä¿¡<br>é›»æºç¯„åœï¼š3.0V è‡³ 5.5V<br>å·¥ä½œæº«åº¦ç¯„åœï¼š-55ÂºC è‡³ +125ÂºC<br>ç²¾åº¦ +/-0.5 ÂºCï¼ˆä»‹æ–¼ -10ÂºC è‡³ 85ÂºC ä¹‹é–“ï¼‰**</p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5051662257603737866?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-M5Mg46TDQM0/YPjn5-wneYI/AAAAAAAAegI/oEFR5CjjUgAsSSWao7HOggVsgpzjWt-QQCNcBGAsYHQ/w407-h266/image.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5051662257603737866?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-vLA_oPaKP3s/YPjoBdCR_iI/AAAAAAAAegM/JtHMyZzu1Fs78AdoOhlIBrBnbn_PR0geACNcBGAsYHQ/w457-h257/image.png"></a></p><hr><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5051662257603737866?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-PalBcnYvW7s/YPjoVWAna1I/AAAAAAAAegY/K9YqBp7hLB8BoFo-disKoJwNDmm65hd6gCNcBGAsYHQ/w457-h496/image.png"></a></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">import</span> time<span class="token keyword">import</span> onewire<span class="token punctuation">,</span> ds18x20  dsSensor<span class="token operator">=</span>ds18x20<span class="token punctuation">.</span>DS18X20<span class="token punctuation">(</span>onewire<span class="token punctuation">.</span>OneWire<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>scan<span class="token operator">=</span>dsSensor<span class="token punctuation">.</span>scan<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Devices: "</span><span class="token punctuation">,</span>scan<span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    rows<span class="token operator">=</span>ds_sensor<span class="token punctuation">.</span>scan<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The devices: "</span><span class="token punctuation">,</span> rows<span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> row <span class="token keyword">in</span> rows<span class="token punctuation">:</span>      ds_sensor<span class="token punctuation">.</span>convert_temp<span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>      temp<span class="token operator">=</span>ds_sensor<span class="token punctuation">.</span>read_temp<span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è§£æ</strong></p><p><strong>åŒ¯å…¥Pin,sleep,å–®ç¸½ç·š,æº«åº¦æ¨¡çµ„</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">import</span> time<span class="token keyword">import</span> onewire<span class="token punctuation">,</span> ds18x20<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>æ§‹é€ å‡½æ•¸</em></strong></p><p><strong><em>ow=onewire.OneWire(machine.Pin(id))</em></strong></p><p><strong><em>æ§‹å»ºå–®ç¸½ç·šå°è±¡ã€‚ id:å¼•è…³ç·¨è™Ÿï¼›</em></strong></p><p><strong><em>ä½¿ç”¨æ–¹æ³•</em></strong></p><p><strong><em>ow.scan()</em></strong></p><p><strong><em>æ§‹é€ å‡½æ•¸</em></strong></p><p><strong><em>ds=ds18x20.DS18X20(ow)</em></strong></p><p><strong><em>æ§‹å»º DS18B20 å‚³æ„Ÿå™¨å°è±¡ã€‚ ow:å®šç¾©å¥½çš„å–®ç¸½ç·šå°è±¡ï¼›</em></strong></p><p><strong><em>ä½¿ç”¨æ–¹æ³•</em></strong></p><p><strong><em>ds.scan()</em></strong></p><p><strong><em>æƒæç¸½ç·šä¸Šçš„è¨­å‚™ã€‚è¿”å›è¨­å‚™åœ°å€ï¼Œæ”¯æŒå¤šè¨­å‚™åŒæ™‚æ›è¼‰ã€‚</em></strong></p><p><strong><em>ds.convert_temp()</em></strong></p><p><strong><em>æº«åº¦è½‰æ›ã€‚</em></strong></p><p><strong><em>ds.read_temp(rom)</em></strong></p><p><strong><em>ç²å–æº«åº¦å€¼ã€‚ romï¼šè¡¨ç¤ºå°æ‡‰çš„è¨­å‚™è™Ÿã€‚</em></strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">dsSensor<span class="token operator">=</span>ds18x20<span class="token punctuation">.</span>DS18X20<span class="token punctuation">(</span>onewire<span class="token punctuation">.</span>OneWire<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>scan<span class="token operator">=</span>dsSensor<span class="token punctuation">.</span>scan<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Devices: "</span><span class="token punctuation">,</span>scan<span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    rows<span class="token operator">=</span>ds_sensor<span class="token punctuation">.</span>scan<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The devices: "</span><span class="token punctuation">,</span> rows<span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> row <span class="token keyword">in</span> rows<span class="token punctuation">:</span>      ds_sensor<span class="token punctuation">.</span>convert_temp<span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>      temp<span class="token operator">=</span>ds_sensor<span class="token punctuation">.</span>read_temp<span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>é¡¯ç¤ºçµæœ</strong></p><pre class="line-numbers language-none"><code class="language-none">Devices:Â Â \[bytearray(b&#39;(t~\\x19\\r\\x00\\x00.&#39;)\]bytearray(b&#39;(t~\\x19\\r\\x00\\x00.&#39;)26.4375bytearray(b&#39;(t~\\x19\\r\\x00\\x00.&#39;)26.375bytearray(b&#39;(t~\\x19\\r\\x00\\x00.&#39;)26.375bytearray(b&#39;(t~\\x19\\r\\x00\\x00.&#39;)26.5625Â Â Â Â <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="åŠ ä¸Šç¶²é é¡¯ç¤ºæ•¸æ“š"><a href="#åŠ ä¸Šç¶²é é¡¯ç¤ºæ•¸æ“š" class="headerlink" title="åŠ ä¸Šç¶²é é¡¯ç¤ºæ•¸æ“š"></a>åŠ ä¸Šç¶²é é¡¯ç¤ºæ•¸æ“š</h2><p><strong>é¦–å…ˆå‹•æ‰‹å¯«ä¸€å€‹html,ä¸¦æŠŠå®ƒå°åŒ…èµ·ä¾†æ–¹ä¾¿å‘¼å«</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">def</span> web_html<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  html<span class="token operator">=</span><span class="token triple-quoted-string string">"""&lt;!DOCTYPE html>      &lt;html>      &lt;head>        &lt;meta charset="utf-8" />        &lt;meta http-equiv="refresh" content="1" />        &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" />        &lt;title>ESP32 TO DS18B20&lt;/title>        &lt;style type="text/css">          body &#123;            color: rgb(9, 39, 95);            background-color: rgb(214, 205, 231);            font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;          &#125;          h1 &#123;text-align: center;&#125;          h2 &#123;text-align: center; color: rgb(60, 12, 114);&#125;          h3 &#123;text-align: center; color: deeppink;&#125;          dd &#123;text-align: center;&#125;        &lt;/style>      &lt;/head>      &lt;body>        &lt;h1>ESP32 TO DS18D20&lt;/h1>        &lt;p Align=center>&lt;img src="https://media.istockphoto.com/photos/fahrenheit-and-celsius-scale-meteorology-thermometer-for-measuring-picture-id1138308244" height="150" width="100" >&lt;/p>        &lt;dl>          &lt;dt>&lt;h2>Temperature&lt;/h2>&lt;/dt>          &lt;h3>&lt;dd class="val">"""</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token triple-quoted-string string">""" *C&lt;/dd>&lt;h3>        &lt;/dl>        &lt;br>&lt;/br>        &lt;dl>          &lt;p>&lt;i class="fas fa-temperature-high">&lt;/i>&lt;/p>          &lt;dt>&lt;h2>Temperature&lt;/h2>&lt;/dt>          &lt;h3>&lt;dd class="val">"""</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>temp <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">9</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">32.0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token triple-quoted-string string">""" *F&lt;/dd>&lt;/h3>        &lt;/dl>      &lt;/body>      &lt;/html>"""</span>  <span class="token keyword">return</span> html<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p><strong>ä¹‹å¾ŒåŠ å…¥wifiå’Œsocketå¥—æ¥å®¢æˆ¶ç«¯çš„ç›¸é—œçš„æ¥æ”¶å’Œè«‹æ±‚</strong></p><p><strong>æ•´å€‹ç¨‹å¼ç¢¼å¦‚ä¸‹:</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">import</span> socket<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">import</span> time<span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token keyword">import</span> onewire<span class="token punctuation">,</span> ds18x20<span class="token keyword">import</span> network  ssid<span class="token operator">=</span><span class="token string">"åŸºåœ°å°åç¨±"</span>password<span class="token operator">=</span><span class="token string">"åŸºåœ°å°å¯†ç¢¼"</span><span class="token keyword">def</span> connected_wifi<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">global</span> ssid<span class="token punctuation">,</span> password  wifi<span class="token operator">=</span>network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>  wifi<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>  wifi<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span>  <span class="token keyword">while</span> wifi<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token boolean">False</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connected successful!"</span><span class="token punctuation">)</span>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IP: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>wifi<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> read_sensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">global</span> temp  ds_sensor<span class="token operator">=</span>ds18x20<span class="token punctuation">.</span>DS18X20<span class="token punctuation">(</span>onewire<span class="token punctuation">.</span>OneWire<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    rows<span class="token operator">=</span>ds_sensor<span class="token punctuation">.</span>scan<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The devices: "</span><span class="token punctuation">,</span> rows<span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> row <span class="token keyword">in</span> rows<span class="token punctuation">:</span>      ds_sensor<span class="token punctuation">.</span>convert_temp<span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>      temp<span class="token operator">=</span>ds_sensor<span class="token punctuation">.</span>read_temp<span class="token punctuation">(</span>row<span class="token punctuation">)</span>      <span class="token keyword">return</span> temp<span class="token keyword">def</span> web_html<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  html<span class="token operator">=</span><span class="token triple-quoted-string string">"""&lt;!DOCTYPE html>      &lt;html>      &lt;head>        &lt;meta charset="utf-8" />        &lt;meta http-equiv="refresh" content="1" />        &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" />        &lt;title>ESP32 TO DS18B20&lt;/title>        &lt;style type="text/css">          body &#123;            color: rgb(9, 39, 95);            background-color: rgb(214, 205, 231);            font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;          &#125;          h1 &#123;text-align: center;&#125;          h2 &#123;text-align: center; color: rgb(60, 12, 114);&#125;          h3 &#123;text-align: center; color: deeppink;&#125;          dd &#123;text-align: center;&#125;        &lt;/style>      &lt;/head>      &lt;body>        &lt;h1>ESP32 TO DS18D20&lt;/h1>        &lt;p Align=center>&lt;img src="https://media.istockphoto.com/photos/fahrenheit-and-celsius-scale-meteorology-thermometer-for-measuring-picture-id1138308244" height="150" width="100" >&lt;/p>        &lt;dl>          &lt;dt>&lt;h2>Temperature&lt;/h2>&lt;/dt>          &lt;h3>&lt;dd class="val">"""</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token triple-quoted-string string">""" *C&lt;/dd>&lt;h3>        &lt;/dl>        &lt;br>&lt;/br>        &lt;dl>          &lt;p>&lt;i class="fas fa-temperature-high">&lt;/i>&lt;/p>          &lt;dt>&lt;h2>Temperature&lt;/h2>&lt;/dt>          &lt;h3>&lt;dd class="val">"""</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>temp <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">9</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">32.0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token triple-quoted-string string">""" *F&lt;/dd>&lt;/h3>        &lt;/dl>      &lt;/body>      &lt;/html>"""</span>  <span class="token keyword">return</span> html  connected_wifi<span class="token punctuation">(</span><span class="token punctuation">)</span>s<span class="token operator">=</span>socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>  conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Got a connection from %s'</span><span class="token operator">%</span><span class="token builtin">str</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">)</span>  request <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"content: %s"</span><span class="token operator">%</span><span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">)</span>  read_temp<span class="token operator">=</span>read_sensor<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">print</span><span class="token punctuation">(</span>read_temp<span class="token punctuation">)</span>  res<span class="token operator">=</span>web_html<span class="token punctuation">(</span><span class="token punctuation">)</span>  conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"http/1.1 200 OK\n"</span><span class="token punctuation">)</span>  conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"Content-Type: text/html\n"</span><span class="token punctuation">)</span>  conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"Connection: close\n\n"</span><span class="token punctuation">)</span>  conn<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>res<span class="token punctuation">)</span>  conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><p><strong>åŒ¯å…¥machine, sockt, network, HC_SR04æ¨¡çµ„</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin <span class="token keyword">from</span> HC_SR04 <span class="token keyword">import</span> HCSR04<span class="token keyword">import</span> socket<span class="token punctuation">,</span> network<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¨­å®šwifié€£ç·š</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">def</span> connected_wifi<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">global</span> ssid<span class="token punctuation">,</span> password  wifi<span class="token operator">=</span>network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>  wifi<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>  wifi<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span>  <span class="token keyword">while</span> wifi<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token boolean">False</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connected successful!"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IP: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>wifi<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è®€å–DS18B20æ•¸æ“š</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">def</span> read_sensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">global</span> temp  ds_sensor<span class="token operator">=</span>ds18x20<span class="token punctuation">.</span>DS18X20<span class="token punctuation">(</span>onewire<span class="token punctuation">.</span>OneWire<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    rows<span class="token operator">=</span>ds_sensor<span class="token punctuation">.</span>scan<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The devices: "</span><span class="token punctuation">,</span> rows<span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> row <span class="token keyword">in</span> rows<span class="token punctuation">:</span>      ds_sensor<span class="token punctuation">.</span>convert_temp<span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>      temp<span class="token operator">=</span>ds_sensor<span class="token punctuation">.</span>read_temp<span class="token punctuation">(</span>row<span class="token punctuation">)</span>      <span class="token keyword">return</span> temp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>socketå¥—æ¥</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">s<span class="token operator">=</span>socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>  conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Got a connection from %s'</span><span class="token operator">%</span><span class="token builtin">str</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">)</span>  request <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"content: %s"</span><span class="token operator">%</span><span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">)</span>  read_temp<span class="token operator">=</span>read_sensor<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">print</span><span class="token punctuation">(</span>read_temp<span class="token punctuation">)</span>  res<span class="token operator">=</span>web_html<span class="token punctuation">(</span><span class="token punctuation">)</span>  conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"http/1.1 200 OK\\n"</span><span class="token punctuation">)</span>  conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"Content-Type: text/html\n"</span><span class="token punctuation">)</span>  conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"Connection: close\n\n"</span><span class="token punctuation">)</span>  conn<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>res<span class="token punctuation">)</span>  conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5051662257603737866?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-2BVcuDPUyWo/YPpATv8mUUI/AAAAAAAAegs/M-2s_MNuCJ88coTfrj8QqGimPFFIcZ7RQCNcBGAsYHQ/w644-h324/2.jpg"></a></p>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DS18B20 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æº«æ¿•åº¦å‚³æ„Ÿå™¨(DHT11/12)+ThingSpeak</title>
      <link href="/2021/08/29/wen-shi-du-chuan-gan-qi-dht11-12-thingspeak/"/>
      <url>/2021/08/29/wen-shi-du-chuan-gan-qi-dht11-12-thingspeak/</url>
      
        <content type="html"><![CDATA[<h1 id="æº«æ¿•åº¦å‚³æ„Ÿå™¨-DHT11-12-ThingSpeak"><a href="#æº«æ¿•åº¦å‚³æ„Ÿå™¨-DHT11-12-ThingSpeak" class="headerlink" title="æº«æ¿•åº¦å‚³æ„Ÿå™¨(DHT11/12)+ThingSpeak"></a>æº«æ¿•åº¦å‚³æ„Ÿå™¨(DHT11/12)+ThingSpeak</h1><h6 id="tags-micropython-thingspeak-dht11-dht12"><a href="#tags-micropython-thingspeak-dht11-dht12" class="headerlink" title="tags: micropython thingspeak dht11/dht12"></a>tags: <code>micropython</code> <code>thingspeak</code> <code>dht11/dht12</code></h6><p><a href="https://1.bp.blogspot.com/-wKr7F1FYVIg/YPjC09ruT-I/AAAAAAAAegA/lJ2_JcIB1eUkbiPNuHqpejBJzidrbNYEwCNcBGAsYHQ/s1920/1.jpg"><img src="https://1.bp.blogspot.com/-wKr7F1FYVIg/YPjC09ruT-I/AAAAAAAAegA/lJ2_JcIB1eUkbiPNuHqpejBJzidrbNYEwCNcBGAsYHQ/w633-h269/1.jpg"></a></p><hr><p><strong>å›é¡§DHT11/12å¯¦ä½œç´€éŒ„</strong></p><p><strong>åŸºæœ¬ä»‹ç´¹å’Œå¯¦é©—åƒè€ƒ-</strong><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2584628173386400659?hl=zh-TW#">https://esp32-blairan.blogspot.com/2021/07/dht11dht12-esp32.html</a></p><hr><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2584628173386400659?hl=zh-TW#"><img src="http://2.bp.blogspot.com/-3syBdItbhrI/Vb6X8sJx7tI/AAAAAAAAEO8/cMmlSOV142M/s320/dht11.jpg"></a></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">import</span> dht<span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">def</span> measureTemp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    sensor<span class="token operator">=</span>dht<span class="token punctuation">.</span>DHT11<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>            sensor<span class="token punctuation">.</span>measure<span class="token punctuation">(</span><span class="token punctuation">)</span>            t<span class="token operator">=</span>sensor<span class="token punctuation">.</span>temperature<span class="token punctuation">(</span><span class="token punctuation">)</span>            t_f<span class="token operator">=</span>t<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">32</span>            h<span class="token operator">=</span>sensor<span class="token punctuation">.</span>humidity<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Temp: &#123;:.1f&#125;.C"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Temp: &#123;:.1f&#125;.F"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>t_f<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Humidity: &#123;:.1f&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> OSError <span class="token keyword">as</span> o<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Failed to read sensor."</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    measureTemp<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¼‰å…¥dhtåº«(å…§å»º)</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">import</span> dht<span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æŒ‡å®šDHT11è…³ä½çµ¦sensorè®Šæ•¸</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">sensor<span class="token operator">=</span>dht<span class="token punctuation">.</span>DHT11<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>çµ¦äºˆwhile()æ¯2ç§’ä¸æ–·åµæ¸¬</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>sensor<span class="token punctuation">.</span>measure<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>æ”æ°æº«åº¦(t)/è¯æ°æº«åº¦(t_f)/æ¿•åº¦</strong></p><p><strong>å…¶ä¸­æ”æ°è½‰æ›è¯æ°çš„å…¬å¼:æ”æ°x(9/5)+32</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">t<span class="token operator">=</span>sensor<span class="token punctuation">.</span>temperature<span class="token punctuation">(</span><span class="token punctuation">)</span>t_f<span class="token operator">=</span>t<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">32</span>h<span class="token operator">=</span>sensor<span class="token punctuation">.</span>humidity<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Temp: &#123;:.1f&#125;.C"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Temp: &#123;:.1f&#125;.F"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>t_f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Humidity: &#123;:.1f&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="çµæœ"><a href="#çµæœ" class="headerlink" title="çµæœ"></a>çµæœ</h2><pre class="line-numbers language-none"><code class="language-none">&gt;&gt;&gt;Â Temp:Â 26.0.CTemp:Â 78.8.FHumidity:Â 27.0Temp:Â 26.0.CTemp:Â 78.8.FHumidity:Â 27.0Temp:Â 26.0.CTemp:Â 78.8.FHumidity:Â 27.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="å¦‚ä½•ä¸Šå‚³æ•¸æ“šåˆ°ThingSpeak"><a href="#å¦‚ä½•ä¸Šå‚³æ•¸æ“šåˆ°ThingSpeak" class="headerlink" title="å¦‚ä½•ä¸Šå‚³æ•¸æ“šåˆ°ThingSpeak"></a>å¦‚ä½•ä¸Šå‚³æ•¸æ“šåˆ°ThingSpeak</h2><p><strong>å…ˆåˆ°æ­¤<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2584628173386400659?hl=zh-TW#">ThingSpeak</a>ç¶²ç«™è¨»å†Šä¸€å¸³è™Ÿ</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2584628173386400659?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-4RxhjYmlh_w/YPi8P5fsN8I/AAAAAAAAeeM/yzV1oiE05VgEVVeNwhVCtsFwQ1cfASN-gCNcBGAsYHQ/w934-h353/4.jpg"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2584628173386400659?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-M_V8HTIXrOE/YPi8nmVCETI/AAAAAAAAee0/1F322PD3xF8K2cShI60AYjD5SWHSU1H8gCNcBGAsYHQ/w862-h326/3.jpg"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2584628173386400659?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-g2Npin1ea78/YPi9X5a3scI/AAAAAAAAefY/NIGB1rmS9EktBe1uC1izXbW9rrMA0VrEgCNcBGAsYHQ/w659-h286/5.jpg"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2584628173386400659?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-mDsWT2vL9uI/YPi9gFDE3tI/AAAAAAAAefc/TtXCW9i2P949XybIa09n606lHwmW-PnwACNcBGAsYHQ/w654-h284/6.jpg"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2584628173386400659?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-mrzm6S71djU/YPi9lqFmdLI/AAAAAAAAefg/Xr5UMJs2m9wzKy6hHJvW-_NDyP5wFljYwCNcBGAsYHQ/w651-h283/7.jpg"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2584628173386400659?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-Dk5fmn8xP0Q/YPi9ro_CJvI/AAAAAAAAefk/8bRay8G7aVYqN5E4szIINBNhkAm0aAYcwCNcBGAsYHQ/w692-h368/8.jpg"></a></p><hr><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2584628173386400659?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-FcMZGCGvGjI/YPi-kOFx8II/AAAAAAAAefw/8lNcoOipruwT3wRTrRYwn36ZL8Eldl8QQCNcBGAsYHQ/w758-h329/%25E6%2593%25B7%25E5%258F%2596_2021_07_22_08_13_19_130.jpg"></a></p><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">import</span> network<span class="token punctuation">,</span> urequests<span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token keyword">import</span> dht<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep  ssid<span class="token operator">=</span><span class="token string">"åŸºåœ°å°åç¨±"</span>password<span class="token operator">=</span><span class="token string">"åŸºåœ°å°å¯†ç¢¼"</span>api_key<span class="token operator">=</span><span class="token string">"VCJQHQFVSMB-----"</span>dht11<span class="token operator">=</span>dht<span class="token punctuation">.</span>DHT11<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">def</span> wifiContent<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> ssid<span class="token punctuation">,</span> password    wifi<span class="token operator">=</span>network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>    wifi<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>    wifi<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span>    <span class="token keyword">while</span> wifi<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connected successful!"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IP: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>wifi<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> getDHT<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        dht11<span class="token punctuation">.</span>measure<span class="token punctuation">(</span><span class="token punctuation">)</span>        d<span class="token operator">=</span>dht11<span class="token punctuation">.</span>temperature<span class="token punctuation">(</span><span class="token punctuation">)</span>        rh<span class="token operator">=</span>dht11<span class="token punctuation">.</span>humidity<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Temp: &#123;:.1f&#125;*C,  Humi: &#123;:.1f&#125;%RH"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> rh<span class="token punctuation">)</span><span class="token punctuation">)</span>        uloadUrl<span class="token operator">=</span><span class="token string">"https://api.thingspeak.com/update?api_key=&#123;&#125;&amp;field1=&#123;&#125;&amp;field2=&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>api<span class="token punctuation">,</span> d<span class="token punctuation">,</span> rh<span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            res<span class="token operator">=</span>urequests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>uloadUrl<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token keyword">except</span> OSError <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">"__main__"</span><span class="token punctuation">:</span>    wifiContent<span class="token punctuation">(</span><span class="token punctuation">)</span>    getDHT<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><p><strong><em>åŒ¯å…¥å°æ‡‰çš„æ¨¡çµ„,å…¶urequestæ˜¯å°å‹çˆ¬èŸ²,å¯ç”¨æ–¼æŠ“å–å’Œä¸Šå‚³</em></strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">import</span> network<span class="token punctuation">,</span> urequests<span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token keyword">import</span> dht<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>åŸºåœ°å°åç¨±å’Œå¯†ç¢¼å…ˆçµ¦äºˆè®Šæ•¸,é‚„æœ‰å‰›åœ¨ThingSpeakçµ¦çš„api_key</em></strong></p><p><strong><em>dhtè…³ä½è¨­å®š,åœæ­¢ä¸€ç§’ä½¿å…¶åˆå§‹åŒ–å®Œå…¨</em></strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">ssid<span class="token operator">=</span><span class="token string">"åŸºåœ°å°åç¨±"</span>password<span class="token operator">=</span><span class="token string">"åŸºåœ°å°å¯†ç¢¼"</span>api<span class="token operator">=</span><span class="token string">"VCJQHQFVSMB-----"</span>dht11<span class="token operator">=</span>dht<span class="token punctuation">.</span>DHT11<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><em><strong>é€™å€‹å°åŒ…è£¡æ˜¯é€£æ¥wifiçš„æµç¨‹</strong></em></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">def</span> wifiContent<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> ssid<span class="token punctuation">,</span> password    wifi<span class="token operator">=</span>network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>    wifi<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>    wifi<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span>    <span class="token keyword">while</span> wifi<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connected successful!"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IP: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>wifi<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>é€™å€‹å°åŒ…è£¡æ˜¯è®€å–dht11/12æ•¸æ“š,å’Œä¸Šå‚³åˆ°ThingSpeakåŒæ­¥</em></strong></p><p>*<strong>å¦‚æœæœ‰ä¸€å€‹ä»¥ä¸Šçš„æ•¸æ“š,é™¤äº†ThingSpeakç¶²ç«™ä¸Šè¦è¨­å®šä¸€å€‹ä»¥ä¸Šçš„å°æ‡‰æ¬„ä½,å†ä¾†å°±æ˜¯ç¨‹å¼çš„ç¶²å€æ ¼å¼,ä¾‹å¦‚:</strong></p><p><strong>api_key</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">api_key<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>2å€‹æ•¸æ“šä¸Šå‚³åˆ°ç¶²ç«™çš„2å€‹æ¬„ä½,field1ä»£è¡¨ç¬¬ä¸€å€‹æ¬„ä½,field2ä»£è¡¨ç¬¬äºŒå€‹æ¬„ä½</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token operator">&amp;</span>field1<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token operator">&amp;</span>field2<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">def</span> getDHT<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        dht11<span class="token punctuation">.</span>measure<span class="token punctuation">(</span><span class="token punctuation">)</span>        d<span class="token operator">=</span>dht11<span class="token punctuation">.</span>temperature<span class="token punctuation">(</span><span class="token punctuation">)</span>        rh<span class="token operator">=</span>dht11<span class="token punctuation">.</span>humidity<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Temp: &#123;:.1f&#125;*C,  Humi: &#123;:.1f&#125;%RH"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> rh<span class="token punctuation">)</span><span class="token punctuation">)</span>        uloadUrl<span class="token operator">=</span><span class="token string">"https://api.thingspeak.com/update?api_key=&#123;&#125;&amp;field1=&#123;&#125;&amp;field2=&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>api<span class="token punctuation">,</span> d<span class="token punctuation">,</span> rh<span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            res<span class="token operator">=</span>urequests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>uloadUrl<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token keyword">except</span> OSError <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2584628173386400659?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-lggjIDGj9VA/YPjA-2exaYI/AAAAAAAAef4/QN52OngWLS4MVqiFHVu2lF5D_EC-BE89wCNcBGAsYHQ/w730-h410/2.jpg"></a></p>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dht11/dht12 </tag>
            
            <tag> thingSpeak </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BMP280æ°£å£“,æº«åº¦æ¨¡çµ„-micropython</title>
      <link href="/2021/08/29/bmp280-qi-ya-wen-du-mo-zu-micropython/"/>
      <url>/2021/08/29/bmp280-qi-ya-wen-du-mo-zu-micropython/</url>
      
        <content type="html"><![CDATA[<h1 id="BMP280æ°£å£“-æº«åº¦æ¨¡çµ„-micropython"><a href="#BMP280æ°£å£“-æº«åº¦æ¨¡çµ„-micropython" class="headerlink" title="BMP280æ°£å£“,æº«åº¦æ¨¡çµ„-micropython"></a>BMP280æ°£å£“,æº«åº¦æ¨¡çµ„-micropython</h1><h6 id="tags-micropython-bmp280"><a href="#tags-micropython-bmp280" class="headerlink" title="tags: micropython bmp280"></a>tags: <code>micropython</code> <code>bmp280</code></h6><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2288121610458811026?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-4LdM2J8lnOY/YPV1dYnda-I/AAAAAAAAecQ/OXHYgyYLfkgCzpZzyPV9wC_xhR4CiLv2ACNcBGAsYHQ/s320/21805656779815_796.jpg"></a></p><p>**_BMP280,è©²å‚³æ„Ÿå™¨å¯ä»¥éå¸¸æº–ç¢ºåœ°æ¸¬é‡æ°£å£“å’Œæº«åº¦ã€‚  </p><p>æ‚¨å¯ä»¥ä½¿ç”¨ I2C æˆ– SPI é€£æ¥å”è­°å°‡å…¶èˆ‡æ‚¨çš„ Arduino æ¿é€£æ¥ã€‚å®ƒæœ‰ä¸€å€‹ 3.3V ç©©å£“å™¨å’Œé›»å¹³è½‰æ›ï¼Œå› æ­¤æ‚¨å¯ä»¥æ¯«ç„¡å•é¡Œåœ°å°‡å®ƒèˆ‡ 3V æˆ– 5V é‚è¼¯å¾®æ§åˆ¶å™¨ä¸€èµ·ä½¿ç”¨ã€‚_**</p><hr><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p>| BME280 | ESP32 |<br>| Vin | 3.3V |<br>| GND | GND |<br>| SCL | GPIO 22 |<br>| SDA | GPIO 21 |</p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2288121610458811026?hl=zh-TW#"><img src="https://i0.wp.com/randomnerdtutorials.com/wp-content/uploads/2018/08/ESP32-bme280_bb_f-768x669.png?resize=768,669&quality=100&strip=all&ssl=1"></a></p><hr><p><strong>å°‡<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2288121610458811026?hl=zh-TW#">bmp280.py</a>ä¸Šå‚³åˆ°æ¿å­è£¡,ä»¥ä¾¿å¯è¼‰å…¥å‡½å¼åº«</strong></p><p>**</p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2288121610458811026?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-1m3Ca316Awg/YPYqYTi4jhI/AAAAAAAAeco/IfQy-3mEXxslGaYpVXR_pTnkesOTuea5wCNcBGAsYHQ/w711-h400/b.jpg"></a></p><p>**</p><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py">fromÂ machineÂ importÂ SoftI2C,Â Pin,Â sleepfromÂ bmp280Â importÂ BMP280whileÂ True:Â Â Â Â i2c&#x3D;SoftI2C(sda&#x3D;Pin(21),Â scl&#x3D;Pin(22))Â Â Â Â bmp&#x3D;BMP280(i2c)Â Â Â Â temp&#x3D;bmp.temperatureÂ Â Â Â pressure&#x3D;bmp.pressureÂ Â Â Â print(&quot;TemptureÂ &#x3D;Â &#123;&#125;Â *C&quot;.format(temp))Â Â Â Â print(&quot;PressureÂ &#x3D;Â &#123;&#125;Â hPa&quot;.format(pressure))Â Â Â Â print(&quot;&#x3D;&quot;*20)Â Â Â Â sleep(1000)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><pre class="line-numbers language-none"><code class="language-none">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Â Â Â TemptureÂ &#x3D;Â 24.67Â *CÂ Â Â Â PressureÂ &#x3D;Â 77892.58Â hPa&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bmp280 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¶²é æ§åˆ¶LED-micropython</title>
      <link href="/2021/08/29/wang-ye-kong-zhi-led-micropython/"/>
      <url>/2021/08/29/wang-ye-kong-zhi-led-micropython/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¶²é æ§åˆ¶LED-micropython"><a href="#ç¶²é æ§åˆ¶LED-micropython" class="headerlink" title="ç¶²é æ§åˆ¶LED-micropython"></a>ç¶²é æ§åˆ¶LED-micropython</h1><p><strong>å› ç‚ºæ˜¯ç”¨å…§å»ºçš„LEDæ‰€ä»¥ä¸ç”¨æ¥ä»»ä½•æœé‚¦ç·š</strong></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token keyword">import</span> network<span class="token punctuation">,</span> socket  ssid<span class="token operator">=</span><span class="token string">"---"</span>password<span class="token operator">=</span><span class="token string">"------"</span>led<span class="token operator">=</span>Pin<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> Pin<span class="token punctuation">.</span>OUT<span class="token punctuation">)</span>ledState<span class="token operator">=</span><span class="token string">"OFF"</span><span class="token keyword">def</span> sw_page<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> led<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>        ledState<span class="token operator">=</span><span class="token string">"ON"</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        ledState<span class="token operator">=</span><span class="token string">"OFF"</span>    html<span class="token operator">=</span><span class="token triple-quoted-string string">"""            &lt;html>        &lt;head>            &lt;title>ESP32 ç¶²é ä¼ºæœå™¨æ§åˆ¶ç·´ç¿’&lt;/title>            &lt;meta name="viewport" content="width=device-width, initial            scale=1">            &lt;link rel="icon" href="data:,">            &lt;style>                html &#123;                    text-align: center;                    font-family: Arial;                    display: inline-block;                    margin: auto;&#125;                .button &#123;                    background-color: #e0e252; /* Green */                    border: none;                    color: white;                    padding: 15px 35px;                    text-align: center;                    text-decoration: none;                    display: inline-block;                    font-size: 16px;                &#125;                .button2 &#123;                    background-color: #b0b1a2; /* Green */                    padding: 15px 32px;                &#125;            &lt;/style>        &lt;/head>          &lt;body>            &lt;h1>ESP32 ç¶²é ä¼ºæœå™¨æ§åˆ¶ç·´ç¿’&lt;/h1>            &lt;p>GPIO-2 ç‹€æ…‹: &lt;strong>"""</span> <span class="token operator">+</span> ledState <span class="token operator">+</span> <span class="token triple-quoted-string string">"""&lt;/strong>&lt;/p>            &lt;p>&lt;a href="/on">&lt;button class="button">ON&lt;/button>&lt;/a>&lt;/p>            &lt;p>&lt;a href="/off">&lt;button class="button button2">OFF&lt;/button>&lt;/a>&lt;/p>        &lt;/body>        &lt;/html>    """</span>    <span class="token keyword">return</span> htmlwifi<span class="token operator">=</span>network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>wifi<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>wifi<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token keyword">while</span> wifi<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token boolean">False</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connected sccessful!"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IP: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>wifi<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  s<span class="token operator">=</span>socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"got a connect from %s"</span><span class="token operator">%</span><span class="token builtin">str</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">)</span>    request <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    request <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"context = %s"</span><span class="token operator">%</span>request<span class="token punctuation">)</span>    led_on <span class="token operator">=</span> request<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"/on"</span><span class="token punctuation">)</span>    led_off <span class="token operator">=</span> request<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"/off"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> led_on <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">:</span>        led<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ON"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> led_off <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">:</span>        led<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"OFF"</span><span class="token punctuation">)</span>    respones <span class="token operator">=</span> sw_page<span class="token punctuation">(</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"HTTP/1.1 200 OK\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"Context-Type: text/html\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"Connection: close\n\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>respones<span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><p><strong>åŒ¯å…¥è…³ä½å’Œwifiå’Œå¥—æ¥çš„æ¨¡çµ„</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token keyword">import</span> network<span class="token punctuation">,</span> socket<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>wifié€£ç·šè¨­å®š</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">ssid<span class="token operator">=</span><span class="token string">"åŸºåœ°å°åç¨±"</span>password<span class="token operator">=</span><span class="token string">"åŸºåœ°å°å¯†ç¢¼"</span>wifi<span class="token operator">=</span>network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>wifi<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>wifi<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token keyword">while</span> wifi<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token boolean">False</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connected sccessful!"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IP: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>wifi<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä¸»è¦é€™è£¡æ˜¯å‰ç«¯ç¶²é ,ifå’Œelseæ˜¯åœ¨æ§åˆ¶ç¶²é çš„é–‹å•“å°±é¡¯ç¤ºON,å¦å‰‡é¡¯ç¤ºOFF</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> sw_page<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> ifled<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>ledState<span class="token operator">=</span><span class="token string">"ON"</span><span class="token keyword">else</span><span class="token punctuation">:</span>        ledState<span class="token operator">=</span><span class="token string">"OFF"</span>    html<span class="token operator">=</span><span class="token triple-quoted-string string">"""            &lt;html>        &lt;head>            &lt;title>ESP32 ç¶²é ä¼ºæœå™¨æ§åˆ¶ç·´ç¿’&lt;/title>            &lt;meta name="viewport" content="width=device-width, initial            scale=1">            &lt;link rel="icon" href="data:,">            &lt;style>                html &#123;                    text-align: center;                    font-family: Arial;                    display: inline-block;                    margin: auto;&#125;                .button &#123;                    background-color: #e0e252; /* Green */                    border: none;                    color: white;                    padding: 15px 35px;                    text-align: center;                    text-decoration: none;                    display: inline-block;                    font-size: 16px;                &#125;                .button2 &#123;                    background-color: #b0b1a2; /* Green */                    padding: 15px 32px;                &#125;            &lt;/style>        &lt;/head>          &lt;body>            &lt;h1>ESP32 ç¶²é ä¼ºæœå™¨æ§åˆ¶ç·´ç¿’&lt;/h1>            &lt;p>GPIO-2 ç‹€æ…‹: &lt;strong>"""</span> <span class="token operator">+</span> ledState <span class="token operator">+</span> <span class="token triple-quoted-string string">"""&lt;/strong>&lt;/p>            &lt;p>&lt;a href="/on">&lt;button class="button">ON&lt;/button>&lt;/a>&lt;/p>            &lt;p>&lt;a href="/off">&lt;button class="button button2">OFF&lt;/button>&lt;/a>&lt;/p>        &lt;/body>        &lt;/html>    """</span>    <span class="token keyword">return</span> html<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p><strong>ä»¥ä¸‹æ˜¯å¥—æ¥</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">s<span class="token operator">=</span>socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"got a connect from %s"</span><span class="token operator">%</span><span class="token builtin">str</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">)</span>    request <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    request <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"context = %s"</span><span class="token operator">%</span>request<span class="token punctuation">)</span>    led_on <span class="token operator">=</span> request<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"/on"</span><span class="token punctuation">)</span>    led_off <span class="token operator">=</span> request<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"/off"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> led_on <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">:</span>        led<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ON"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> led_off <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">:</span>        led<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"OFF"</span><span class="token punctuation">)</span>    respones <span class="token operator">=</span> sw_page<span class="token punctuation">(</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"HTTP/1.1 200 OK\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"Context-Type: text/html\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"Connection: close\n\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>respones<span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/OmbY4UQ8Kcc" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web server </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HC-SR04è¶…éŸ³æ³¢æ¨¡çµ„&amp;ç¶²é é¡¯ç¤º</title>
      <link href="/2021/08/29/hc-sr04-chao-yin-bo-mo-zu-wang-ye-xian-shi/"/>
      <url>/2021/08/29/hc-sr04-chao-yin-bo-mo-zu-wang-ye-xian-shi/</url>
      
        <content type="html"><![CDATA[<h1 id="HC-SR04è¶…éŸ³æ³¢æ¨¡çµ„-amp-ç¶²é é¡¯ç¤º"><a href="#HC-SR04è¶…éŸ³æ³¢æ¨¡çµ„-amp-ç¶²é é¡¯ç¤º" class="headerlink" title="HC-SR04è¶…éŸ³æ³¢æ¨¡çµ„&amp;ç¶²é é¡¯ç¤º"></a>HC-SR04è¶…éŸ³æ³¢æ¨¡çµ„&amp;ç¶²é é¡¯ç¤º</h1><h6 id="tags-micropython-â€˜hc-sr04â€™"><a href="#tags-micropython-â€˜hc-sr04â€™" class="headerlink" title="tags: micropython, â€˜hc-sr04â€™"></a>tags: <code>micropython</code>, â€˜hc-sr04â€™</h6><p><strong>è¶…éŸ³æ³¢æ¨¡çµ„æ¸¬è©¦åƒè€ƒ-</strong><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/956822760667011320#">https://blairan-esp32-micropython.blogspot.com/2021/07/blog-post.html</a></p><p><strong><em>åŸºæ–¼ä»¥ä¸Šçš„åŸºæœ¬æ¸¬è©¦,åŠ å…¥WiFiç¶²é ä¼ºæœå™¨å³å¯é¡¯ç¤ºæ–¼ç¶²é </em></strong></p><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p>â€”â€”â€”â€”â€”â€”â€”â€”â€“Â Â Â Â </p><p>//Â Â *Â |Â HC-SC04Â |Â ESP32 Â |Â Â Â Â </p><p>//Â Â *Â â€”â€”â€”â€”â€”â€”â€”Â Â Â Â </p><p>//Â Â *Â |Â Â Â VccÂ Â Â |Â Â Â 3.3VÂ Â |Â Â Â Â </p><p>//Â Â *Â |Â Â Â TrigÂ Â |Â Â Â 32Â Â Â Â |Â  </p><p>//Â Â *Â |Â Â Â EchoÂ Â |Â Â Â 33Â Â Â Â |Â Â Â Â Â </p><p>//Â Â *Â |Â Â Â GndÂ Â Â |Â Â Â GNDÂ Â Â |Â  </p><p>//Â Â *Â â€”â€”â€”â€”â€”â€”â€”</p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/956822760667011320#"><img src="https://lemariva.com/storage/temp/public/295/644/a2e/esp32_bb__750.png"></a></p><hr><h2 id="ä¸Šå‚³HC-SR04-pyæª”è‡³æ¿ä¸Š"><a href="#ä¸Šå‚³HC-SR04-pyæª”è‡³æ¿ä¸Š" class="headerlink" title="ä¸Šå‚³HC-SR04.pyæª”è‡³æ¿ä¸Š"></a>ä¸Šå‚³HC-SR04.pyæª”è‡³æ¿ä¸Š</h2><h2 id="HC-SR04-py"><a href="#HC-SR04-py" class="headerlink" title="HC_SR04.py"></a>HC_SR04.py</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">import</span> machine<span class="token punctuation">,</span> time<span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin <span class="token keyword">class</span> <span class="token class-name">HCSR04</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Driver to use the untrasonic sensor HC-SR04.    The sensor range is between 2cm and 4m.    The timeouts received listening to echo pin are converted to OSError('Out of range')    """</span>    <span class="token comment"># echo_timeout_us is based in chip range limit (400cm)</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> trigger_pin<span class="token punctuation">,</span> echo_pin<span class="token punctuation">,</span> echo_timeout_us<span class="token operator">=</span><span class="token number">500</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">*</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        trigger_pin: Output pin to send pulses        echo_pin: Readonly pin to measure the distance. The pin should be protected with 1k resistor        echo_timeout_us: Timeout in microseconds to listen to echo pin.         By default is based in sensor limit range (4m)        """</span>        self<span class="token punctuation">.</span>echo_timeout_us <span class="token operator">=</span> echo_timeout_us        <span class="token comment"># Init trigger pin (out)</span>        self<span class="token punctuation">.</span>trigger <span class="token operator">=</span> Pin<span class="token punctuation">(</span>trigger_pin<span class="token punctuation">,</span> mode<span class="token operator">=</span>Pin<span class="token punctuation">.</span>OUT<span class="token punctuation">,</span> pull<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>trigger<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>         <span class="token comment"># Init echo pin (in)</span>        self<span class="token punctuation">.</span>echo <span class="token operator">=</span> Pin<span class="token punctuation">(</span>echo_pin<span class="token punctuation">,</span> mode<span class="token operator">=</span>Pin<span class="token punctuation">.</span>IN<span class="token punctuation">,</span> pull<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>     <span class="token keyword">def</span> <span class="token function">_send_pulse_and_wait</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        Send the pulse to trigger and listen on echo pin.        We use the method `machine.time_pulse_us()` to get the microseconds until the echo is received.        """</span>        self<span class="token punctuation">.</span>trigger<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># Stabilize the sensor</span>        time<span class="token punctuation">.</span>sleep_us<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>trigger<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment"># Send a 10us pulse.</span>        time<span class="token punctuation">.</span>sleep_us<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>trigger<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            pulse_time <span class="token operator">=</span> machine<span class="token punctuation">.</span>time_pulse_us<span class="token punctuation">(</span>self<span class="token punctuation">.</span>echo<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>echo_timeout_us<span class="token punctuation">)</span>            <span class="token keyword">return</span> pulse_time        <span class="token keyword">except</span> OSError <span class="token keyword">as</span> ex<span class="token punctuation">:</span>            <span class="token keyword">if</span> ex<span class="token punctuation">.</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">110</span><span class="token punctuation">:</span> <span class="token comment"># 110 = ETIMEDOUT</span>                <span class="token keyword">raise</span> OSError<span class="token punctuation">(</span><span class="token string">'Out of range'</span><span class="token punctuation">)</span>            <span class="token keyword">raise</span> ex     <span class="token keyword">def</span> <span class="token function">distance_mm</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        Get the distance in milimeters without floating point operations.        """</span>        pulse_time <span class="token operator">=</span> self<span class="token punctuation">.</span>_send_pulse_and_wait<span class="token punctuation">(</span><span class="token punctuation">)</span>         <span class="token comment"># To calculate the distance we get the pulse_time and divide it by 2 </span>        <span class="token comment"># (the pulse walk the distance twice) and by 29.1 becasue</span>        <span class="token comment"># the sound speed on air (343.2 m/s), that It's equivalent to</span>        <span class="token comment"># 0.34320 mm/us that is 1mm each 2.91us</span>        <span class="token comment"># pulse_time // 2 // 2.91 -> pulse_time // 5.82 -> pulse_time * 100 // 582 </span>        mm <span class="token operator">=</span> pulse_time <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">//</span> <span class="token number">582</span>        <span class="token keyword">return</span> mm     <span class="token keyword">def</span> <span class="token function">distance_cm</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        Get the distance in centimeters with floating point operations.        It returns a float        """</span>        pulse_time <span class="token operator">=</span> self<span class="token punctuation">.</span>_send_pulse_and_wait<span class="token punctuation">(</span><span class="token punctuation">)</span>         <span class="token comment"># To calculate the distance we get the pulse_time and divide it by 2 </span>        <span class="token comment"># (the pulse walk the distance twice) and by 29.1 becasue</span>        <span class="token comment"># the sound speed on air (343.2 m/s), that It's equivalent to</span>        <span class="token comment"># 0.034320 cm/us that is 1cm each 29.1us</span>        cms <span class="token operator">=</span> <span class="token punctuation">(</span>pulse_time <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">29.1</span>        <span class="token keyword">return</span> cms<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ä¸»ç¨‹å¼ç¢¼"><a href="#ä¸»ç¨‹å¼ç¢¼" class="headerlink" title="ä¸»ç¨‹å¼ç¢¼"></a>ä¸»ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token operator">**</span>main<span class="token punctuation">.</span>py<span class="token operator">**</span><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin <span class="token comment">#åŒ¯å…¥i2cç›¸é—œæ¨¡çµ„å’Œè…³ä½æ¨¡çµ„</span><span class="token keyword">from</span> HC_SR04 <span class="token keyword">import</span> HCSR04<span class="token keyword">import</span> socket<span class="token punctuation">,</span> network  ssid<span class="token operator">=</span><span class="token string">"åŸºåœ°å°åç¨±"</span>password<span class="token operator">=</span><span class="token string">"åŸºåœ°å°å¯†ç¢¼"</span>wifi <span class="token operator">=</span> network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>wifi<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>wifi<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span>  sensor<span class="token operator">=</span>HCSR04<span class="token punctuation">(</span>trigger_pin<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> echo_pin<span class="token operator">=</span><span class="token number">33</span><span class="token punctuation">,</span> echo\_timeout\_us<span class="token operator">=</span><span class="token number">100000</span><span class="token punctuation">)</span>  <span class="token keyword">while</span> wifi<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token boolean">False</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Connected Successful!"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IP: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>wifi<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> readDist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> dist    dist<span class="token operator">=</span><span class="token builtin">round</span><span class="token punctuation">(</span>sensor<span class="token punctuation">.</span>distance_cm<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The distance is &#123;:.1f&#125; cm"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>dist<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> dist  <span class="token keyword">def</span> htmlPage<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    html<span class="token operator">=</span><span class="token triple-quoted-string string">"""        &lt;html>    &lt;head>      &lt;meta charset="utf-8" />      &lt;meta http-equiv="refresh" content="1" />      &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" />      &lt;style>        h1  &#123;text-align: center; background-color: orange; margin-right:5px;&#125;        dl &#123; width: 320px; margin: 12px auto; &#125;        dt &#123;           font-size: 20pt; color: #444; background-color: #ddd;          margin: 6pt 0; padding: 6pt 12pt;        &#125;        dd &#123;          text-align: right; padding-right: 6pt;        &#125;        .num &#123; font-size: 36pt; color: dodgerblue; &#125;      &lt;/style>      &lt;/head>    &lt;body>      &lt;p>&lt;h1>ESP32 HC-SR04 Distance Test&lt;/h1>&lt;/p>      &lt;dl>        &lt;dt>Distance:&lt;/dt>        &lt;dd class=num>"""</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>dist<span class="token punctuation">)</span><span class="token operator">+</span><span class="token triple-quoted-string string">"""cm&lt;/dd>      &lt;/dl>    &lt;/body>    &lt;/html>    """</span>    <span class="token keyword">return</span> htmls<span class="token operator">=</span>socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Got a connection from %s'</span> <span class="token operator">%</span> <span class="token builtin">str</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">)</span>    req <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Content = %s'</span> <span class="token operator">%</span> <span class="token builtin">str</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">)</span>    DRead <span class="token operator">=</span> readDist<span class="token punctuation">(</span><span class="token punctuation">)</span>    response <span class="token operator">=</span> htmlPage<span class="token punctuation">(</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"http/1.1 200 OK\\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"Content-Type: text/html\\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"Connection: close\\n\\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>response<span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><p><strong>åŒ¯å…¥machine, sockt, network, HC_SR04æ¨¡çµ„</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin <span class="token keyword">from</span> HC_SR04 <span class="token keyword">import</span> HCSR04<span class="token keyword">import</span> socket<span class="token punctuation">,</span> network<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¨­å®šwifié€£ç·š</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">ssid<span class="token operator">=</span><span class="token string">"åŸºåœ°å°åç¨±"</span>password<span class="token operator">=</span><span class="token string">"åŸºåœ°å°å¯†ç¢¼"</span>wifi <span class="token operator">=</span> network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>wifi<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>wifi<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token keyword">while</span> wifi<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token boolean">False</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Connected Successful!"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IP: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>wifi<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¶…éŸ³æ³¢æ¸¬è·</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">sensor<span class="token operator">=</span>HCSR04<span class="token punctuation">(</span>trigger_pin<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> echo_pin<span class="token operator">=</span><span class="token number">33</span><span class="token punctuation">,</span>echo_timeout_us<span class="token operator">=</span><span class="token number">100000</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>è®€å–è·é›¢çš„å‡½å¼</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">def</span> readDist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> dist    dist<span class="token operator">=</span><span class="token builtin">round</span><span class="token punctuation">(</span>sensor<span class="token punctuation">.</span>distance_cm<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The distance is &#123;:.1f&#125; cm"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>dist<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> dist<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å‰ç«¯ç¶²é </strong></p><pre class="line-numbers language-html" data-language="html"><code class="language-html">def htmlPage():    html="""        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>refresh<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">        <span class="token selector">h1</span>  <span class="token punctuation">&#123;</span><span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span> background-color<span class="token punctuation">:</span> orange<span class="token punctuation">;</span> margin-right<span class="token punctuation">:</span>5px<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>        <span class="token selector">dl</span> <span class="token punctuation">&#123;</span> width<span class="token punctuation">:</span> 320px<span class="token punctuation">;</span> margin<span class="token punctuation">:</span> 12px auto<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>        <span class="token selector">dt</span> <span class="token punctuation">&#123;</span>           font-size<span class="token punctuation">:</span> 20pt<span class="token punctuation">;</span> color<span class="token punctuation">:</span> #444<span class="token punctuation">;</span> background-color<span class="token punctuation">:</span> #ddd<span class="token punctuation">;</span>          margin<span class="token punctuation">:</span> 6pt 0<span class="token punctuation">;</span> padding<span class="token punctuation">:</span> 6pt 12pt<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">dd</span> <span class="token punctuation">&#123;</span>          text-align<span class="token punctuation">:</span> right<span class="token punctuation">;</span> padding-right<span class="token punctuation">:</span> 6pt<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.num</span> <span class="token punctuation">&#123;</span> font-size<span class="token punctuation">:</span> 36pt<span class="token punctuation">;</span> color<span class="token punctuation">:</span> dodgerblue<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>      </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>ESP32 HC-SR04 Distance Test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dl</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dt</span><span class="token punctuation">></span></span>Distance:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dt</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dd</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>num</span><span class="token punctuation">></span></span>"""+str(dist)+"""cm<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dd</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dl</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>    """    return html  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>socketå¥—æ¥</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">s<span class="token operator">=</span>socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Got a connection from %s'</span> <span class="token operator">%</span> <span class="token builtin">str</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">)</span>    req <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Content = %s'</span> <span class="token operator">%</span> <span class="token builtin">str</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">)</span>    DRead <span class="token operator">=</span> readDist<span class="token punctuation">(</span><span class="token punctuation">)</span>    response <span class="token operator">=</span> htmlPage<span class="token punctuation">(</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"http/1.1 200 OK\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"Content-Type: text/html\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"Connection: close\n\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>response<span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/10foDr8unxo" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hc-sr04 </tag>
            
            <tag> web server </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¶…éŸ³æ³¢æ¨¡çµ„&amp;0.96OLED-micropython</title>
      <link href="/2021/08/29/chao-yin-bo-mo-zu-0-96oled-micropython/"/>
      <url>/2021/08/29/chao-yin-bo-mo-zu-0-96oled-micropython/</url>
      
        <content type="html"><![CDATA[<h1 id="è¶…éŸ³æ³¢æ¨¡çµ„-amp-0-96OLED-micropython"><a href="#è¶…éŸ³æ³¢æ¨¡çµ„-amp-0-96OLED-micropython" class="headerlink" title="è¶…éŸ³æ³¢æ¨¡çµ„&amp;0.96OLED-micropython"></a>è¶…éŸ³æ³¢æ¨¡çµ„&amp;0.96OLED-micropython</h1><h6 id="tags-micropython-hcsr04-amp-0-96oled-esp32"><a href="#tags-micropython-hcsr04-amp-0-96oled-esp32" class="headerlink" title="tags: micropython hcsr04&amp;0.96oled esp32"></a>tags: <code>micropython</code> <code>hcsr04&amp;0.96oled</code> <code>esp32</code></h6><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/3844235121108768211#"><img src="https://1.bp.blogspot.com/-vUSt95-nd5I/YOqB-78G3uI/AAAAAAAAebY/SOiwses8e8QZD-XSYQsYuJA3B0DTTVAMQCNcBGAsYHQ/w703-h340/MicroPython-Ultrasonic-Sensor-ESP32.jpg"></a></p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€“Â Â Â Â Â  â€”â€”â€”â€”â€”â€”â€”Â Â Â Â Â </p><p>//Â Â *Â |Â HC-SC04Â |Â ESP32 Â |Â Â Â Â Â |  OLED | ESP32 |</p><p>//Â Â *Â â€”â€”â€”â€”â€”â€”â€”Â Â Â Â Â â€”â€”â€”â€”â€”â€”â€”Â Â Â Â Â </p><p>//Â Â *Â |Â Â Â VccÂ Â Â |Â Â Â 3.3VÂ Â |Â Â Â Â Â | Vcc | 3.3V |</p><p>//Â Â *Â |Â Â Â TrigÂ Â |Â Â Â 32Â Â Â Â |Â Â Â  Â | Gnd | GND |</p><p>//Â Â *Â |Â Â Â EchoÂ Â |Â Â Â 33Â Â Â Â |Â Â Â Â Â | SCL | 21 |</p><p>//Â Â *Â |Â Â Â GndÂ Â Â |Â Â Â GNDÂ Â Â |Â Â Â  Â | SDA | 22 |</p><p>//Â Â *Â --------------------- â€”â€”â€”â€”â€”â€”â€”-</p><hr><h2 id="å°‡ssd1306-py-HC-SR04-pyä¸Šå‚³è‡³æ¿å­è£¡"><a href="#å°‡ssd1306-py-HC-SR04-pyä¸Šå‚³è‡³æ¿å­è£¡" class="headerlink" title="å°‡ssd1306.py HC_SR04.pyä¸Šå‚³è‡³æ¿å­è£¡"></a>å°‡ssd1306.py HC_SR04.pyä¸Šå‚³è‡³æ¿å­è£¡</h2><p>**è€ƒé‹‡ä»¥ä¸‹äºŒæª”ä¸¦å­˜æˆpyæª”Â **</p><p><strong>ssd1306.py</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token comment"># MicroPython SSD1306 OLED driver, I2C and SPI interfaces</span><span class="token keyword">from</span> micropython <span class="token keyword">import</span> const<span class="token keyword">import</span> time<span class="token keyword">import</span> framebuf<span class="token keyword">import</span> sys currentBoard<span class="token operator">=</span><span class="token string">""</span><span class="token keyword">if</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>platform<span class="token operator">==</span><span class="token string">"esp8266"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  currentBoard<span class="token operator">=</span><span class="token string">"esp8266"</span><span class="token keyword">elif</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>platform<span class="token operator">==</span><span class="token string">"esp32"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  currentBoard<span class="token operator">=</span><span class="token string">"esp32"</span><span class="token keyword">elif</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>platform<span class="token operator">==</span><span class="token string">"pyboard"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  currentBoard<span class="token operator">=</span><span class="token string">"pyboard"</span>  <span class="token keyword">import</span> pyb<span class="token comment"># register definitions</span>SET_CONTRAST        <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0x81</span><span class="token punctuation">)</span>SET_ENTIRE_ON       <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0xa4</span><span class="token punctuation">)</span>SET_NORM_INV        <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0xa6</span><span class="token punctuation">)</span>SET_DISP            <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0xae</span><span class="token punctuation">)</span>SET_MEM_ADDR        <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">)</span>SET_COL_ADDR        <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0x21</span><span class="token punctuation">)</span>SET_PAGE_ADDR       <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0x22</span><span class="token punctuation">)</span>SET_DISP_START_LINE <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0x40</span><span class="token punctuation">)</span>SET_SEG_REMAP       <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0xa0</span><span class="token punctuation">)</span>SET_MUX_RATIO       <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0xa8</span><span class="token punctuation">)</span>SET_COM_OUT_DIR     <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0xc0</span><span class="token punctuation">)</span>SET_DISP_OFFSET     <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0xd3</span><span class="token punctuation">)</span>SET_COM_PIN_CFG     <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0xda</span><span class="token punctuation">)</span>SET_DISP_CLK_DIV    <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0xd5</span><span class="token punctuation">)</span>SET_PRECHARGE       <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0xd9</span><span class="token punctuation">)</span>SET_VCOM_DESEL      <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0xdb</span><span class="token punctuation">)</span>SET_CHARGE_PUMP     <span class="token operator">=</span> const<span class="token punctuation">(</span><span class="token number">0x8d</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">SSD1306</span><span class="token punctuation">:</span>  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> external_vcc<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>width <span class="token operator">=</span> width    self<span class="token punctuation">.</span>height <span class="token operator">=</span> height    self<span class="token punctuation">.</span>external_vcc <span class="token operator">=</span> external_vcc    self<span class="token punctuation">.</span>pages <span class="token operator">=</span> self<span class="token punctuation">.</span>height <span class="token operator">//</span> <span class="token number">8</span>    self<span class="token punctuation">.</span><span class="token builtin">buffer</span> <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>pages <span class="token operator">*</span> self<span class="token punctuation">.</span>width<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>framebuf <span class="token operator">=</span> framebuf<span class="token punctuation">.</span>FrameBuffer<span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>width<span class="token punctuation">,</span> self<span class="token punctuation">.</span>height<span class="token punctuation">,</span> framebuf<span class="token punctuation">.</span>MVLSB<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>poweron<span class="token punctuation">(</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>init_display<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">init_display</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> cmd <span class="token keyword">in</span> <span class="token punctuation">(</span>      SET_DISP <span class="token operator">|</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token comment"># off</span>      <span class="token comment"># address setting</span>      SET_MEM_ADDR<span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token comment"># horizontal</span>      <span class="token comment"># resolution and layout</span>      SET_DISP_START_LINE <span class="token operator">|</span> <span class="token number">0x00</span><span class="token punctuation">,</span>      SET_SEG_REMAP <span class="token operator">|</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token comment"># column addr 127 mapped to SEG0</span>      SET_MUX_RATIO<span class="token punctuation">,</span> self<span class="token punctuation">.</span>height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>      SET_COM_OUT_DIR <span class="token operator">|</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token comment"># scan from COM[N] to COM0</span>      SET_DISP_OFFSET<span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span>      SET_COM_PIN_CFG<span class="token punctuation">,</span> <span class="token number">0x02</span> <span class="token keyword">if</span> self<span class="token punctuation">.</span>height <span class="token operator">==</span> <span class="token number">32</span> <span class="token keyword">else</span> <span class="token number">0x12</span><span class="token punctuation">,</span>      <span class="token comment"># timing and driving scheme</span>      SET_DISP_CLK_DIV<span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span>      SET_PRECHARGE<span class="token punctuation">,</span> <span class="token number">0x22</span> <span class="token keyword">if</span> self<span class="token punctuation">.</span>external_vcc <span class="token keyword">else</span> <span class="token number">0xf1</span><span class="token punctuation">,</span>      SET_VCOM_DESEL<span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token comment"># 0.83*Vcc</span>      <span class="token comment"># display</span>      SET_CONTRAST<span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token comment"># maximum</span>      SET_ENTIRE_ON<span class="token punctuation">,</span> <span class="token comment"># output follows RAM contents</span>      SET_NORM_INV<span class="token punctuation">,</span> <span class="token comment"># not inverted</span>      <span class="token comment"># charge pump</span>      SET_CHARGE_PUMP<span class="token punctuation">,</span> <span class="token number">0x10</span> <span class="token keyword">if</span> self<span class="token punctuation">.</span>external_vcc <span class="token keyword">else</span> <span class="token number">0x14</span><span class="token punctuation">,</span>      SET_DISP <span class="token operator">|</span> <span class="token number">0x01</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># on</span>      self<span class="token punctuation">.</span>write_cmd<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>fill<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">poweroff</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>write_cmd<span class="token punctuation">(</span>SET_DISP <span class="token operator">|</span> <span class="token number">0x00</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">contrast</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> contrast<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>write_cmd<span class="token punctuation">(</span>SET_CONTRAST<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>write_cmd<span class="token punctuation">(</span>contrast<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">invert</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> invert<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>write_cmd<span class="token punctuation">(</span>SET_NORM_INV <span class="token operator">|</span> <span class="token punctuation">(</span>invert <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    x0 <span class="token operator">=</span> <span class="token number">0</span>    x1 <span class="token operator">=</span> self<span class="token punctuation">.</span>width <span class="token operator">-</span> <span class="token number">1</span>    <span class="token keyword">if</span> self<span class="token punctuation">.</span>width <span class="token operator">==</span> <span class="token number">64</span><span class="token punctuation">:</span>      <span class="token comment"># displays with width of 64 pixels are shifted by 32</span>      x0 <span class="token operator">+=</span> <span class="token number">32</span>      x1 <span class="token operator">+=</span> <span class="token number">32</span>    self<span class="token punctuation">.</span>write_cmd<span class="token punctuation">(</span>SET_COL_ADDR<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>write_cmd<span class="token punctuation">(</span>x0<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>write_cmd<span class="token punctuation">(</span>x1<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>write_cmd<span class="token punctuation">(</span>SET_PAGE_ADDR<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>write_cmd<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>write_cmd<span class="token punctuation">(</span>self<span class="token punctuation">.</span>pages <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>write_data<span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">fill</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>framebuf<span class="token punctuation">.</span>fill<span class="token punctuation">(</span>col<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">pixel</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>framebuf<span class="token punctuation">.</span>pixel<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> col<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">scroll</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dx<span class="token punctuation">,</span> dy<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>framebuf<span class="token punctuation">.</span>scroll<span class="token punctuation">(</span>dx<span class="token punctuation">,</span> dy<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">text</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> string<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>framebuf<span class="token punctuation">.</span>text<span class="token punctuation">(</span>string<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> col<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">hline</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>framebuf<span class="token punctuation">.</span>hline<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> col<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">vline</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> h<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>framebuf<span class="token punctuation">.</span>vline<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> h<span class="token punctuation">,</span> col<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">line</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>framebuf<span class="token punctuation">.</span>line<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2<span class="token punctuation">,</span> col<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">rect</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>framebuf<span class="token punctuation">.</span>rect<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">,</span> col<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">fill_rect</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>framebuf<span class="token punctuation">.</span>fill_rect<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">,</span> col<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">blit</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> fbuf<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>framebuf<span class="token punctuation">.</span>blit<span class="token punctuation">(</span>fbuf<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token keyword">class</span> <span class="token class-name">SSD1306_I2C</span><span class="token punctuation">(</span>SSD1306<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> i2c<span class="token punctuation">,</span> addr<span class="token operator">=</span><span class="token number">0x3c</span><span class="token punctuation">,</span> external_vcc<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>i2c <span class="token operator">=</span> i2c    self<span class="token punctuation">.</span>addr <span class="token operator">=</span> addr    self<span class="token punctuation">.</span>temp <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> external_vcc<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">write_cmd</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cmd<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>temp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x80</span> <span class="token comment"># Co=1, D/C#=0</span>    self<span class="token punctuation">.</span>temp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> cmd    <span class="token comment">#IF SYS  :</span>    <span class="token keyword">global</span> currentBoard    <span class="token keyword">if</span> currentBoard<span class="token operator">==</span><span class="token string">"esp8266"</span> <span class="token keyword">or</span> currentBoard<span class="token operator">==</span><span class="token string">"esp32"</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>i2c<span class="token punctuation">.</span>writeto<span class="token punctuation">(</span>self<span class="token punctuation">.</span>addr<span class="token punctuation">,</span> self<span class="token punctuation">.</span>temp<span class="token punctuation">)</span>    <span class="token keyword">elif</span> currentBoard<span class="token operator">==</span><span class="token string">"pyboard"</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>i2c<span class="token punctuation">.</span>send<span class="token punctuation">(</span>self<span class="token punctuation">.</span>temp<span class="token punctuation">,</span>self<span class="token punctuation">.</span>addr<span class="token punctuation">)</span>    <span class="token comment">#ELSE:</span>            <span class="token keyword">def</span> <span class="token function">write_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>temp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>addr <span class="token operator">&lt;&lt;</span> <span class="token number">1</span>    self<span class="token punctuation">.</span>temp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x40</span> <span class="token comment"># Co=0, D/C#=1</span>    <span class="token keyword">global</span> currentBoard    <span class="token keyword">if</span> currentBoard<span class="token operator">==</span><span class="token string">"esp8266"</span> <span class="token keyword">or</span> currentBoard<span class="token operator">==</span><span class="token string">"esp32"</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>i2c<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>      self<span class="token punctuation">.</span>i2c<span class="token punctuation">.</span>write<span class="token punctuation">(</span>self<span class="token punctuation">.</span>temp<span class="token punctuation">)</span>      self<span class="token punctuation">.</span>i2c<span class="token punctuation">.</span>write<span class="token punctuation">(</span>buf<span class="token punctuation">)</span>      self<span class="token punctuation">.</span>i2c<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> currentBoard<span class="token operator">==</span><span class="token string">"pyboard"</span><span class="token punctuation">:</span>      <span class="token comment">#self.i2c.send(self.temp,self.addr)</span>      <span class="token comment">#self.i2c.send(buf,self.addr)</span>      self<span class="token punctuation">.</span>i2c<span class="token punctuation">.</span>mem_write<span class="token punctuation">(</span>buf<span class="token punctuation">,</span>self<span class="token punctuation">.</span>addr<span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">poweron</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span> <span class="token keyword">class</span> <span class="token class-name">SSD1306_SPI</span><span class="token punctuation">(</span>SSD1306<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> spi<span class="token punctuation">,</span> dc<span class="token punctuation">,</span> res<span class="token punctuation">,</span> cs<span class="token punctuation">,</span> external_vcc<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>rate <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span>    dc<span class="token punctuation">.</span>init<span class="token punctuation">(</span>dc<span class="token punctuation">.</span>OUT<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    res<span class="token punctuation">.</span>init<span class="token punctuation">(</span>res<span class="token punctuation">.</span>OUT<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    cs<span class="token punctuation">.</span>init<span class="token punctuation">(</span>cs<span class="token punctuation">.</span>OUT<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>spi <span class="token operator">=</span> spi    self<span class="token punctuation">.</span>dc <span class="token operator">=</span> dc    self<span class="token punctuation">.</span>res <span class="token operator">=</span> res    self<span class="token punctuation">.</span>cs <span class="token operator">=</span> cs    <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> external_vcc<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">write_cmd</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cmd<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> currentBoard    <span class="token keyword">if</span> currentBoard<span class="token operator">==</span><span class="token string">"esp8266"</span> <span class="token keyword">or</span> currentBoard<span class="token operator">==</span><span class="token string">"esp32"</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>spi<span class="token punctuation">.</span>init<span class="token punctuation">(</span>baudrate<span class="token operator">=</span>self<span class="token punctuation">.</span>rate<span class="token punctuation">,</span> polarity<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> phase<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> currentBoard<span class="token operator">==</span><span class="token string">"pyboard"</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>spi<span class="token punctuation">.</span>init<span class="token punctuation">(</span>mode <span class="token operator">=</span> pyb<span class="token punctuation">.</span>SPI<span class="token punctuation">.</span>MASTER<span class="token punctuation">,</span>baudrate<span class="token operator">=</span>self<span class="token punctuation">.</span>rate<span class="token punctuation">,</span> polarity<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> phase<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>cs<span class="token punctuation">.</span>high<span class="token punctuation">(</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dc<span class="token punctuation">.</span>low<span class="token punctuation">(</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>cs<span class="token punctuation">.</span>low<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">global</span> currentBoard    <span class="token keyword">if</span> currentBoard<span class="token operator">==</span><span class="token string">"esp8266"</span> <span class="token keyword">or</span> currentBoard<span class="token operator">==</span><span class="token string">"esp32"</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>spi<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> currentBoard<span class="token operator">==</span><span class="token string">"pyboard"</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>spi<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>cs<span class="token punctuation">.</span>high<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">write_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> currentBoard    <span class="token keyword">if</span> currentBoard<span class="token operator">==</span><span class="token string">"esp8266"</span> <span class="token keyword">or</span> currentBoard<span class="token operator">==</span><span class="token string">"esp32"</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>spi<span class="token punctuation">.</span>init<span class="token punctuation">(</span>baudrate<span class="token operator">=</span>self<span class="token punctuation">.</span>rate<span class="token punctuation">,</span> polarity<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> phase<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> currentBoard<span class="token operator">==</span><span class="token string">"pyboard"</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>spi<span class="token punctuation">.</span>init<span class="token punctuation">(</span>mode <span class="token operator">=</span> pyb<span class="token punctuation">.</span>SPI<span class="token punctuation">.</span>MASTER<span class="token punctuation">,</span>baudrate<span class="token operator">=</span>self<span class="token punctuation">.</span>rate<span class="token punctuation">,</span> polarity<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> phase<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>cs<span class="token punctuation">.</span>high<span class="token punctuation">(</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>dc<span class="token punctuation">.</span>high<span class="token punctuation">(</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>cs<span class="token punctuation">.</span>low<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">global</span> currentBoard    <span class="token keyword">if</span> currentBoard<span class="token operator">==</span><span class="token string">"esp8266"</span> <span class="token keyword">or</span> currentBoard<span class="token operator">==</span><span class="token string">"esp32"</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>spi<span class="token punctuation">.</span>write<span class="token punctuation">(</span>buf<span class="token punctuation">)</span>    <span class="token keyword">elif</span> currentBoard<span class="token operator">==</span><span class="token string">"pyboard"</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>spi<span class="token punctuation">.</span>send<span class="token punctuation">(</span>buf<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>cs<span class="token punctuation">.</span>high<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">poweron</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>res<span class="token punctuation">.</span>high<span class="token punctuation">(</span><span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep_ms<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>res<span class="token punctuation">.</span>low<span class="token punctuation">(</span><span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep_ms<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>res<span class="token punctuation">.</span>high<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="HC-SR04-py"><a href="#HC-SR04-py" class="headerlink" title="HC_SR04.py"></a>HC_SR04.py</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">import</span> machine<span class="token punctuation">,</span> time<span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin <span class="token keyword">class</span> <span class="token class-name">HCSR04</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Driver to use the untrasonic sensor HC-SR04.    The sensor range is between 2cm and 4m.    The timeouts received listening to echo pin are converted to OSError('Out of range')    """</span>    <span class="token comment"># echo_timeout_us is based in chip range limit (400cm)</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> trigger_pin<span class="token punctuation">,</span> echo_pin<span class="token punctuation">,</span> echo_timeout_us<span class="token operator">=</span><span class="token number">500</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">*</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        trigger_pin: Output pin to send pulses        echo_pin: Readonly pin to measure the distance. The pin should be protected with 1k resistor        echo_timeout_us: Timeout in microseconds to listen to echo pin.         By default is based in sensor limit range (4m)        """</span>        self<span class="token punctuation">.</span>echo_timeout_us <span class="token operator">=</span> echo_timeout_us        <span class="token comment"># Init trigger pin (out)</span>        self<span class="token punctuation">.</span>trigger <span class="token operator">=</span> Pin<span class="token punctuation">(</span>trigger_pin<span class="token punctuation">,</span> mode<span class="token operator">=</span>Pin<span class="token punctuation">.</span>OUT<span class="token punctuation">,</span> pull<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>trigger<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>         <span class="token comment"># Init echo pin (in)</span>        self<span class="token punctuation">.</span>echo <span class="token operator">=</span> Pin<span class="token punctuation">(</span>echo_pin<span class="token punctuation">,</span> mode<span class="token operator">=</span>Pin<span class="token punctuation">.</span>IN<span class="token punctuation">,</span> pull<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>     <span class="token keyword">def</span> <span class="token function">_send_pulse_and_wait</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        Send the pulse to trigger and listen on echo pin.        We use the method `machine.time_pulse_us()` to get the microseconds until the echo is received.        """</span>        self<span class="token punctuation">.</span>trigger<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># Stabilize the sensor</span>        time<span class="token punctuation">.</span>sleep_us<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>trigger<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment"># Send a 10us pulse.</span>        time<span class="token punctuation">.</span>sleep_us<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>trigger<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            pulse_time <span class="token operator">=</span> machine<span class="token punctuation">.</span>time_pulse_us<span class="token punctuation">(</span>self<span class="token punctuation">.</span>echo<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>echo_timeout_us<span class="token punctuation">)</span>            <span class="token keyword">return</span> pulse_time        <span class="token keyword">except</span> OSError <span class="token keyword">as</span> ex<span class="token punctuation">:</span>            <span class="token keyword">if</span> ex<span class="token punctuation">.</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">110</span><span class="token punctuation">:</span> <span class="token comment"># 110 = ETIMEDOUT</span>                <span class="token keyword">raise</span> OSError<span class="token punctuation">(</span><span class="token string">'Out of range'</span><span class="token punctuation">)</span>            <span class="token keyword">raise</span> ex     <span class="token keyword">def</span> <span class="token function">distance_mm</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        Get the distance in milimeters without floating point operations.        """</span>        pulse_time <span class="token operator">=</span> self<span class="token punctuation">.</span>_send_pulse_and_wait<span class="token punctuation">(</span><span class="token punctuation">)</span>         <span class="token comment"># To calculate the distance we get the pulse_time and divide it by 2 </span>        <span class="token comment"># (the pulse walk the distance twice) and by 29.1 becasue</span>        <span class="token comment"># the sound speed on air (343.2 m/s), that It's equivalent to</span>        <span class="token comment"># 0.34320 mm/us that is 1mm each 2.91us</span>        <span class="token comment"># pulse_time // 2 // 2.91 -> pulse_time // 5.82 -> pulse_time * 100 // 582 </span>        mm <span class="token operator">=</span> pulse_time <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">//</span> <span class="token number">582</span>        <span class="token keyword">return</span> mm     <span class="token keyword">def</span> <span class="token function">distance_cm</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        Get the distance in centimeters with floating point operations.        It returns a float        """</span>        pulse_time <span class="token operator">=</span> self<span class="token punctuation">.</span>_send_pulse_and_wait<span class="token punctuation">(</span><span class="token punctuation">)</span>         <span class="token comment"># To calculate the distance we get the pulse_time and divide it by 2 </span>        <span class="token comment"># (the pulse walk the distance twice) and by 29.1 becasue</span>        <span class="token comment"># the sound speed on air (343.2 m/s), that It's equivalent to</span>        <span class="token comment"># 0.034320 cm/us that is 1cm each 29.1us</span>        cms <span class="token operator">=</span> <span class="token punctuation">(</span>pulse_time <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">29.1</span>        <span class="token keyword">return</span> cms<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><p><strong>main.py</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">import</span> ssd1306 <span class="token comment">#åŒ¯å…¥oledæ¨¡çµ„</span><span class="token keyword">from</span> machine <span class="token keyword">import</span> I2C<span class="token punctuation">,</span> Pin <span class="token comment">#åŒ¯å…¥i2cç›¸é—œæ¨¡çµ„å’Œè…³ä½æ¨¡çµ„</span><span class="token keyword">from</span> HC_SR04 <span class="token keyword">import</span> HCSR04i2c<span class="token operator">=</span>I2C<span class="token punctuation">(</span>scl<span class="token operator">=</span>Pin<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sda<span class="token operator">=</span>Pin<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span>oled<span class="token operator">=</span>ssd1306<span class="token punctuation">.</span>SSD1306_I2C<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> i2c<span class="token punctuation">)</span>sensor<span class="token operator">=</span>HCSR04<span class="token punctuation">(</span>trigger_pin<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> echo_pin<span class="token operator">=</span><span class="token number">33</span><span class="token punctuation">,</span>echo_timeout_us<span class="token operator">=</span><span class="token number">100000</span><span class="token punctuation">)</span>  <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    dist<span class="token operator">=</span>sensor<span class="token punctuation">.</span>distance_cm<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The distance is &#123;:.1f&#125; cm"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>dist<span class="token punctuation">)</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>fill<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">"Distance: "</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>dist<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">"cm"</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>    oled<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><p><strong>åŒ¯å…¥OLED, I2C, HC_SR04æ¨¡çµ„</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">import</span> ssd1306 <span class="token comment">#åŒ¯å…¥oledæ¨¡çµ„</span><span class="token keyword">from</span> machine <span class="token keyword">import</span> I2C<span class="token punctuation">,</span> Pin <span class="token comment">#åŒ¯å…¥i2cç›¸é—œæ¨¡çµ„å’Œè…³ä½æ¨¡çµ„</span><span class="token keyword">from</span> HC_SR04 <span class="token keyword">import</span> HCSR04<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>i2cé€šè¨­å®š</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">i2c<span class="token operator">=</span>I2C<span class="token punctuation">(</span>scl<span class="token operator">=</span>Pin<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sda<span class="token operator">=</span>Pin<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>OLEDé¡¯ç¤º</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">oled<span class="token operator">=</span>ssd1306<span class="token punctuation">.</span>SSD1306_I2C<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> i2c<span class="token punctuation">)</span>oled<span class="token punctuation">.</span>fill<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">"Distance: "</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>dist<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>oled<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">"cm"</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>oled<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¶…éŸ³æ³¢æ¸¬è·</strong></p><p><strong>ä½¿ç”¨while True: å½¢æˆè¿´åœˆ</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">sensor<span class="token operator">=</span>HCSR04<span class="token punctuation">(</span>trigger_pin<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> echo_pin<span class="token operator">=</span><span class="token number">33</span><span class="token punctuation">,</span>echo_timeout_us<span class="token operator">=</span><span class="token number">100000</span><span class="token punctuation">)</span>dist<span class="token operator">=</span>sensor<span class="token punctuation">.</span>distance_cm<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><hr><div class="video-container"><iframe src="https://www.youtube.com/embed/IkzFiOHADV0" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hc-sr04 </tag>
            
            <tag> è¶…éŸ³æ³¢æ¨¡çµ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¶…éŸ³æ³¢æ¸¬è·(HC-SR04)&amp;ç¶²é é¡¯ç¤º(wifi_server)</title>
      <link href="/2021/08/29/chao-yin-bo-ce-ju-hc-sr04-wang-ye-xian-shi-wifi-server/"/>
      <url>/2021/08/29/chao-yin-bo-ce-ju-hc-sr04-wang-ye-xian-shi-wifi-server/</url>
      
        <content type="html"><![CDATA[<h1 id="è¶…éŸ³æ³¢æ¸¬è·-HC-SR04-amp-ç¶²é é¡¯ç¤º-wifi-server"><a href="#è¶…éŸ³æ³¢æ¸¬è·-HC-SR04-amp-ç¶²é é¡¯ç¤º-wifi-server" class="headerlink" title="è¶…éŸ³æ³¢æ¸¬è·(HC-SR04)&amp;ç¶²é é¡¯ç¤º(wifi_server)"></a>è¶…éŸ³æ³¢æ¸¬è·(HC-SR04)&amp;ç¶²é é¡¯ç¤º(wifi_server)</h1><h6 id="tags-micropython-HC-SR04-amp-wifi"><a href="#tags-micropython-HC-SR04-amp-wifi" class="headerlink" title="tags: micropython HC-SR04&amp;wifi"></a>tags: <code>micropython</code> <code>HC-SR04&amp;wifi</code></h6><p>Â <strong>è¶…éŸ³æ³¢æ¸¬è·åƒè€ƒ-</strong><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7733761810113940833?hl=zh-TW#">https://esp32-blairan.blogspot.com/2021/07/blog-post.html</a></p><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7733761810113940833?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-7dHBsjW47XU/YQtG3H38s_I/AAAAAAAAeoE/8OowIoEHa7g1BMcbMxiBIOMDO7f2dHopACNcBGAsYHQ/w367-h461/image.png"></a></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;Arduino.h&gt;#include &lt;WiFi.h&gt;#include &lt;ESPAsyncWebServer.h&gt;#include &lt;Ultrasonic.h&gt;  &#x2F;&#x2F;Â ---------------------Â Â Â Â Â ---------------------Â Â Â Â Â -------------------&#x2F;&#x2F;Â Â *Â |Â HC-SC04Â |Â ArduinoÂ |Â Â Â Â Â |Â PING)))Â |Â ArduinoÂ |Â Â Â Â Â |Â SeeedÂ |Â ArduinoÂ |&#x2F;&#x2F;Â Â *Â ---------------------Â Â Â Â Â ---------------------Â Â Â Â Â -------------------&#x2F;&#x2F;Â Â *Â |Â Â Â VccÂ Â Â |Â Â Â 5VÂ Â Â Â |Â Â Â Â Â |Â Â Â VccÂ Â Â |Â Â Â 5VÂ Â Â Â |Â Â Â Â Â |Â Â VccÂ Â |Â Â Â 5VÂ Â Â Â |&#x2F;&#x2F;Â Â *Â |Â Â Â TrigÂ Â |Â Â Â 12Â Â Â Â |Â ANDÂ |Â Â Â SIGÂ Â Â |Â Â Â 10Â Â Â Â |Â ANDÂ |Â Â SIGÂ Â |Â Â Â Â 8Â Â Â Â |&#x2F;&#x2F;Â Â *Â |Â Â Â EchoÂ Â |Â Â Â 13Â Â Â Â |Â Â Â Â Â |Â Â Â GndÂ Â Â |Â Â Â GNDÂ Â Â |Â Â Â Â Â |Â Â GndÂ Â |Â Â Â GNDÂ Â Â |&#x2F;&#x2F;Â Â *Â |Â Â Â GndÂ Â Â |Â Â Â GNDÂ Â Â |Â Â Â Â Â ---------------------Â Â Â Â Â -------------------&#x2F;&#x2F;Â Â *Â ---------------------  constÂ char*Â ssid&#x3D;&quot;åŸºåœ°å°åç¨±&quot;;constÂ char*Â password&#x3D;&quot;åŸºåœ°å°å¯†ç¢¼&quot;;AsyncWebServerÂ server(80);UltrasonicÂ ultrasonic1(32,Â 33);Â &#x2F;&#x2F;ultrasonic(trig,Â echo)  constÂ charÂ indexHtml[]Â PROGMEMÂ &#x3D;Â R&quot;&#x3D;&#x3D;&#x3D;(Â Â Â Â &lt;html&gt;&lt;head&gt;Â Â Â Â &lt;metaÂ charset&#x3D;&quot;utf-8&quot;Â &#x2F;&gt;Â Â Â Â &lt;metaÂ http-equiv&#x3D;&quot;refresh&quot;Â content&#x3D;&quot;0.5&quot;Â &#x2F;&gt;Â Â Â Â &lt;metaÂ name&#x3D;&quot;viewport&quot;Â content&#x3D;&quot;width&#x3D;device-width,Â initial-scale&#x3D;1.0&quot;Â &#x2F;&gt;Â Â Â Â &lt;style&gt;Â Â Â Â Â Â Â Â h1Â &#123;text-align:Â center;Â background-color:Â rgb(226,Â 155,Â 23);Â color:Â rgb(47,Â 49,Â 42);Â margin-right:Â 5px;&#125;Â Â Â Â Â Â Â Â dlÂ &#123;width:Â 320px;Â margin:Â auto;&#125;Â Â Â Â Â Â Â Â dtÂ &#123;font-size:Â 20pt;Â color:Â rgb(36,Â 45,Â 168);Â background-color:Â rgb(197,Â 194,Â 11);Â Â Â Â Â Â Â Â Â Â Â Â margin:Â 6ptÂ 0;Â padding:Â 6ptÂ 12pt;&#125;Â Â Â Â Â Â Â Â ddÂ &#123;text-align:Â left;Â padding-right:Â 6pt;&#125;Â Â Â Â Â Â Â Â .valÂ &#123;Â font-size:Â 30pt;Â color:Â rgb(255,Â 120,Â 30);Â &#125;Â Â Â Â &lt;&#x2F;style&gt;&lt;&#x2F;head&gt;&lt;body&gt;Â Â Â Â &lt;p&gt;&lt;h1&gt;HC-SR04è¶…éŸ³æ³¢æ¸¬è·å¯¦é©—&lt;&#x2F;h1&gt;&lt;&#x2F;p&gt;Â Â Â Â &lt;dl&gt;Â Â Â Â Â Â Â Â &lt;dt&gt;åµæ¸¬ç‰©é«”è·é›¢&lt;&#x2F;dt&gt;Â Â Â Â Â Â Â Â &lt;ddÂ class&#x3D;val&gt;%distance%Â å…¬åˆ†&lt;&#x2F;dd&gt;Â Â Â Â &lt;&#x2F;dl&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;)&#x3D;&#x3D;&#x3D;&quot;;  StringÂ readDist()&#123;Â Â Â Â unsignedÂ intÂ distance&#x3D;ultrasonic1.read(CM);Â Â Â Â Serial.print(distance);Â Serial.println(&quot;Â CM&quot;);Â Â Â Â returnÂ String(distance);&#125;StringÂ hcsr04Processors(String(value))&#123;Â Â Â Â ifÂ (value&#x3D;&#x3D;&quot;distance&quot;)&#123;Â Â Â Â Â Â Â Â returnÂ readDist();Â Â Â Â &#125;&#125;  voidÂ setup()&#123;Â Â Â Â Serial.begin(115200);Â Â Â Â WiFi.begin(ssid,Â password);Â Â Â Â whileÂ (WiFi.status()Â !&#x3D;Â WL_CONNECTED)&#123;Â Â Â Â Â Â Â Â Serial.print(&quot;.&quot;);Â Â Â Â Â Â Â Â delay(500);Â Â Â Â &#125;Â Â Â Â Serial.println(&quot;ConnectedÂ successful!&quot;);Â Â Â Â Serial.print(&quot;IP:Â &quot;);Â Serial.println(WiFi.localIP());Â Â Â Â server.on(&quot;&#x2F;&quot;,Â HTTP_GET,Â [](AsyncWebServerRequestÂ *request)&#123;Â Â Â Â Â Â Â Â request-&gt;send_P(200,Â &quot;text&#x2F;html&quot;,Â indexHtml,Â hcsr04Processors);Â Â Â Â &#125;);Â Â Â Â server.on(&quot;&#x2F;distance&quot;,Â HTTP_GET,Â [](AsyncWebServerRequestÂ *request)&#123;Â Â Â Â Â Â Â Â request-&gt;send_P(200,Â &quot;text&#x2F;plain&quot;,Â readDist().c_str());Â Â Â Â &#125;);Â Â Â Â server.begin();&#125;  voidÂ loop()&#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è§£èªª"><a href="#è§£èªª" class="headerlink" title="è§£èªª"></a>è§£èªª</h2><p><em><strong>åŒ¯å…¥WiFiå’Œè¶…éŸ³æ³¢åŠç¶²è·¯ä¼ºæœå™¨æ¨¡çµ„</strong></em></p><pre class="line-numbers language-none"><code class="language-none">#include &lt;WiFi.h&gt;#include &lt;ESPAsyncWebServer.h&gt;#include &lt;Ultrasonic.h&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>å®šç¾©åŸºåœ°å°åç¨±å’Œå¯†ç¢¼,ä¸¦æŒ‡å®šç«¯å£è™Ÿ80åŸ </em></strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">const char* ssidÂ &#x3D;Â &quot;åŸºåœ°å°åç¨±&quot;;const char* passwordÂ &#x3D; &quot;åŸºåœ°å°å¯†ç¢¼&quot;;AsyncWebServer server(80);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>é€™å€‹æ¨¡çµ„æ˜¯å‘¼å¸è¶…éŸ³æ³¢ç”¨çš„</em></strong></p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Ultrasonic.h></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong><em>è¨­åˆ¶è¶…éŸ³æ³¢è…³ä½</em></strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Ultrasonic ultrasonic1(32,Â 33);Â &#x2F;&#x2F;ultrasonic(trig,Â echo)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong><em>å‰ç«¯ç¶²é </em></strong></p><p>é€™ä¸€è¡Œæ˜¯æ¯éš”0.5ç§’è‡ªå‹•æ›´æ–°ä¸€æ¬¡ç¶²é Â <metaÂ http-equiv="refresh"Â content="0.5"Â /></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">constÂ charÂ indexHtml[]Â PROGMEMÂ &#x3D;Â R&quot;&#x3D;&#x3D;&#x3D;(Â Â Â Â &lt;html&gt;&lt;head&gt;Â Â Â Â &lt;metaÂ charset&#x3D;&quot;utf-8&quot;Â &#x2F;&gt;Â Â Â Â &lt;metaÂ http-equiv&#x3D;&quot;refresh&quot;Â content&#x3D;&quot;0.5&quot;Â &#x2F;&gt;Â Â Â Â &lt;metaÂ name&#x3D;&quot;viewport&quot;Â content&#x3D;&quot;width&#x3D;device-width,Â initial-scale&#x3D;1.0&quot;Â &#x2F;&gt;Â Â Â Â &lt;style&gt;Â Â Â Â Â Â Â Â h1Â &#123;text-align:Â center;Â background-color:Â rgb(226,Â 155,Â 23);Â color:Â rgb(47,Â 49,Â 42);Â margin-right:Â 5px;&#125;Â Â Â Â Â Â Â Â dlÂ &#123;width:Â 320px;Â margin:Â auto;&#125;Â Â Â Â Â Â Â Â dtÂ &#123;font-size:Â 20pt;Â color:Â rgb(36,Â 45,Â 168);Â background-color:Â rgb(197,Â 194,Â 11);Â Â Â Â Â Â Â Â Â Â Â Â margin:Â 6ptÂ 0;Â padding:Â 6ptÂ 12pt;&#125;Â Â Â Â Â Â Â Â ddÂ &#123;text-align:Â left;Â padding-right:Â 6pt;&#125;Â Â Â Â Â Â Â Â .valÂ &#123;Â font-size:Â 30pt;Â color:Â rgb(255,Â 120,Â 30);Â &#125;Â Â Â Â &lt;&#x2F;style&gt;&lt;&#x2F;head&gt;&lt;body&gt;Â Â Â Â &lt;p&gt;&lt;h1&gt;HC-SR04è¶…éŸ³æ³¢æ¸¬è·å¯¦é©—&lt;&#x2F;h1&gt;&lt;&#x2F;p&gt;Â Â Â Â &lt;dl&gt;Â Â Â Â Â Â Â Â &lt;dt&gt;åµæ¸¬ç‰©é«”è·é›¢&lt;&#x2F;dt&gt;Â Â Â Â Â Â Â Â &lt;ddÂ class&#x3D;val&gt;%distance%Â å…¬åˆ†&lt;&#x2F;dd&gt;Â Â Â Â &lt;&#x2F;dl&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;)&#x3D;&#x3D;&#x3D;&quot;;  _**è®€å–æ•¸å€¼å’Œå‰ç«¯åŒæ­¥æ•¸å€¼çš„å‡½å¼**_String readDist()&#123; unsignedÂ int distance&#x3D;ultrasonic1.read(CM); Serial.print(distance); Serial.println(&quot;Â CM&quot;); return String(distance);&#125;String hcsr04Processors(String(value))&#123; ifÂ (value&#x3D;&#x3D;&quot;distance&quot;)&#123; return readDist();Â Â Â Â &#125;&#125;  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>ç¶²è·¯é€£ç·š</em></strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">voidÂ setup()&#123;Â Â Â Â Serial.begin(115200);Â Â Â Â WiFi.begin(ssid,Â password);Â Â Â Â whileÂ (WiFi.status()Â !&#x3D;Â WL_CONNECTED)&#123;Â Â Â Â Â Â Â Â Serial.print(&quot;.&quot;);Â Â Â Â Â Â Â Â delay(500);Â Â Â Â &#125;Â Â Â Â Serial.println(&quot;ConnectedÂ successful!&quot;);Â Â Â Â Serial.print(&quot;IP:Â &quot;);Â Serial.println(WiFi.localIP());<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¶²è·¯ä¼ºæœå™¨çš„è«‹æ±‚å’Œå›æ‡‰</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#"> server.on(&quot;&#x2F;&quot;,Â HTTP_GET,Â [](AsyncWebServerRequestÂ *request)&#123;Â Â Â Â Â Â Â Â request-&gt;send_P(200,Â &quot;text&#x2F;html&quot;,Â indexHtml,Â hcsr04Processors);Â Â Â Â &#125;);Â Â Â Â server.on(&quot;&#x2F;distance&quot;,Â HTTP_GET,Â [](AsyncWebServerRequestÂ *request)&#123;Â Â Â Â Â Â Â Â request-&gt;send_P(200,Â &quot;text&#x2F;plain&quot;,Â readDist().c_str());Â Â Â Â &#125;);Â Â Â Â server.begin();&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/ammBs4Z-DTs" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hc-sr04 </tag>
            
            <tag> web server </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0.96OLEDå¯¦ä½œ-micropython</title>
      <link href="/2021/08/29/0-96oled-shi-zuo-micropython/"/>
      <url>/2021/08/29/0-96oled-shi-zuo-micropython/</url>
      
        <content type="html"><![CDATA[<h1 id="0-96OLEDå¯¦ä½œ-micropython"><a href="#0-96OLEDå¯¦ä½œ-micropython" class="headerlink" title="0.96OLEDå¯¦ä½œ-micropython"></a>0.96OLEDå¯¦ä½œ-micropython</h1><h6 id="tags-micropython-0-96oled"><a href="#tags-micropython-0-96oled" class="headerlink" title="tags: micropython 0.96oled"></a>tags: <code>micropython</code> <code>0.96oled</code></h6><h2 id="ssd1306æ¨¡çµ„"><a href="#ssd1306æ¨¡çµ„" class="headerlink" title="ssd1306æ¨¡çµ„"></a>ssd1306æ¨¡çµ„</h2><p><strong>å…ˆå°‡<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2255135354625309493?hl=zh-TW#">ssd1306.py</a>æª”å’Œmain.pyæ”¾åœ¨ä¸€èµ·æ‰èƒ½å‘¼å«åˆ°ssd1306æ¨¡çµ„</strong></p><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><strong>21Â  SCL</strong></p><p><strong>22Â  SDA</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2255135354625309493?hl=zh-TW#"><img src="https://i2.wp.com/randomnerdtutorials.com/wp-content/uploads/2019/05/ESP32_OLED.png?w=873&quality=100&strip=all&ssl=1"></a></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-py" data-language="py"><code class="language-py">importÂ ssd1306Â #åŒ¯å…¥oledæ¨¡çµ„fromÂ machineÂ importÂ Pin,Â SoftI2CÂ #åŒ¯å…¥i2cç›¸é—œæ¨¡çµ„å’Œè…³ä½æ¨¡çµ„  i2c&#x3D;SoftI2C(scl&#x3D;Pin(22),Â sda&#x3D;Pin(21))Â #è¨­å®ši2cè…³ä½width&#x3D;128Â #oledé«˜height&#x3D;64Â #oledå¯›oled&#x3D;ssd1306.SSD1306_I2C(width,Â height,Â i2c)Â #è³¦äºˆè®Šæ•¸çµ¦è¨­åˆ¶å¥½çš„ssd1306æ¨¡çµ„,ä¸¦çµ¦äºˆæ‰€é ˆåƒæ•¸  #oled.text(&quot;æ–‡å­—&quot;,Â x,Â y,Â col&#x3D;0&#x2F;1)#xæ˜¯ç¸±è»¸ä½ç½®#yæ˜¯æ©«è»¸ä½ç½®#col&#x3D;æ˜¯é¡è‰²,0-BLACK,1-WHITEoled.text(&quot;HelloÂ world!&quot;,Â 0,Â 0,Â col&#x3D;1)oled.text(&quot;ESP32Â NICE!&quot;,Â 0,Â 10,Â col&#x3D;1)oled.text(&quot;iÂ amÂ CTK&quot;,Â 0,Â 30,Â col&#x3D;1)#oled.invert(True)Â #èƒŒæ™¯å…¨é¡¯oled.show()Â #é¡¯ç¤ºæ–¼oledä¸Š<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2255135354625309493?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-k9n260VQuDA/YOexfePzh5I/AAAAAAAAeag/Fu7ZGxbHb9s63zR5_q-D06nDEPyzIWOHgCNcBGAsYHQ/s1600/1625796956591112-0.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> oled </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DHT11/DHT12æº«æº¼åº¦å‚³æ„Ÿå™¨å¯¦é©—-micropython</title>
      <link href="/2021/08/29/dht11-dht12-wen-shi-du-chuan-gan-qi-shi-yan-micropython/"/>
      <url>/2021/08/29/dht11-dht12-wen-shi-du-chuan-gan-qi-shi-yan-micropython/</url>
      
        <content type="html"><![CDATA[<h1 id="DHT11-DHT12æº«æº¼åº¦å‚³æ„Ÿå™¨å¯¦é©—-micropython"><a href="#DHT11-DHT12æº«æº¼åº¦å‚³æ„Ÿå™¨å¯¦é©—-micropython" class="headerlink" title="DHT11/DHT12æº«æº¼åº¦å‚³æ„Ÿå™¨å¯¦é©—-micropython"></a>DHT11/DHT12æº«æº¼åº¦å‚³æ„Ÿå™¨å¯¦é©—-micropython</h1><h6 id="tags-micropython-dht11-dht12"><a href="#tags-micropython-dht11-dht12" class="headerlink" title="tags: micropython dht11/dht12"></a>tags: <code>micropython</code> <code>dht11/dht12</code></h6><p><strong>åŸºæœ¬ä»‹ç´¹å’Œå¯¦é©—åƒè€ƒ-</strong><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2565290853340818706?hl=zh-TW#">https://esp32-blairan.blogspot.com/2021/07/dht11dht12-esp32.html</a></p><hr><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/2565290853340818706?hl=zh-TW#"><img src="http://2.bp.blogspot.com/-3syBdItbhrI/Vb6X8sJx7tI/AAAAAAAAEO8/cMmlSOV142M/s320/dht11.jpg"></a></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">import</span> dht<span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">def</span> measureTemp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    sensor<span class="token operator">=</span>dht<span class="token punctuation">.</span>DHT11<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>            sensor<span class="token punctuation">.</span>measure<span class="token punctuation">(</span><span class="token punctuation">)</span>            t<span class="token operator">=</span>sensor<span class="token punctuation">.</span>temperature<span class="token punctuation">(</span><span class="token punctuation">)</span>            t_f<span class="token operator">=</span>t<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">32</span>            h<span class="token operator">=</span>sensor<span class="token punctuation">.</span>humidity<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Temp: &#123;:.1f&#125;.C"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Temp: &#123;:.1f&#125;.F"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>t_f<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Humidity: &#123;:.1f&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> OSError <span class="token keyword">as</span> o<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Failed to read sensor."</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    measureTemp<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¼‰å…¥dhtåº«(å…§å»º)</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">import</span> dht<span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æŒ‡å®šDHT11è…³ä½çµ¦sensorè®Šæ•¸</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">sensor<span class="token operator">=</span>dht<span class="token punctuation">.</span>DHT11<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>çµ¦äºˆwhile()æ¯2ç§’ä¸æ–·åµæ¸¬</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>sensor<span class="token punctuation">.</span>measure<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>æ”æ°æº«åº¦(t)/è¯æ°æº«åº¦(t_f)/æ¿•åº¦</strong></p><p><strong>å…¶ä¸­æ”æ°è½‰æ›è¯æ°çš„å…¬å¼:æ”æ°x(9/5)+32</strong></p><pre class="line-numbers language-py" data-language="py"><code class="language-py">t<span class="token operator">=</span>sensor<span class="token punctuation">.</span>temperature<span class="token punctuation">(</span><span class="token punctuation">)</span>t_f<span class="token operator">=</span>t<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">32</span>h<span class="token operator">=</span>sensor<span class="token punctuation">.</span>humidity<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Temp: &#123;:.1f&#125;.C"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Temp: &#123;:.1f&#125;.F"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>t_f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Humidity: &#123;:.1f&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="çµæœ"><a href="#çµæœ" class="headerlink" title="çµæœ"></a>çµæœ</h2><pre class="line-numbers language-none"><code class="language-none">&#x3D;&#x3D;&#x3D;Â Temp:Â 26.0.CTemp:Â 78.8.FHumidity:Â 27.0Temp:Â 26.0.CTemp:Â 78.8.FHumidity:Â 27.0Temp:Â 26.0.CTemp:Â 78.8.FHumidity:Â 27.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dht11/dht12 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWM-å‘¼å¸ç‡ˆ-mpython</title>
      <link href="/2021/08/29/pwm-hu-xi-deng-mpython/"/>
      <url>/2021/08/29/pwm-hu-xi-deng-mpython/</url>
      
        <content type="html"><![CDATA[<h1 id="PWM-å‘¼å¸ç‡ˆ-mpython"><a href="#PWM-å‘¼å¸ç‡ˆ-mpython" class="headerlink" title="PWM-å‘¼å¸ç‡ˆ-mpython"></a>PWM-å‘¼å¸ç‡ˆ-mpython</h1><h6 id="tags-micropython"><a href="#tags-micropython" class="headerlink" title="tags: micropython"></a>tags: <code>micropython</code></h6><h2 id="æ‰€éœ€é›¶ä»¶"><a href="#æ‰€éœ€é›¶ä»¶" class="headerlink" title="æ‰€éœ€é›¶ä»¶"></a>æ‰€éœ€é›¶ä»¶</h2><ul><li>  ESP32</li><li>  5mm LED</li><li>  330 æ­å§†é›»é˜»</li><li>  éºµåŒ…æ¿</li><li>  è·³ç·š</li></ul><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/7086602446312056740?hl=zh-TW#"><img src="https://i1.wp.com/randomnerdtutorials.com/wp-content/uploads/2019/04/PWM_esp32_bb.png?w=1065&quality=100&strip=all&ssl=1"></a></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><p><strong><em>åƒç…§â€“æˆ‘çš„</em></strong><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/7086602446312056740?hl=zh-TW#">micropythonå‡½å¼ç­†è¨˜æœ¬</a></p><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token punctuation">,</span> PWM<span class="token keyword">from</span> time <span class="token keyword">import</span> sleepled <span class="token operator">=</span> PWM<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> duty_cycle1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        led<span class="token punctuation">.</span>duty<span class="token punctuation">(</span>duty_cycle1<span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> duty_cycle2 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        led<span class="token punctuation">.</span>duty<span class="token punctuation">(</span>duty_cycle2<span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/Hw_L3j1hgvQ" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‘¼å¸ç‡ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ESP32-Camè¦–è¨Šå°è»Š</title>
      <link href="/2021/08/29/esp32-cam-shi-xun-xiao-che/"/>
      <url>/2021/08/29/esp32-cam-shi-xun-xiao-che/</url>
      
        <content type="html"><![CDATA[<h1 id="ESP32-Camè¦–è¨Šå°è»Š"><a href="#ESP32-Camè¦–è¨Šå°è»Š" class="headerlink" title="ESP32-Camè¦–è¨Šå°è»Š"></a>ESP32-Camè¦–è¨Šå°è»Š</h1><h6 id="tags-esp32-cam"><a href="#tags-esp32-cam" class="headerlink" title="tags: esp32-cam"></a>tags: <code>esp32-cam</code></h6><p><strong>æƒ³ä¸åˆ°ç¾åœ¨æœ‰äº†ESP32-CamçœŸæ˜¯æ–¹ä¾¿ï¼Œçµ„è£è»Šèº«ä¸Šæ•´å€‹æ¤å…¥</strong></p><p><strong>ç¯„ä¾‹ç¨‹å¼ï¼Œå¤§æ¦‚ï¼‘å°æ™‚ä¸ç­‰å°±å…¨éƒ¨å®Œæˆã€‚</strong></p><p><strong>æˆ‘æ˜¯åƒç…§ä¸€ä½åœ‹å¤–çš„å¤§å¤§çš„è£½ä½œ</strong>-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8416915322345407552#">https://youtu.be/Wfpvj9KlEMs</a></p><hr><h2 id="ææ–™"><a href="#ææ–™" class="headerlink" title="ææ–™"></a>ææ–™</h2><ol><li> <strong>é¦¬é”x1</strong></li><li> <strong>L298N x1</strong></li><li> <strong>åº•ç›¤æˆ–è»Šèº« x1</strong></li><li> <strong>ESP32-Cam x1</strong></li><li> <strong>18650ä¸²æ¥é›»æ± ç›’ x1</strong></li><li> <strong>18650é›»æ±  x2</strong></li><li> <strong>æœé‚¦ç·š</strong></li></ol><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><ul><li>  å…ˆåˆ°æ­¤é é¢æœ€åº•ä¸‹ï¼Œä¸‹è¼‰å°è»Šç¯„ä¾‹-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8416915322345407552#">https://www.viralsciencecreativity.com/post/esp32-cam-surveillance-spy-camera-car</a></li><li>  ä¸‹è¼‰å®Œå¾Œè§£å£“ç¸®ï¼Œå°‡æ•´å€‹è³‡æ–™å¤¾æ”¾å…¥Arduinoè£¡çš„libraryè³‡æ–™å¤¾è£¡.ï¼Œç„¶å¾Œå¾ç¯„ä¾‹è£¡æ‰¾åˆ°å°è»Šç¯„ä¾‹ã€‚</li><li>  æ›´æ”¹è‡ªå·±çš„WIFIåç¨±å’Œå¯†ç¢¼ï¼Œé¸å–ä¸Šå‚³(å¦‚æœä¸æœƒä¸Šå‚³ESP32CAMå¯ä»¥çœ‹ä¸€ä¸‹é€™ä¸€ç¯‡-[<a href="https://esp32-blairan.blogspot.com/2021/04/esp32-cam.htm]">https://esp32-blairan.blogspot.com/2021/04/esp32-cam.htm]</a></li></ul><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8416915322345407552?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-Di2phCbK_C4/YMK_QwaxbuI/AAAAAAAAeRU/c0k5do3OCBckqzA0ZeNfxX8095dSnHITQCNcBGAsYHQ/s1600/1623375629694103-0.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8416915322345407552?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-FB_Pb4_d9rg/YMK-fcW9RSI/AAAAAAAAeRA/C2psKg3sXnQ1MDd-YGw7C00cUNlfVb-FgCNcBGAsYHQ/s1600/1623375426928438-1.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8416915322345407552?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-A5IFpKhPTDA/YMK-QOJbRzI/AAAAAAAAeQ8/fXRsejo6DY4AItogU3cn1qZknIe-zw5KACNcBGAsYHQ/s1600/1623375369965993-2.png"></a></p><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><ul><li>  æ¥è‘—å°±å¯ä»¥é–‹å§‹çµ„è£è»Šèº«ä¸¦æŠŠè…³ä½å°æ‡‰L298Næ’ä¸Šã€‚</li></ul><p><img src="https://static.wixstatic.com/media/c901e7_50da7f5d492a4096b8d8ec78a96e5978~mv2.png/v1/fill/w_740,h_581,al_c,q_90/c901e7_50da7f5d492a4096b8d8ec78a96e5978~mv2.webp"></p><hr><div class="video-container"><iframe src="https://www.youtube.com/embed/QT0z2qLUymk" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 cam </category>
          
      </categories>
      
      
        <tags>
            
            <tag> esp32 camè¨Šè¦–å°è»Š </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ESP32-camå¯¦ä½œ</title>
      <link href="/2021/08/29/esp32-cam-shi-zuo/"/>
      <url>/2021/08/29/esp32-cam-shi-zuo/</url>
      
        <content type="html"><![CDATA[<h1 id="ESP32-camå¯¦ä½œ"><a href="#ESP32-camå¯¦ä½œ" class="headerlink" title="ESP32-camå¯¦ä½œ"></a>ESP32-camå¯¦ä½œ</h1><h6 id="tags-esp32-cam"><a href="#tags-esp32-cam" class="headerlink" title="tags: esp32-cam"></a>tags: <code>esp32-cam</code></h6><hr><p>-<strong>åœ¨è‡‰æ›¸ç¤¾åœ˜å¾ˆå¤šå¤§å¤§åˆ†äº«ESP32ç³»åˆ—çš„æ¿å­ï¼Œæ„Ÿè¦ºå°è€Œç¾å°è€Œçœ</strong></p><p><strong>èƒ½åšçš„äº‹ä¹Ÿå¾ˆå¤šï¼Œæ‰€ä»¥å°±é›†é«”æ¡æ§‹äº†ï¼’ç‰‡esp32å’Œesp32-camï¼Œå› ç‚º</strong></p><p><strong>æ—©å…ˆæˆ‘æœ‰å…¥æ‰‹é…è£½å¥½çš„esp32çš„é›†æˆæ¿ï¼Œä½†å’Œé€šç”¨çš„ä¸ä¸€æ¨£ï¼Œå¥½åƒ</strong></p><p><strong>æ˜¯é‚£å®¶å…¬å¸åŸºæ–¼esp32å†å‰µç ”çš„ï¼Œä½†æˆ‘å€‹äººæ˜¯ä¸å¤ªå–œæ­¡ç”¨å¸‚é¢ä¸Šä¸</strong></p><p><strong>ç›¸åŒè¦æ ¼çš„æ¿å­ï¼Œæ‰€ä»¥æ‰åˆè²·äº†esp32é€šç”¨æ¿ã€‚</strong></p><p><strong>é‚£å…ˆå¾esp32-camè©¦èµ·ï¼Œè½èªªå‰è¼©å€‘è¸©å‘ï¼Œæ‰€ä»¥åˆ©ç”¨è²¨é‚„æ²’åˆ°å…ˆçˆ¬æ–‡</strong></p><p><strong>ï¼Œå¥½ä¸å®¹æ˜“éäº†åäº”å¤©çµ‚æ–¼åˆ°è²¨ï¼Œæ­£å¼é–‹å§‹å¯¦ä½œäº†ã€‚</strong></p><hr><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-IG2vOkjYr_g/YGmJWUMFS4I/AAAAAAAAeAg/CsYgGDLlUlYE242dPXOWPTAYuJFNwRJ0QCNcBGAsYHQ/w306-h350/20210404_155013.jpg"></a><br><img src="https://i.imgur.com/I8NXL4y.png"></p><hr><h2 id="æ¥ç·šæ–¹å¼"><a href="#æ¥ç·šæ–¹å¼" class="headerlink" title="æ¥ç·šæ–¹å¼"></a>æ¥ç·šæ–¹å¼</h2><hr><h4 id="ç‡’éŒ„é ˆè¦æœ‰USB-TTLçš„è½‰æ¥é ­"><a href="#ç‡’éŒ„é ˆè¦æœ‰USB-TTLçš„è½‰æ¥é ­" class="headerlink" title="ç‡’éŒ„é ˆè¦æœ‰USB TTLçš„è½‰æ¥é ­"></a>ç‡’éŒ„é ˆè¦æœ‰USB TTLçš„è½‰æ¥é ­</h4><p><img src="https://i.imgur.com/j32bpm3.png"><br><strong>ä½†å› ç‚ºæˆ‘æ‰‹ä¸Šä¹‹å‰æœ‰è²·éé¡ä¼¼çš„è½‰æ¥ç·šï¼Œæ‰€ä»¥å°±æ²’æœ‰å†è²·è½‰æ¥é ­</strong></p><p><strong>å”¯ä¸€çš„ç¼ºé»å°±æ˜¯æˆ‘æ‰‹ä¸Šé€™æ¢USB-TTLè½‰æ¥é©…å‹•ç¨‹å¼å·²ç¶“çµ•ç‰ˆï¼Œä½†</strong></p><p><strong>åœ¨ç¶²ä¸Šæ‰¾é‚„æ˜¯å¯æ‰¾çš„åˆ°ï¼Œä¸€é–‹å§‹æ’å…¥USBæ˜¯ç„¡æ³•è¾¨è­˜ã€‚</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-0CIJEIGrJIA/YGmOKrk2qpI/AAAAAAAAeA8/kDpzDpUbCSIo4wFcW6-gDzHLofZfBtWvQCNcBGAsYHQ/w273-h273/images.jpg"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-ORlRmW1ZHXc/YGmOebWesvI/AAAAAAAAeBE/wqp-XeSUeewGT8uGeW_6mdVms0DHmuqawCNcBGAsYHQ/w447-h344/1562393756-3686635058.png"></a></p><hr><p><strong>æŒ‰ç…§ä¸Šåœ–æ¥ç·šå¾Œï¼Œåˆ°ï¼‚è£ç½®ç®¡ç†å“¡ï¼‚ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡å®‰è£ï¼µï¼³ï¼¢é©…å‹•</strong></p><p><strong>æœƒå¦‚ä¸‹é¡¯ç¤ºï¼‚USB-serial controlï¼‚æœ‰å€‹ä¸‰è§’é©šå˜†è™Ÿ!</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-MRS_-cK3nYg/YGmP7oNK2nI/AAAAAAAAeBM/-DDNKU9Gt8M0fB-r7YZMoOoNqZxKGF1BQCNcBGAsYHQ/w443-h249/1.jpg"></a></p><p><strong>ä¸‹è¼‰<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#">PL2303_64bit_Installer</a>ï¼Œé€²å…¥ç¶²å€å¾Œé»é¸ä¸‹åœ–ç´…æ¡†è™•ä¸‹è¼‰é©…å‹•</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-7GnCQo9ZUJg/YGmRF_ueoxI/AAAAAAAAeBU/y292EXqa5MIevfUHVO8T-3FWYCmKyjdewCNcBGAsYHQ/w427-h240/1.jpg"></a></p><p><strong>è§£å£“å¾Œå®‰è£è»Ÿé«”</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-8Gl2Tfo2FcQ/YGmRdkQoW0I/AAAAAAAAeBc/y99qiFEWepsza-tYxkol_aVOHBHeSPjxACNcBGAsYHQ/w490-h276/1.jpg"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-T2G-LewhLQ0/YGmRrAQjMDI/AAAAAAAAeBg/gp1kamt2GWMdi8tB9gCOaGUypwRHZVWhQCNcBGAsYHQ/w426-h240/1.jpg"></a></p><p><strong>æŒ‰ä¸‹â€finshï¼‚æœƒè‡ªå‹•é‡å•“é›»è…¦</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-Sf28JI3q4uc/YGmR92n-UDI/AAAAAAAAeBs/p99mswf_9i8ymjplFYWtHTf03L677Yl4QCNcBGAsYHQ/w424-h239/1.jpg"></a></p><p><strong>é‡é–‹æ©Ÿå¾Œï¼Œå†åˆ°â€è£ç½®ç®¡ç†å“¡ï¼‚ï¼Œ ä»¥æˆ‘çš„ç­†é›»æ˜¯com7å°±å‡ºç¾äº†</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-4zSMNpvu-jI/YGmUTdUf1rI/AAAAAAAAeB0/wzwo-lTSoI87nEsncW0dmdL0nqUNxa46ACNcBGAsYHQ/w452-h254/1.jpg"></a></p><hr><h2 id="æ¥ä¸‹ä¾†åˆ°Arduino-IDE"><a href="#æ¥ä¸‹ä¾†åˆ°Arduino-IDE" class="headerlink" title="æ¥ä¸‹ä¾†åˆ°Arduino IDE"></a>æ¥ä¸‹ä¾†åˆ°Arduino IDE</h2><p><strong>å› ç‚ºIDEè£¡æ²’æœ‰ESP32çš„åº« ï¼Œæ‰€ä»¥è¦å…ˆæ“´å¢</strong></p><p><strong>åˆ°ï¼‚æª”æ¡ˆ-&gt;åå¥½è¨­å®šï¼‚è£¡ï¼Œï¼‚é¡å¤–çš„é–‹ç™¼æ¿ç®¡ç†å“¡ç¶²å€ï¼‚è²¼ä¸Šä»¥ä¸‹ç¶²å€</strong></p><p><strong><a href="https://dl.espressif.com/dl/package/_esp32/_index.json%EF%BC%8C%E4%B8%A6%E6%8C%89%E7%A2%BA%E5%AE%9A">https://dl.espressif.com/dl/package\_esp32\_index.jsonï¼Œä¸¦æŒ‰ç¢ºå®š</a></strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-Z0BIUuFp-Sk/YGmVoELnJyI/AAAAAAAAeB8/ni-B6jxLZbAG3r4OvSIiqWTiLrWoF3TngCNcBGAsYHQ/w460-h259/1.jpg"></a></p><p><strong>ç„¶å¾Œåˆ°ï¼‚å·¥å…·ï¼‚â€”ï¼ï¼‚é–‹ç™¼æ¿ç®¡ç†å“¡ï¼‚æœå°‹â€esp32ï¼‚ï¼Œæœƒå‡ºç¾å°æ‡‰çš„</strong></p><p><strong>åº«ï¼Œé¸æ“‡ï¼‚å®‰è£ï¼‚ã€‚</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-F0WNedLy2Uk/YGmZZ7xPzfI/AAAAAAAAeCE/FqUlSPxlqVkcoAA6Gx6epLibKKJsT1XbQCNcBGAsYHQ/w434-h244/2.jpg"></a></p><p><strong>å®‰è£å¥½å¾Œä¸€æ¨£åœ¨ï¼‚å·¥å…·ï¼‚åº•ä¸‹ï¼Œé¸æ“‡ï¼‚ESP32 Arduinoï¼‚-&gt;â€ESP32 Wrrover Moduleâ€</strong></p><p><strong>ä¸¦é¸æ“‡å°æ‡‰çš„åºåˆ—åŸ (com)</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-rWDqD0dz2qc/YGmakbrRnGI/AAAAAAAAeCM/s3df9UK3zRIrxBhr6C5lY1v3XzpmSGkLQCNcBGAsYHQ/w479-h270/1.jpg"></a></p><p><strong>å› ç‚ºwifiå³æ™‚çš„æµé‡è¦æ¯”è¼ƒå¤§ï¼Œä¸”è€—èƒ½ï¼Œæ‰€ä»¥å†å¦æŠŠä»¥ä¸‹é€™å€‹é¸æ“‡æ”¹ä¸€ä¸‹</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-gf7kO8q5y38/YGmbLCcvtEI/AAAAAAAAeCU/z0jC6RtDGbMVCJRXdTumt6URuxFQzT08ACNcBGAsYHQ/w421-h237/2.jpg"></a></p><p><strong>å†åˆ°â€ç¯„ä¾‹ï¼‚åº•ä¸‹åŒ¯å…¥ç¯„ä¾‹</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-cnsDAyIqb_c/YGmcJ4-UPuI/AAAAAAAAeCc/rWqVlsd-ke4YfrkN13yliiMV2x21gPFywCNcBGAsYHQ/w478-h269/2.jpg"></a></p><p><strong>é€™è£¡æœ‰å¹¾å€‹åœ°æ–¹è¦æ›´æ”¹ä¸€ä¸‹è¨­ç½®</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-kaulw1wcg1w/YGmdFDhEwBI/AAAAAAAAeCk/70Ycqy_IG_0-HAHfFxRiJ4W9V3-9oN2zwCNcBGAsYHQ/w514-h289/2.jpg"></a></p><hr><p><strong>éƒ½è¨­ç½®å¥½äº†ä¹‹å¾Œï¼Œå…ˆæŠŠæ¿å­ä¸Šçš„ï¼©ï¼¯ï¼å’Œï¼§ï¼®ï¼¤çŸ­æ¥èµ·ä¾†ã€‚</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-3knPVurgzB0/YGmgfPGKXfI/AAAAAAAAeCs/c9U4ihOIFXwLNHRMvAdXPbOwRdFj7jvkgCNcBGAsYHQ/w436-h413/20210404_191546.jpg"></a></p><p><strong>æ¥ä¸‹ä¾†æŒ‰ä¸‹â€ä¸Šå‚³ï¼‚</strong></p><p><strong>â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦æ™‚é–“ç´„6åˆ†é˜ï¼Œå¯ä»¥å–å£æ°´</strong></p><p><strong>å¯«å…¥ç¨‹å¼å¾Œæœ€å¾Œå‡ºç¾ä¸‹åœ–ï¼Œé€™æ™‚æŠŠçŸ­æ¥æ‹”æ‰ä¸¦REST</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-b_dwGskTofY/YGmiH2rDZwI/AAAAAAAAeC0/RIFbmrKvELkQLfHSEy3EZBcxpQeuwgsLgCNcBGAsYHQ/w418-h235/2.jpg"></a></p><hr><p><strong>ç„¶å¾Œé–‹å•“â€ç›£æ§è¢å¹•â€ï¼Œå®ƒæœƒçµ¦ä¸€çµ„ï¼©ï¼°ï¼Œç”¨ç€è¦½å™¨ç™»å…¥</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-aIu_JpV1Vb0/YGmiv6GgpvI/AAAAAAAAeC8/qagkETKhQ0kUiqzfZLsE6TMPUO8cSiSIACNcBGAsYHQ/w441-h248/2.jpg"></a></p><p><strong>ç„¶å¾ŒæˆåŠŸäº†å°±æœƒé€²å…¥ä»¥ä¸‹ç•«é¢</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-3iwr7LwXbN8/YGmkZ7oslaI/AAAAAAAAeDE/iFIaXkzSu8Yc6r-PH-_qAtYcKleMXOM3wCNcBGAsYHQ/w463-h253/2.jpg"></a></p><p><strong>ç•«é¢å·¦ä¸‹æ–¹â€start streamâ€æŒ‰ä¸‹ï¼Œç›£æ§é »å°±æœƒå‡ºç¾</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2908832685289288450#"><img src="https://1.bp.blogspot.com/-GYoCegVuku0/YGmlmlN3_dI/AAAAAAAAeDM/G8yTthhipZI8i_zpatL0m7t-dcEmDL2NgCNcBGAsYHQ/w552-h272/2.jpg"></a></p><p><strong>è½èªªé‚„æœ‰å¾ˆå¤šåŠŸèƒ½ï¼Œä¾‹å¦‚äººè‡‰è¾¨è­˜ï¼Œä¹Ÿå¯ç½®å…¥ä¸€äº›åƒæ•¸ï¼Œåšåˆ·è‡‰é–€ç¦ç­‰ç­‰â€¦.</strong></p><p>**ç­‰æœ‰ç©ºå†ä¾†æ‰¾æ‰¾é€™é¡è³‡æ–™ã€‚<br>**</p>]]></content>
      
      
      <categories>
          
          <category> esp32 cam </category>
          
      </categories>
      
      
        <tags>
            
            <tag> esp32 cam </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ESP32é€£ä¸Šç„¡ç·šåŸºåœ°å°ï¼ˆï¼¡ï¼°ï¼‰</title>
      <link href="/2021/08/29/esp32-lian-shang-wu-xian-ji-di-tai-ap/"/>
      <url>/2021/08/29/esp32-lian-shang-wu-xian-ji-di-tai-ap/</url>
      
        <content type="html"><![CDATA[<h1 id="ESP32é€£ä¸Šç„¡ç·šåŸºåœ°å°ï¼ˆAPï¼‰"><a href="#ESP32é€£ä¸Šç„¡ç·šåŸºåœ°å°ï¼ˆAPï¼‰" class="headerlink" title="ESP32é€£ä¸Šç„¡ç·šåŸºåœ°å°ï¼ˆï¼¡ï¼°ï¼‰"></a>ESP32é€£ä¸Šç„¡ç·šåŸºåœ°å°ï¼ˆï¼¡ï¼°ï¼‰</h1><h6 id="tags-esp32-wifi"><a href="#tags-esp32-wifi" class="headerlink" title="tags: esp32 wifi"></a>tags: <code>esp32</code> <code>wifi</code></h6><hr><h2 id="å¯¦é©—èªªæ˜ï¼š"><a href="#å¯¦é©—èªªæ˜ï¼š" class="headerlink" title="å¯¦é©—èªªæ˜ï¼š"></a>å¯¦é©—èªªæ˜ï¼š</h2><p><strong>ç”¨ ESP32å…§å»ºWi-Fié€£åˆ°åŸºåœ°å°ï¼Œç¨‹å¼ä½¿ç”¨while()è¿´åœˆ</strong></p><p><strong>ä¸¦ä»¥WiFi.staus()åˆ¤æ–·æ˜¯å¦å·²é€£ç·š,å¦‚æœæ­£åœ¨é€£ç·šï¼Œæœƒå°å‡º</strong></p><p><strong>ï¼‚.ï¼‚ï¼Œå¦‚å›å‚³ç‚ºå¦,æ¯éš”0.5ç§’æœƒå†é€²å…¥å›è¿´åœˆæƒæé™„è¿‘</strong></p><p><strong>é…å°çš„åŸºåœ°å°ï¼Œç›´åˆ°é€£ç·šæˆåŠŸç‚ºè·³å‡ºè¿´åœˆä¸¦å°å‡ºâ€å·²é€£ç·š</strong></p><p><strong>æˆåŠŸâ€å­—æ¨£ã€‚</strong></p><hr><ul><li><strong>é€£ç·šä¸­</strong></li></ul><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1075448515665169120#"><img src="https://1.bp.blogspot.com/-pReU1rtq-8Q/YJyl1JGCz_I/AAAAAAAAeJA/qeYtYdCBIKwjeUF62PlEbad5mVj7kqmoACNcBGAsYHQ/w609-h194/1.jpg"></a></p><ul><li><strong>å·²é€£ç·š</strong></li></ul><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1075448515665169120#"><img src="https://1.bp.blogspot.com/--1iFhC4mnNU/YJyl98_zwgI/AAAAAAAAeJE/MNJ4WMupFAUL0d13nyJ-k-uzZTIpvhRVACNcBGAsYHQ/w645-h214/2.jpg"></a></p><hr><h1 id="ESP32é€£ä¸Šç„¡ç·šåŸºåœ°å°ï¼ˆAPï¼‰-1"><a href="#ESP32é€£ä¸Šç„¡ç·šåŸºåœ°å°ï¼ˆAPï¼‰-1" class="headerlink" title="ESP32é€£ä¸Šç„¡ç·šåŸºåœ°å°ï¼ˆï¼¡ï¼°ï¼‰"></a>ESP32é€£ä¸Šç„¡ç·šåŸºåœ°å°ï¼ˆï¼¡ï¼°ï¼‰</h1><hr><h2 id="å¯¦é©—èªªæ˜ï¼š-1"><a href="#å¯¦é©—èªªæ˜ï¼š-1" class="headerlink" title="å¯¦é©—èªªæ˜ï¼š"></a>å¯¦é©—èªªæ˜ï¼š</h2><p><strong>ç”¨ ESP32å…§å»ºWi-Fié€£åˆ°åŸºåœ°å°ï¼Œç¨‹å¼ä½¿ç”¨while()è¿´åœˆ</strong></p><p><strong>ä¸¦ä»¥WiFi.staus()åˆ¤æ–·æ˜¯å¦å·²é€£ç·š,å¦‚æœæ­£åœ¨é€£ç·šï¼Œæœƒå°å‡º</strong></p><p><strong>ï¼‚.ï¼‚ï¼Œå¦‚å›å‚³ç‚ºå¦,æ¯éš”0.5ç§’æœƒå†é€²å…¥å›è¿´åœˆæƒæé™„è¿‘</strong></p><p><strong>é…å°çš„åŸºåœ°å°ï¼Œç›´åˆ°é€£ç·šæˆåŠŸç‚ºè·³å‡ºè¿´åœˆä¸¦å°å‡ºâ€å·²é€£ç·š</strong></p><p><strong>æˆåŠŸâ€å­—æ¨£ã€‚</strong></p><hr><h3 id="é€£ç·šä¸­"><a href="#é€£ç·šä¸­" class="headerlink" title="é€£ç·šä¸­"></a>é€£ç·šä¸­</h3><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1075448515665169120#"><img src="https://1.bp.blogspot.com/-pReU1rtq-8Q/YJyl1JGCz_I/AAAAAAAAeJA/qeYtYdCBIKwjeUF62PlEbad5mVj7kqmoACNcBGAsYHQ/w609-h194/1.jpg"></a></p><h3 id="å·²é€£ç·š"><a href="#å·²é€£ç·š" class="headerlink" title="å·²é€£ç·š"></a>å·²é€£ç·š</h3><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1075448515665169120#"><img src="https://1.bp.blogspot.com/--1iFhC4mnNU/YJyl98_zwgI/AAAAAAAAeJE/MNJ4WMupFAUL0d13nyJ-k-uzZTIpvhRVACNcBGAsYHQ/w645-h214/2.jpg"></a></p><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;WiFi.h&gt; â€”â€”â€”å¥—ç”¨ï¼·ï½‰ï¼¦ï½‰åº«constÂ charÂ *ssidÂ &#x3D;Â &quot;åŸºåœ°å°åç¨±&quot;;constÂ charÂ *passwordÂ &#x3D;Â &quot;åŸºåœ°å°å¯†ç¢¼&quot;;  voidÂ setup()&#123;Â Â Â Â Serial.begin(115200);Â Â Â Â WiFi.begin(ssid,Â password);Â Â Â Â whileÂ (WiFi.status()Â !&#x3D;Â WL_CONNECTED)&#123; â€”â€”â€”åˆ¤æ–·æ˜¯å¦å·²é€£ç·šÂ Â Â Â Â Â Â Â delay(500);Â Â Â Â Â Â Â Â Serial.print(&quot;.&quot;);Â Â Â Â &#125;Â Â Â Â Serial.println(&quot;å·²é€£ç·šåˆ°Wi-FiåŸºåœ°å°&quot;);&#125;voidÂ loop()&#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç²å–APè³‡è¨Š"><a href="#ç²å–APè³‡è¨Š" class="headerlink" title="  ç²å–APè³‡è¨Š "></a>  ç²å–APè³‡è¨Š </h2><p><strong>ç›¸é—œå‡½å¼è«‹åƒé–±-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1075448515665169120#">ESP32å‡½å¼ç­†è¨˜æœ¬</a></strong></p><p><strong>åŸºæœ¬ä¸Šå’Œä¸Šé¢ç¨‹å¼ç¢¼ä¸€æ¨£ï¼Œåªæ˜¯å¤šå¥—ç”¨äº†å–å¾—ç¶²è·¯ç›¸é—œçš„è³‡è¨Š</strong></p><p><strong>ï¼Œæ¯å€‹èƒ½é€£ä¸Šç¶²è·¯çš„è¨­å‚™éƒ½æœƒæœ‰é€™äº›ç›¸é—œè¨Šæ¯ï¼Œä¾‹å¦‚é›»è…¦ï¼Œåœ¨</strong></p><p><strong>çµ‚è«¯æ©Ÿè¼¸å…¥ipconfigå°±æœƒå‡ºç¾ä¸‹åœ–:</strong></p><p><a href="https://1.bp.blogspot.com/-1J2iaS1THkk/YJzRS-H6gyI/AAAAAAAAeJQ/Z8D0k_dYVtI1pmHiwtpn5cgkguvjwvubwCNcBGAsYHQ/s1456/1.jpg"><img src="https://1.bp.blogspot.com/-1J2iaS1THkk/YJzRS-H6gyI/AAAAAAAAeJQ/Z8D0k_dYVtI1pmHiwtpn5cgkguvjwvubwCNcBGAsYHQ/w544-h275/1.jpg"></a></p><p><strong>é‚£éº¼ESP32åŒæ¨£å¯åšç‚ºç¶²è·¯è¨­å‚™ä¾†èªªä¹Ÿæ˜¯æœƒæœ‰é€™äº›è³‡è¨Š</strong></p><p>**å°‡ç¨‹å¼ç¢¼ä¸Šå‚³å¾Œå³æœƒå–å¾—ç›¸é—œçš„è³‡è¨Š<br>**</p><p><a href="https://1.bp.blogspot.com/-Eb5_RJ8ay48/YJzR3ZC4AII/AAAAAAAAeJY/Qi9yLfNdupghRcPWGuw7KX0AR7HOWo9ZACNcBGAsYHQ/s1541/2.jpg"><img src="https://1.bp.blogspot.com/-Eb5_RJ8ay48/YJzR3ZC4AII/AAAAAAAAeJY/Qi9yLfNdupghRcPWGuw7KX0AR7HOWo9ZACNcBGAsYHQ/w469-h283/2.jpg"></a></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;WiFi.h&gt;constÂ charÂ *ssidÂ &#x3D;Â &quot;åŸºåœ°å°åç¨±&quot;;constÂ charÂ *passwordÂ &#x3D;Â &quot;åŸºåœ°å°å¯†ç¢¼&quot;;  voidÂ setup()&#123;Â Â Â Â Serial.begin(115200);Â Â Â Â WiFi.begin(ssid,Â password);Â Â Â Â whileÂ (WiFi.status()Â !&#x3D;Â WL_CONNECTED)Â Â Â Â &#123;Â Â Â Â Â Â Â Â delay(500);Â Â Â Â Â Â Â Â Serial.print(&quot;.&quot;);Â Â Â Â &#125;Â Â Â Â Serial.println(&quot;å·²é€£ä¸ŠWiFi&quot;);Â Â Â Â Serial.print(&quot;æˆ‘çš„IPä½å€&quot;);Â Â Â Â Serial.println(WiFi.localIP());  Â Â Â Â Serial.print(&quot;å­é®ç½©ç¶²è·¯:Â &quot;);Â Â Â Â Serial.println(WiFi.subnetMask());  Â Â Â Â Serial.print(&quot;é–˜é“ç¶²è·¯:Â &quot;);Â Â Â Â Serial.println(WiFi.gatewayIP());  Â Â Â Â Serial.print(&quot;DNSä½å€:Â &quot;);Â Â Â Â Serial.println(WiFi.dnsIP());&#125;voidÂ loop()&#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wifi </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ESP32è®Šæˆç¶²é ä¼ºæœå™¨,ä½¿å®¢æˆ¶ç«¯é€£å…¥ç¶²é </title>
      <link href="/2021/08/29/esp32-bian-cheng-wang-ye-si-fu-qi-shi-ke-hu-duan-lian-ru-wang-ye/"/>
      <url>/2021/08/29/esp32-bian-cheng-wang-ye-si-fu-qi-shi-ke-hu-duan-lian-ru-wang-ye/</url>
      
        <content type="html"><![CDATA[<h1 id="ESP32è®Šæˆç¶²é ä¼ºæœå™¨-ä½¿å®¢æˆ¶ç«¯é€£å…¥ç¶²é "><a href="#ESP32è®Šæˆç¶²é ä¼ºæœå™¨-ä½¿å®¢æˆ¶ç«¯é€£å…¥ç¶²é " class="headerlink" title="ESP32è®Šæˆç¶²é ä¼ºæœå™¨,ä½¿å®¢æˆ¶ç«¯é€£å…¥ç¶²é "></a>ESP32è®Šæˆç¶²é ä¼ºæœå™¨,ä½¿å®¢æˆ¶ç«¯é€£å…¥ç¶²é </h1><h6 id="tags-esp32-WiFi"><a href="#tags-esp32-WiFi" class="headerlink" title="tags: esp32 WiFi"></a>tags: <code>esp32</code> <code>WiFi</code></h6><hr><h4 id="åŸºæœ¬ä¸Šå°±æ˜¯é€™ç¯‡çš„å»¶ä¼¸"><a href="#åŸºæœ¬ä¸Šå°±æ˜¯é€™ç¯‡çš„å»¶ä¼¸" class="headerlink" title="åŸºæœ¬ä¸Šå°±æ˜¯é€™ç¯‡çš„å»¶ä¼¸-"></a>åŸºæœ¬ä¸Šå°±æ˜¯é€™ç¯‡çš„å»¶ä¼¸-</h4><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4116986106197766676?hl=zh-TW#">https://esp32-blairan.blogspot.com/2021/05/esp32ap.html</a>  </p><h2 id="æµç¨‹æ€æƒŸ"><a href="#æµç¨‹æ€æƒŸ" class="headerlink" title="æµç¨‹æ€æƒŸ"></a>æµç¨‹æ€æƒŸ</h2><p>è¦å…ˆæœ‰æ•´å€‹æµç¨‹çš„æ¦‚å¿µï¼Œæ¯”è¼ƒä¸æœƒåœ¨å¯«ç¨‹å¼æ™‚ææ··</p><p>ç”¨æˆ‘è‡ªå·±çš„è§£é‡‹æ˜¯ï¼Œå…ˆé€£ä¸ŠESP32åŸºåœ°å°ï¼Œè¬ä¸€é€£</p><p>ä¸ä¸Šï¼Œå°±æœƒä¸€ç›´å‡ºç¾é»é»é»â€¦.ï¼Œè©¦åœ–é€£ä¸Šï¼Œé€£ç·šæˆ</p><p>åŠŸå¾Œæœƒé¡¯ç¤ºï¼‚å·²é€£ç·šæˆåŠŸï¼‚(åœ–1)ï¼Œä¸¦é…ç™¼IPä½å€çµ¦å®¢æˆ¶ç«¯</p><p>æ­¤æ™‚ä¼ºæœå™¨å•“å‹•ç­‰å¾…å®¢æˆ¶ç«¯è«‹æ±‚æ ¹ç›®éŒ„çš„å›è¦†,è‹¥å®¢</p><p>æˆ¶ç«¯é€£ä¸ŠIP,ä¼ºæœå™¨å°‡æä¾›æ ¹ç›®éŒ„é è¨­çš„å›è¦†è¨Šæ¯(åœ–2)ï¼Œ</p><p>å¦‚æœåœ¨IPå¾Œé¢éš¨æ„æ‰“å­—ï¼Œå› ç‚ºæ ¹ç›®éŒ„ä¸‹æ²’æœ‰é€™å€‹é è¨­</p><p>ç›®æ¨™ï¼Œå°‡æœƒé¡¯æŸ¥ç„¡é€™å€‹ç¶²é (åœ–3)ã€‚</p><p>(åœ–1)</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4116986106197766676?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-aHVdMYxdyUo/YLHndJOPIaI/AAAAAAAAeNU/-HZtR82h3JQIeA9oJ5JRNz8Phn_h1sDFgCNcBGAsYHQ/w500-h281/2.jpg"></a></p><p>(åœ–2)</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4116986106197766676?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-LNy_a5hKhTA/YLHni6wxvNI/AAAAAAAAeNY/GL8WBynD2FocPIgJVTmzzFJW7IxpR3LTACNcBGAsYHQ/w502-h269/1.jpg"></a></p><p>(åœ–3)</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4116986106197766676?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-F2vTjv5E6Uc/YLHoaliw3gI/AAAAAAAAeNk/JWP9Xp9d2h0-yFONJzfrqP3ZZdI-JHq1wCNcBGAsYHQ/w504-h267/3.jpg"></a></p><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;WiFi.h&gt;#include &lt;WebServer.h&gt;constÂ charÂ *ssid&#x3D;&quot;åŸºåœ°å°åç¨±&quot;;constÂ charÂ *password&#x3D;&quot;åŸºåœ°å°å¯†ç¢¼&quot;;WebServerÂ server(80);voidÂ handleRoot()&#123;Â Â server.send(200,Â &quot;text&#x2F;html;Â charset&#x3D;UTF-8&quot;,Â &quot;å®¢æˆ¶ç«¯æ”¶åˆ°è¨Šæ¯!!!&quot;);&#125;voidÂ handleNotFound()&#123;Â Â server.send(400,Â &quot;text&#x2F;html;Â charset&#x3D;UTF-8&quot;,Â &quot;æ‰¾ä¸åˆ°å›å‚³çš„è¨Šæ¯&quot;);&#125;voidÂ setup(void)&#123;Â Â Serial.begin(115200);Â Â WiFi.begin(ssid,Â password);Â Â server.begin();Â Â whileÂ (WiFi.status()Â !&#x3D;Â WL_CONNECTED)&#123;Â Â Â Â Serial.print(&quot;.&quot;);Â Â Â Â delay(500);Â Â &#125;Â Â Serial.print(&quot;å·²é€£ç·šè‡³åŸºåœ°å°&quot;);Â Â Serial.println(ssid)Â Â Serial.print(&quot;è«‹æ–¼ç€è¦½å™¨ä¸­é–‹å•“é€™å€‹IPä½å€:Â &quot;);Â Â Serial.println(WiFi.localIP());  Â Â server.on(&quot;&#x2F;&quot;,Â handleRoot);Â Â server.onNotFound(handleNotFound);Â Â Serial.println(&quot;HTTPä¼ºæœå™¨å·²å•“å‹•&quot;);&#125;  voidÂ loop()Â &#123;Â Â server.handleClient();&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webserver </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ESP32é»äº®å…§ç½®LED</title>
      <link href="/2021/08/29/esp32-dian-liang-nei-zhi-led/"/>
      <url>/2021/08/29/esp32-dian-liang-nei-zhi-led/</url>
      
        <content type="html"><![CDATA[<h1 id="ESP32é»äº®å…§ç½®LED"><a href="#ESP32é»äº®å…§ç½®LED" class="headerlink" title="ESP32é»äº®å…§ç½®LED"></a>ESP32é»äº®å…§ç½®LED</h1><h6 id="tags-esp32"><a href="#tags-esp32" class="headerlink" title="tags: esp32"></a>tags: <code>esp32</code></h6><hr><h4 id="é€™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡çœŸæ­£å­¸ç¿’esp32ç³»åˆ—-é›–ç„¶ä¹‹å‰æœ‰ä½¿ç”¨wemos-d1-miniä½†ä¹Ÿåªæ˜¯ç…§æ›¸åš-ç”¨å®Œé‚„æ˜¯è¦ºå¾—å¾ˆæ¨¡ç³Š-ç©äº†ä¸€é™£å­çš„Arduino-ç¾åœ¨æœ‰ç©ºä¸€é‚Šç ”ç©¶espç³»åˆ—å’Œæ¨¹è“æ´¾-ä»Šå¤©ç•¶åšä¸€å€‹èµ·å§‹é»äº®æ¿ä¸Šçš„LED"><a href="#é€™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡çœŸæ­£å­¸ç¿’esp32ç³»åˆ—-é›–ç„¶ä¹‹å‰æœ‰ä½¿ç”¨wemos-d1-miniä½†ä¹Ÿåªæ˜¯ç…§æ›¸åš-ç”¨å®Œé‚„æ˜¯è¦ºå¾—å¾ˆæ¨¡ç³Š-ç©äº†ä¸€é™£å­çš„Arduino-ç¾åœ¨æœ‰ç©ºä¸€é‚Šç ”ç©¶espç³»åˆ—å’Œæ¨¹è“æ´¾-ä»Šå¤©ç•¶åšä¸€å€‹èµ·å§‹é»äº®æ¿ä¸Šçš„LED" class="headerlink" title="é€™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡çœŸæ­£å­¸ç¿’esp32ç³»åˆ—,é›–ç„¶ä¹‹å‰æœ‰ä½¿ç”¨wemos d1 miniä½†ä¹Ÿåªæ˜¯ç…§æ›¸åš,ç”¨å®Œé‚„æ˜¯è¦ºå¾—å¾ˆæ¨¡ç³Š,ç©äº†ä¸€é™£å­çš„Arduino,ç¾åœ¨æœ‰ç©ºä¸€é‚Šç ”ç©¶espç³»åˆ—å’Œæ¨¹è“æ´¾,ä»Šå¤©ç•¶åšä¸€å€‹èµ·å§‹é»äº®æ¿ä¸Šçš„LED."></a>é€™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡çœŸæ­£å­¸ç¿’esp32ç³»åˆ—,é›–ç„¶ä¹‹å‰æœ‰ä½¿ç”¨wemos d1 miniä½†ä¹Ÿåªæ˜¯ç…§æ›¸åš,ç”¨å®Œé‚„æ˜¯è¦ºå¾—å¾ˆæ¨¡ç³Š,ç©äº†ä¸€é™£å­çš„Arduino,ç¾åœ¨æœ‰ç©ºä¸€é‚Šç ”ç©¶espç³»åˆ—å’Œæ¨¹è“æ´¾,ä»Šå¤©ç•¶åšä¸€å€‹èµ·å§‹é»äº®æ¿ä¸Šçš„LED.</h4><hr><h4 id="æˆ‘æ‰€ä½¿ç”¨çš„ESP32æ˜¯æ·˜-è²·çš„-å› ç‚ºé€™æ¬¾æœ‰é™„å–®å…ƒèª²ç¨‹-æ‰€ä»¥æœ‰ä¸€å€‹é›†æˆæ¿-å¾ˆæ–¹ä¾¿ã€‚"><a href="#æˆ‘æ‰€ä½¿ç”¨çš„ESP32æ˜¯æ·˜-è²·çš„-å› ç‚ºé€™æ¬¾æœ‰é™„å–®å…ƒèª²ç¨‹-æ‰€ä»¥æœ‰ä¸€å€‹é›†æˆæ¿-å¾ˆæ–¹ä¾¿ã€‚" class="headerlink" title="æˆ‘æ‰€ä½¿ç”¨çš„ESP32æ˜¯æ·˜*è²·çš„,å› ç‚ºé€™æ¬¾æœ‰é™„å–®å…ƒèª²ç¨‹,æ‰€ä»¥æœ‰ä¸€å€‹é›†æˆæ¿,å¾ˆæ–¹ä¾¿ã€‚"></a>æˆ‘æ‰€ä½¿ç”¨çš„ESP32æ˜¯æ·˜*è²·çš„,å› ç‚ºé€™æ¬¾æœ‰é™„å–®å…ƒèª²ç¨‹,æ‰€ä»¥æœ‰ä¸€å€‹é›†æˆæ¿,å¾ˆæ–¹ä¾¿ã€‚</h4><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5957928262171433878#"><img src="https://1.bp.blogspot.com/-EHIybPXQ1TQ/YESQWt2rOZI/AAAAAAAAd5g/dPueSjsi6HgMLS-72nLW0wTPYWWGqEHZACNcBGAsYHQ/w343-h762/20210307_162828.jpg"></a><br><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5957928262171433878#"><img src="https://1.bp.blogspot.com/-WUH-nbqYfnU/YESTI1KqdqI/AAAAAAAAd58/5OAKs359y9spbLh5KE9AuOSuGQjegmF4ACNcBGAsYHQ/w542-h361/pyWiFi-ESP32_pinout.png"></a></p><h6 id="lt-åœ–ç‰‡å¼•ç”¨01Studioç¶²ç«™-gt"><a href="#lt-åœ–ç‰‡å¼•ç”¨01Studioç¶²ç«™-gt" class="headerlink" title="&lt;åœ–ç‰‡å¼•ç”¨01Studioç¶²ç«™&gt;"></a>&lt;åœ–ç‰‡å¼•ç”¨01Studioç¶²ç«™&gt;</h6><hr><h3 id="ä»Šå¤©å…ˆä¾†ç­†è¨˜ä¸€ä¸‹ä½¿ç”¨micropythonçš„èªæ³•"><a href="#ä»Šå¤©å…ˆä¾†ç­†è¨˜ä¸€ä¸‹ä½¿ç”¨micropythonçš„èªæ³•" class="headerlink" title="ä»Šå¤©å…ˆä¾†ç­†è¨˜ä¸€ä¸‹ä½¿ç”¨micropythonçš„èªæ³•"></a>ä»Šå¤©å…ˆä¾†ç­†è¨˜ä¸€ä¸‹ä½¿ç”¨micropythonçš„èªæ³•</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="é€™å€‹æ˜¯æ§åˆ¶æ¿ä¸Šçš„gpioçš„å¥—ä»¶"><a href="#é€™å€‹æ˜¯æ§åˆ¶æ¿ä¸Šçš„gpioçš„å¥—ä»¶" class="headerlink" title="é€™å€‹æ˜¯æ§åˆ¶æ¿ä¸Šçš„gpioçš„å¥—ä»¶"></a>é€™å€‹æ˜¯æ§åˆ¶æ¿ä¸Šçš„gpioçš„å¥—ä»¶</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">led<span class="token punctuation">(</span>è®Šæ•¸<span class="token punctuation">)</span><span class="token operator">=</span>Pin<span class="token punctuation">(</span>è…³ä½<span class="token punctuation">,</span> Pin<span class="token punctuation">.</span>OUT<span class="token punctuation">)</span>led<span class="token punctuation">.</span>on<span class="token punctuation">(</span>off<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> æˆ– led<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">or</span> <span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><hr><h3 id="å¯«ä¸€å€‹è¿´åœˆä¾†æ§åˆ¶LEDé–ƒçˆ"><a href="#å¯«ä¸€å€‹è¿´åœˆä¾†æ§åˆ¶LEDé–ƒçˆ" class="headerlink" title="å¯«ä¸€å€‹è¿´åœˆä¾†æ§åˆ¶LEDé–ƒçˆ"></a>å¯«ä¸€å€‹è¿´åœˆä¾†æ§åˆ¶LEDé–ƒçˆ</h3><pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token keyword">import</span> timeled<span class="token operator">=</span>Pin<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> Pin<span class="token punctuation">.</span>OUT<span class="token punctuation">)</span>a<span class="token operator">=</span><span class="token number">0</span><span class="token keyword">while</span> a<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">:</span>    led<span class="token punctuation">.</span>on<span class="token punctuation">(</span><span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    led<span class="token punctuation">.</span>off<span class="token punctuation">(</span><span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    a<span class="token operator">+=</span><span class="token number">1</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/X79o9kU_hh0" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
          <category> micropython </category>
          
      </categories>
      
      
        <tags>
            
            <tag> led </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨platformIOç·¨è¼¯esp32æ›´æ”¹æ³¢ç‰¹ç‡</title>
      <link href="/2021/08/29/shi-yong-platformio-bian-ji-esp32-geng-gai-bo-te-lu/"/>
      <url>/2021/08/29/shi-yong-platformio-bian-ji-esp32-geng-gai-bo-te-lu/</url>
      
        <content type="html"><![CDATA[<h1 id="ä½¿ç”¨platformIOç·¨è¼¯esp32æ›´æ”¹æ³¢ç‰¹ç‡"><a href="#ä½¿ç”¨platformIOç·¨è¼¯esp32æ›´æ”¹æ³¢ç‰¹ç‡" class="headerlink" title="ä½¿ç”¨platformIOç·¨è¼¯esp32æ›´æ”¹æ³¢ç‰¹ç‡"></a>ä½¿ç”¨platformIOç·¨è¼¯esp32æ›´æ”¹æ³¢ç‰¹ç‡</h1><h6 id="tags-esp32"><a href="#tags-esp32" class="headerlink" title="tags: esp32"></a>tags: <code>esp32</code></h6><h2 id="åŸç”±"><a href="#åŸç”±" class="headerlink" title="åŸç”±:"></a>åŸç”±:</h2><p><strong>å› ç‚ºä½¿ç”¨VScodeçš„å¤–æ›platformIOç·¨ç¨‹ESP32æ™‚,é‡åˆ°ä¸€å€‹å•é¡Œæ˜¯,æ³¢ç‰¹ç‡çš„é è¨­æ˜¯9600,æ‰€ä»¥åœ¨ä¸Šå‚³ESP32åªè¦é–‹å•“ä¸²å£çª—,æœƒå‡ºç¾äº‚ç¢¼,æ­¤æ™‚åªè¦åŠ </strong></p><p><strong>å…¥ä¸€è¡Œè¨­å®šä»£ç¢¼å³å¯ã€‚</strong></p><h2 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•:"></a>æ–¹æ³•:</h2><h3 id="åœ¨platformIOçš„å°ˆæ¡ˆè³‡æ–™å¤¾è£¡æœ‰ä¸€å€‹platformio-iniï¼Œæ‰“é–‹æ­¤æ–‡ä»¶ã€‚"><a href="#åœ¨platformIOçš„å°ˆæ¡ˆè³‡æ–™å¤¾è£¡æœ‰ä¸€å€‹platformio-iniï¼Œæ‰“é–‹æ­¤æ–‡ä»¶ã€‚" class="headerlink" title="åœ¨platformIOçš„å°ˆæ¡ˆè³‡æ–™å¤¾è£¡æœ‰ä¸€å€‹platformio.iniï¼Œæ‰“é–‹æ­¤æ–‡ä»¶ã€‚"></a>åœ¨platformIOçš„å°ˆæ¡ˆè³‡æ–™å¤¾è£¡æœ‰ä¸€å€‹platformio.iniï¼Œæ‰“é–‹æ­¤æ–‡ä»¶ã€‚</h3><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5479708402450547329#"><img src="https://1.bp.blogspot.com/-vKAPXvvPExQ/YIYxS2l229I/AAAAAAAAeFQ/kfyB0nSsx1AbRjBkrwblppLarywketgVQCNcBGAsYHQ/w591-h332/but2.jpg"></a></p><h3 id="åŠ å…¥monitor-speed-115200ï¼ŒåŠ å…¥å¾Œå­˜æª”å³å¯ã€‚"><a href="#åŠ å…¥monitor-speed-115200ï¼ŒåŠ å…¥å¾Œå­˜æª”å³å¯ã€‚" class="headerlink" title="åŠ å…¥monitor_speed=115200ï¼ŒåŠ å…¥å¾Œå­˜æª”å³å¯ã€‚"></a>åŠ å…¥monitor_speed=115200ï¼ŒåŠ å…¥å¾Œå­˜æª”å³å¯ã€‚</h3><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5479708402450547329#"><img src="https://1.bp.blogspot.com/-4fs9OT3YkHc/YIYxS_sPvSI/AAAAAAAAeFU/--QyhpQ7P844rjcXviYpBcSACr_9LYpdACNcBGAsYHQ/w580-h326/but.jpg"></a></p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ³¢ç‰¹ç‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ESP32-CAMç¸®æ™‚éŒ„å½±</title>
      <link href="/2021/08/29/esp32-cam-suo-shi-lu-ying/"/>
      <url>/2021/08/29/esp32-cam-suo-shi-lu-ying/</url>
      
        <content type="html"><![CDATA[<h1 id="ESP32-CAMç¸®æ™‚éŒ„å½±"><a href="#ESP32-CAMç¸®æ™‚éŒ„å½±" class="headerlink" title="ESP32-CAMç¸®æ™‚éŒ„å½±"></a>ESP32-CAMç¸®æ™‚éŒ„å½±</h1><h6 id="tags-esp32-esp32-camç¸®æ™‚éŒ„å½±"><a href="#tags-esp32-esp32-camç¸®æ™‚éŒ„å½±" class="headerlink" title="tags: esp32 esp32-camç¸®æ™‚éŒ„å½±"></a>tags: <code>esp32</code> <code>esp32-camç¸®æ™‚éŒ„å½±</code></h6><h2 id="æº–å‚™"><a href="#æº–å‚™" class="headerlink" title="æº–å‚™"></a>æº–å‚™</h2><p><strong>MicroSDå¡ x1</strong></p><p><strong>ESP32-CAM x1</strong></p><p><strong>USB TTLå‚³è¼¸ç·š æˆ– USB TTLæ¨¡çµ„</strong></p><p><strong>é›™æ¯æœé‚¦ç·š x1</strong></p><hr><h2 id="ä¸‹è¼‰ç¸®æ™‚éŒ„å½±çš„åº«"><a href="#ä¸‹è¼‰ç¸®æ™‚éŒ„å½±çš„åº«" class="headerlink" title="ä¸‹è¼‰ç¸®æ™‚éŒ„å½±çš„åº«"></a>ä¸‹è¼‰ç¸®æ™‚éŒ„å½±çš„åº«</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/220625865150685015#">https://github.com/jameszah/ESP32-CAM-Video-Recorder</a>  </p><p><strong>ä¸‹è¼‰å®Œå¾Œï¼Œæ–°å¢åˆ°Arduino IDEçš„libraryè£¡</strong></p><p><strong>æ‰“é–‹ç·¨è¼¯å™¨è£¡çš„ç¯„ä¾‹-&gt;TimeLapse</strong></p><p>**</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/220625865150685015#"><img src="https://1.bp.blogspot.com/-LjDyK9KNMpk/YGwIPQCplYI/AAAAAAAAeDY/mx4YiCbQDxIEx4VHjyYmzJwMRU_Gg9yrACNcBGAsYHQ/w438-h246/1.jpg"></a></p><hr><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/220625865150685015#"><img src="https://1.bp.blogspot.com/-vym3Op0cW0s/YGwI357s-KI/AAAAAAAAeDg/KZRbfinTtQESOD8tmqD9f-5VXMC4uvX2QCNcBGAsYHQ/w441-h248/1.jpg"></a></p><hr><p>å°‡ESP32-CAMæ¿å­ä¸Šçš„IO0å’ŒGNDç”¨é›™æ¯æœé‚¦é€£æ¥èµ·ä¾†ã€‚**</p><h2 id="é‚„æœ‰ä¸€äº›é¸æ“‡çš„è¨­å®šï¼Œå¾€ä¸‹çœ‹å½±ç‰‡æ›´æ¸…æ¥š"><a href="#é‚„æœ‰ä¸€äº›é¸æ“‡çš„è¨­å®šï¼Œå¾€ä¸‹çœ‹å½±ç‰‡æ›´æ¸…æ¥š" class="headerlink" title="é‚„æœ‰ä¸€äº›é¸æ“‡çš„è¨­å®šï¼Œå¾€ä¸‹çœ‹å½±ç‰‡æ›´æ¸…æ¥š"></a><strong>é‚„æœ‰ä¸€äº›é¸æ“‡çš„è¨­å®šï¼Œå¾€ä¸‹çœ‹å½±ç‰‡æ›´æ¸…æ¥š</strong></h2><p>**</p><div class="video-container"><iframe src="https://www.youtube.com/embed/BJXV09NFz1U" frameborder="0" loading="lazy" allowfullscreen></iframe></div><p><a href="https://youtu.be/BJXV09NFz1U">https://youtu.be/BJXV09NFz1U</a></p><p>æœ‰ç©ºå†ä¾†è£œå¦‚ä½•ç”¨ffmpegæŠŠç¸®æ™‚çš„ç…§ç‰‡æ•´åˆèµ·ä¾†**</p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
          <category> esp32 cam </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ESP32 CAM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆåšESP32-å¯«å…¥è»”é«”</title>
      <link href="/2021/08/29/chu-chang-esp32-xie-ru-ren-ti/"/>
      <url>/2021/08/29/chu-chang-esp32-xie-ru-ren-ti/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆåšESP32â€”å¯«å…¥è»”é«”"><a href="#åˆåšESP32â€”å¯«å…¥è»”é«”" class="headerlink" title="åˆåšESP32â€”å¯«å…¥è»”é«”"></a>åˆåšESP32â€”å¯«å…¥è»”é«”</h1><h6 id="tags-esp32"><a href="#tags-esp32" class="headerlink" title="tags: esp32"></a>tags: <code>esp32</code></h6><h2 id="æœ‰é»è¤‡é›œä½†åˆå¦äººæƒ³åšè©¦çš„ESP32"><a href="#æœ‰é»è¤‡é›œä½†åˆå¦äººæƒ³åšè©¦çš„ESP32" class="headerlink" title="æœ‰é»è¤‡é›œä½†åˆå¦äººæƒ³åšè©¦çš„ESP32"></a>æœ‰é»è¤‡é›œä½†åˆå¦äººæƒ³åšè©¦çš„ESP32</h2><p>æ¨‚é‘«ç§‘æŠ€-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7215718092950677692#">https://www.espressif.com/zh-hans/products/devkits/esp32-devkitc/overview</a>  </p><p>ç©äº†ä¸€é™£å­Arduinoå¾Œï¼Œçœ‹äº†å¹¾å€‹ç¤¾åœ˜æ¨ESP32ç³»åˆ—ï¼Œ</p><p>æ–¼æ˜¯å…¥æ‰‹äº†ESP32-CAMä¾†ç©ç©ï¼Œå°æ¯”æ¨¹è“æ´¾çš„äººè‡‰</p><p>è¾¨è­˜ï¼Œåªè¦çŒå…¥ç¯„ä¾‹å°±èƒ½è·‘äººè‡‰è­˜åˆ¥ï¼Œæ‰€ä»¥é–‹å§‹é—œæ³¨</p><p>ESP32ç³»åˆ—çš„æ¿å­ã€‚åŸä¾†å®ƒæ˜¯å¤§é™¸ä¸€å®¶å«æ¨‚é‘«çš„å¤§å» </p><p>åšçš„é–‹æºæ¿ï¼Œä¸Šç¶²çœ‹äº†ä»–å€‘çš„ç¶²ç«™ï¼Œç™¼ç¾é —è±å¯Œçš„ï¼Œ</p><p>å…¶å¯¦å¾ˆå¤šå‰è¼©è€å¸«å€‘éƒ½å·²åšäº†å¾ˆè©³ç›¡çš„ä»‹ç´¹ï¼Œæˆ‘å°±</p><p>ä¸å¤šèªªäº†ã€‚</p><p>ä¸»è¦æˆ‘æ˜¯è¦ºå¾—ESP32æ„Ÿè¦ºæœ‰åŒæ–¼Arduinoç³»åˆ—ï¼Œä½†åˆæœ‰</p><p>ä¸ä¸€æ¨£çš„åœ°æ–¹ï¼Œè½èªªå®ƒè…³ä½æœ‰äº›ä¸èƒ½çµ¦æˆ‘å€‘æ­£å¸¸ä½¿ç”¨ï¼Œ</p><p>è€Œä¸”åªæ¥å—3.3Vè¼¸å…¥ï¼Œä½†å¥½è™•æ˜¯é›†çµäº†WIFIå’Œè—èŠ½ã€‚</p><p>å¯ä»¥ç”¨micropythonå’ŒCèªè¨€ä¾†ç·¨è­¯ï¼Œä½†é€™è£¡æˆ‘å°±æœ‰é»</p><p>é›£å–æ¨ï¼Œåˆ°åº•è¦ç”¨micropythonæˆ–Cä¾†å¯«ï¼Œé›–ç„¶ç”¨ï½ƒæ¯”è¼ƒ</p><p>ç°¡å–®è€Œä¸”åˆæœ‰å¼·å¤§çš„ç¯„ä¾‹ï¼Œä½†ä¹Ÿæˆ‘æœ¬èº«æ˜¯å¾pythoné–‹å§‹</p><p>å­¸èµ·çš„ï¼Œæˆ–è¨±æœ‰ç©ºå…©ç¨®éƒ½æœƒå­¸å­¸ã€‚</p><hr><h2 id="æˆ‘å…¥æ‰‹çš„ESP32-DOIT-DEVKIT-V1"><a href="#æˆ‘å…¥æ‰‹çš„ESP32-DOIT-DEVKIT-V1" class="headerlink" title="æˆ‘å…¥æ‰‹çš„ESP32-DOIT-DEVKIT-V1"></a>æˆ‘å…¥æ‰‹çš„ESP32-DOIT-DEVKIT-V1</h2><p>é€™è£¡æ„Ÿè¦ºå¾ˆå²å®³çš„æ˜¯æœ‰è¨±å¤šçµ„â€è§¸æ§æ¥è…³â€ï¼Œä»¥ï¼‚TOUCHï¼‚é–‹é ­ç‚ºè¡¨ç¤º</p><p>å¦å¤–GPIOç”¨Arduinoçš„æ–¹å¼å¯«ä¸€æ¨£æ˜¯D*ï¼Œè€ŒADC1 CH0å°±è¡¨ç¤ºA0ã€‚</p><p>é‚„æœ‰ä¸€å€‹è¦æ³¨æ„çš„æ˜¯ï¼Œåºåˆ—æ’å­”å·¦å³æœ‰å…©å€‹æŒ‰éµï¼Œï¼¥ï¼®ä»£è¡¨ï¼²ï¼³ï¼´</p><p>ï¼¢ï¼¯ï¼¯ï¼´ä»£è¡¨å¯«å…¥ç‹€æ…‹</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7215718092950677692#"><img src="https://1.bp.blogspot.com/-aqByH8jZaHU/YIZiXH3A6NI/AAAAAAAAeFk/ZHPxVHay7pgsHhz54ZGE8xA33kHgiIWxwCNcBGAsYHQ/w327-h294/c44b9f5d0a23649c7b352c7c1eb8b5d8.jpg"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7215718092950677692#"><img src="https://1.bp.blogspot.com/-uV84UOVkK8A/YIZij6ll2LI/AAAAAAAAeFs/jQsh0S-ZUswKm_V-HmN8tGN_i2G7bpQJwCNcBGAsYHQ/w496-h359/ESP32-DOIT-DEVKIT-V1-Board-Pinout-30-GPIOs-Copy.png"></a></p><hr><h2 id="å¦‚ä½•å¯«å…¥è»”é«”"><a href="#å¦‚ä½•å¯«å…¥è»”é«”" class="headerlink" title="å¦‚ä½•å¯«å…¥è»”é«”"></a>å¦‚ä½•å¯«å…¥è»”é«”</h2><p>åƒè€ƒç¶²å€</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7215718092950677692#">ä¸‹è¼‰ windows å°ˆç”¨ FlashTools</a>-å–è‡ªJIMIå¤§çš„æ•™å­¸ç¶²ç«™  </p><p>é€™è£¡è¦æ³¨æ„çš„æ˜¯ESP32ç‡’éŒ„å·¥å…·è‹¥ä¸€æ‰“é–‹å°±è·³æ‰ï¼Œè«‹åˆ°</p><p>ï¼‚è¨­å®šï¼‚-â€œæ™‚é–“èˆ‡èªè¨€â€-â€œåœ°å€æ ¼å¼â€é¸æ“‡ç‚ºâ€ä¸­æ–‡(ç°¡é«”,ä¸­åœ‹)ï¼‚</p><p>é‡é–‹æ©Ÿå³å¯åŸ·è¡Œè©²è»Ÿé«”ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯«å…¥è»”é«” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0.96å‹OLEDåŸºæœ¬é¡¯ç¤º-ESP32</title>
      <link href="/2021/08/29/0-96-cun-oled-ji-ben-xian-shi-esp32/"/>
      <url>/2021/08/29/0-96-cun-oled-ji-ben-xian-shi-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="0-96å‹OLEDåŸºæœ¬é¡¯ç¤º-ESP32"><a href="#0-96å‹OLEDåŸºæœ¬é¡¯ç¤º-ESP32" class="headerlink" title="0.96å‹OLEDåŸºæœ¬é¡¯ç¤º-ESP32"></a>0.96å‹OLEDåŸºæœ¬é¡¯ç¤º-ESP32</h1><h6 id="tags-esp32-oled"><a href="#tags-esp32-oled" class="headerlink" title="tags: esp32 oled"></a>tags: <code>esp32</code> <code>oled</code></h6><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/6459347446114782211?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-SfRPMdP0feE/YMdKWUgpKzI/AAAAAAAAeTk/DtG0FqRB7hI4Xu0suyprVmf1lSZ2c6BpwCNcBGAsYHQ/s1600/1623673410135139-0.png"></a></p><h2 id="æ¥ç·šæ–¹å¼"><a href="#æ¥ç·šæ–¹å¼" class="headerlink" title="æ¥ç·šæ–¹å¼"></a>æ¥ç·šæ–¹å¼</h2><p><strong><em>OLED</em></strong>||<strong>ESP32</strong></p><p>-----------------</p><p>VCC----3V3</p><p>GNDâ€”-GND</p><p>SCLâ€”â€“D22</p><p>SDAâ€”-D21</p><h2 id="å‡½å¼åƒè€ƒ"><a href="#å‡½å¼åƒè€ƒ" class="headerlink" title="å‡½å¼åƒè€ƒ"></a>å‡½å¼åƒè€ƒ</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/6459347446114782211?hl=zh-TW#">æˆ‘çš„å‡½å¼ç­†è¨˜æœ¬</a>  </p><hr><h2 id="é ˆä¸‹è¼‰åŠåŒ¯å…¥ä»¥ä¸‹å‡½å¼åº«"><a href="#é ˆä¸‹è¼‰åŠåŒ¯å…¥ä»¥ä¸‹å‡½å¼åº«" class="headerlink" title="é ˆä¸‹è¼‰åŠåŒ¯å…¥ä»¥ä¸‹å‡½å¼åº«"></a>é ˆä¸‹è¼‰åŠåŒ¯å…¥ä»¥ä¸‹å‡½å¼åº«</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/6459347446114782211?hl=zh-TW#">Adafruit_SSD1306</a>  </p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/6459347446114782211?hl=zh-TW#">Adafruit-GFX-Library</a>  </p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;Adafruit_GFX.h&gt;#include &lt;Adafruit_SSD1306.h&gt;#include &lt;Adafruit_GrayOLED.h&gt;#include &lt;Wire.h&gt;#define SCREEN_WIDTH 128Â &#x2F;&#x2F;Â OLEDÂ displayÂ width,Â inÂ pixels#define SCREEN_HEIGHT 64Â &#x2F;&#x2F;Â OLEDÂ displayÂ height,Â inÂ pixels  #define OLED_RESET -1Â &#x2F;&#x2F;Â ResetÂ pinÂ #Â (orÂ -1Â ifÂ sharingÂ ArduinoÂ resetÂ pin)#define SCREEN_ADDRESS 0x3CÂ &#x2F;&#x2F;&#x2F;&lt;Â SeeÂ datasheetÂ forÂ Address;Â 0x3DÂ forÂ 128x64,Â 0x3CÂ forÂ 128x32Adafruit_SSD1306Â display(SCREEN_WIDTH,Â SCREEN_HEIGHT,Â &amp;Wire,Â OLED_RESET);voidÂ setup()&#123;Â Â Serial.begin(115200);Â Â display.begin(SSD1306_SWITCHCAPVCC,Â SCREEN_ADDRESS,Â OLED_RESET);&#125;voidÂ loop()&#123;Â Â display.clearDisplay();Â Â display.setCursor(0,Â 0);Â Â display.setTextSize(1);Â Â display.setTextColor(BLACK,Â WHITE);Â Â display.println(&quot;Hello!&quot;);Â Â display.setCursor(0,Â 16);Â Â display.setTextSize(2);Â Â display.setTextColor(WHITE);Â Â display.println(&quot;ESP32&quot;);Â Â display.setTextSize(3);Â Â display.setCursor(0,Â 32);Â Â display.println(&quot;Arduino&quot;);Â Â display.display();&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/6459347446114782211?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-FEjaHLmo_yM/YMdNVhVTE-I/AAAAAAAAeTs/fbsZkMqTyR8UmjWzqETE6Bvx6Hce70NCACNcBGAsYHQ/s1600/1623674195093239-0.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> oled </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‘¼å¸ç‡ˆ-ESP32</title>
      <link href="/2021/08/29/hu-xi-deng-esp32/"/>
      <url>/2021/08/29/hu-xi-deng-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="å‘¼å¸ç‡ˆ-ESP32"><a href="#å‘¼å¸ç‡ˆ-ESP32" class="headerlink" title="å‘¼å¸ç‡ˆ-ESP32"></a>å‘¼å¸ç‡ˆ-ESP32</h1><h2 id="æ¥ç·šæ–¹å¼"><a href="#æ¥ç·šæ–¹å¼" class="headerlink" title="æ¥ç·šæ–¹å¼"></a>æ¥ç·šæ–¹å¼</h2><h6 id="tags-esp32"><a href="#tags-esp32" class="headerlink" title="tags: esp32"></a>tags: <code>esp32</code></h6><ul><li>  <strong>é›»é˜» 10Kæ­å§† x1</strong></li><li>  <strong>LED x1</strong></li></ul><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/632666415205285811?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-o7ZeTZikdPc/YMlLS_bH5VI/AAAAAAAAeT8/p-2FoevUIRQT9z24R3Dfjrq-w-hmE7rgwCNcBGAsYHQ/w594-h373/222251qialhmh1wlko8hz8.jpg"></a></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><p><strong><em>å‡½å¼èªªæ˜è«‹åƒè€ƒ-</em></strong><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/632666415205285811?hl=zh-TW#">æˆ‘çš„å‡½å¼ç­†è¨˜æœ¬</a></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">voidÂ setup()&#123;Â Â Â Â ledcSetup(0,Â 5000,Â 8);Â Â Â Â ledcAttachPin(25,Â 0);&#125;voidÂ loop()&#123;Â Â Â Â forÂ (intÂ iÂ &#x3D;Â 0;Â iÂ &lt;&#x3D;255Â ;Â i++)Â Â Â Â &#123;Â Â Â Â Â Â Â Â ledcWrite(0,Â i);Â Â Â Â Â Â Â Â delay(20);Â Â Â Â &#125;Â Â Â Â forÂ (intÂ jÂ &#x3D;Â 255;Â jÂ &gt;Â 0;Â j--)Â Â Â Â &#123;Â Â Â Â Â Â Â Â ledcWrite(0,Â j);Â Â Â Â Â Â Â Â delay(20);Â Â Â Â &#125;Â Â Â Â delay(300);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‘¼å¸ç‡ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PIRäººé«”æ„Ÿæ‡‰å™¨</title>
      <link href="/2021/08/29/pir-ren-ti-gan-ying-qi/"/>
      <url>/2021/08/29/pir-ren-ti-gan-ying-qi/</url>
      
        <content type="html"><![CDATA[<h1 id="PIRäººé«”æ„Ÿæ‡‰å™¨"><a href="#PIRäººé«”æ„Ÿæ‡‰å™¨" class="headerlink" title="PIRäººé«”æ„Ÿæ‡‰å™¨"></a>PIRäººé«”æ„Ÿæ‡‰å™¨</h1><h6 id="tags-esp32-PIR-motion"><a href="#tags-esp32-PIR-motion" class="headerlink" title="tags: esp32 PIR_motion"></a>tags: <code>esp32</code> <code>PIR_motion</code></h6><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5742917802289246193?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-IyjhCgpFA20/YMtNtZbtNII/AAAAAAAAeUI/Yxs-05vGkwQmMKGDMdRG4OWA72p9fYW-ACNcBGAsYHQ/w403-h333/pir-01.jpg"></a><br>å¯¦é©—èªªæ˜</p><hr><p><em>æ­¤æ¬¡å¯¦é©—ï¼Œä»¥PIRæ„Ÿæ‡‰å™¨æª¢æ¸¬äººé«”é‹å‹•ï¼Œåœ¨é«˜é›»ä½æ™‚ä½¿LEDäº®ï¼Œ</em></p><p><em>åˆ°é”è¨­è£½çš„æ™‚é–“ï¼Œè‡ªå‹•æ»…æ‰ã€‚</em></p><p><em>åŒæ™‚æˆ‘åœ¨é€™å€‹å¯¦é©—è£¡å­¸åˆ°ä¸­æ–·å‡½å¼attachInterrupt()å’Œmills()çš„é‹ç”¨</em></p><p><em>ä¸­æ–·å‡½å¼å¯ä»¥é‹ç”¨åœ¨PIRï¼Œç•¶æª¢æ¸¬åˆ°è®ŠåŒ–ï¼Œä¸­æ–·å‡½å¼æœƒè¢«è§¸ç™¼å»åŸ·è¡Œæ‰€</em></p><p><em>è¨­å®šçš„å‹•ä½œã€‚åŒæ™‚è—‰ç”±mills()æ›¿åŒ–delay()è€Œä¸è‡³æ–¼æ‰€æœ‰çš„éç¨‹éƒ½è¢«delay()</em></p><p><em>æš«åœã€‚</em></p><hr><h2 id="æ¥ç·šæ–¹å¼"><a href="#æ¥ç·šæ–¹å¼" class="headerlink" title="æ¥ç·šæ–¹å¼"></a>æ¥ç·šæ–¹å¼</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5742917802289246193?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-kZQEvtpmUs8/YMtRIIu7vbI/AAAAAAAAeUQ/cap6CtGU6xAU2z7SGzMpPxYlg-pUY5kZQCNcBGAsYHQ/w826-h457/0d48261252092c03a3a44e37cd427709.jpg"></a></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">constÂ intÂ led&#x3D;18;constÂ intÂ motionSensor&#x3D;27;unsignedÂ longÂ oldTime;boolÂ startTimer&#x3D;false;voidÂ IRAM_ATTRÂ detectedMotion()&#123;Â Â Â Â Serial.println(&quot;detectedÂ motion....&quot;);Â Â Â Â digitalWrite(led,Â HIGH);Â Â Â Â oldTime&#x3D;millis();Â Â Â Â startTimer&#x3D;true;&#125;voidÂ setup()&#123;Â Â Â Â Serial.begin(115200);Â Â Â Â pinMode(led,Â OUTPUT);Â Â Â Â pinMode(motionSensor,Â INPUT_PULLUP);Â Â Â Â attachInterrupt(digitalPinToInterrupt(motionSensor),Â detectedMotion,Â RISING);&#125;voidÂ loop()&#123;Â Â Â Â unsignedÂ longÂ now&#x3D;millis();Â Â Â Â ifÂ (startTimer&amp;&amp;(now-oldTime&gt;5000))&#123;Â Â Â Â Â Â Â Â Serial.println(&quot;motionÂ stop!!!&quot;);Â Â Â Â Â Â Â Â digitalWrite(led,Â LOW);Â Â Â Â Â Â Â Â startTimer&#x3D;false;Â Â Â Â &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><em>ç‰¹åˆ¥æåˆ°é€™è£¡æœ‰ä¸€å€‹è‡ªå®šç¾©å‡½å¼ï¼Œå®ƒçš„ä½œç”¨æ˜¯ç•¶PIRåµæ¸¬åˆ°å‹•ä½œå¾Œï¼Œå°±æœƒå»åŸ·è¡Œé€™éƒ¨ä»½</em></p><p><em>ä¸¦ä¸”ä½¿startTimeré–‹å§‹ç´€éŒ„åŸ·è¡Œå¾Œçš„æ—¶é–“ã€‚</em></p><p><strong>æ³¨æ„ï¼šIRAM_ATTR ç”¨æ–¼é‹è¡Œ RAM ä¸­çš„ä¸­æ–·ä»£ç¢¼ï¼Œå¦å‰‡ä»£ç¢¼å­˜å„²åœ¨ flash ä¸­ï¼Œé€Ÿåº¦è¼ƒæ…¢ã€‚</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">voidÂ IRAM_ATTRÂ detectedMotion()&#123;Â Â Â Â Serial.println(&quot;detectedÂ motion....&quot;);Â Â Â Â digitalWrite(led,Â HIGH);Â Â Â Â oldTime&#x3D;millis();Â Â Â Â startTimer&#x3D;true;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><em>ä¸­æ–·å‡½å¼å¯ä»¥åƒè€ƒ</em>-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5742917802289246193?hl=zh-TW#">æˆ‘çš„å‡½å¼ç­†è¨˜æœ¬</a></p><pre class="line-numbers language-none"><code class="language-none">attachInterrupt(digitalPinToInterrupt(motionSensor),Â detectedMotion,Â RISING);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><em>æ™‚é–“å‡½å¼å¯ä»¥åƒè€ƒ</em>-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5742917802289246193?hl=zh-TW#">æˆ‘çš„å‡½å¼ç­†è¨˜æœ¬</a></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">unsignedÂ longÂ now&#x3D;millis();Â Â Â Â ifÂ (startTimer&amp;&amp;(now-oldTime&gt;5000))&#123;Â Â Â Â Â Â Â Â Serial.println(&quot;motionÂ stop!!!&quot;);Â Â Â Â Â Â Â Â digitalWrite(led,Â LOW);Â Â Â Â Â Â Â Â startTimer&#x3D;false;Â Â Â Â &#125;  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/xQr5rVHvR-k" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PIR </tag>
            
            <tag> PIRäººé«”æ„Ÿæ‡‰å™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¶²é æ§åˆ¶LEDç‡ˆ-ESP32</title>
      <link href="/2021/08/29/wang-ye-kong-zhi-led-deng-esp32/"/>
      <url>/2021/08/29/wang-ye-kong-zhi-led-deng-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¶²é æ§åˆ¶LEDç‡ˆ-ESP32"><a href="#ç¶²é æ§åˆ¶LEDç‡ˆ-ESP32" class="headerlink" title="ç¶²é æ§åˆ¶LEDç‡ˆ-ESP32"></a>ç¶²é æ§åˆ¶LEDç‡ˆ-ESP32</h1><h6 id="tags-esp32"><a href="#tags-esp32" class="headerlink" title="tags: esp32"></a>tags: <code>esp32</code></h6><h2 id="å…ˆä¸Šç¨‹å¼ç¢¼"><a href="#å…ˆä¸Šç¨‹å¼ç¢¼" class="headerlink" title="å…ˆä¸Šç¨‹å¼ç¢¼"></a>å…ˆä¸Šç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;WiFi.h&gt;const char* ssid&#x3D;&quot;åŸºåœ°å°åç¨±&quot;;const char* password&#x3D;&quot;åŸºåœ°å°å¯†ç¢¼&quot;;WiFiServer server(80);String header;String output2&#x3D;&quot;off&quot;;const int output&#x3D;2;unsigned long currentTime&#x3D;millis();unsigned long previousTime&#x3D;0;void setup()&#123;  pinMode(output, OUTPUT);  digitalWrite(output, LOW);  WiFi.begin(ssid, password);  Serial.begin(115200);  while (WiFi.status() !&#x3D; WL_CONNECTED)  &#123;    delay(500);    Serial.print(&quot;.&quot;);  &#125;  Serial.println(&quot;å·²é€£ç·šåˆ°åŸºåœ°å°&quot;);  Serial.print(&quot;åŸºåœ°å°åç¨±: &quot;);  Serial.println(ssid);  Serial.println(WiFi.localIP());  server.begin();&#125;void loop()&#123;  WiFiClient client&#x3D;server.available();  if (client)&#123;    currentTime&#x3D;millis();    previousTime&#x3D;currentTime;    Serial.println(&quot;æ–°çš„å®¢æˆ¶ç«¯&quot;);    String currentLine&#x3D;&quot;&quot;;    while (client.connected()&amp;&amp;currentTime-previousTime&lt;&#x3D;2000)    &#123;      currentTime&#x3D;millis();      if (client.available())&#123;        char c&#x3D;client.read();        Serial.write(c);        header+&#x3D;c;        if (c&#x3D;&#x3D;&#39;\n&#39;)&#123;          if (currentLine.length()&#x3D;&#x3D;0)&#123;            client.println(&quot;HTTP&#x2F;1.1 200 OK&quot;);            client.println(&quot;Content-type:text&#x2F;html&quot;);            client.println(&quot;Connection: close&quot;);            client.println();            if (header.indexOf(&quot;GET &#x2F;2&#x2F;on&quot;)&gt;&#x3D;0)&#123;              Serial.println(&quot;on&quot;);              output2&#x3D;&quot;on&quot;;              digitalWrite(output, HIGH);            &#125;else if (header.indexOf(&quot;GET &#x2F;2&#x2F;off&quot;)&gt;&#x3D;0)&#123;              Serial.println(&quot;off&quot;);              output2&#x3D;&quot;off&quot;;              digitalWrite(output, LOW);            &#125;            client.println(&quot;&lt;!DOCTYPE html&gt;&lt;html&gt;&quot;);            client.println(&quot;&lt;style&gt;html &#123;text-align: center;font-family: Arial;display: inline-block;margin: auto;&#125;&quot;);            client.println(&quot;.button &#123;background-color: #e0e252; border: none;color: white;padding: 15px 35px;&quot;);            client.println(&quot;text-align: center;text-decoration: none;display: inline-block;font-size: 16px;&#125;&quot;);            client.println(&quot;.button2 &#123;background-color: #b0b1a2;padding: 15px 32px;&#125;&lt;&#x2F;style&gt;&lt;&#x2F;head&gt;&quot;);                        client.println(&quot;&lt;body&gt;&lt;h1&gt;ESP32 Web Server&lt;&#x2F;h1&gt;&quot;);                        client.println(&quot;&lt;p&gt;GPIO-2  &quot;+output2+&quot;&lt;&#x2F;p&gt;&quot;);                           if (output2&#x3D;&#x3D;&quot;off&quot;) &#123;              client.println(&quot;&lt;p&gt;&lt;a href&#x3D;\&quot;&#x2F;2&#x2F;on\&quot;&gt;&lt;button class&#x3D;\&quot;button\&quot;&gt;ON&lt;&#x2F;button&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;&quot;);              client.println(&quot;&lt;p&gt;&lt;a href&#x3D;\&quot;&#x2F;2&#x2F;off\&quot;&gt;&lt;button class&#x3D;\&quot;button button2\&quot;&gt;OFF&lt;&#x2F;button&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;&quot;);            &#125; else if (output2&#x3D;&#x3D;&quot;on&quot;)&#123;              client.println(&quot;&lt;p&gt;&lt;a href&#x3D;\&quot;&#x2F;2&#x2F;on\&quot;&gt;&lt;button class&#x3D;\&quot;button button2\&quot;&gt;ON&lt;&#x2F;button&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;&quot;);              client.println(&quot;&lt;p&gt;&lt;a href&#x3D;\&quot;&#x2F;2&#x2F;off\&quot;&gt;&lt;button class&#x3D;\&quot;button\&quot;&gt;OFF&lt;&#x2F;button&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;&quot;);            &#125;            client.println(&quot;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;&quot;);            client.println();            break;          &#125;else&#123;            currentLine&#x3D;&quot;&quot;;          &#125;        &#125;      &#125;    &#125;  header&#x3D;&quot;&quot;;  client.stop();  Serial.println(&quot;Client disconnected.&quot;);  Serial.println(&quot;&quot;);  &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><p>åŒ¯å…¥WIFIçš„åº«</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;WiFi.h&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®šç¾©åŸºåœ°å°åç¨±å’Œå¯†ç¢¼</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">const char* ssid&#x3D;&quot;åŸºåœ°å°åç¨±&quot;;const char* password&#x3D;&quot;åŸºåœ°å°å¯†ç¢¼&quot;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å®šç¾©ä¼ºæœå™¨çš„ç«¯å£</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">WiFiServer server(80);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å»ºç«‹å­˜æ”¾æ¥æ•¸åˆ°çš„æª”é ­</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">String header;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¶²å€åˆ—é è¨­å…§å»ºLEDç‚ºoff<br>ä¾‹å¦‚:<a href="http://localhost/off">http://localhost/off</a></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">String output2&#x3D;&quot;off&quot;;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å»ºç«‹LEDè…³ä½,ç´€éŒ„ç•¶ä¸‹æ™‚é–“,å’Œéå»çš„æ™‚é–“</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">const int output&#x3D;2;unsigned long currentTime&#x3D;millis();unsigned long previousTime&#x3D;0;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä¸»è¦æ˜¯å»ºç«‹WiFié€£ç·šåˆ°åŸºåœ°å°çš„åˆå§‹åŒ–<br>åŒ…å«ä¼ºæœç«¯çš„åˆå§‹åŒ–,å¦‚æœé€£ç·šæˆåŠŸå¾Œ,<br>æœƒåœ¨ç›£æ§è¦–çª—ä¸Šé¡¯ç¤ºIP</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">void setup()&#123;  pinMode(output, OUTPUT);  digitalWrite(output, LOW);  WiFi.begin(ssid, password);  Serial.begin(115200);  while (WiFi.status() !&#x3D; WL_CONNECTED)  &#123;    delay(500);    Serial.print(&quot;.&quot;);  &#125;  Serial.println(&quot;å·²é€£ç·šåˆ°åŸºåœ°å°&quot;);  Serial.print(&quot;åŸºåœ°å°åç¨±: &quot;);  Serial.println(ssid);  Serial.println(WiFi.localIP());  server.begin();&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨void loop(){}è£¡é¢<br>å…ˆå»ºç«‹å®¢æœç«¯çš„ç›£è½</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">WiFiClient client&#x3D;server.available();<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœå®¢æˆ¶ç«¯å’Œä¼ºæœç«¯èƒ½æˆåŠŸå»ºç«‹æºé€š,ä¼ºæœç«¯æœƒä¸€ç›´ç›£è½å®¢æœç«¯æ‰€çµ¦äºˆçš„è«‹æ±‚<br>é€™å€‹è«‹æ±‚æ˜¯ä»¥å­—ä¸²è¢«å­˜å…¥è®Šæ•¸ä¸¦å­˜æ”¾æ–¼å…§,å¦‚æœå¾—åˆ°onå°±å›æ‡‰é–‹ç‡ˆ,å¥³æœå¾—åˆ°off<br>å°±é—œç‡ˆ</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">if (client)&#123;    currentTime&#x3D;millis();    previousTime&#x3D;currentTime;    Serial.println(&quot;æ–°çš„å®¢æˆ¶ç«¯&quot;);    String currentLine&#x3D;&quot;&quot;;    while (client.connected()&amp;&amp;currentTime-previousTime&lt;&#x3D;2000)    &#123;      currentTime&#x3D;millis();      if (client.available())&#123;        char c&#x3D;client.read();        Serial.write(c);        header+&#x3D;c;        if (c&#x3D;&#x3D;&#39;\n&#39;)&#123;          if (currentLine.length()&#x3D;&#x3D;0)&#123;            client.println(&quot;HTTP&#x2F;1.1 200 OK&quot;);            client.println(&quot;Content-type:text&#x2F;html&quot;);            client.println(&quot;Connection: close&quot;);            client.println();             if (header.indexOf(&quot;GET &#x2F;2&#x2F;on&quot;)&gt;&#x3D;0)&#123;              Serial.println(&quot;on&quot;);              output2&#x3D;&quot;on&quot;;              digitalWrite(output, HIGH);            &#125;else if (header.indexOf(&quot;GET &#x2F;2&#x2F;off&quot;)&gt;&#x3D;0)&#123;              Serial.println(&quot;off&quot;);              output2&#x3D;&quot;off&quot;;              digitalWrite(output, LOW);            &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥ä¸‹æ˜¯html</p><pre class="line-numbers language-html" data-language="html"><code class="language-html">client.println("<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>");client.println("<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"><span class="token selector">html</span> <span class="token punctuation">&#123;</span><span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span><span class="token property">font-family</span><span class="token punctuation">:</span> Arial<span class="token punctuation">;</span><span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>"<span class="token punctuation">)</span><span class="token punctuation">;</span>client.<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">".button &#123;background-color: #e0e252; border: none;color: white;padding: 15px 35px;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>client.<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"text-align: center;text-decoration: none;display: inline-block;font-size: 16px;&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>client.<span class="token function">println</span><span class="token punctuation">(</span>".button2 <span class="token punctuation">&#123;</span><span class="token property">background-color</span><span class="token punctuation">:</span> #b0b1a2<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span> 15px 32px<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>");client.println("<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>ESP32 Web Server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>");client.println("<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>GPIO-2  "+output2+"<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>");   if (output2=="off") &#123;  client.println("<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>&lt;a href=\"/2/on\">&lt;button class=\"button\">ON<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>");  client.println("<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>&lt;a href=\"/2/off\">&lt;button class=\"button button2\">OFF<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>");&#125; else if (output2=="on")&#123;  client.println("<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>&lt;a href=\"/2/on\">&lt;button class=\"button button2\">ON<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>");  client.println("<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>&lt;a href=\"/2/off\">&lt;button class=\"button\">OFF<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>");&#125;client.println("<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>");<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€å¾Œå®Œæˆå›æ‡‰,çµ‚æ­¢å®¢æˆ¶ç«¯å°ä¼ºæœç«¯çš„è«‹æ±‚</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">client.stop();<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="å¯¦é©—çµæœ"><a href="#å¯¦é©—çµæœ" class="headerlink" title="å¯¦é©—çµæœ"></a>å¯¦é©—çµæœ</h2><div class="video-container"><iframe src="https://www.youtube.com/embed/OmbY4UQ8Kcc" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webserver </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DeepSleepæ·±åº¦ç¡çœ çš„å¯¦é©—</title>
      <link href="/2021/08/29/deepsleep-shen-du-shui-mian-de-shi-yan/"/>
      <url>/2021/08/29/deepsleep-shen-du-shui-mian-de-shi-yan/</url>
      
        <content type="html"><![CDATA[<h2 id="ç‚ºä»€éº¼è¦è®“ESP32é€²å…¥æ·±åº¦ç¡çœ æ¨¡å¼"><a href="#ç‚ºä»€éº¼è¦è®“ESP32é€²å…¥æ·±åº¦ç¡çœ æ¨¡å¼" class="headerlink" title="ç‚ºä»€éº¼è¦è®“ESP32é€²å…¥æ·±åº¦ç¡çœ æ¨¡å¼?"></a>ç‚ºä»€éº¼è¦è®“ESP32é€²å…¥æ·±åº¦ç¡çœ æ¨¡å¼?</h2><p><strong><em>å…¶å¯¦æˆ‘ä¹Ÿæ˜¯æœ€è¿‘å‰›å­¸åˆ°é€™ä¸€å¡Šï¼Œæ‰€ä»¥å°±é †æ‰‹ç´€éŒ„ä¸‹ä¾†ã€‚</em></strong></p><p><strong><em>è¨˜å¾—ä»¥å‰åšéä¸€äº›è¦é›»æ± çš„æˆå“ï¼Œç™¼ç¾æ”¾ä¸€å¤©åŠå·¦å³å°±</em></strong></p><p><strong><em>æ²’é›»äº†ï¼Œå¾Œä¾†ç¶²è·¯ä¸Šæœå°‹ç›¸é—œçŸ¥è­˜æ‰çŸ¥é“Arduinoå’Œesp32</em></strong></p><p><strong><em>å®ƒå€‘éƒ½æœ‰ä½¿å…¶é€²å…¥æ·±åº¦ç¡çœ çš„æ–¹æ³•ã€‚</em></strong></p><p><strong><em>åœ¨æ·±åº¦ç¡çœ ä¸­ï¼Œå¯ä»¥ä½¿æ©Ÿæ¿é™ä½åŠŸè€—ï¼ŒCPUå’ŒWIFIéƒ½æœƒ</em></strong></p><p><strong>_åœæ­¢é‹ä½œï¼Œåªæœ‰ULPé‚„æœƒä»¥æœ€ä½åŠŸè€—é‹ä½œï¼Œé›–ç„¶ ESP32Â _</strong></p><p><strong><em>è™•æ–¼æ·±åº¦ç¡çœ æ¨¡å¼ï¼Œä½† RTC è¨˜æ†¶é«”ä¹Ÿä»ç„¶è™•æ–¼æ‰“é–‹ç‹€æ…‹ï¼Œ</em></strong></p><p><strong><em>å› æ­¤æˆ‘å€‘å¯ä»¥ç‚º ULP å…±åŒè™•ç†å™¨ç·¨å¯«ä¸€å€‹ç¨‹å¼ï¼Œä¸¦å°‡å…¶</em></strong></p><p><strong><em>å­˜å„²åœ¨ RTC è¨˜æ†¶é«”ä¸­ä»¥è¨ªå•é€±é‚Šè¨­å‚™ã€å…§éƒ¨å®šæ™‚å™¨å’Œå…§</em></strong></p><p><strong><em>éƒ¨æ„Ÿæ¸¬å™¨ã€‚</em></strong></p><h2 id="RTCå¼•è…³"><a href="#RTCå¼•è…³" class="headerlink" title="RTCå¼•è…³"></a>RTCå¼•è…³</h2><p><strong><em>ä¸‹åœ–é»ƒè‰²å€å¡Šçš„éƒ½å¯ä»¥ä½¿ç”¨RTC</em></strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4527766207386106731#"><img src="https://1.bp.blogspot.com/-Ap7xbLO-MAE/YM_mR7e9KwI/AAAAAAAAeUw/rcA6j1T1gKgaLSdPPXI5A2zfn467tEIJwCNcBGAsYHQ/w694-h412/ESP32-DOIT-DEVKIT-V1-Board-Pinout-30-GPIOs-Copy.png"></a></p><hr><h2 id="å–šé†’æ¨¡å¼"><a href="#å–šé†’æ¨¡å¼" class="headerlink" title="å–šé†’æ¨¡å¼"></a>å–šé†’æ¨¡å¼</h2><h3 id="ä¸»è¦æœ‰ç¨®å–šé†’æ¨¡å¼"><a href="#ä¸»è¦æœ‰ç¨®å–šé†’æ¨¡å¼" class="headerlink" title="ä¸»è¦æœ‰ç¨®å–šé†’æ¨¡å¼"></a>ä¸»è¦æœ‰ç¨®å–šé†’æ¨¡å¼</h3><ol><li> <em><strong>å®šæ™‚å™¨å–šé†’</strong></em></li><li> <em><strong>è§¸æ‘¸å–šé†’</strong></em></li><li> <em><strong>å¤–éƒ¨å–šé†’/å¤šç¨®ä¸åŒçš„å¤–éƒ¨å–šé†’</strong></em></li><li> <em><strong>ULPå–šé†’</strong></em></li></ol><hr><h2 id="1-å®šæ™‚å™¨å–šé†’æ¨¡å¼å¯¦é©—"><a href="#1-å®šæ™‚å™¨å–šé†’æ¨¡å¼å¯¦é©—" class="headerlink" title="1.å®šæ™‚å™¨å–šé†’æ¨¡å¼å¯¦é©—"></a>1.å®šæ™‚å™¨å–šé†’æ¨¡å¼å¯¦é©—</h2><p><strong><em>ESP32å¯é€²å…¥æ·±ç¡æ¨¡å¼ï¼Œä¸¦é è¨­æ™‚é–“å–šé†’</em></strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#define us_to_s 1000000#define time__to_sleep 5  RTC_DATA_ATTRÂ intÂ countÂ &#x3D;Â 0;  voidÂ print_wakeup_reason()&#123;Â Â esp_sleep_wakeup_cause_tÂ wakeup_reason;Â Â wakeup_reasonÂ &#x3D;Â esp_sleep_get_wakeup_cause();Â Â switchÂ (wakeup_reason)Â Â &#123;Â Â caseÂ ESP_SLEEP_WAKEUP_EXT0:Â Â Â Â Serial.println(&quot;WakeupÂ causedÂ byÂ externalÂ signalÂ usingÂ RTC_IO&quot;);Â Â Â Â break;Â Â caseÂ ESP_SLEEP_WAKEUP_EXT1:Â Â Â Â Serial.println(&quot;WakeupÂ causedÂ byÂ externalÂ signalÂ usingÂ RTC_CNTL&quot;);Â Â Â Â break;Â Â caseÂ ESP_SLEEP_WAKEUP_TIMER:Â Â Â Â Serial.println(&quot;WakeupÂ causedÂ byÂ timer&quot;);Â Â Â Â break;Â Â caseÂ ESP_SLEEP_WAKEUP_TOUCHPAD:Â Â Â Â Serial.println(&quot;WakeupÂ causedÂ byÂ touchpad&quot;);Â Â Â Â break;Â Â caseÂ ESP_SLEEP_WAKEUP_ULP:Â Â Â Â Serial.println(&quot;WakeupÂ causedÂ byÂ ULPÂ program&quot;);Â Â Â Â break;Â Â default:Â Â Â Â Serial.printf(&quot;WakeupÂ wasÂ notÂ causedÂ byÂ deepÂ sleep:Â %d\n&quot;,Â wakeup_reason);Â Â Â Â break;Â Â &#125;&#125;  voidÂ setup()&#123;Â Â Serial.begin(115200);Â Â delay(1000);Â Â ++count;Â Â Serial.println(&quot;bootÂ num:Â &quot;Â +Â String(count));Â Â print_wakeup_reason();Â Â esp_sleep_enable_timer_wakeup(us_to_sÂ *Â time_to_sleep);Â Â delay(1000);Â Â esp_deep_sleep_start();&#125;voidÂ loop()&#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä¸€é–‹å§‹è¨­å®šå¾®ç§’è½‰æˆç§’ï¼Œä¹Ÿå¯ä»¥ä»¥ç›´æ¥å¯«æˆ</strong>TIME_TO_SLEEPÂ  5000000</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#define us_TO_s 1000000#define TIME_TO_SLEEP  5   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>é€™ä¸€æ®µæ˜¯èªªè¦åœ¨RTCä¸Šä¿å­˜å–šé†’çš„æ¬¡æ•¸ï¼Œå¯ä»¥åœ¨æœ€å‰é¢åŠ ä¸ŠRTC_DATA_ATTR</strong></p><p>**_<em>ä½†æ˜¯åœ¨æŒ‰ä¸‹ENéµé‡å•“é€™å€‹æ•¸æ“šæœƒæµå¤±æ‰_</em>*</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">RTC_DATA_ATTR int count &#x3D; 0;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>é€™å€‹å‡½å¼ä¸»è¦æ˜¯è¨­å®šâ€è¢«æ›é†’çš„åŸå› â€</strong></p><pre class="line-numbers language-none"><code class="language-none">rst:0x5Â (DEEPSLEEP_RESET),boot:0x17Â (SPI_FAST_FLASH_BOOT)configsip:Â 0,Â SPIWP:0xeeclk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00mode:DIO,Â clockÂ div:2load:0x3fff0018,len:4load:0x3fff001c,len:1044load:0x40078000,len:10124load:0x40080400,len:5828entryÂ 0x400806a8bootÂ num:Â 2WakeupÂ causedÂ byÂ timeretsÂ JunÂ Â 8Â 2016Â 00:22:57  rst:0x5Â (DEEPSLEEP_RESET),boot:0x17Â (SPI_FAST_FLASH_BOOT)configsip:Â 0,Â SPIWP:0xeeclk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00mode:DIO,Â clockÂ div:2load:0x3fff0018,len:4load:0x3fff001c,len:1044load:0x40078000,len:10124load:0x40080400,len:5828entryÂ 0x400806a8bootÂ num:Â 3WakeupÂ causedÂ byÂ timeretsÂ JunÂ Â 8Â 2016Â 00:22:57  rst:0x5Â (DEEPSLEEP\_RESET),boot:0x17Â (SPI\_FAST\_FLASH\_BOOT)configsip:Â 0,Â SPIWP:0xeeclk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00mode:DIO,Â clockÂ div:2load:0x3fff0018,len:4load:0x3fff001c,len:1044load:0x40078000,len:10124load:0x40080400,len:5828entryÂ 0x400806a8bootÂ num:Â 4WakeupÂ causedÂ byÂ timeretsÂ JunÂ Â 8Â 2016Â 00:22:57<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p><strong>é€²å…¥åˆ°void setup(){}</strong></p><p><strong>è¨­å®šåºåˆ—åŸ çš„æ³¢ç‰¹ç‡</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Serial.begin(115200);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>æ¯æ¬¡è¢«å–šé†’ï¼Œcountå°±æœƒåŠ 1ï¼Œä¸¦è¢«å°å‡ºä¾†</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">++count; Serial.println(&quot;Boot number: &quot;   +   String(bootCount));<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>èª¿ç”¨å‰›æœ€å‰æ–¹é‚£å€‹è¢«å–šé†’çš„åŸå› å‡½å¼</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">print_wakeup_reason()<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å•“ç”¨å¹¾ç§’å¾Œï¼Œèª¿ç”¨ç¡çœ æ¨¡å¼çš„å‡½å¼</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">esp_sleep_enable_timer_wakeup(TIME_TO_SLEEP * uS_TO_S_FACTOR);esp_deep_sleep_start()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><hr><h2 id="å¯¦é©—çµæœ"><a href="#å¯¦é©—çµæœ" class="headerlink" title="å¯¦é©—çµæœ"></a>å¯¦é©—çµæœ</h2><p>ç´…è‰²å­—é«”æ˜¯æŒ‡é€²å…¥æ·±ç¡æ¨¡å¼</p><p>åœŸé»ƒè‰²å­—é«”æ˜¯æŒ‡è¢«å–šé†’çš„æ¬¡æ•¸</p><p>æ·±è—è‰²å­—é«”æ˜¯è¢«å–šé†’çš„åŸå› </p><pre class="line-numbers language-none"><code class="language-none">rst:0x5Â (DEEPSLEEP\_RESET),boot:0x17Â (SPI\_FAST\_FLASH\_BOOT)configsip:Â 0,Â SPIWP:0xeeclk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00mode:DIO,Â clockÂ div:2load:0x3fff0018,len:4load:0x3fff001c,len:1044load:0x40078000,len:10124load:0x40080400,len:5828entryÂ 0x400806a8bootÂ num:Â 2WakeupÂ causedÂ byÂ timeretsÂ JunÂ Â 8Â 2016Â 00:22:57  rst:0x5Â (DEEPSLEEP\_RESET),boot:0x17Â (SPI\_FAST\_FLASH\_BOOT)configsip:Â 0,Â SPIWP:0xeeclk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00mode:DIO,Â clockÂ div:2load:0x3fff0018,len:4load:0x3fff001c,len:1044load:0x40078000,len:10124load:0x40080400,len:5828entryÂ 0x400806a8bootÂ num:Â 3WakeupÂ causedÂ byÂ timeretsÂ JunÂ Â 8Â 2016Â 00:22:57  rst:0x5Â (DEEPSLEEP\_RESET),boot:0x17Â (SPI\_FAST\_FLASH\_BOOT)configsip:Â 0,Â SPIWP:0xeeclk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00mode:DIO,Â clockÂ div:2load:0x3fff0018,len:4load:0x3fff001c,len:1044load:0x40078000,len:10124load:0x40080400,len:5828entryÂ 0x400806a8bootÂ num:Â 4WakeupÂ causedÂ byÂ timeretsÂ JunÂ Â 8Â 2016Â 00:22:57<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ï¼’-è§¸æ‘¸å–šé†’å¯¦é©—"><a href="#ï¼’-è§¸æ‘¸å–šé†’å¯¦é©—" class="headerlink" title="ï¼’.è§¸æ‘¸å–šé†’å¯¦é©—"></a>ï¼’.è§¸æ‘¸å–šé†’å¯¦é©—</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4527766207386106731#"><img src="https://i0.wp.com/randomnerdtutorials.com/wp-content/uploads/2019/02/Zero_Touch_Wake_Up_bb.png?w=858&quality=100&strip=all&ssl=1"></a></p><p>å¾Œä¾†æˆ‘ç™¼ç¾ä¾†åœ¨Arduino IDEè£¡åˆ‡æ›åˆ°ESP32çš„æ¨¡å¼ä¸‹ï¼Œç¯„ä¾‹è£¡å°±æœ‰DEEP SLEEPçš„ç¯„ä¾‹å¯ç”¨</p><p>å°‡ç¯„ä¾‹è¼‰å…¥å¾Œï¼Œä¸Šå‚³ã€‚</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4527766207386106731#"><img src="https://1.bp.blogspot.com/-3tHh0qOHWtA/YNFMzOX5NfI/AAAAAAAAeVY/oDALi3RFu_43L-nOaPyxfx28RiB_6ypmwCNcBGAsYHQ/w603-h647/1.jpg"></a></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#define Threshold 40 RTC_DATA_ATTRÂ intÂ bootCountÂ &#x3D;Â 0;touch_pad_tÂ touchPin;voidÂ print_wakeup_reason()&#123;Â Â esp_sleep_wakeup_cause_tÂ wakeup_reason;Â Â wakeup_reasonÂ &#x3D;Â esp_sleep_get_wakeup_cause();Â Â switch(wakeup_reason)Â Â &#123;Â Â Â Â caseÂ ESP_SLEEP_WAKEUP_EXT0Â :Â Serial.println(&quot;WakeupÂ causedÂ byÂ externalÂ signalÂ usingÂ RTC_IO&quot;);Â break;Â Â Â Â caseÂ ESP_SLEEP_WAKEUP_EXT1Â :Â Serial.println(&quot;WakeupÂ causedÂ byÂ externalÂ signalÂ usingÂ RTC_CNTL&quot;);Â break;Â Â Â Â caseÂ ESP_SLEEP_WAKEUP_TIMERÂ :Â Serial.println(&quot;WakeupÂ causedÂ byÂ timer&quot;);Â break;Â Â Â Â caseÂ ESP_SLEEP_WAKEUP_TOUCHPADÂ :Â Serial.println(&quot;WakeupÂ causedÂ byÂ touchpad&quot;);Â break;Â Â Â Â caseÂ ESP_SLEEP_WAKEUP_ULPÂ :Â Serial.println(&quot;WakeupÂ causedÂ byÂ ULPÂ program&quot;);Â break;Â Â Â Â defaultÂ :Â Serial.printf(&quot;WakeupÂ wasÂ notÂ causedÂ byÂ deepÂ sleep:Â %d\\n&quot;,wakeup_reason);Â break;Â Â &#125;&#125;  voidÂ print_wakeup_touchpad()&#123;Â Â touchPinÂ &#x3D;Â esp_sleep_get_touchpad_wakeup_status();Â Â switch(touchPin)Â Â &#123;Â Â Â Â caseÂ 0Â Â :Â Serial.println(&quot;TouchÂ detectedÂ onÂ GPIOÂ 4&quot;);Â break;Â Â Â Â caseÂ 1Â Â :Â Serial.println(&quot;TouchÂ detectedÂ onÂ GPIOÂ 0&quot;);Â break;Â Â Â Â caseÂ 2Â Â :Â Serial.println(&quot;TouchÂ detectedÂ onÂ GPIOÂ 2&quot;);Â break;Â Â Â Â caseÂ 3Â Â :Â Serial.println(&quot;TouchÂ detectedÂ onÂ GPIOÂ 15&quot;);Â break;Â Â Â Â caseÂ 4Â Â :Â Serial.println(&quot;TouchÂ detectedÂ onÂ GPIOÂ 13&quot;);Â break;Â Â Â Â caseÂ 5Â Â :Â Serial.println(&quot;TouchÂ detectedÂ onÂ GPIOÂ 12&quot;);Â break;Â Â Â Â caseÂ 6Â Â :Â Serial.println(&quot;TouchÂ detectedÂ onÂ GPIOÂ 14&quot;);Â break;Â Â Â Â caseÂ 7Â Â :Â Serial.println(&quot;TouchÂ detectedÂ onÂ GPIOÂ 27&quot;);Â break;Â Â Â Â caseÂ 8Â Â :Â Serial.println(&quot;TouchÂ detectedÂ onÂ GPIOÂ 33&quot;);Â break;Â Â Â Â caseÂ 9Â Â :Â Serial.println(&quot;TouchÂ detectedÂ onÂ GPIOÂ 32&quot;);Â break;Â Â Â Â defaultÂ :Â Serial.println(&quot;WakeupÂ notÂ byÂ touchpad&quot;);Â break;Â Â &#125;&#125;voidÂ callback()&#123;&#125;voidÂ setup()&#123;Â Â Serial.begin(115200)Â Â delay(1000);Â Â Â ++bootCount;Â Â Serial.println(&quot;BootÂ number:Â &quot;Â +Â String(bootCount));Â Â print_wakeup_reason();Â Â print_wakeup_touchpad();Â Â touchAttachInterrupt(T4,Â callback,Â Threshold);Â Â esp_sleep_enable_touchpad_wakeup();Â Â Serial.println(&quot;GoingÂ toÂ sleepÂ now&quot;);Â Â esp_deep_sleep_start();Â Â Serial.println(&quot;ThisÂ willÂ neverÂ beÂ printed&quot;);&#125;voidÂ loop()&#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¨‹å¼ç¢¼è£¡é¢é€™å€‹æ˜¯çµ¦äºˆè§¸æ‘¸è§¸ç™¼çš„å€¼</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#define Threshold   40<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç•¶åœ¨è§¸æ‘¸å¼•è…³ä¸Šè®€å–çš„å€¼ä½æ–¼ Threshold è®Šé‡ä¸Šè¨­ç½®çš„å€¼æ™‚ï¼ŒESP32 å–šé†’ä¸¦åŸ·è¡Œå›èª¿å‡½æ•¸ã€‚<br>Callback() å‡½æ•¸åªæœ‰åœ¨ ESP32 è™•æ–¼å–šé†’ç‹€æ…‹æ™‚æ‰æœƒåŸ·è¡Œã€‚</p><p>æ‰€ä»¥å¦‚æœæ˜¯åœ¨å–šé†’çš„ç‹€æ…‹ä¸‹å£“è‘—è§¸æ‘¸è…³ä¸æ”¾é–‹ï¼Œä¸¦ä¸æœƒåŸ·è¡Œcallback()å›èª¿ã€‚</p><p>å¦‚æœæ˜¯åœ¨ç¡çœ ç‹€æ…‹ä¸‹ç¢°äº†ä¸€ä¸‹å¼•è…³é¦¬ä¸Šæ”¾é–‹ï¼Œé€™æ¨£ä¹Ÿä¸æœƒåŸ·è¡Œcallback()å›èª¿ã€‚</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">touchAttachInterrupt(T3, callback, Threshold); <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>callback() å‡½æ•¸æ˜¯ç©ºçš„</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">void  callback()&#123;   &#x2F;&#x2F;placeholder callback function   &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¥ä¸‹ä¾†ï¼Œä½¿ç”¨ esp_sleep_enable_touchpad_wakeup() å‡½æ•¸å°‡è§¸æ‘¸å¼•è…³è¨­ç½®ç‚ºå–šé†’æºã€‚</p><p>esp_sleep_enable_touchpad_wakeup()</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4527766207386106731#"><img src="https://lh3.googleusercontent.com/-gTuSGE2uzFA/YNFSKM2L1WI/AAAAAAAAeVg/mSIR56s4R8QZhOw7ylC3CoBbSPiYcyoygCNcBGAsYHQ/s1600/1624330763119130-0.png"></a> </p><hr><h2 id="3-å¤–éƒ¨å–šé†’-ext0"><a href="#3-å¤–éƒ¨å–šé†’-ext0" class="headerlink" title="3.å¤–éƒ¨å–šé†’ (ext0)"></a>3.å¤–éƒ¨å–šé†’ (ext0)</h2><p>è¦ä½¿ç”¨æ­¤å–šé†’ï¼Œè«‹ä½¿ç”¨ä»¥ä¸‹å‡½æ•¸ï¼š  </p><p>Esp_sleep_enable_ext0_wakeupï¼ˆGPIO_NUM_Xï¼Œlevelï¼‰<br>æ­¤å‡½æ•¸æ¥å—æ‚¨è¦ä½¿ç”¨çš„å¼•è…³ä½œç‚ºç¬¬ä¸€å€‹åƒæ•¸ï¼Œæ ¼å¼ç‚º GPIO_NUM_Xï¼Œå…¶ä¸­ X è¡¨ç¤ºè©²å¼•è…³çš„ GPIO ç·¨è™Ÿã€‚  </p><p>ç¬¬äºŒå€‹åƒæ•¸ level å¯ä»¥æ˜¯ 1 æˆ– 0ã€‚é€™è¡¨ç¤ºå°‡è§¸ç™¼å–šé†’çš„ GPIO ç‹€æ…‹ã€‚</p><p>æ³¨æ„ï¼šä½¿ç”¨æ­¤å–šé†’ï¼Œåªèƒ½ä½¿ç”¨ RTC GPIO å¼•è…³ã€‚</p><blockquote><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4527766207386106731#"><img src="https://i1.wp.com/randomnerdtutorials.com/wp-content/uploads/2019/02/external_wake_up_button_bb.png?w=1134&quality=100&strip=all&ssl=1"></a></p></blockquote><p><strong>å¯ä»¥åœ¨ç¯„ä¾‹è£¡è¼‰å…¥å¦‚ä¸‹ç¨‹å¼ç¢¼</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4527766207386106731#"><img src="https://1.bp.blogspot.com/-E9SwEIStzFc/YNKgrFbR7fI/AAAAAAAAeVo/OtrrY-gkN-QraG7XaiuSA6VUX-pik6F2wCNcBGAsYHQ/w655-h549/2.jpg"></a></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">&gt; &#x2F;*&gt; &gt; DeepÂ SleepÂ withÂ ExternalÂ WakeÂ Up&gt; &gt; &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt; &gt; ThisÂ codeÂ displaysÂ howÂ toÂ useÂ deepÂ sleepÂ with&gt; &gt; anÂ externalÂ triggerÂ asÂ aÂ wakeÂ upÂ sourceÂ andÂ how&gt; &gt; toÂ storeÂ dataÂ inÂ RTCÂ memoryÂ toÂ useÂ itÂ overÂ reboots&gt; &gt;   &gt; &gt; ThisÂ codeÂ isÂ underÂ PublicÂ DomainÂ License.&gt; &gt; &gt; HardwareÂ Connections&gt; &gt; &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt; &gt; PushÂ ButtonÂ toÂ GPIOÂ 33Â pulledÂ downÂ withÂ aÂ 10KÂ Ohm&gt; &gt; resistor&gt;&gt; &gt; NOTE:&gt; &gt; &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt; &gt; OnlyÂ RTCÂ IOÂ canÂ beÂ usedÂ asÂ aÂ sourceÂ forÂ externalÂ wake&gt; &gt; source.Â TheyÂ areÂ pins:Â 0,2,4,12-15,25-27,32-39.&gt; &gt; &gt; Author:&gt; &gt; PranavÂ CherukupalliÂ &lt;cherukupallip@gmail.com&gt;&gt; &gt; *&#x2F;&gt; &gt; &gt; #define BUTTON_PIN_BITMASK 0x200000000Â &#x2F;&#x2F;Â 2^33Â inÂ hex&gt; &gt;   &gt; &gt; RTC_DATA_ATTRÂ intÂ bootCountÂ &#x3D;Â 0;&gt;&gt; &gt; &#x2F;*&gt; &gt; MethodÂ toÂ printÂ theÂ reasonÂ byÂ whichÂ ESP32&gt; &gt; hasÂ beenÂ awakenÂ fromÂ sleep&gt; &gt; *&#x2F;&gt; &gt; voidÂ print_wakeup_reason()&#123;&gt; &gt; Â Â esp_sleep_wakeup_cause_tÂ wakeup_reason;&gt;&gt; &gt; Â Â wakeup_reasonÂ &#x3D;Â esp_sleep_get_wakeup_cause();&gt; &gt; &gt; Â Â switch(wakeup_reason)&gt; &gt; Â Â &#123;&gt; &gt; Â Â Â Â caseÂ ESP_SLEEP_WAKEUP_EXT0Â :Â Serial.println(&quot;WakeupÂ causedÂ byÂ externalÂ signalÂ usingÂ RTC_IO&quot;);Â break;&gt; &gt; Â Â Â Â caseÂ ESP_SLEEP_WAKEUP_EXT1Â :Â Serial.println(&quot;WakeupÂ causedÂ byÂ externalÂ signalÂ usingÂ RTC_CNTL&quot;);Â break;&gt; &gt; Â Â Â Â caseÂ ESP_SLEEP_WAKEUP_TIMERÂ :Â Serial.println(&quot;WakeupÂ causedÂ byÂ timer&quot;);Â break;&gt; &gt; Â Â Â Â caseÂ ESP_SLEEP_WAKEUP_TOUCHPADÂ :Â Serial.println(&quot;WakeupÂ causedÂ byÂ touchpad&quot;);Â break;&gt; &gt; Â Â Â Â caseÂ ESP_SLEEP_WAKEUP_ULPÂ :Â Serial.println(&quot;WakeupÂ causedÂ byÂ ULPÂ program&quot;);Â break;&gt; &gt; Â Â Â Â defaultÂ :Â Serial.printf(&quot;WakeupÂ wasÂ notÂ causedÂ byÂ deepÂ sleep:Â %d\\n&quot;,wakeup_reason);Â break;&gt; &gt; Â Â &#125;&gt; &gt; &#125;&gt; &gt;   &gt; &gt; voidÂ setup()&#123;&gt; &gt; Â Â Serial.begin(115200);&gt; &gt; Â Â delay(1000);Â &#x2F;&#x2F;TakeÂ someÂ timeÂ toÂ openÂ upÂ theÂ SerialÂ Monitor&gt; &gt; &gt; Â Â &#x2F;&#x2F;IncrementÂ bootÂ numberÂ andÂ printÂ itÂ everyÂ reboot&gt; &gt; Â Â ++bootCount;&gt; &gt; Â Â Serial.println(&quot;BootÂ number:Â &quot;Â +Â String(bootCount));&gt; &gt;   &gt; Â Â &#x2F;&#x2F;PrintÂ theÂ wakeupÂ reasonÂ forÂ ESP32&gt; &gt; Â Â print_wakeup_reason();&gt; &gt;  &gt; Â Â &#x2F;*&gt; &gt; Â Â FirstÂ weÂ configureÂ theÂ wakeÂ upÂ source&gt; &gt; Â Â WeÂ setÂ ourÂ ESP32Â toÂ wakeÂ upÂ forÂ anÂ externalÂ trigger.&gt; &gt; Â Â ThereÂ areÂ twoÂ typesÂ forÂ ESP32,Â ext0Â andÂ ext1Â .&gt; &gt; Â Â ext0Â usesÂ RTC_IOÂ toÂ wakeupÂ thusÂ requiresÂ RTCÂ peripherals&gt; &gt; Â Â toÂ beÂ onÂ whileÂ ext1Â usesÂ RTCÂ ControllerÂ soÂ doesntÂ need&gt; &gt; Â Â peripheralsÂ toÂ beÂ poweredÂ on.&gt; &gt; Â Â NoteÂ thatÂ usingÂ internalÂ pullups&#x2F;pulldownsÂ alsoÂ requires&gt; &gt; Â Â RTCÂ peripheralsÂ toÂ beÂ turnedÂ on.&gt; &gt; Â Â *&#x2F;&gt; &gt; Â Â esp_sleep_enable_ext0_wakeup(GPIO_NUM_33,1);Â &#x2F;&#x2F;1Â &#x3D;Â High,Â 0Â &#x3D;Â Low&gt; &gt;   &gt; &gt; Â Â &#x2F;&#x2F;IfÂ youÂ wereÂ toÂ useÂ ext1,Â youÂ wouldÂ useÂ itÂ like&gt; &gt; Â Â &#x2F;&#x2F;esp_sleep_enable_ext1_wakeup(BUTTON_PIN_BITMASK,ESP_EXT1_WAKEUP_ANY_HIGH);&gt; &gt;   &gt; &gt; Â Â &#x2F;&#x2F;GoÂ toÂ sleepÂ now&gt; &gt; Â Â Serial.println(&quot;GoingÂ toÂ sleepÂ now&quot;);&gt; &gt; Â Â esp_deep_sleep_start();&gt; &gt; Â Â Serial.println(&quot;ThisÂ willÂ neverÂ beÂ printed&quot;);&gt; &gt; &#125;&gt; &gt;   &gt; &gt; voidÂ loop()&#123;&gt; &gt; Â Â &#x2F;&#x2F;ThisÂ isÂ notÂ goingÂ toÂ beÂ called&gt; &gt; &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>åœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œæˆ‘å€‘ä½¿ç”¨äº†åœ¨ä»£ç¢¼é–‹é ­å®šç¾©çš„è®Šé‡ BUTTON_PIN_BITMASKï¼š</p></blockquote><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#define   BUTTON\_PIN\_BITMASK   0x200000000 &#x2F;&#x2F; 2^33 in hex<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŒ‰éˆ•é€£æ¥åˆ° GPIO 33ã€‚è¦ç²å– GPIO 33 çš„åå…­é€²ä½ç¢¼ï¼š  </p><p>è¨ˆç®— 2çš„33æ¬¡æ–¹,æ‡‰è©²å¾—åˆ° 8589934592,å°‡è©²æ•¸å­— (8589934592) è½‰æ›ç‚ºåå…­é€²åˆ¶ã€‚æ‚¨å¯ä»¥è½‰åˆ°æ­¤è½‰æ›å™¨ä¾†åŸ·è¡Œæ­¤æ“ä½œã€‚</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">esp_sleep_enable_ext0_wakeup(GPIO_NUM_33,1);   &#x2F;&#x2F;1 &#x3D; High, 0 &#x3D; Low<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ï¼ƒå¯ä»¥ä½¿ç”¨ä»»ä½•å…¶ä»– RTC GPIO å¼•è…³ä¾†ä»£æ›¿ GPIO 33</p><div class="video-container"><iframe src="https://www.youtube.com/embed/twRIlLu60Y0" frameborder="0" loading="lazy" allowfullscreen></iframe></div><hr><h2 id="4-å¤–éƒ¨å–šé†’-ext1"><a href="#4-å¤–éƒ¨å–šé†’-ext1" class="headerlink" title="4.å¤–éƒ¨å–šé†’ (ext1)"></a>4.å¤–éƒ¨å–šé†’ (ext1)</h2><p>åœ¨é€™è£¡ä¸ä½¿ç”¨esp_sleep_enable_ext0_wakeup()ï¼Œè€Œæ˜¯ä½¿ç”¨</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">esp_sleep_enable_ext1_wakeup()&#96;&#96;&#96;c#&#x2F;*DeepÂ SleepÂ withÂ ExternalÂ WakeÂ Up&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;ThisÂ codeÂ displaysÂ howÂ toÂ useÂ deepÂ sleepÂ withanÂ externalÂ triggerÂ asÂ aÂ wakeÂ upÂ sourceÂ andÂ howtoÂ storeÂ dataÂ inÂ RTCÂ memoryÂ toÂ useÂ itÂ overÂ reboots  ThisÂ codeÂ isÂ underÂ PublicÂ DomainÂ License.  HardwareÂ Connections&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;PushÂ ButtonÂ toÂ GPIOÂ 33Â pulledÂ downÂ withÂ aÂ 10KÂ Ohmresistor  NOTE:&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;OnlyÂ RTCÂ IOÂ canÂ beÂ usedÂ asÂ aÂ sourceÂ forÂ externalÂ wakesource.Â TheyÂ areÂ pins:Â 0,2,4,12-15,25-27,32-39.  Author:PranavÂ CherukupalliÂ &lt;cherukupallip@gmail.com&gt;*&#x2F;#define BUTTON_PIN_BITMASK 0x8004Â &#x2F;&#x2F;Â GPIOsÂ 2Â andÂ 15RTC_DATA_ATTRÂ intÂ bootCountÂ &#x3D;Â 0;&#x2F;*MethodÂ toÂ printÂ theÂ reasonÂ byÂ whichÂ ESP32hasÂ beenÂ awakenÂ fromÂ sleep*&#x2F;voidÂ print_wakeup_reason()&#123;Â Â esp_sleep_wakeup_cause_tÂ wakeup_reason;Â Â wakeup_reasonÂ &#x3D;Â esp_sleep_get_wakeup_cause();Â Â switch(wakeup_reason)Â Â &#123;Â Â Â Â caseÂ ESP_SLEEP_WAKEUP_EXT0Â :Â Serial.println(&quot;WakeupÂ causedÂ byÂ externalÂ signalÂ usingÂ RTC_IO&quot;);Â break;Â Â Â Â caseÂ ESP_SLEEP_WAKEUP_EXT1Â :Â Serial.println(&quot;WakeupÂ causedÂ byÂ externalÂ signalÂ usingÂ RTC_CNTL&quot;);Â break;Â Â Â Â caseÂ ESP_SLEEP_WAKEUP_TIMERÂ :Â Serial.println(&quot;WakeupÂ causedÂ byÂ timer&quot;);Â break;Â Â Â Â caseÂ ESP_SLEEP_WAKEUP_TOUCHPADÂ :Â Serial.println(&quot;WakeupÂ causedÂ byÂ touchpad&quot;);Â break;Â Â Â Â caseÂ ESP_SLEEP_WAKEUP_ULPÂ :Â Serial.println(&quot;WakeupÂ causedÂ byÂ ULPÂ program&quot;);Â break;Â Â Â Â defaultÂ :Â Serial.printf(&quot;WakeupÂ wasÂ notÂ causedÂ byÂ deepÂ sleep:Â %d\\n&quot;,wakeup_reason);Â break;Â Â &#125;&#125;&#x2F;*MethodÂ toÂ printÂ theÂ GPIOÂ thatÂ triggeredÂ theÂ wakeup*&#x2F;voidÂ print_GPIO_wake_up()&#123;Â Â uint64_tÂ GPIO_reasonÂ &#x3D;Â esp_sleep_get_ext1_wakeup_status();Â Â Serial.print(&quot;GPIOÂ thatÂ triggeredÂ theÂ wakeÂ up:Â GPIOÂ &quot;);Â Â Serial.println((log(GPIO_reason))&#x2F;log(2),Â 0);&#125;voidÂ setup()&#123;Â Â Serial.begin(115200);Â Â delay(1000);Â &#x2F;&#x2F;TakeÂ someÂ timeÂ toÂ openÂ upÂ theÂ SerialÂ Monitor  Â Â &#x2F;&#x2F;IncrementÂ bootÂ numberÂ andÂ printÂ itÂ everyÂ rebootÂ Â ++bootCount;Â Â Serial.println(&quot;BootÂ number:Â &quot;Â +Â String(bootCount));  Â Â &#x2F;&#x2F;PrintÂ theÂ wakeupÂ reasonÂ forÂ ESP32Â Â print_wakeup_reason();  Â Â &#x2F;&#x2F;PrintÂ theÂ GPIOÂ usedÂ toÂ wakeÂ upÂ Â print\_GPIO\_wake_up();Â Â &#x2F;*Â Â FirstÂ weÂ configureÂ theÂ wakeÂ upÂ sourceÂ Â WeÂ setÂ ourÂ ESP32Â toÂ wakeÂ upÂ forÂ anÂ externalÂ trigger.Â Â ThereÂ areÂ twoÂ typesÂ forÂ ESP32,Â ext0Â andÂ ext1Â .Â Â ext0Â usesÂ RTC_IOÂ toÂ wakeupÂ thusÂ requiresÂ RTCÂ peripheralsÂ Â toÂ beÂ onÂ whileÂ ext1Â usesÂ RTCÂ ControllerÂ soÂ doesntÂ needÂ Â peripheralsÂ toÂ beÂ poweredÂ on.Â Â NoteÂ thatÂ usingÂ internalÂ pullups&#x2F;pulldownsÂ alsoÂ requiresÂ Â RTCÂ peripheralsÂ toÂ beÂ turnedÂ on.Â Â *&#x2F;Â Â &#x2F;&#x2F;esp_deep_sleep_enable_ext0_wakeup(GPIO\_NUM_15,1);Â &#x2F;&#x2F;1Â &#x3D;Â High,Â 0Â &#x3D;Â Low  Â Â &#x2F;&#x2F;IfÂ youÂ wereÂ toÂ useÂ ext1,Â youÂ wouldÂ useÂ itÂ likeÂ Â esp_sleep_enable_ext1_wakeup(BUTTON_PIN_BITMASK,ESP_EXT1_WAKEUP_ANY_HIGH);Â Â &#x2F;&#x2F;GoÂ toÂ sleepÂ nowÂ Â Serial.println(&quot;GoingÂ toÂ sleepÂ now&quot;);Â Â delay(1000);Â Â esp_deep_sleep_start();Â Â Serial.println(&quot;ThisÂ willÂ neverÂ beÂ printed&quot;);&#125;  voidÂ loop()&#123;Â Â &#x2F;&#x2F;ThisÂ isÂ notÂ goingÂ toÂ beÂ called&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>0x8004æ€éº¼ä¾†çš„?</strong></p><p>è¨ˆç®— 2^2 + 2^15ã€‚ä½ æ‡‰è©²å¾—åˆ° 32772</p><p>å°‡è©²æ•¸å­—è½‰æ›ç‚ºåå…­é€²åˆ¶ã€‚ä½ æ‡‰è©²å¾—åˆ°ï¼š8004</p><p>åœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œæˆ‘å€‘ä½¿ç”¨äº†åœ¨ä»£ç¢¼é–‹é ­å®šç¾©çš„è®Šé‡Â BUTTON_PIN_BITMASK</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BUTTON_PIN_BITMASK</span>   <span class="token expression"><span class="token number">0x8004</span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç•¶æ‚¨ä½¿ç”¨å¤šå€‹å¼•è…³ä¾†å–šé†’ ESP32 æ™‚ï¼ŒçŸ¥é“æ˜¯å“ªå€‹å¼•è…³å¼•èµ·äº†å–šé†’æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚ç‚ºæ­¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹åŠŸèƒ½ï¼š</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">esp_sleep_get_ext1_wakeup_status()<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è©²å‡½æ•¸è¿”å›ä¸€å€‹åŸºæ•¸2ï¼Œèˆ‡GPIOè™Ÿç¢¼ä½œç‚ºæŒ‡æ•¸ï¼š2 ^ï¼ˆGPIO_NUMBERï¼‰ã€‚å› æ­¤ï¼Œåœ¨å°æ•¸å¾—åˆ°GPIOï¼Œä½ éœ€è¦åšä»¥ä¸‹è¨ˆç®—ï¼š</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">GPIO &#x3D; log(GPIO_NUMBER)&#x2F;log(2)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å…¶å®ƒç¨‹å¼ç¢¼å¦‚åŒå‰é¢è©¦é©—</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4527766207386106731#"><img src="https://i1.wp.com/randomnerdtutorials.com/wp-content/uploads/2019/02/external_wake_up_2buttons_bb.png?w=984&quality=100&strip=all&ssl=1"></a></p><p><strong>å°‡ç¨‹å¼ç¢¼ä¸Šå‚³å¾Œå¯ä»¥çœ‹åˆ°æŒ‰å£“å“ªå€‹GPIOæœƒé¡¯ç¤ºåœ¨ç›£æ¸¬çª—å£</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4527766207386106731#"><img src="https://1.bp.blogspot.com/-YanqfR__Opo/YNWKA45FOQI/AAAAAAAAeWE/pkp3y8n5qa8WHrloC2ZCECaWWHN5kTwuACNcBGAsYHQ/w674-h314/1.jpg"></a></p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> deep sleep </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DHT11/DHT12æº«æº¼åº¦å‚³æ„Ÿå™¨å¯¦é©—</title>
      <link href="/2021/08/29/dht11-dht12-wen-shi-du-chuan-gan-qi-shi-yan/"/>
      <url>/2021/08/29/dht11-dht12-wen-shi-du-chuan-gan-qi-shi-yan/</url>
      
        <content type="html"><![CDATA[<h1 id="DHT11-DHT12æº«æº¼åº¦å‚³æ„Ÿå™¨å¯¦é©—"><a href="#DHT11-DHT12æº«æº¼åº¦å‚³æ„Ÿå™¨å¯¦é©—" class="headerlink" title="DHT11/DHT12æº«æº¼åº¦å‚³æ„Ÿå™¨å¯¦é©—"></a>DHT11/DHT12æº«æº¼åº¦å‚³æ„Ÿå™¨å¯¦é©—</h1><h6 id="tags-esp32-dht11-dht12"><a href="#tags-esp32-dht11-dht12" class="headerlink" title="tags: esp32 dht11/dht12"></a>tags: <code>esp32</code> <code>dht11/dht12</code></h6><p>Â <strong>åƒè€ƒç¶²å€</strong>-[<a href="https://randomnerdtutorials.com/esp32-dht11-dht22-temperature-humidity-sensor-arduino-ide/]">https://randomnerdtutorials.com/esp32-dht11-dht22-temperature-humidity-sensor-arduino-ide/]</a>(<a href="https://draft.blo/">https://draft.blo</a> gger.com/blog/post/edit/3809681606094011522/8795709619283851665?hl=zh-TW#)</p><p><em>æº«æº¼åº¦å‚³æ„Ÿå™¨åœ¨æ§åˆ¶æ¿å­¸ç¿’è£¡æ˜¯å¿…å‚™å…¥é–€å¯¦ä½œçš„èª²é¡Œ</em></p><p><em>å®ƒåŒ…å«DHT11/DHT12é€™å…©ç¨®å½¢å¼,é€™äº›å‚³æ„Ÿå™¨åŒ…å«ä¸€å€‹</em></p><p><em>èŠ¯ç‰‡ï¼Œå¯ä»¥é€²è¡Œæ¨¡æ“¬åˆ°æ•¸å­—çš„è½‰æ›ï¼Œä¸¦è¼¸å‡ºå¸¶æœ‰æº«åº¦å’Œæ¿•åº¦</em></p><p><em>çš„æ•¸å­—ä¿¡è™Ÿã€‚é€™ä½¿å¾—å®ƒå€‘å¾ˆå®¹æ˜“èˆ‡ä»»ä½•å¾®æ§åˆ¶å™¨ä¸€èµ·ä½¿ç”¨ã€‚</em></p><p>_DHT11 å’Œ DHT22 éå¸¸ç›¸ä¼¼ï¼Œä½†å®ƒå€‘çš„è¦æ ¼ä¸åŒã€‚</p><hr><p>_DHT11 çš„ç¯„åœæ›´å°ï¼Œç²¾åº¦ä¹Ÿæ›´ä½ã€‚ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥æ¯ç§’è«‹æ±‚å‚³æ„Ÿå™¨è®€æ•¸ã€‚å®ƒä¹Ÿä¾¿å®œä¸€é»ã€‚<br>_</p><p><em>DHT22å‚³æ„Ÿå™¨å…·æœ‰æ›´å¥½çš„åˆ†è¾¨ç‡å’Œæ›´å¯¬çš„æº«æ¿•åº¦æ¸¬é‡ç¯„åœã€‚ä½†æ˜¯ï¼Œå®ƒæœ‰é»è²´ï¼Œä¸¦ä¸”æ‚¨</em></p><p><em>åªèƒ½ä»¥ 2 ç§’çš„é–“éš”è«‹æ±‚è®€æ•¸ã€‚</em></p><h2 id="æ¥è…³"><a href="#æ¥è…³" class="headerlink" title="æ¥è…³"></a>æ¥è…³</h2><p><em>DHT å‚³æ„Ÿå™¨æœ‰å››å€‹å¼•è…³ï¼Œå¦‚ä¸‹åœ–æ‰€ç¤ºã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨å°‡ DHT å‚³æ„Ÿå™¨å®‰è£åœ¨åˆ†ç·šæ¿ä¸­ï¼Œå‰‡å®ƒåªæœ‰ä¸‰å€‹å¼•è…³ï¼Œä¸¦ä¸”åœ¨å¼•è…³ 2 ä¸Šå¸¶æœ‰ä¸€å€‹å…§éƒ¨ä¸Šæ‹‰é›»é˜»ã€‚</em></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8795709619283851665?hl=zh-TW#"><img src="https://i2.wp.com/randomnerdtutorials.com/wp-content/uploads/2019/04/dht22-pinout.png?resize=138,300&quality=100&strip=all&ssl=1"></a></p><p><em>ä¸‹è¡¨é¡¯ç¤ºäº† DHT22/DHT11 å¼•è…³æ’åˆ—ã€‚ç•¶å‚³æ„Ÿå™¨é¢å‘æ‚¨æ™‚ï¼Œå¼•è…³ç·¨è™Ÿå¾å·¦åˆ°å³å¾ 1 é–‹å§‹</em></p><p>| DHT pin | Connect to |<br>| 1 | 3.3V |<br>| 2 | Any digital GPIO; also connect a 10k Ohm pull-up resistor |<br>| 3 | Donâ€™t connect |<br>| 4 | GND |</p><h2 id="æ‰€é ˆææ–™"><a href="#æ‰€é ˆææ–™" class="headerlink" title="æ‰€é ˆææ–™"></a>æ‰€é ˆææ–™</h2><ul><li>  ESP32</li><li>  DHT11æˆ–DHT22æº«æ¿•åº¦å‚³æ„Ÿå™¨</li><li>  10k æ­å§†é›»é˜»</li><li>  éºµåŒ…æ¿</li><li>  è·³ç·š</li></ul><hr><h2 id="æ¥ç·šåœ–"><a href="#æ¥ç·šåœ–" class="headerlink" title="æ¥ç·šåœ–"></a>æ¥ç·šåœ–</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8795709619283851665?hl=zh-TW#"><img src="https://i0.wp.com/randomnerdtutorials.com/wp-content/uploads/2019/04/dht_esp32_bb.png?w=714&quality=100&strip=all&ssl=1"></a></p><hr><p>ä¸‹è¼‰æ‰€é ˆçš„å‡½å¼åº«</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8795709619283851665?hl=zh-TW#">Adafruit_Sensor</a>  </p><p>åŒ¯å…¥ç¯„ä¾‹æª”</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;Adafruit_Sensor.h&gt;#include &lt;DHT.h&gt;#include &lt;DHT_U.h&gt;  #define DHTPIN 4Â Â Â Â Â &#x2F;&#x2F;Â DigitalÂ pinÂ connectedÂ toÂ theÂ DHTÂ sensorÂ &#x2F;&#x2F;Â FeatherÂ HUZZAHÂ ESP8266Â note:Â useÂ pinsÂ 3,Â 4,Â 5,Â 12,Â 13Â orÂ 14Â --&#x2F;&#x2F;Â PinÂ 15Â canÂ workÂ butÂ DHTÂ mustÂ beÂ disconnectedÂ duringÂ programÂ upload.  &#x2F;&#x2F;Â UncommentÂ theÂ typeÂ ofÂ sensorÂ inÂ use:#define DHTTYPE DHT11Â Â Â Â Â &#x2F;&#x2F;Â DHTÂ 11&#x2F;&#x2F;#defineÂ DHTTYPEÂ Â Â Â DHT22Â Â Â Â Â &#x2F;&#x2F;Â DHTÂ 22Â (AM2302)&#x2F;&#x2F;#defineÂ DHTTYPEÂ Â Â Â DHT21Â Â Â Â Â &#x2F;&#x2F;Â DHTÂ 21Â (AM2301)  &#x2F;&#x2F;Â SeeÂ guideÂ forÂ detailsÂ onÂ sensorÂ wiringÂ andÂ usage:&#x2F;&#x2F;Â Â Â https:&#x2F;&#x2F;learn.adafruit.com&#x2F;dht&#x2F;overview  DHT_UnifiedÂ dht(DHTPIN,Â DHTTYPE);  uint32_tÂ delayMS;  voidÂ setup()Â &#123;Â Â Serial.begin(115200);Â Â &#x2F;&#x2F;Â InitializeÂ device.Â Â dht.begin();&#125;  voidÂ loop()Â &#123;Â Â &#x2F;&#x2F;Â DelayÂ betweenÂ measurements.Â Â delay(2000);Â Â &#x2F;&#x2F;Â GetÂ temperatureÂ eventÂ andÂ printÂ itsÂ value.Â Â sensors\_event\_tÂ event;Â Â dht.temperature().getEvent(&amp;event);Â Â ifÂ (isnan(event.temperature))Â &#123;Â Â Â Â Serial.println(F(&quot;ErrorÂ readingÂ temperature!&quot;));Â Â &#125;Â Â elseÂ &#123;Â Â Â Â Serial.print(F(&quot;Temperature:Â &quot;));Â Â Â Â Serial.print(event.temperature);Â Â Â Â Serial.println(F(&quot;Â°C&quot;));Â Â &#125;Â Â &#x2F;&#x2F;Â GetÂ humidityÂ eventÂ andÂ printÂ itsÂ value.Â Â dht.humidity().getEvent(&amp;event);Â Â ifÂ (isnan(event.relative_humidity))Â &#123;Â Â Â Â Serial.println(F(&quot;ErrorÂ readingÂ humidity!&quot;));Â Â &#125;Â Â elseÂ &#123;Â Â Â Â Serial.print(F(&quot;Humidity:Â &quot;));Â Â Â Â Serial.print(event.relative_humidity);Â Â Â Â Serial.println(F(&quot;%&quot;));Â Â &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/8795709619283851665?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-5Zp3nVebHME/YOPu0xLelvI/AAAAAAAAeZY/hXFOvxMB5WYGya2btew2FDpecuWGw4oUQCNcBGAsYHQ/w510-h226/DHT-C.jpg"></a></p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dht11/dht12 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¶…éŸ³æ³¢&amp;0.96OLED-ESP32</title>
      <link href="/2021/08/29/chao-yin-bo-0-96oled-esp32/"/>
      <url>/2021/08/29/chao-yin-bo-0-96oled-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="è¶…éŸ³æ³¢-amp-0-96OLED-ESP32"><a href="#è¶…éŸ³æ³¢-amp-0-96OLED-ESP32" class="headerlink" title="è¶…éŸ³æ³¢&amp;0.96OLED-ESP32"></a>è¶…éŸ³æ³¢&amp;0.96OLED-ESP32</h1><h6 id="tags-esp32-HC-SR04-è¶…éŸ³æ³¢æ¨¡çµ„"><a href="#tags-esp32-HC-SR04-è¶…éŸ³æ³¢æ¨¡çµ„" class="headerlink" title="tags: esp32 HC-SR04 è¶…éŸ³æ³¢æ¨¡çµ„"></a>tags: <code>esp32</code> <code>HC-SR04</code> <code>è¶…éŸ³æ³¢æ¨¡çµ„</code></h6><p><strong>0.96OLEDå¯¦ä½œåƒè€ƒ</strong>-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4510305853656321015#">https://esp32-blairan.blogspot.com/2021/05/091oled-esp32.html</a></p><p><strong>è¶…éŸ³æ³¢(Arduino)å¯¦ä½œåƒè€ƒ</strong>-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4510305853656321015#">https://blairandreamwork.blogspot.com/2021/05/hc-sr04.html</a></p><p><strong>è¶…éŸ³æ³¢å’ŒArduinoä¸Šçš„æ¨¡çµ„å¤§åŒå°ç¾©,ä¸éæˆ‘ä½¿ç”¨çš„æ¨¡çµ„æ¯”ä¸€èˆ¬ç°¡å–®å¤šäº†,çœå»</strong></p><p><strong>è¨ˆç®—,ç›´æ¥å‘¼å«å‡½å¼å°±èƒ½å–å¾—incå’Œcmã€‚</strong></p><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/4510305853656321015#"><img src="https://1.bp.blogspot.com/-vO1z_SK7Oh8/YOfhLRPWtII/AAAAAAAAeaw/vccMexvBlicqE1OUOSTG8UonqgV6fIe6wCNcBGAsYHQ/w698-h338/%25E4%25B8%258B%25E8%25BC%2589.jpg"></a></p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€“Â Â Â Â Â  â€”â€”â€”â€”â€”â€”â€”Â Â Â Â Â </p><p>//Â Â *Â |Â HC-SC04Â |Â ESP32 Â |Â Â Â Â Â |  OLED | ESP32 |</p><p>//Â Â *Â â€”â€”â€”â€”â€”â€”â€”Â Â Â Â Â â€”â€”â€”â€”â€”â€”â€”Â Â Â Â Â </p><p>//Â Â *Â |Â Â Â VccÂ Â Â |Â Â Â 3.3VÂ Â |Â Â Â Â Â | Vcc | 3.3V |</p><p>//Â Â *Â |Â Â Â TrigÂ Â |Â Â Â 32Â Â Â Â |Â Â Â  Â | Gnd | GND |</p><p>//Â Â *Â |Â Â Â EchoÂ Â |Â Â Â 33Â Â Â Â |Â Â Â Â Â | SCL | 21 |</p><p>//Â Â *Â |Â Â Â GndÂ Â Â |Â Â Â GNDÂ Â Â |Â Â Â  Â | SDA | 22 |</p><p>//Â Â *Â --------------------- â€”â€”â€”â€”â€”â€”â€”-</p><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;Ultrasonic.h&gt;#include &lt;Adafruit_SSD1306.h&gt;#include &lt;Adafruit_GFX.h&gt;#include &lt;Adafruit_GrayOLED.h&gt;#include &lt;Wire.h&gt;UltrasonicÂ ultrasonic1(32,Â 33);Â &#x2F;&#x2F;ultrasonic(trig,Â echo)#define SCREEN_WIDTH 128#define SCREEN_HEIGHT 64#define OLED_RESET -1Adafruit_SSD1306Â display(SCREEN_WIDTH,Â SCREEN_HEIGHT,Â &amp;Wire,Â OLED_RESET);voidÂ setup()&#123;Â Â Â Â Serial.begin(115200);Â Â Â Â display.begin(SSD1306_SWITCHCAPVCC,Â 0x3C,Â OLED_RESET);&#125;voidÂ loop()&#123;Â Â Â Â unsignedÂ intÂ distance&#x3D;ultrasonic1.read(CM);Â Â Â Â Serial.print(distance);Â Serial.println(&quot;Â CM&quot;);Â Â Â Â display.clearDisplay();Â Â Â Â display.setTextSize(3);Â Â Â Â display.setTextColor(WHITE);Â Â Â Â display.setCursor(0,Â 20);Â Â Â Â display.print(distance);Â Â Â Â display.setTextSize(2);Â Â Â Â display.setCursor(60,Â 40);Â Â Â Â display.println(&quot;CM&quot;);Â Â Â Â display.display();Â Â Â Â delay(500);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>é€™å€‹æ¨¡çµ„æ˜¯å‘¼å¸è¶…éŸ³æ³¢ç”¨çš„</em></strong></p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Ultrasonic.h></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong><em>é€™äº›æ˜¯OLEDä½¿ç”¨çš„æ¨¡çµ„</em></strong></p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Adafruit_SSD1306.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Adafruit_GFX.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Adafruit_GrayOLED.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Wire.h></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>è¨­åˆ¶è¶…éŸ³æ³¢è…³ä½</em></strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Ultrasonic ultrasonic1(32,Â 33);Â &#x2F;&#x2F;ultrasonic(trig,Â echo)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong><em>å®šç¾©oledæ‰€é ˆåƒæ•¸</em></strong></p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SCREEN_WIDTH</span> <span class="token expression"><span class="token number">128</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SCREEN_HEIGHT</span> <span class="token expression"><span class="token number">64</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">OLED_RESET</span> <span class="token expression"><span class="token operator">-</span><span class="token number">1</span></span></span>Adafruit_SSD1306 <span class="token function">display</span><span class="token punctuation">(</span>SCREEN_WIDTH<span class="token punctuation">,</span> SCREEN_HEIGHT<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Wire<span class="token punctuation">,</span> OLED_RESET<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><em><strong>åˆå§‹åŒ–</strong></em></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">void setup()&#123;Â Â Â Â Serial.begin(115200);Â Â Â Â display.begin(SSD1306_SWITCHCAPVCC,Â 0x3C,Â OLED_RESET);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>void loop(){}è£¡é¢</p><p><em><strong>è®€å–è¶…éŸ³æ³¢æ•¸è³ªä¸¦è³¦äºˆè®Šæ•¸</strong></em></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">unsigned int distance&#x3D;ultrasonic1.read(CM);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å…¶ä¸­</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">setTextSize(3),setTextColor(WHITE),setCursor(0,Â 20),display.display()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><em><strong>ä¸€å®šè¦æœ‰,è¦ä¸ç„¶ä¸æœƒé¡¯ç¤ºæ–¼OLEDä¸Š</strong></em></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">display.clearDisplay();Â Â Â Â display.setTextSize(3);Â Â Â Â display.setTextColor(WHITE);Â Â Â Â display.setCursor(0,Â 20);Â Â Â Â display.print(distance);Â Â Â Â display.setTextSize(2);Â Â Â Â display.setCursor(60,Â 40);Â Â Â Â display.println(&quot;CM&quot;);Â Â Â Â display.display();Â Â Â Â delay(500);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/HDNld7TiiFQ" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¶…éŸ³æ³¢æ¨¡çµ„ </tag>
            
            <tag> HC-SC04 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DHT11/12ç¶²è·¯ç›£æ¸¬-ESP32</title>
      <link href="/2021/08/29/dht11-12-wang-lu-jian-ce-esp32/"/>
      <url>/2021/08/29/dht11-12-wang-lu-jian-ce-esp32/</url>
      
        <content type="html"><![CDATA[<head>Â Â <metaÂ charset="utf-8"Â />Â Â <metaÂ name="viewport"Â content="width=device-width,Â initial-scale=1.0"Â />Â Â <style>Â Â Â Â h1Â Â {text-align:Â center;Â background-color:Â orange;Â margin-right:5px;}Â Â Â Â dlÂ {Â width:Â 320px;Â margin:Â 12pxÂ auto;Â }Â Â Â Â dtÂ {Â Â Â Â Â Â Â font-size:Â 20pt;Â color:Â #444;Â background-color:Â #ddd;Â Â Â Â Â Â margin:Â 6ptÂ 0;Â padding:Â 6ptÂ 12pt;Â Â Â Â }Â Â Â Â ddÂ {Â Â Â Â Â Â text-align:Â right;Â padding-right:Â 6pt;Â Â Â Â }Â Â Â Â .numÂ {Â font-size:Â 36pt;Â color:Â dodgerblue;Â }Â Â </style>Â Â </head><body>Â Â <p><h1>ESP32Â æº«æº¼åº¦é¡¯ç¤ºè¨ˆ</h1></p>Â Â <dl>Â Â Â Â <dt>æº«åº¦</dt>Â Â Â Â <ddÂ class=num>%TEMP%Â Â°C</dd>Â Â Â Â <dt>æ¿•åº¦</dt>Â Â Â Â <ddÂ class=num>%HUMI%Â %</dd>Â Â </dl></body></html><p>)===â€;</p><hr><p><strong><em>å…¶ä¸­æœ‰å…©å€‹å‡½å¼ä¸€å€‹æ˜¯readTemp()å’ŒreadHumi()æ˜¯è®€å–æº«åº¦å’Œæ¿•åº¦</em></strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">StringÂ readTemp()&#123;Â Â dht.temperature().getEvent(&amp;event);Â Â ifÂ (isnan(event.temperature))Â &#123;Â Â Â Â Serial.println(F(&quot;ErrorÂ readingÂ temperature!&quot;));Â Â Â Â returnÂ &quot;--&quot;;Â Â &#125;Â Â elseÂ &#123;Â Â Â Â Serial.print(F(&quot;Temperature:Â &quot;));Â Â Â Â Serial.print(float(event.temperature));Â Â Â Â Serial.println(F(&quot;Â°C&quot;));Â Â Â Â returnÂ String(float(event.temperature));Â Â &#125;&#125;StringÂ readHumi()&#123;Â Â dht.humidity().getEvent(&amp;event);Â Â ifÂ (isnan(event.relative_humidity))Â &#123;Â Â Â Â Serial.println(F(&quot;ErrorÂ readingÂ humidity!&quot;));Â Â Â Â returnÂ &quot;--&quot;;Â Â &#125;Â Â elseÂ &#123;Â Â Â Â Serial.print(F(&quot;Humidity:Â &quot;));Â Â Â Â Serial.print(float(event.relative_humidity));Â Â Â Â Serial.println(F(&quot;%&quot;));Â Â Â Â returnÂ String(float(event.relative_humidity));Â Â &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>é€™å€‹å‡½å¼æ„æŒ‡å¦‚æœè®€åˆ°ç¶²é è«‹æ±‚çš„å­—ä¸²æ˜¯TEMPå°±å›å‚³readTemp()è£¡çš„æº«åº¦æ•¸å€¼ä»¥å­—ä¸²å›å‚³</em></strong></p><p><strong><em>å¦‚æœç¶²é è«‹æ±‚çš„å­—ä¸²æ˜¯HUMIå°±å›å‚³readHumi()è£¡çš„æ¿•åº¦æ•¸å€¼ä¸¦ä»¥å­—ä¸²å›å‚³</em></strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">StringÂ tmplProcessor(constÂ StringÂ &amp;Â var)&#123;Â Â ifÂ (varÂ &#x3D;&#x3D;Â &quot;TEMP&quot;)&#123;Â Â Â Â returnÂ readTemp();Â Â &#125;elseÂ ifÂ (varÂ &#x3D;&#x3D;Â &quot;HUMI&quot;)&#123;Â Â Â Â returnÂ readHumi();Â Â &#125;Â Â returnÂ String();&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>åœ¨void stup(){ }è£¡</em></strong></p><p><strong><em>å…ˆæŠŠesp32é€£åˆ°åŸºåœ°å°çš„è¨­åˆ¶å¯«å¥½</em></strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">Serial.begin(115200);dht.begin();WiFi.begin(ssid,Â password);Â Serial.print(&quot;åŸºåœ°å°åç¨±:Â &quot;);Â Serial.println(ssid);whileÂ (WiFi.status()Â !&#x3D;Â WL_CONNECTED)&#123;Â Â Â delay(1000);Â Â Â Serial.println(&quot;.&quot;);&#125;Serial.print(&quot;IP:Â &quot;);Â Serial.println(WiFi.localIP());<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>å‰©ä¸‹å°±æ˜¯ä¼ºæœå™¨çš„å›æ‡‰æ–¹å¼</em></strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">server.on(&quot;&#x2F;&quot;,Â HTTP_GET,Â [](AsyncWebServerRequestÂ *request)&#123;Â Â Â Â request-&gt;send_P(200,Â &quot;text&#x2F;html&quot;,Â indexHtml,Â tmplProcessor);&#125;);server.on(&quot;&#x2F;TEMP&quot;,Â HTTP_GET,Â [](AsyncWebServerRequestÂ *request)&#123;Â Â   request-&gt;send_P(200,Â &quot;text&#x2F;plain&quot;,Â readTemp().c_str());Â Â &#125;);server.on(&quot;&#x2F;HUMI&quot;,Â HTTP_GET,Â [](AsyncWebServerRequestÂ *request)&#123;Â Â Â Â request-&gt;send_P(200,Â &quot;text&#x2F;plain&quot;,Â readHumi().c_str());Â Â &#125;);server.begin();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p><strong><em>ç¨‹å¼ç¢¼ä¸Šå‚³å¾Œå¯ä»¥çœ‹åœ¨é¡¯ç¤ºçš„ipæ‰“é–‹ç€è¦½å™¨å°±æœƒå‘ˆç¾å¦‚ä¸‹:</em></strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7172775240521960034?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-qC9CxO4i-Xc/YOZFdnar8PI/AAAAAAAAeaI/R8u1hTYwETYdszDZYvxurjlFGHujuNH6QCNcBGAsYHQ/s1600/1625703786581523-0.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7172775240521960034?hl=zh-TW#"><img src="https://1.bp.blogspot.com/-oOSgkfavhws/YOWz-Awpe-I/AAAAAAAAeZk/izEsvNIimRAk01_oxk-CKIQGdiK3c57YQCNcBGAsYHQ/w638-h349/1.jpg"></a></p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dht11/dht12 </tag>
            
            <tag> webserver </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BMP280æ°£å£“,æº«åº¦æ¨¡çµ„-ESP32</title>
      <link href="/2021/08/29/bmp280-qi-ya-wen-du-mo-zu-esp32/"/>
      <url>/2021/08/29/bmp280-qi-ya-wen-du-mo-zu-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="BMP280æ°£å£“-æº«åº¦æ¨¡çµ„-ESP32"><a href="#BMP280æ°£å£“-æº«åº¦æ¨¡çµ„-ESP32" class="headerlink" title="BMP280æ°£å£“,æº«åº¦æ¨¡çµ„-ESP32"></a>BMP280æ°£å£“,æº«åº¦æ¨¡çµ„-ESP32</h1><h6 id="tags-esp32-bmp280"><a href="#tags-esp32-bmp280" class="headerlink" title="tags: esp32 bmp280"></a>tags: <code>esp32</code> <code>bmp280</code></h6><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2010016947036646160#"><img src="https://1.bp.blogspot.com/-4LdM2J8lnOY/YPV1dYnda-I/AAAAAAAAecQ/OXHYgyYLfkgCzpZzyPV9wC_xhR4CiLv2ACNcBGAsYHQ/s320/21805656779815_796.jpg"></a></p><p>**_BMP280,è©²å‚³æ„Ÿå™¨å¯ä»¥éå¸¸æº–ç¢ºåœ°æ¸¬é‡æ°£å£“å’Œæº«åº¦ã€‚  </p><p>æ‚¨å¯ä»¥ä½¿ç”¨ I2C æˆ– SPI é€£æ¥å”è­°å°‡å…¶èˆ‡æ‚¨çš„ Arduino æ¿é€£æ¥ã€‚å®ƒæœ‰ä¸€å€‹ 3.3V ç©©å£“å™¨å’Œé›»å¹³è½‰æ›ï¼Œå› æ­¤æ‚¨å¯ä»¥æ¯«ç„¡å•é¡Œåœ°å°‡å®ƒèˆ‡ 3V æˆ– 5V é‚è¼¯å¾®æ§åˆ¶å™¨ä¸€èµ·ä½¿ç”¨ã€‚_**</p><hr><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p>*<strong>ç¶²è·¯ä¸Šå¾ˆå¤šæ•™å­¸éƒ½æ²’æœ‰èªªSDOè¦æ¥VCC,å› ç‚ºæˆ‘ä¸€é–‹å§‹æ˜¯</strong></p><p><strong>æ²’æœ‰æ¥,ç™¼ç¾ä¸€ç›´é¡¯ç¤ºæ‰¾ä¸åˆ°Addr,å¾Œä¾†æŸ¥ä¸€ä¸‹åœ‹å¤–æœ‰äººèªª</strong></p><p><strong>æ¥ä¸Šå»æ‰æœƒæ‰¾çš„åˆ°ä½å€ã€‚</strong></p><p>| BME280       | ESP32 |</p><p>| <strong>SDOâ€“&gt;VCC</strong>|<br> |<br>| <strong>VCC</strong>â€”â€”â€”-| 3.3V |<br>| <strong>GND</strong>â€”â€”â€”| GND |<br>| <strong>SCL</strong>â€”â€”â€”-| GPIO 22 |<br>| <strong>SDA</strong>â€”â€”â€”| GPIO 21 |</p><p>There are other versions of this sensor that can use either SPI or I2C communication protocols, like the module shown in the next figure:</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2010016947036646160#"><img src="https://1.bp.blogspot.com/-_kyGe2Iyy2E/YPV2DIT7ndI/AAAAAAAAecY/FaJYnuihXPEGxJyZgeP-KK2B7mx4DkzEgCNcBGAsYHQ/w653-h310/1.jpg"></a></p><hr><h2 id="ä¸‹è¼‰å‡½å¼åº«"><a href="#ä¸‹è¼‰å‡½å¼åº«" class="headerlink" title="ä¸‹è¼‰å‡½å¼åº«"></a>ä¸‹è¼‰å‡½å¼åº«</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2010016947036646160#">Adafruit_BME280_Library</a>  </p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2010016947036646160#">Adafruit_Sensor</a>  </p><p>å°‡ä¸Šé¢å…©å€‹æª”è§£å£“å¾Œ,æ•´å€‹è³‡æ–™å¤¾æ”¾å…¥Arduinoçš„libraryè£¡</p><hr><p>æ‰“é–‹Arduino IDEâ€“&gt;<strong><em>æª”æ¡ˆ</em></strong>Â &gt; <strong><em>ç¯„ä¾‹</em></strong>&gt;Â <em>Adafruit BME280 library</em>Â &gt;Â <em>bme280 test</em></p><p>å°‡æ­¤ç¨‹å¼ç¢¼ä¸Šå‚³</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;Wire.h&gt;#include &lt;SPI.h&gt;#include &lt;Adafruit_BMP280.h&gt;#define BMP_SCKÂ Â (13)#define BMP_MISOÂ (12)#define BMP_MOSIÂ (11)#define BMP_CSÂ Â Â (10)Adafruit_BMP280Â bmp;Â &#x2F;&#x2F;Â I2C&#x2F;&#x2F;Adafruit_BMP280Â bmp(BMP_CS);Â &#x2F;&#x2F;Â hardwareÂ SPI&#x2F;&#x2F;Adafruit_BMP280Â bmp(BMP_CS,Â BMP_MOSI,Â BMP_MISO,Â Â BMP_SCK);void setup()Â &#123; Serial.begin(9600); Serial.println(F(&quot;BMP280Â test&quot;));Â Â &#x2F;&#x2F;ifÂ (!bmp.begin(BMP280_ADDRESS_ALT,Â BMP280_CHIPID))Â &#123; ifÂ (!bmp.begin())Â &#123;    Serial.println(F(&quot;CouldÂ notÂ findÂ aÂ validÂ BMP280Â sensor,Â checkÂ wiringÂ orÂ &quot;    &quot;tryÂ aÂ differentÂ address!&quot;)); whileÂ (1)Â delay(10);Â Â &#125;  Â Â &#x2F;*Â DefaultÂ settingsÂ fromÂ datasheet.Â *&#x2F; bmp.setSampling(Adafruit_BMP280::MODE_NORMAL,Â Â Â Â Â &#x2F;*Â OperatingÂ Mode.Â *&#x2F; Adafruit_BMP280::SAMPLING_X2,Â Â Â Â Â &#x2F;*Â Temp.Â oversamplingÂ *&#x2F; Adafruit_BMP280::SAMPLING_X16,Â Â Â Â &#x2F;*Â PressureÂ oversamplingÂ *&#x2F; Adafruit_BMP280::FILTER_X16,Â Â Â Â Â Â &#x2F;*Â Filtering.Â *&#x2F; Adafruit_BMP280::STANDBY_MS_500);Â &#x2F;*Â StandbyÂ time.Â *&#x2F;&#125;  void loop()Â &#123; Serial.print(F(&quot;TemperatureÂ &#x3D;Â &quot;)); Serial.print(bmp.readTemperature()); Serial.println(&quot;Â *C&quot;); Serial.print(F(&quot;PressureÂ &#x3D;Â &quot;)); Serial.print(bmp.readPressure()); Serial.println(&quot;Â Pa&quot;); Serial.print(F(&quot;ApproxÂ altitudeÂ &#x3D;Â &quot;)); Serial.print(bmp.readAltitude(1013.25));Â &#x2F;*Â AdjustedÂ toÂ localÂ forecast!Â *&#x2F; Serial.println(&quot;Â m&quot;); Serial.println(); delay(2000);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2010016947036646160#"><img src="https://1.bp.blogspot.com/-uuCjmn1O69U/YPYNTBw5lXI/AAAAAAAAecg/PdiElAnsgXY-m87_nbhB_nYmHrFE8svHQCNcBGAsYHQ/w488-h261/bmp280-val.jpg"></a></p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bmp280 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BMP280+ThingSpeak IoT</title>
      <link href="/2021/08/29/bmp280-thingspeak-iot/"/>
      <url>/2021/08/29/bmp280-thingspeak-iot/</url>
      
        <content type="html"><![CDATA[<h1 id="BMP280-ThingSpeak-IoT"><a href="#BMP280-ThingSpeak-IoT" class="headerlink" title="BMP280+ThingSpeak IoT"></a>BMP280+ThingSpeak IoT</h1><h6 id="tags-esp32-thingspeak-bmp280"><a href="#tags-esp32-thingspeak-bmp280" class="headerlink" title="tags: esp32 thingspeak bmp280"></a>tags: <code>esp32</code> <code>thingspeak</code> <code>bmp280</code></h6><p><em>ESP32çœŸçš„æ˜¯å€‹æ–¹ä¾¿åˆç¥å¥‡çš„ç‰ˆå­ï¼Œ3å€‹æœˆå‰æˆ‘é‚„åœ¨çŒ¶è±«è¦ä¸è¦è·¨è¶³</em></p><p><em>ç ”ç©¶ESP32ï¼Œå¸¶è‘—ä¸€ä»½ä¸å®‰çš„å¿ƒï¼Œè²·äº†ä¸€äº›æ›¸é–‹å§‹å­¸ï¼Œè‡³ä»Šç´„ä¸‰å€‹æœˆ</em></p><p><em>ï¼Œè¦ºå¾—ä¹‹å‰æœ‰ç©Arduinoå› ç‚ºèªè¨€ç›¸é€šï¼Œçœå»äº†ä¸€äº›æ™‚é–“ï¼Œåªæ˜¯æ¯”è¼ƒ</em></p><p><em>ç•¥é¡¯ä¸è¶³çš„æ˜¯esp32æ²’æœ‰5Vå€’æ˜¯æœ‰é»å¯æƒœï¼Œå¦å¤–æˆ‘è¦ºå¾—å„ªå‹¢æ˜¯å…§å»ºWIFI</em></p><p><em>å’Œè—èŠ½ï¼Œä¸ç”¨åˆå¤–æ¥ï¼Œä¸¦ä¸”ä¹Ÿæ”¯æ´mpythonï¼Œé€™è®“æˆ‘ç„¡å½¢ä¸­ä¸æœƒå› ç‚ºåª</em></p><p><em>ç©esp32ç”¨äº†Cèªè¨€ï¼Œè€Œå¿˜äº†Pythonã€‚</em></p><hr><p>ä»Šå¤©å‘¢å°±å¿ƒè¡€ä¾†æ½®æƒ³ç©ä¸€ä¸‹äº‘ç«¯æ•¸æ“šåœ–å½¢åŒ–ï¼Œä¹‹å‰çœ‹äº†å¾ˆå¤šç¶²ä¸Šå¤§ç¥å€‘</p><p>éƒ½æœ‰æåŠThingSpeaké€™å€‹å’Œæ„Ÿæ¸¬å™¨çµåˆä¸€èµ·ç”¨ï¼Œæ˜¨å¤©å‰›ç ”ç©¶äº†BMP280å‰›å¥½</p><p>å¯ä»¥æ´¾ä¸Šç”¨å ´ã€‚</p><p>ç­†è¨˜é€£çµâ€”<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/849309138521769078#">BMP280æ°£å£“,æº«åº¦æ¨¡çµ„-ESP32</a></p><p><em><strong>é€™è£¡å°±ç›´æ¥æ¥çµåˆWIFIå’ŒThingSpeak IoTçš„ä½¿ç”¨</strong></em></p><h2 id="å¦‚ä½•ç”³è«‹ThingSpeak"><a href="#å¦‚ä½•ç”³è«‹ThingSpeak" class="headerlink" title="å¦‚ä½•ç”³è«‹ThingSpeak"></a>å¦‚ä½•ç”³è«‹ThingSpeak</h2><p><strong><em>å¦‚ä½•ç”³è«‹</em></strong><em><strong>ThingSpeak IoTå¸³è™Ÿ-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/849309138521769078#">http://web.htjh.tp.edu.tw/B4/106iot/ThingSpeak%E7%89%A9%E8%81%AF%E7%B6%B2%E5%B9%B3%E5%8F%B0.pdf</a></strong></em></p><p>_</p><hr><p>_<strong>ä»¥ä¸‹å› ç¯€çœæ™‚é–“ï¼Œå¼•ç”¨åˆ¥çš„ä½œè€…çš„æ–‡ç« ï¼Œå‡ºè™•</strong>â€”<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/849309138521769078#">https://randomnerdtutorials.com/esp32-thingspeak-publish-arduino/</a></p><p>**è½‰åˆ° ThingSpeakï¼Œç„¶å¾Œå–®æ“Šâ€œå…è²»å…¥é–€â€æŒ‰éˆ•å‰µå»ºä¸€å€‹æ–°å¸³æˆ¶ã€‚æ­¤å¸³æˆ¶èˆ‡ Mathworks å¸³æˆ¶ç›¸é—œè¯ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨å·²æœ‰ Mathworks å¸³æˆ¶ï¼Œå‰‡æ‡‰ä½¿ç”¨è©²å¸³æˆ¶ç™»éŒ„ã€‚  </p><p>å‰µå»ºæ–°é »é“<br>å¸³æˆ¶æº–å‚™å¥½å¾Œï¼Œç™»éŒ„ï¼Œæ‰“é–‹â€œé »é“â€æ¨™ç±¤ä¸¦é¸æ“‡â€œæˆ‘çš„é »é“â€ã€‚**</p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/849309138521769078#"><img src="https://lh3.googleusercontent.com/-XzTxSCPscZ0/YPa4xM-M8vI/AAAAAAAAedA/zy3dDY4cQDMSnSWEP6fOfBxrGtOgNea6wCNcBGAsYHQ/w437-h257/image.png"></a></p><p><strong>æŒ‰â€œæ–°é »é“â€æŒ‰éˆ•å‰µå»ºä¸€å€‹æ–°é »é“ã€‚</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/849309138521769078#"><img src="https://lh3.googleusercontent.com/-MJJR2oVyJQk/YPa45d0cVHI/AAAAAAAAedE/b4Qqx0Wvn7M8szBtL9iXxVv7XkY3g8KHACNcBGAsYHQ/w481-h346/image.png"></a></p><p><strong>ç‚ºæ‚¨çš„é »é“è¼¸å…¥åç¨±ä¸¦æ·»åŠ èªªæ˜ã€‚</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/849309138521769078#"><img src="https://lh3.googleusercontent.com/-7eVycTiCOuQ/YPa5Gv1-SJI/AAAAAAAAedM/Q1KRU-Rqu98pbo5kkSlP8yvRTnR_zCxoACNcBGAsYHQ/w481-h325/image.png"></a></p><p><strong>å¯ä»¥è‡ªå®šç¾©åœ–è¡¨ï¼Œè½‰åˆ°æ‚¨çš„ç§äººè¦–åœ–é¸é …å¡ï¼Œç„¶å¾Œå–®æ“Šç·¨è¼¯åœ–æ¨™ã€‚</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/849309138521769078#"><img src="https://lh3.googleusercontent.com/-zJ909rDk0Lg/YPa5P7g5aiI/AAAAAAAAedU/g8BMvBNOgYIjFTkI6SE7I8gDnFP1Qs6YQCNcBGAsYHQ/w472-h474/image.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/849309138521769078#"><img src="https://lh3.googleusercontent.com/-dT4teOJYE3I/YPa5XbOTmTI/AAAAAAAAedc/qFrNXBkcyLI_MEbT0y6lPsUrzW2qwS7cwCNcBGAsYHQ/w574-h477/image.png"></a></p><p><strong>å®Œæˆå¾Œï¼ŒæŒ‰â€œä¿å­˜â€æŒ‰éˆ•ã€‚</strong></p><p><strong>è¦å°‡å€¼å¾ ESP32 ç™¼é€åˆ° ThingSpeakï¼Œæ‚¨éœ€è¦å¯«å…¥ API å¯†é‘°ã€‚æ‰“é–‹â€œAPI å¯†é‘°â€<br>é¸é …å¡ä¸¦å°‡å¯«å…¥ API å¯†é‘°è¤‡è£½åˆ°ä¸€å€‹å®‰å…¨çš„åœ°æ–¹ï¼Œå› ç‚ºæ‚¨ç¨å¾Œæœƒéœ€è¦å®ƒã€‚</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/849309138521769078#"><img src="https://lh3.googleusercontent.com/-35r-wuz8QZA/YPa5nUmuVSI/AAAAAAAAedo/UXDaOoHybCMW0cC2Si6Mj7d_uKNcDv1VACNcBGAsYHQ/w729-h351/image.png"></a></p><hr><p>å®‰è£ ThingSpeak åº«<br>è¦å°‡å‚³æ„Ÿå™¨è®€æ•¸ç™¼é€åˆ° ThingSpeakï¼Œæˆ‘å€‘å°‡ä½¿ç”¨ thingspeak-arduino åº«ã€‚æ‚¨å¯ä»¥é€šé Arduino åº«ç®¡ç†å™¨å®‰è£æ­¤åº«ã€‚è½‰åˆ° Sketch Include Library Manage Librariesâ€¦ ä¸¦åœ¨ Library Manager ä¸­æœç´¢â€œThingSpeakâ€ã€‚å®‰è£ MathWorks çš„ ThingSpeak åº«ã€‚</p><hr><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/849309138521769078#"><img src="https://lh3.googleusercontent.com/-x91vImHJl_g/YPa9gniW-2I/AAAAAAAAedw/ta8IapxF41MfqYbYSXUOIlN3IY8f_pQUQCNcBGAsYHQ/w627-h353/image.png"></a></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;WiFi.h&gt;#include &lt;Wire.h&gt;#include &lt;SPI.h&gt;#include &lt;Adafruit_BMP280.h&gt;#include &lt;ThingSpeak.h&gt;constÂ char*Â ssid&#x3D;&quot;---&quot;;constÂ char*Â password&#x3D;&quot;-----&quot;;constÂ char*Â APIKey&#x3D;&quot;X0V369ZQ4VM9YGA8&quot;;WiFiClientÂ client;Adafruit_BMP280Â bmp;Â &#x2F;&#x2F;Â I2CunsignedÂ longÂ lastTime&#x3D;0;unsignedÂ longÂ currenTime&#x3D;millis();voidÂ setup()Â &#123;Â Â Serial.begin(115200);Â Â ifÂ (!bmp.begin())Â &#123;Â Â Â Â Serial.println(F(&quot;CouldÂ notÂ findÂ aÂ validÂ BMP280Â sensor,Â checkÂ wiringÂ orÂ &quot;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &quot;tryÂ aÂ differentÂ address!&quot;));Â Â Â Â whileÂ (1)Â delay(10);Â Â &#125;Â Â WiFi.mode(WIFI_STA);Â Â ThingSpeak.begin(client);Â Â WiFi.begin(ssid,Â password);Â Â whileÂ (WiFi.status()Â !&#x3D;Â WL_CONNECTED)&#123;Â Â Â Â Serial.print(&quot;.&quot;);Â Â &#125;Â Â Serial.println(&quot;ConnectedÂ successful!&quot;);&#125;voidÂ loop()Â &#123;Â Â floatÂ temp&#x3D;bmp.readTemperature();Â Â intÂ x&#x3D;ThingSpeak.writeField(1,Â 1,Â temp,Â APIKey);Â Â ifÂ (x&#x3D;&#x3D;200)&#123;Â Â Â Â Serial.println(&quot;requestÂ successful!&quot;);Â Â &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><p><strong>åŒ¯å…¥æ‰€é ˆçš„æ¨¡çµ„</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;WiFi.h&gt;#include &lt;Wire.h&gt;#include &lt;SPI.h&gt;#include &lt;Adafruit_BMP280.h&gt;#include &lt;ThingSpeak.h&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>WIFIå’ŒAPIçš„KEY</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">const char*Â ssid&#x3D;&quot;åŸºåœ°å°åç¨±&quot;;const char*Â password&#x3D;&quot;åŸºåœ°å°å¯†ç¢¼&quot;;const char*Â APIKey&#x3D;&quot;X0V36---------&quot;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>WIFIçš„å®¢æˆ¶ç«¯</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">WiFiClientÂ client;&#96;**BMP280æŒ‡å®šå°è±¡**Adafruit_BMP280Â bmp;Â &#x2F;&#x2F;Â I2C&#96;**BMP280åˆå§‹åŒ–**&#96;&#96;&#96;c#ifÂ (!bmp.begin())Â &#123;Â Â Â Â Serial.println(F(&quot;CouldÂ notÂ findÂ aÂ validÂ BMP280Â sensor,Â checkÂ wiringÂ orÂ &quot;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &quot;tryÂ aÂ differentÂ address!&quot;));Â Â Â Â whileÂ (1)Â delay(10);Â Â &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>WIFIé€£ç·šè¨­å®šèˆ‡è¨­å®šæˆSTAæ¨¡å¼</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">WiFi.mode(WIFI_STA);WiFi.begin(ssid,Â password);Â Â whileÂ (WiFi.status()Â !&#x3D;Â WL_CONNECTED)&#123;Â Â Â Â Serial.print(&quot;.&quot;);Â Â &#125;Â Â Serial.println(&quot;ConnectedÂ successful!&quot;);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ThingSpeakåˆå§‹åŒ–</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">ThingSpeak.begin(client);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>loop()è£¡é¢</strong></p><p><strong>è®€å–æº«åº¦å’Œä¸Šå‚³æ•¸è‡³åˆ°ThingSpeak</strong></p><p><strong>å¦‚æœæˆåŠŸç™¼å¸ƒè®€æ•¸ï¼Œæ­¤å‡½æ•¸å°‡è¿”å›ä»£ç¢¼ 200ã€‚</strong><br><strong>// å¯«å…¥ ThingSpeakã€‚ä¸€å€‹é€šé“æœ€å¤šæœ‰ 8 å€‹å­—æ®µï¼Œæœ€å¤šå¯ä»¥å­˜å„² 8 å€‹ä¸åŒçš„å­—æ®µã€‚<br>// é€šé“ä¸­çš„ä¿¡æ¯ç‰‡æ®µã€‚åœ¨é€™è£¡ï¼Œæˆ‘å€‘å¯«å…¥å­—æ®µ 1ã€‚</strong></p><p><strong>//ThingSpeak.writeField(1,Â 1,Â temp,Â APIKey)ç¬¬ä¸€å€‹1ä»£è¡¨é »é“,ç¬¬äºŒå€‹1ä»£è¡¨å­—æ®µ</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">floatÂ temp&#x3D;bmp.readTemperature();Â Â intÂ x&#x3D;ThingSpeak.writeField(1,Â 1,Â temp,Â APIKey);Â Â ifÂ (x&#x3D;&#x3D;200)&#123;Â Â Â Â Serial.println(&quot;requestÂ successful!&quot;);Â Â &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/849309138521769078#"><img src="https://1.bp.blogspot.com/-I1rIMHBqD9I/YPbEIweD_4I/AAAAAAAAed4/g288Q1gyvFwLWDSlOo4WzL_wFCcgqypmgCNcBGAsYHQ/w687-h303/BMP280TEMP.jpg"></a></p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bmp280 </tag>
            
            <tag> ThingSpeak </tag>
            
            <tag> IOT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DS1306å¯¦æ™‚æ™‚é˜æ¨¡çµ„-ESP32</title>
      <link href="/2021/08/29/ds1306-shi-shi-shi-zhong-mo-zu-esp32/"/>
      <url>/2021/08/29/ds1306-shi-shi-shi-zhong-mo-zu-esp32/</url>
      
        <content type="html"><![CDATA[<h2 id="DS1306å¯¦æ™‚æ™‚é˜æ¨¡çµ„-ESP32"><a href="#DS1306å¯¦æ™‚æ™‚é˜æ¨¡çµ„-ESP32" class="headerlink" title="DS1306å¯¦æ™‚æ™‚é˜æ¨¡çµ„-ESP32"></a>DS1306å¯¦æ™‚æ™‚é˜æ¨¡çµ„-ESP32</h2><h6 id="tags-esp32-ds1302"><a href="#tags-esp32-ds1302" class="headerlink" title="tags: esp32 ds1302"></a>tags: <code>esp32</code> <code>ds1302</code></h6><p>é€™æ˜¯å»£è¯é›»å­ä¸Šçš„ä»‹ç´¹<br>â— æ™‚é˜å…·æœ‰èƒ½è¨ˆç®—2100 å¹´ä¹‹å‰çš„ç§’ã€åˆ†ã€æ™‚ã€æ—¥ã€æ˜ŸæœŸã€æœˆã€å¹´çš„èƒ½åŠ›ï¼Œé‚„æœ‰é–å¹´èª¿æ•´çš„èƒ½åŠ›<br>â— 31 8 ä½æš«å­˜æ•¸æ“šå­˜å„²RAM<br>â— ä¸²è¡Œ I/O å£æ–¹å¼ä½¿å¾—ç®¡è…³æ•¸é‡æœ€å°‘<br>â— å¯¬ç¯„åœå·¥ä½œé›»å£“2.0 5.5V<br>â— å·¥ä½œé›»æµ 2.0V æ™‚,å°æ–¼300nA<br>â— è®€ / å¯«æ™‚é˜æˆ–RAM æ•¸æ“šæ™‚æœ‰å…©ç¨®å‚³é€æ–¹å¼å–®å­—ç¯€å‚³é€å’Œå¤šå­—ç¯€å‚³é€å­—ç¬¦çµ„æ–¹å¼<br>â— 8 è…³DIP å°è£æˆ–å¯é¸çš„8 è…³SOIC å°è£æ ¹æ“šè¡¨é¢è£é…<br>â— ç°¡å–® 3 ç·šæ¥å£<br>â— èˆ‡ TTL ç›¸å®¹Vcc=5V<br>â— é›™é›»æºç®¡ç”¨æ–¼ä¸»é›»æºå’Œå‚™ä»½é›»æºä¾›æ‡‰<br>â— é›»æ± ï¼šCR2032 é›»å£“3Vï¼Œé›»æµ260mAh<br>â— æ™¶æŒ¯32.768KHzï¼ŒåŒ¹é…é›»å®¹ç‚º6pF<br>â— DS1302ç‚º8è…³ç›´æ’å¤§æ™¶ç‰‡ï¼Œæ™¶ç‰‡ä¸‹é¢æœ‰ICåº§ï¼Œæ–¹ä¾¿æ›´æ›åŠæ’æ‹”ç‰‡<br>6.æ¨¡å¡Šå·¥ä½œé›»å£“å…¼å®¹3.3V/5Vï¼Œå¯èˆ‡5VåŠ3.3Vå–®ç‰‡æ©Ÿé€£æ¥<br>â—å¸¶4å€‹å®šä½å­”ï¼Œç›´å¾‘3.1mm<br>â—å·¥ä½œæº«åº¦ï¼š0Â°ï½70Â°</p><p>â— å®‰è£æ³¨æ„!<br>1.VCCèˆ‡GNDåƒè¬ä¸è¦æ¥åï¼Œä»¥å…ç‡’å£æ™¶ç‰‡<br>2.51ç³»åˆ—å–®æ™¶ç‰‡P0æ¥è…³éœ€è¦é€£æ¥ä¸Šæ‹‰é›»é˜»ï¼Œå¦‚æœå–®æ™¶ç‰‡æ²’æœ‰é€£æ¥ä¸Šæ‹‰é›»é˜»ï¼Œå¯ä»¥å°‡æ•¸æ“šç·šæ¥åˆ°å…¶ä»–æ¥è…³</p><p>æ­¥é©Ÿ1:<br>åœ¨Arduino IDEä¸‹è¼‰ç¨‹å¼åº«DS1302ï¼Œä¸¦é¸å¥½ç‰ˆå‹ï¼ŒCOMå’Œæ³¢ç‰¹ç‡</p><p>æ¥ç·š</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">&#x2F;&#x2F; DS1302 CLK&#x2F;SCLK --&gt; 5&#x2F;&#x2F; DS1302 DAT&#x2F;IO --&gt; 4&#x2F;&#x2F; DS1302 RST&#x2F;CE --&gt; 2&#x2F;&#x2F; DS1302 VCC --&gt; 3.3v - 5v&#x2F;&#x2F; DS1302 GND --&gt; GND<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¨‹å¼ç¢¼</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;ThreeWire.h&gt;  #include &lt;RtcDS1302.h&gt; ThreeWire myWire(4,5,2); &#x2F;&#x2F; IO, SCLK, CE  &#x2F;&#x2F;å¯¹åº”æ¥åˆ°ESP32çš„IOå·RtcDS1302&lt;ThreeWire&gt; Rtc(myWire); void setup () &#123;    Serial.begin(57600);    Serial.print(&quot;compiled: &quot;);    Serial.print(__DATE__); &#x2F;&#x2F;æ‰“å°ç³»ç»Ÿæ—¥æœŸ    Serial.println(__TIME__); &#x2F;&#x2F;æ‰“å°ç³»ç»Ÿæ—¶é—´    Rtc.Begin();  &#x2F;&#x2F;ç”¨ç®¡è„šå£°æ˜æ¥åˆå§‹åŒ–RTC     RtcDateTime compiled &#x3D; RtcDateTime(__DATE__, __TIME__); &#x2F;&#x2F;å°†ç³»ç»Ÿæ—¶é—´å£°æ˜ä¸€ä¸ªæ—¶é—´ç»“æ„    printDateTime(compiled);  &#x2F;&#x2F;æ‰“å°æ—¶é—´    Serial.println();     if (!Rtc.IsDateTimeValid())   &#x2F;&#x2F;è¯»RTCæ—¶é—´ï¼Œå¦‚æœæ²¡è¯»åˆ°ï¼Œå°±æ˜¯ç”µæ± æ²¡ç”µäº†    &#123;        &#x2F;&#x2F; Common Causes:        &#x2F;&#x2F;    1) first time you ran and the device wasn&#39;t running yet        &#x2F;&#x2F;    2) the battery on the device is low or even missing         Serial.println(&quot;RTC lost confidence in the DateTime!&quot;);        Rtc.SetDateTime(compiled);    &#x2F;&#x2F;è®¾ç½®ç³»ç»Ÿæ—¶é—´ä¸ºå½“å‰æ—¶é—´    &#125;     if (Rtc.GetIsWriteProtected())    &#x2F;&#x2F;æ£€æŸ¥æ˜¯ä¸æ˜¯å†™ä¿æŠ¤äº†    &#123;        Serial.println(&quot;RTC was write protected, enabling writing now&quot;);        Rtc.SetIsWriteProtected(false);    &#125;     if (!Rtc.GetIsRunning())  &#x2F;&#x2F;æ£€æŸ¥æ˜¯ä¸æ˜¯å¯è¯»    &#123;        Serial.println(&quot;RTC was not actively running, starting now&quot;);        Rtc.SetIsRunning(true);    &#125;     RtcDateTime now &#x3D; Rtc.GetDateTime();  &#x2F;&#x2F;å¾—åˆ°RTCçš„æ—¶é—´    if (now &lt; compiled) &#x2F;&#x2F;å¦‚æœè¯»å‡ºçš„æ—¶é—´æ—©äºç³»ç»Ÿæ—¶é—´ï¼Œåˆ™é‡æ–°è®¾ç½®RTCæ—¶é—´    &#123;        Serial.println(&quot;RTC is older than compile time!  (Updating DateTime)&quot;);        Rtc.SetDateTime(compiled);    &#125;    else if (now &gt; compiled) &#x2F;&#x2F;å¦‚æœè¯»å‡ºçš„æ—¶é—´æ™šäºç³»ç»Ÿæ—¶é—´ï¼Œåˆ™é‡æ–°è®¾ç½®RTCæ—¶é—´    &#123;        Serial.println(&quot;RTC is newer than compile time. (this is expected)&quot;);    &#125;    else if (now &#x3D;&#x3D; compiled)     &#123;        Serial.println(&quot;RTC is the same as compile time! (not expected but all is fine)&quot;);    &#125;&#125; void loop () &#123;    RtcDateTime now &#x3D; Rtc.GetDateTime();    &#x2F;&#x2F;æ ¸å¿ƒå‡½æ•°ï¼Œè¯»å½“å‰RTCæ—¶é—´    printDateTime(now);    Serial.println();    if (!now.IsValid())&#123;        &#x2F;&#x2F; Common Causes:        &#x2F;&#x2F;    1) the battery on the device is low or even missing and the power line was disconnected        Serial.println(&quot;RTC lost confidence in the DateTime!&quot;);    &#125;    delay(10000); &#x2F;&#x2F; ten seconds    &#x2F;&#x2F;å»¶æ—¶10s&#125; #define countof(a) (sizeof(a) &#x2F; sizeof(a[0]))void printDateTime(const RtcDateTime&amp; dt)   &#x2F;&#x2F;ä¸€ä¸ªé€šè¿‡ä¸²å£æ ¼å¼åŒ–æ‰“å°æ—¥æœŸå’Œæ—¶é—´çš„å‡½æ•°&#123;    char datestring[20];     snprintf_P(datestring,                &#x2F;&#x2F;avrçš„ä¸€ä¸ªæ‰“å°æ ¼å¼åŒ–å‡½æ•°            countof(datestring),            PSTR(&quot;%04u&#x2F;%02u&#x2F;%02u %02u:%02u:%02u&quot;),    &#x2F;&#x2F;å’Œprintç±»ä¼¼ï¼ŒæŒ‡å®šé•¿åº¦            dt.Year(),            dt.Month(),            dt.Day(),            dt.Hour(),            dt.Minute(),            dt.Second() );    Serial.print(datestring);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>DS1306å¯¦æ™‚æ™‚é˜æ¨¡çµ„+0.96OLED<br>æç¤º:å…ˆä¸‹è¼‰é€™äº›ç¨‹å¼åº«</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;Adafruit_SSD1306.h&gt;#include &lt;Adafruit_GFX.h&gt;#include &lt;Adafruit_GrayOLED.h&gt;#include &lt;Wire.h&gt;#include &lt;ThreeWire.h&gt;  #include &lt;RtcDS1302.h&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ds1302åœ¨ç¯„ä¾‹è£¡é¢æœ‰</p><p>// CONNECTIONS:<br>// DS1302 CLK/SCLK â€“&gt; 5<br>// DS1302 DAT/IO â€“&gt; 4<br>// DS1302 RST/CE â€“&gt; 2<br>// DS1302 VCC â€“&gt; 3.3v - 5v<br>// DS1302 GND â€“&gt; GND</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;SPI.h&gt;#include &lt;Adafruit_SSD1306.h&gt;#include &lt;Adafruit_GFX.h&gt;#include &lt;Adafruit_GrayOLED.h&gt;#include &lt;Wire.h&gt;#include &lt;ThreeWire.h&gt;  #include &lt;RtcDS1302.h&gt;ThreeWire myWire(4,5,2); &#x2F;&#x2F; IO, SCLK, CERtcDS1302&lt;ThreeWire&gt; Rtc(myWire);#define SCREEN_WIDTH 128#define SCREEN_HEIGHT 64#define OLED_RESET -1Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT, &amp;Wire, OLED_RESET);void setup () &#123;    Serial.begin(115200);    display.begin(SSD1306_SWITCHCAPVCC, 0x3C, OLED_RESET);    Serial.print(&quot;compiled: &quot;);    Serial.print(__DATE__);    Serial.println(__TIME__);    Rtc.Begin();    RtcDateTime compiled &#x3D; RtcDateTime(__DATE__, __TIME__);    printDateTime(compiled);    Serial.println();    if (!Rtc.IsDateTimeValid())     &#123;        &#x2F;&#x2F; Common Causes:        &#x2F;&#x2F;    1) first time you ran and the device wasn&#39;t running yet        &#x2F;&#x2F;    2) the battery on the device is low or even missing        Serial.println(&quot;RTC lost confidence in the DateTime!&quot;);        Rtc.SetDateTime(compiled);    &#125;    if (Rtc.GetIsWriteProtected())    &#123;        Serial.println(&quot;RTC was write protected, enabling writing now&quot;);        Rtc.SetIsWriteProtected(false);    &#125;    if (!Rtc.GetIsRunning())    &#123;        Serial.println(&quot;RTC was not actively running, starting now&quot;);        Rtc.SetIsRunning(true);    &#125;    RtcDateTime now &#x3D; Rtc.GetDateTime();    if (now &lt; compiled)     &#123;        Serial.println(&quot;RTC is older than compile time!  (Updating DateTime)&quot;);        Rtc.SetDateTime(compiled);    &#125;    else if (now &gt; compiled)     &#123;        Serial.println(&quot;RTC is newer than compile time. (this is expected)&quot;);    &#125;    else if (now &#x3D;&#x3D; compiled)     &#123;        Serial.println(&quot;RTC is the same as compile time! (not expected but all is fine)&quot;);    &#125;&#125;void loop () &#123;    RtcDateTime now &#x3D; Rtc.GetDateTime();    printDateTime(now);    Serial.println();    if (!now.IsValid())    &#123;        &#x2F;&#x2F; Common Causes:        &#x2F;&#x2F;    1) the battery on the device is low or even missing and the power line was disconnected        Serial.println(&quot;RTC lost confidence in the DateTime!&quot;);    &#125;    display.clearDisplay();    display.setTextSize(2);    display.setTextColor(WHITE);    display.setCursor(0, 0);    display.print(now.Year()); display.print(&quot;&#x2F;&quot;); display.print(now.Month()); display.print(&quot;&#x2F;&quot;); display.println(now.Day());    display.setCursor(0, 20);    display.setTextSize(2);    display.setTextColor(WHITE);    display.print(now.Hour()); display.print(&quot;:&quot;); display.print(now.Minute()); display.print(&quot;:&quot;); display.println(now.Second());    display.display();    delay(1000); &#x2F;&#x2F; ten seconds&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/8HeV3ZOpPSI" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DS1306 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–æ¡¿æ¨¡çµ„-ESP32</title>
      <link href="/2021/08/29/yao-gan-mo-zu-esp32/"/>
      <url>/2021/08/29/yao-gan-mo-zu-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="æ–æ¡¿æ¨¡çµ„-ESP32"><a href="#æ–æ¡¿æ¨¡çµ„-ESP32" class="headerlink" title="æ–æ¡¿æ¨¡çµ„-ESP32"></a>æ–æ¡¿æ¨¡çµ„-ESP32</h1><h6 id="tags-esp32-æ–æ¡¿"><a href="#tags-esp32-æ–æ¡¿" class="headerlink" title="tags: esp32 æ–æ¡¿"></a>tags: <code>esp32</code> <code>æ–æ¡¿</code></h6><hr><h2 id="æ–æ¡¿æ¨¡çµ„"><a href="#æ–æ¡¿æ¨¡çµ„" class="headerlink" title="æ–æ¡¿æ¨¡çµ„"></a>æ–æ¡¿æ¨¡çµ„</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2467346807906815384#"><img src="https://1.bp.blogspot.com/-liS9OQ7lsPg/YIkRkqPRvrI/AAAAAAAAeGQ/AzkfR9Z0sy4i-gdxKveKbMqg4GFCYR4igCNcBGAsYHQ/w186-h331/20210428_152206.jpg"></a></p><h3 id="æ–æ¡¿æ¨¡çµ„å¤§éƒ½ç”¨æ–¼æ©Ÿæ¢°æ‰‹è‡‚æˆ–æ§åˆ¶æœ‰ä¼ºæœé¦¬é”çš„åœ°æ–¹ï¼Œå®ƒæœ‰ï¼’çµ„è»¸ï¼ˆXå’ŒYï¼‰å’Œä¸€å€‹æŒ‰éµ-ï¼ŒESP32å’ŒArduinoä¸Šæ˜¯ä½¿ç”¨é¡æ¯”è¨Šè™Ÿæ¸¬é‡ï¼Œä¸éåœ¨ESP32ä¸Šåªæœ‰3-3Væ‰€ä»¥é¡æ¯”è¨Šè™Ÿæœƒåˆ°4059-å¿…é ˆè½‰æ›åˆ°1023ï¼Œå¾Œä¾†æ‰ç™¼ç¾ESP32æœ‰å¹¾å€‹å…§éµè½‰æ›çš„å‡½å¼ä¸éŒ¯ç”¨ï¼Œå°±ä¸ç”¨ä¸€ç›´æ­»å‘†å‘†çš„ç”¨-map-ä¾†è½‰æ›ã€‚ç„¶å¾Œå®ƒçš„åŸç†å’Œå¯èª¿é›»é˜»ä¸€æ¨£ï¼Œæ‰€ä»¥æ²’ä»€éº¼ç‰¹åˆ¥è¦å¼·èª¿çš„ã€‚"><a href="#æ–æ¡¿æ¨¡çµ„å¤§éƒ½ç”¨æ–¼æ©Ÿæ¢°æ‰‹è‡‚æˆ–æ§åˆ¶æœ‰ä¼ºæœé¦¬é”çš„åœ°æ–¹ï¼Œå®ƒæœ‰ï¼’çµ„è»¸ï¼ˆXå’ŒYï¼‰å’Œä¸€å€‹æŒ‰éµ-ï¼ŒESP32å’ŒArduinoä¸Šæ˜¯ä½¿ç”¨é¡æ¯”è¨Šè™Ÿæ¸¬é‡ï¼Œä¸éåœ¨ESP32ä¸Šåªæœ‰3-3Væ‰€ä»¥é¡æ¯”è¨Šè™Ÿæœƒåˆ°4059-å¿…é ˆè½‰æ›åˆ°1023ï¼Œå¾Œä¾†æ‰ç™¼ç¾ESP32æœ‰å¹¾å€‹å…§éµè½‰æ›çš„å‡½å¼ä¸éŒ¯ç”¨ï¼Œå°±ä¸ç”¨ä¸€ç›´æ­»å‘†å‘†çš„ç”¨-map-ä¾†è½‰æ›ã€‚ç„¶å¾Œå®ƒçš„åŸç†å’Œå¯èª¿é›»é˜»ä¸€æ¨£ï¼Œæ‰€ä»¥æ²’ä»€éº¼ç‰¹åˆ¥è¦å¼·èª¿çš„ã€‚" class="headerlink" title="æ–æ¡¿æ¨¡çµ„å¤§éƒ½ç”¨æ–¼æ©Ÿæ¢°æ‰‹è‡‚æˆ–æ§åˆ¶æœ‰ä¼ºæœé¦¬é”çš„åœ°æ–¹ï¼Œå®ƒæœ‰ï¼’çµ„è»¸ï¼ˆï¼¸å’Œï¼¹ï¼‰å’Œä¸€å€‹æŒ‰éµ ï¼ŒESP32å’ŒArduinoä¸Šæ˜¯ä½¿ç”¨é¡æ¯”è¨Šè™Ÿæ¸¬é‡ï¼Œä¸éåœ¨ESP32ä¸Šåªæœ‰3.3Væ‰€ä»¥é¡æ¯”è¨Šè™Ÿæœƒåˆ°4059  å¿…é ˆè½‰æ›åˆ°1023ï¼Œå¾Œä¾†æ‰ç™¼ç¾ESP32æœ‰å¹¾å€‹å…§éµè½‰æ›çš„å‡½å¼ä¸éŒ¯ç”¨ï¼Œå°±ä¸ç”¨ä¸€ç›´æ­»å‘†å‘†çš„ç”¨  map()ä¾†è½‰æ›ã€‚ç„¶å¾Œå®ƒçš„åŸç†å’Œå¯èª¿é›»é˜»ä¸€æ¨£ï¼Œæ‰€ä»¥æ²’ä»€éº¼ç‰¹åˆ¥è¦å¼·èª¿çš„ã€‚"></a>æ–æ¡¿æ¨¡çµ„å¤§éƒ½ç”¨æ–¼æ©Ÿæ¢°æ‰‹è‡‚æˆ–æ§åˆ¶æœ‰ä¼ºæœé¦¬é”çš„åœ°æ–¹ï¼Œå®ƒæœ‰ï¼’çµ„è»¸ï¼ˆï¼¸å’Œï¼¹ï¼‰å’Œä¸€å€‹æŒ‰éµ ï¼ŒESP32å’ŒArduinoä¸Šæ˜¯ä½¿ç”¨é¡æ¯”è¨Šè™Ÿæ¸¬é‡ï¼Œä¸éåœ¨ESP32ä¸Šåªæœ‰3.3Væ‰€ä»¥é¡æ¯”è¨Šè™Ÿæœƒåˆ°4059  å¿…é ˆè½‰æ›åˆ°1023ï¼Œå¾Œä¾†æ‰ç™¼ç¾ESP32æœ‰å¹¾å€‹å…§éµè½‰æ›çš„å‡½å¼ä¸éŒ¯ç”¨ï¼Œå°±ä¸ç”¨ä¸€ç›´æ­»å‘†å‘†çš„ç”¨  map()ä¾†è½‰æ›ã€‚ç„¶å¾Œå®ƒçš„åŸç†å’Œå¯èª¿é›»é˜»ä¸€æ¨£ï¼Œæ‰€ä»¥æ²’ä»€éº¼ç‰¹åˆ¥è¦å¼·èª¿çš„ã€‚</h3><hr><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><h3 id="Xâ€“-gt-D33-A5"><a href="#Xâ€“-gt-D33-A5" class="headerlink" title="Xâ€“&gt;D33(A5)"></a>Xâ€“&gt;D33(A5)</h3><h3 id="Yâ€“-gt-D32-A4"><a href="#Yâ€“-gt-D32-A4" class="headerlink" title="Yâ€“&gt;D32(A4)"></a>Yâ€“&gt;D32(A4)</h3><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2467346807906815384#"><img src="https://1.bp.blogspot.com/-eo9WBofHtSo/YIkUVUGy3qI/AAAAAAAAeGY/UINLcUssojkL362WOFOI2wTBFM4P68OtACNcBGAsYHQ/w568-h472/1.jpg"></a></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><p>esp32å‡½å¼ç­†è¨˜æœ¬-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2467346807906815384#">https://esp32-blairan.blogspot.com/2021/04/esp32_26.html</a></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#defineÂ posXÂ 33#defineÂ posYÂ 32voidÂ setup()&#123;Â Â Serial.begin(115200);Â Â analogSetAttenuation(ADC_11db);Â Â analogSetWidth(10);&#125;voidÂ loop()&#123;Â Â intÂ valx&#x3D;analogRead(posX);Â Â intÂ valy&#x3D;analogRead(posY);Â Â delay(500);Â Â Serial.printf(&quot;posXçš„æ–æ¡¿å€¼ç‚º:Â %dÂ Â &#x2F;&#x2F;Â posYçš„æ–æ¡¿å€¼ç‚º:Â %d\\n&quot;,valx,Â valy);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><div class="video-container"><iframe src="https://www.youtube.com/embed/kJ70IxVJXVo" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é™æ¡¿æ¨¡çµ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŒ‰éˆ•é–‹é—œæ§åˆ¶LEDæ˜æ»…</title>
      <link href="/2021/08/29/an-niu-kai-guan-kong-zhi-led-ming-mie/"/>
      <url>/2021/08/29/an-niu-kai-guan-kong-zhi-led-ming-mie/</url>
      
        <content type="html"><![CDATA[<h1 id="æŒ‰éˆ•é–‹é—œæ§åˆ¶LEDæ˜æ»…"><a href="#æŒ‰éˆ•é–‹é—œæ§åˆ¶LEDæ˜æ»…" class="headerlink" title="æŒ‰éˆ•é–‹é—œæ§åˆ¶LEDæ˜æ»…Â "></a>æŒ‰éˆ•é–‹é—œæ§åˆ¶LEDæ˜æ»…Â </h1><h6 id="tags-esp32-æŒ‰éˆ•é–‹é—œ-led"><a href="#tags-esp32-æŒ‰éˆ•é–‹é—œ-led" class="headerlink" title="tags: esp32 æŒ‰éˆ•é–‹é—œ led"></a>tags: <code>esp32</code> <code>æŒ‰éˆ•é–‹é—œ</code> <code>led</code></h6><h2 id="ææ–™"><a href="#ææ–™" class="headerlink" title="ææ–™"></a>ææ–™</h2><p><strong>LED x1</strong></p><p><strong>æŒ‰éˆ•é–‹é—œ x1</strong></p><p><strong>220æ­å§†é›»é˜» x1</strong></p><p><strong>ESP32</strong></p><p><a href="https://lh3.googleusercontent.com/-Yc_T7233Jvo/YJDgE6FwwII/AAAAAAAAeHA/etFpI543t8ErXzzDlgCpLc3ME02Ex294gCNcBGAsYHQ/s1600/1620107250751841-0.png"><img src="https://lh3.googleusercontent.com/-Yc_T7233Jvo/YJDgE6FwwII/AAAAAAAAeHA/etFpI543t8ErXzzDlgCpLc3ME02Ex294gCNcBGAsYHQ/w204-h362/1620107250751841-0.png"></a></p><h3 id="æŒ‰éˆ•é–‹é—œåŸç†"><a href="#æŒ‰éˆ•é–‹é—œåŸç†" class="headerlink" title="æŒ‰éˆ•é–‹é—œåŸç†"></a>æŒ‰éˆ•é–‹é—œåŸç†</h3><p><a href="https://1.bp.blogspot.com/-KqBfr6zKGPs/YJDkUqq4rnI/AAAAAAAAeHI/RVPN3_dsIssR8ebADpEl8eSYkreF9OWXQCNcBGAsYHQ/s946/1715185-1FP216354U55.jpg"><img src="https://1.bp.blogspot.com/-KqBfr6zKGPs/YJDkUqq4rnI/AAAAAAAAeHI/RVPN3_dsIssR8ebADpEl8eSYkreF9OWXQCNcBGAsYHQ/w400-h240/1715185-1FP216354U55.jpg"></a></p><p><a href="https://1.bp.blogspot.com/-czSSM3yjims/YJDkaJ8V4yI/AAAAAAAAeHM/lfjKT3t-kiQRnBU3CUVd6fsRfUwBkLp5wCNcBGAsYHQ/s318/%25E4%25B8%258B%25E8%25BC%2589.jpg"><img src="https://1.bp.blogspot.com/-czSSM3yjims/YJDkaJ8V4yI/AAAAAAAAeHM/lfjKT3t-kiQRnBU3CUVd6fsRfUwBkLp5wCNcBGAsYHQ/w418-h209/%25E4%25B8%258B%25E8%25BC%2589.jpg"></a></p><h2 id="å¯¦é©—ç›®çš„"><a href="#å¯¦é©—ç›®çš„" class="headerlink" title="å¯¦é©—ç›®çš„"></a>å¯¦é©—ç›®çš„</h2><p><strong>åˆ©ç”¨æŒ‰éˆ•é–‹é—œåˆ‡æ›ESP32å…§éµLEDæ˜æ»…</strong></p><p><strong>ä¸»è¦æ˜¯ç·´ç¿’æ¶ˆé™¤æŒ‰ä¸‹æŒ‰éˆ•æ™‚çš„å½ˆè·³é›œè¨Š</strong></p><h3 id="å‹•ä½œè¦æ±‚"><a href="#å‹•ä½œè¦æ±‚" class="headerlink" title="å‹•ä½œè¦æ±‚"></a>å‹•ä½œè¦æ±‚</h3><p><strong>æŒ‰ä¸€ä¸‹é–‹é—œ:é»äº®LED</strong></p><p><strong>å†æŒ‰ä¸€ä¸‹é–‹é—œ:é—œé–‰LED</strong></p><h2 id="æ¥ç·šåœ–"><a href="#æ¥ç·šåœ–" class="headerlink" title="æ¥ç·šåœ–"></a><strong>æ¥ç·šåœ–</strong></h2><p>**</p><p><a href="https://1.bp.blogspot.com/-VuvcXgXf6uw/YJDtVXFoJTI/AAAAAAAAeHY/Wi1KlYE0rOkmBEIeS1Ao7vAbXkUatJgiwCNcBGAsYHQ/s1187/B.jpg"><img src="https://1.bp.blogspot.com/-VuvcXgXf6uw/YJDtVXFoJTI/AAAAAAAAeHY/Wi1KlYE0rOkmBEIeS1Ao7vAbXkUatJgiwCNcBGAsYHQ/w453-h225/B.jpg"></a></p><p> **</p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">byteÂ swÂ &#x3D;Â 4;byteÂ buttonÂ &#x3D;Â LOW;Â &#x2F;&#x2F;æŒ‰éˆ•é è¨­ä½é›»ä½byteÂ toggleÂ &#x3D;Â LOW;Â &#x2F;&#x2F;æš«å­˜ç´€éŒ„é è¨­ä½é›»ä½ voidÂ setup()&#123;Â Â Â Â Serial.begin(115200);Â Â Â Â pinMode(LED_BUILTIN,Â OUTPUT);Â Â Â Â pinMode(sw,Â INPUT);&#125;voidÂ loop()&#123;Â Â Â Â boolÂ bÂ &#x3D;Â digitalRead(sw);Â Â Â Â ifÂ (b)&#123;Â Â Â Â Â Â Â Â delay(20);Â &#x2F;&#x2F;æ¶ˆé™¤å½ˆè·³Â Â Â Â Â Â Â Â buttonÂ &#x3D;Â b;Â Â Â Â &#125;Â Â Â Â ifÂ (bÂ !&#x3D;Â button)&#123;Â Â Â Â Â Â Â Â toggleÂ &#x3D;!Â toggle;Â Â Â Â Â Â Â Â digitalWrite(LED_BUILTIN,Â toggle);Â Â Â Â Â Â Â Â buttonÂ &#x3D;Â LOW;Â Â Â Â &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å¯¦é©—çµæœ"><a href="#å¯¦é©—çµæœ" class="headerlink" title="å¯¦é©—çµæœ"></a>å¯¦é©—çµæœ</h2><div class="video-container"><iframe src="https://www.youtube.com/embed/NGC4oxTKZm0" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ§éˆ•é–‹é—œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LEDè·‘é¦¬ç‡ˆ-ESP32</title>
      <link href="/2021/08/29/led-pao-ma-deng-esp32/"/>
      <url>/2021/08/29/led-pao-ma-deng-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="LEDè·‘é¦¬ç‡ˆ-ESP32"><a href="#LEDè·‘é¦¬ç‡ˆ-ESP32" class="headerlink" title="LEDè·‘é¦¬ç‡ˆ-ESP32"></a>LEDè·‘é¦¬ç‡ˆ-ESP32</h1><h6 id="tags-esp32-led"><a href="#tags-esp32-led" class="headerlink" title="tags: esp32 led"></a>tags: <code>esp32</code> <code>led</code></h6><h2 id="å¯¦é©—ç›®çš„"><a href="#å¯¦é©—ç›®çš„" class="headerlink" title="å¯¦é©—ç›®çš„"></a>å¯¦é©—ç›®çš„</h2><h4 id="äº†è§£è¿´åœˆé‹ç”¨å’Œé™£åˆ—çš„å®£å‘Š-https-esp32-blairan-blogspot-com-2021-04-esp32-26-html"><a href="#äº†è§£è¿´åœˆé‹ç”¨å’Œé™£åˆ—çš„å®£å‘Š-https-esp32-blairan-blogspot-com-2021-04-esp32-26-html" class="headerlink" title="äº†è§£è¿´åœˆé‹ç”¨å’Œé™£åˆ—çš„å®£å‘Š -https://esp32-blairan.blogspot.com/2021/04/esp32_26.html"></a>äº†è§£<strong>è¿´åœˆ</strong>é‹ç”¨å’Œ<strong>é™£åˆ—</strong>çš„å®£å‘Š -<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/6656678562008851992#">https://esp32-blairan.blogspot.com/2021/04/esp32_26.html</a></h4><h2 id="ææ–™"><a href="#ææ–™" class="headerlink" title="ææ–™"></a>ææ–™</h2><p><strong>LEDÃ—4</strong></p><p><strong>220æ­å§†é›»é˜»Ã—4</strong></p><p><strong>æœé‚¦ç·š</strong></p><p><strong>ESP32</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/6656678562008851992#"><img src="https://lh3.googleusercontent.com/-_YYwfEof1D0/YI5jHSJ3t6I/AAAAAAAAeG0/_k5HrzCSfV80legdS9URTnUH0Ad7Kmo7QCNcBGAsYHQ/s1600/1619944218044458-0.png"></a></p><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><h4 id="é™£åˆ—å®£å‘Š-https-esp32-blairan-blogspot-com-2021-04-esp32-26-html"><a href="#é™£åˆ—å®£å‘Š-https-esp32-blairan-blogspot-com-2021-04-esp32-26-html" class="headerlink" title="é™£åˆ—å®£å‘Š https://esp32-blairan.blogspot.com/2021/04/esp32_26.html"></a>é™£åˆ—å®£å‘Š <a href="https://esp32-blairan.blogspot.com/2021/04/esp32_26.html">https://esp32-blairan.blogspot.com/2021/04/esp32_26.html</a></h4><h4 id="forè¿´åœˆ-https-esp32-blairan-blogspot-com-2021-04-esp32-26-html"><a href="#forè¿´åœˆ-https-esp32-blairan-blogspot-com-2021-04-esp32-26-html" class="headerlink" title="forè¿´åœˆ https://esp32-blairan.blogspot.com/2021/04/esp32_26.html"></a>forè¿´åœˆ <a href="https://esp32-blairan.blogspot.com/2021/04/esp32_26.html">https://esp32-blairan.blogspot.com/2021/04/esp32_26.html</a></h4><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">constÂ byteÂ led\[\]&#x3D;&#123;35,Â 32,Â 33,Â 25&#125;;voidÂ setup()Â &#123;Â Â Serial.begin(115200);Â Â forÂ (intÂ iÂ &#x3D;Â 0;Â iÂ &lt;&#x3D;3;Â i++)&#123;    pinMode(led\[i\],Â OUTPUT);Â Â &#125;&#125;voidÂ loop()Â &#123;Â Â forÂ (intÂ iÂ &#x3D;Â 0;Â iÂ &lt;&#x3D;3;Â i++)Â Â &#123;Â Â Â Â digitalWrite(led\[i\],Â HIGH);Â Â Â Â delay(100);Â Â Â Â digitalWrite(led\[i\],Â LOW);Â Â &#125;Â Â Â forÂ (intÂ iÂ &#x3D;Â 3;Â iÂ &gt;&#x3D;Â 0;Â i--)Â Â &#123;Â Â Â Â digitalWrite(led\[i\],Â HIGH);Â Â Â Â delay(100);Â Â Â Â digitalWrite(led\[i\],Â LOW);Â Â &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><div class="video-container"><iframe src="https://www.youtube.com/embed/lDSiaGsfrE4" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ledè·‘é¦¬ç‡ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DHT11/12ç¶²è·¯ç›£æ¸¬æº«æ¿•åº¦è¨ˆ-micropython</title>
      <link href="/2021/08/29/dht11-12-wang-lu-jian-ce-wen-shi-du-ji-micropython/"/>
      <url>/2021/08/29/dht11-12-wang-lu-jian-ce-wen-shi-du-ji-micropython/</url>
      
        <content type="html"><![CDATA[<h2 id="DHT11-12ç¶²è·¯ç›£æ¸¬æº«æ¿•åº¦è¨ˆ-micropython"><a href="#DHT11-12ç¶²è·¯ç›£æ¸¬æº«æ¿•åº¦è¨ˆ-micropython" class="headerlink" title="DHT11/12ç¶²è·¯ç›£æ¸¬æº«æ¿•åº¦è¨ˆ-micropython"></a>DHT11/12ç¶²è·¯ç›£æ¸¬æº«æ¿•åº¦è¨ˆ-micropython</h2><h6 id="tags-micropython-dht11-12-webserver"><a href="#tags-micropython-dht11-12-webserver" class="headerlink" title="tags: micropython dht11/12 webserver"></a>tags: <code>micropython</code> <code>dht11/12 webserver</code></h6><hr><p><strong><em>DHT11/12å–®ç´”æ¸¬è©¦åƒè€ƒé é¢-</em></strong></p><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5661741645243406963?hl=zh-TW#">https://blairan-esp32-micropython.blogspot.com/2021/07/dht11dht12-micropython.html</a></p><p><em><strong>WiFiè¯ç¶²åƒè€ƒ-</strong></em><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5661741645243406963?hl=zh-TW#">https://blairan-esp32-micropython.blogspot.com/2021/07/wifi.html</a></p><hr><h2 id="å®Œæ•´ç¨‹å¼ç¢¼"><a href="#å®Œæ•´ç¨‹å¼ç¢¼" class="headerlink" title="å®Œæ•´ç¨‹å¼ç¢¼"></a>å®Œæ•´ç¨‹å¼ç¢¼</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> dht<span class="token keyword">import</span> network<span class="token punctuation">,</span> socket<span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token keyword">from</span> time <span class="token keyword">import</span> sleepssid<span class="token operator">=</span><span class="token string">"---"</span>password<span class="token operator">=</span><span class="token string">"------"</span>STA<span class="token operator">=</span>network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>STA<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>STA<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token keyword">while</span> STA<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token boolean">False</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The connected successful!"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IP:  &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>STA<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> readTempAndHumi<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> temp<span class="token punctuation">,</span> humi    <span class="token keyword">try</span><span class="token punctuation">:</span>        sensor<span class="token operator">=</span>dht<span class="token punctuation">.</span>DHT11<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        sensor<span class="token punctuation">.</span>measure<span class="token punctuation">(</span><span class="token punctuation">)</span>        temp<span class="token operator">=</span>sensor<span class="token punctuation">.</span>temperature<span class="token punctuation">(</span><span class="token punctuation">)</span>        humi<span class="token operator">=</span>sensor<span class="token punctuation">.</span>humidity<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>humi<span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>humi<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>          measureResult<span class="token operator">=</span><span class="token string">"&#123;&#125;,&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> humi<span class="token punctuation">)</span>          <span class="token keyword">return</span> measureResult        <span class="token keyword">else</span><span class="token punctuation">:</span>          <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token string">"--"</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> OSError <span class="token keyword">as</span> o<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"--"</span><span class="token punctuation">)</span><span class="token keyword">def</span> Htmlpage<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  html<span class="token operator">=</span> <span class="token triple-quoted-string string">"""        &lt;html>    &lt;head>      &lt;meta charset="utf-8" />      &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" />      &lt;style>        h1  &#123;text-align: center; background-color: orange; margin-right:5px;&#125;        dl &#123; width: 320px; margin: 12px auto; &#125;        dt &#123;           font-size: 20pt; color: #444; background-color: #ddd;          margin: 6pt 0; padding: 6pt 12pt;        &#125;        dd &#123;          text-align: right; padding-right: 6pt;        &#125;        .num &#123; font-size: 36pt; color: dodgerblue; &#125;      &lt;/style>      &lt;/head>    &lt;body>      &lt;p>&lt;h1>ESP32 DHT11/12&lt;/h1>&lt;/p>      &lt;dl>        &lt;dt>Temp&lt;/dt>        &lt;dd class=num>"""</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token operator">+</span><span class="token triple-quoted-string string">"""Â°C&lt;/dd>        &lt;dt>Humi&lt;/dt>        &lt;dd class=num>"""</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>humi<span class="token punctuation">)</span><span class="token operator">+</span><span class="token triple-quoted-string string">""" %&lt;/dd>      &lt;/dl>    &lt;/body>    &lt;/html>    """</span>  <span class="token keyword">return</span> htmls<span class="token operator">=</span>socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Got a connection from %s'</span> <span class="token operator">%</span> <span class="token builtin">str</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">)</span>    req <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Content = %s'</span> <span class="token operator">%</span> <span class="token builtin">str</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">)</span>    sensor_reading <span class="token operator">=</span> readTempAndHumi<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>sensor_reading<span class="token punctuation">)</span>    respone <span class="token operator">=</span> Htmlpage<span class="token punctuation">(</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"http/1.1 200 OK\\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"Content-Type: text/html; charset='utf-8'\\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"Connection: close\\n\\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>respone<span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">**</span>_è¼‰å…¥dht<span class="token punctuation">,</span>wifi<span class="token punctuation">,</span>ç«¯å£<span class="token punctuation">,</span>pinå’Œæ™‚é–“æ¨¡çµ„_<span class="token operator">**</span><span class="token keyword">import</span> dht<span class="token keyword">import</span> network<span class="token punctuation">,</span> socket<span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>é€™å€‹éƒ¨ä»½æ˜¯è¨­åˆ¶WiFiçš„æµç¨‹</em></strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ssid<span class="token operator">=</span><span class="token string">"åŸºåœ°å°åç¨±"</span>password<span class="token operator">=</span><span class="token string">"åŸºåœ°å°å¯†ç¢¼"</span>STA<span class="token operator">=</span>network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>STA<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>STA<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token keyword">while</span> STA<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token boolean">False</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The connected successful!"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IP:  &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>STA<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>è®€å–æº«æº¼åº¦çš„å‡½å¼</em></strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> readTempAndHumi<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> temp<span class="token punctuation">,</span> humi    <span class="token keyword">try</span><span class="token punctuation">:</span>        sensor<span class="token operator">=</span>dht<span class="token punctuation">.</span>DHT11<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        sensor<span class="token punctuation">.</span>measure<span class="token punctuation">(</span><span class="token punctuation">)</span>        temp<span class="token operator">=</span>sensor<span class="token punctuation">.</span>temperature<span class="token punctuation">(</span><span class="token punctuation">)</span>        humi<span class="token operator">=</span>sensor<span class="token punctuation">.</span>humidity<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>humi<span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>humi<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        measureResult<span class="token operator">=</span><span class="token string">"&#123;&#125;,&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> humi<span class="token punctuation">)</span>            <span class="token keyword">return</span> measureResult        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token string">"--"</span><span class="token punctuation">)</span>     <span class="token keyword">except</span> OSError <span class="token keyword">as</span> o<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"--"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ç¶²é å‰ç«¯çš„å¸ƒç½®,è¨˜å¾—è¦è®“å…¶è®€å–æ™‚å¯è¿”å›(return)</strong></p><p><strong>å…¶ä¸­é ˆæ³¨æ„çš„æ˜¯è®“æº«æº¼åº¦çš„å€¼å¯ä»¥æ­£é¡¯ç¤ºè¦ä½¿ç”¨</strong>â€œâ€â€+str(æº«/æº¼åº¦è®Šæ•¸)+â€â€â€</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> Htmlpage<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  html<span class="token operator">=</span> <span class="token triple-quoted-string string">"""        &lt;html>    &lt;head>      &lt;meta charset="utf-8" />      &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" />      &lt;style>        h1  &#123;text-align: center; background-color: orange; margin-right:5px;&#125;        dl &#123; width: 320px; margin: 12px auto; &#125;        dt &#123;           font-size: 20pt; color: #444; background-color: #ddd;          margin: 6pt 0; padding: 6pt 12pt;        &#125;        dd &#123;          text-align: right; padding-right: 6pt;        &#125;        .num &#123; font-size: 36pt; color: dodgerblue; &#125;      &lt;/style>      &lt;/head>    &lt;body>      &lt;p>&lt;h1>ESP32 DHT11/12&lt;/h1>&lt;/p>      &lt;dl>        &lt;dt>Temp&lt;/dt>        &lt;dd class=num>"""</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token operator">+</span><span class="token triple-quoted-string string">"""Â°C&lt;/dd>        &lt;dt>Humi&lt;/dt>        &lt;dd class=num>"""</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>humi<span class="token punctuation">)</span><span class="token operator">+</span><span class="token triple-quoted-string string">""" %&lt;/dd>      &lt;/dl>    &lt;/body>    &lt;/html>    """</span>  <span class="token keyword">return</span> html<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>è¨­åˆ¶ç›£è½å¥—æ¥ç«¯å£</em></strong></p><p><strong><em>å‡½å¼åƒè€ƒ-</em></strong><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5661741645243406963?hl=zh-TW#">æˆ‘çš„micropythonå‡½å¼ç­†è¨˜</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">s<span class="token operator">=</span>socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Got a connection from %s'</span> <span class="token operator">%</span> <span class="token builtin">str</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">)</span>    req <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Content = %s'</span> <span class="token operator">%</span> <span class="token builtin">str</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">)</span>    sensor_reading <span class="token operator">=</span> readTempAndHumi<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>sensor_reading<span class="token punctuation">)</span>    respone <span class="token operator">=</span> Htmlpage<span class="token punctuation">(</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"http/1.1 200 OK\\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"Content-Type: text/html; charset='utf-8'\\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"Connection: close\\n\\n"</span><span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>respone<span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/5661741645243406963?hl=zh-TW#"><img src="https://lh3.googleusercontent.com/-stu-h6hdsgc/YOaaTDfLfOI/AAAAAAAAeaQ/NiNjk1xHXl0YOU_J8btvb9Qd3isHo6ZvwCNcBGAsYHQ/s1600/1625725506698515-0.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webserver </tag>
            
            <tag> DHT11/DHT12 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWMæ§åˆ¶æ¿ä¸Šå…§å»ºLED-ESP32</title>
      <link href="/2021/08/29/pwm-kong-zhi-ban-shang-nei-jian-led-esp32/"/>
      <url>/2021/08/29/pwm-kong-zhi-ban-shang-nei-jian-led-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="PWMæ§åˆ¶æ¿ä¸Šå…§å»ºLED-ESP32"><a href="#PWMæ§åˆ¶æ¿ä¸Šå…§å»ºLED-ESP32" class="headerlink" title="PWMæ§åˆ¶æ¿ä¸Šå…§å»ºLED-ESP32"></a>PWMæ§åˆ¶æ¿ä¸Šå…§å»ºLED-ESP32</h1><h6 id="tags-esp32-led-pwm"><a href="#tags-esp32-led-pwm" class="headerlink" title="tags: esp32 led pwm"></a>tags: <code>esp32</code> <code>led</code> <code>pwm</code></h6><h2 id="ææ–™"><a href="#ææ–™" class="headerlink" title="ææ–™"></a>ææ–™</h2><ol><li><h4 id="ESP32æ§åˆ¶æ¿-x1"><a href="#ESP32æ§åˆ¶æ¿-x1" class="headerlink" title="ESP32æ§åˆ¶æ¿ x1"></a>ESP32æ§åˆ¶æ¿ x1</h4></li><li><h4 id="å¯è®Šé›»é˜»-x1"><a href="#å¯è®Šé›»é˜»-x1" class="headerlink" title="å¯è®Šé›»é˜» x1"></a>å¯è®Šé›»é˜» x1</h4></li><li><h4 id="10Kæ­å§†é›»é˜»-x1"><a href="#10Kæ­å§†é›»é˜»-x1" class="headerlink" title="10Kæ­å§†é›»é˜» x1"></a>10Kæ­å§†é›»é˜» x1</h4></li></ol><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5354569437760337966#"><img src="https://1.bp.blogspot.com/-lGkj-SvW41c/YId8HIPFBQI/AAAAAAAAeGI/P0q3-HrMSrI2FS2aWVSbTbB_09B4vGtpACNcBGAsYHQ/w718-h337/2.jpg"></a></p><hr><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre><code class="c#">#define pwm1 A4voidÂ setup()&#123;Â Â Serial.begin(115200);Â Â ledcSetup(0,Â 5000,Â 10);Â Â ledcAttachPin(LED_BUILTIN,Â 0);Â Â pinMode(LED_BUILTIN,Â OUTPUT);&#125;voidÂ loop()&#123;Â Â intÂ val=analogRead(pwm1);Â Â val=map(val,Â 0,Â 4095,Â 0,Â 1023);Â Â Serial.printf(&quot;è¼¸å‡ºå€¼ç‚º:Â %u\\n&quot;,Â val);Â Â ledcWrite(0,Â val);Â Â delay(100);&#125;</code></pre><hr><h2 id="ç¨‹å¼ç¢¼éƒ¨ä»½èªªæ˜"><a href="#ç¨‹å¼ç¢¼éƒ¨ä»½èªªæ˜" class="headerlink" title="ç¨‹å¼ç¢¼éƒ¨ä»½èªªæ˜"></a>ç¨‹å¼ç¢¼éƒ¨ä»½èªªæ˜</h2><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/5354569437760337966#">ESP32å‡½å¼ç­†è¨˜æœ¬</a>-PWM  </p><h3 id="å’ŒArduinoä¸ä¸€å¤ªä¸€æ¨£çš„åœ°æ–¹æ˜¯åœ¨å¤šäº†è¨­å®šPWMçš„é€šé“å’Œé »ç‡-ç•¶ä¸­å…¶å¯¦æ›´å®Œå–„çš„æ–¹æ³•é‚„æœ‰ä½å…ƒæ•¸çš„è½‰æ›ï¼Œå› ç‚ºESP32çš„é¡æ¯”æ•¸å€¼æ˜¯4095-è€ŒArduinoçš„æ•¸å€¼æ˜¯1023-æ‰€ä»¥åœ¨ledcSetup-è£¡çš„10æ˜¯ä»£è¡¨esp32çš„10ä½å…ƒ-ä½†æˆ‘è©¦è‘—ç”¨åŸç”Ÿçš„æ–¹å¼map-è½‰æ›æ¸¬è©¦å¾Œé‚„å¯ä»¥-analogRead-ä¸€æ¨£æœ‰-ä½†å°‘äº†analogWrite-é€™éƒ¨ä»½ä»¥ledcWrite-å–ä»£ã€‚"><a href="#å’ŒArduinoä¸ä¸€å¤ªä¸€æ¨£çš„åœ°æ–¹æ˜¯åœ¨å¤šäº†è¨­å®šPWMçš„é€šé“å’Œé »ç‡-ç•¶ä¸­å…¶å¯¦æ›´å®Œå–„çš„æ–¹æ³•é‚„æœ‰ä½å…ƒæ•¸çš„è½‰æ›ï¼Œå› ç‚ºESP32çš„é¡æ¯”æ•¸å€¼æ˜¯4095-è€ŒArduinoçš„æ•¸å€¼æ˜¯1023-æ‰€ä»¥åœ¨ledcSetup-è£¡çš„10æ˜¯ä»£è¡¨esp32çš„10ä½å…ƒ-ä½†æˆ‘è©¦è‘—ç”¨åŸç”Ÿçš„æ–¹å¼map-è½‰æ›æ¸¬è©¦å¾Œé‚„å¯ä»¥-analogRead-ä¸€æ¨£æœ‰-ä½†å°‘äº†analogWrite-é€™éƒ¨ä»½ä»¥ledcWrite-å–ä»£ã€‚" class="headerlink" title="å’ŒArduinoä¸ä¸€å¤ªä¸€æ¨£çš„åœ°æ–¹æ˜¯åœ¨å¤šäº†è¨­å®šPWMçš„é€šé“å’Œé »ç‡,ç•¶ä¸­å…¶å¯¦æ›´å®Œå–„çš„æ–¹æ³•é‚„æœ‰ä½å…ƒæ•¸çš„è½‰æ›ï¼Œå› ç‚ºESP32çš„é¡æ¯”æ•¸å€¼æ˜¯4095,è€ŒArduinoçš„æ•¸å€¼æ˜¯1023,æ‰€ä»¥åœ¨ledcSetup()è£¡çš„10æ˜¯ä»£è¡¨esp32çš„10ä½å…ƒ,ä½†æˆ‘è©¦è‘—ç”¨åŸç”Ÿçš„æ–¹å¼map()è½‰æ›æ¸¬è©¦å¾Œé‚„å¯ä»¥,analogRead()ä¸€æ¨£æœ‰,ä½†å°‘äº†analogWrite(),é€™éƒ¨ä»½ä»¥ledcWrite()å–ä»£ã€‚"></a>å’ŒArduinoä¸ä¸€å¤ªä¸€æ¨£çš„åœ°æ–¹æ˜¯åœ¨å¤šäº†è¨­å®šPWMçš„é€šé“å’Œé »ç‡,ç•¶ä¸­å…¶å¯¦æ›´å®Œå–„çš„æ–¹æ³•é‚„æœ‰ä½å…ƒæ•¸çš„è½‰æ›ï¼Œå› ç‚ºESP32çš„é¡æ¯”æ•¸å€¼æ˜¯4095,è€ŒArduinoçš„æ•¸å€¼æ˜¯1023,æ‰€ä»¥åœ¨ledcSetup()è£¡çš„10æ˜¯ä»£è¡¨esp32çš„10ä½å…ƒ,ä½†æˆ‘è©¦è‘—ç”¨åŸç”Ÿçš„æ–¹å¼map()è½‰æ›æ¸¬è©¦å¾Œé‚„å¯ä»¥,analogRead()ä¸€æ¨£æœ‰,ä½†å°‘äº†analogWrite(),é€™éƒ¨ä»½ä»¥ledcWrite()å–ä»£ã€‚</h3><hr><div class="video-container"><iframe src="https://www.youtube.com/embed/bO9G6uzPRcw" frameborder="0" loading="lazy" allowfullscreen></iframe></div>https://youtu.be/bO9G6uzPRcw]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> esp32 </tag>
            
            <tag> led </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQTT&amp;node-REDæ§åˆ¶äºŒè»¸äº‘å°-mpython</title>
      <link href="/2021/08/28/mqtt-node-red-kong-zhi-er-zhou-yun-tai-mpython/"/>
      <url>/2021/08/28/mqtt-node-red-kong-zhi-er-zhou-yun-tai-mpython/</url>
      
        <content type="html"><![CDATA[<h1 id="MQTT-amp-node-REDæ§åˆ¶äºŒè»¸äº‘å°-mpython"><a href="#MQTT-amp-node-REDæ§åˆ¶äºŒè»¸äº‘å°-mpython" class="headerlink" title="MQTT&amp;node-REDæ§åˆ¶äºŒè»¸äº‘å°-mpython"></a>MQTT&amp;node-REDæ§åˆ¶äºŒè»¸äº‘å°-mpython</h1><p><a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/4999901201185761586#"><img src="https://lh3.googleusercontent.com/-sqJOZzdBnks/YSjK1HOEkWI/AAAAAAAAe3o/ShJX8l8V20cmENfwoL0iij0uZm_wHfwaQCNcBGAsYHQ/w208-h349/1630063309993121-0.png"></a></p><p><em><strong>æ‰¿æ¥<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/4999901201185761586#">ä½¿ç”¨PWMæ§åˆ¶ä¼ºæœé¦¬é”-micropython</a>é€™ç¯‡ï¼Œé€énode-redåŠ å…¥mqttè¨‚é–±ä¸»é¡Œæ§åˆ¶äºŒè»¸äº‘å°</strong></em></p><p><em><strong>æœ‰ä¸€äº›æ„Ÿæƒ³ç´€éŒ„ä¸‹ä¾†ï¼Œæˆ‘ç™¼ç¾å…¶å¯¦åƒmqttæˆ–è€…wifié€£ç¶²ï¼Œå¤§éƒ½æ˜¯å›ºå®šä¸€å€‹å¯«æ³•ï¼Œå…¶å®ƒä¸åŒçš„æ¨¡çµ„åˆ†ç‚ºè®€å–æ•¸å€¼æˆ–ç”¨æ•¸å€¼å—æ§åˆ¶çš„å…ƒä»¶ï¼Œåªè¦å¥—ç”¨ä¸Šå»å°±å¯ä»¥ã€‚</strong></em></p><p><em><strong>é¦–å…ˆä¸»è¦æ˜¯è¢«æ§åˆ¶çš„ä¼ºæœé¦¬é”ï¼Œæ‰€ä»¥å…ˆæŠŠå®ƒæ¸¬è©¦ä¸€ä¸‹ï¼Œåƒè€ƒé€™ç¯‡ï¼ˆ<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/4999901201185761586#">é»æˆ‘</a>ï¼‰</strong></em></p><p><em><strong>æ¸¬è©¦å¥½ä¹‹å¾Œï¼Œå°±å¯ä»¥é–‹å§‹åŠ å…¥wifiå’Œmqttäº†ï¼Œä½†å› ç‚ºæˆ‘ç”¨çš„æ˜¯æ¨¹è“æ´¾å»ºç«‹çš„ï¼­QTTï¼Œæ‰€ä»¥é€™é™ªåˆ†å‰ææ˜¯è¦æœ‰æ¨¹è‹ºæ´¾ï¼Œå¦‚ä½•åœ¨æ¨¹è‹ºæ´¾ä¸Šå»ºç«‹ï¼®ode-REDå’ŒMQTTï¼Œå¯ä»¥åƒè€ƒé€™ç¯‡ï¼ˆ<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/4999901201185761586#">é»æˆ‘</a>ï¼‰ã€‚</strong></em></p><hr><h2 id="Node-REDè¨­å®š"><a href="#Node-REDè¨­å®š" class="headerlink" title="Node-REDè¨­å®š"></a>Node-REDè¨­å®š</h2><p><a href="https://1.bp.blogspot.com/-GksKBPZ26_o/YSpWJWFmwhI/AAAAAAAAe4E/6peztH_jPDgTVkrbfKGBriWMdPbxcnCyACNcBGAsYHQ/s1920/3.jpg"><img src="https://1.bp.blogspot.com/-GksKBPZ26_o/YSpWJWFmwhI/AAAAAAAAe4E/6peztH_jPDgTVkrbfKGBriWMdPbxcnCyACNcBGAsYHQ/w654-h368/3.jpg"></a></p><p><a href="https://1.bp.blogspot.com/-bIpsZvvgG6Y/YSpVzj9SmhI/AAAAAAAAe34/-V-RirefCUETcVru84SLRomgYX3EzNOnQCNcBGAsYHQ/s1920/1.jpg"><img src="https://1.bp.blogspot.com/-bIpsZvvgG6Y/YSpVzj9SmhI/AAAAAAAAe34/-V-RirefCUETcVru84SLRomgYX3EzNOnQCNcBGAsYHQ/w661-h370/1.jpg"></a></p><p><a href="https://1.bp.blogspot.com/-AS8DJhdGX5Q/YSpV8K4e0hI/AAAAAAAAe38/1h6rhTpCw1wwJ_hmA4QAZDDkU-6MBBANwCNcBGAsYHQ/s1920/2.jpg"><img src="https://1.bp.blogspot.com/-AS8DJhdGX5Q/YSpV8K4e0hI/AAAAAAAAe38/1h6rhTpCw1wwJ_hmA4QAZDDkU-6MBBANwCNcBGAsYHQ/w654-h368/2.jpg"></a></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre><code class="python">from machine import SLEEP, Pin, PWM, freqfrom time import sleep from umqtttsimple import MQTTClient  import binascii, micropython, network, time, socket, machine    ssid = &quot;------------&quot;password = &quot;-------&quot;mqtt_server = &quot;192.168.210.22&quot;    #å°‡å®¢æˆ¶ç«¯IDè½‰æ›ç‚º16é€²ä½,ä»¥ä¾¿MQTTä¼ºæœç«¯è®€å–    mqtt_id = binascii.hexlify(machine.unique_id())    #å’ŒNord-REDä¸Šçš„ä¸»é¡Œä¸€è‡´    client_servoPan = b&#39;esp32/servoPan&#39;client_servoTilt = b&#39;esp32/servoTilt&#39;    servo_pan = PWM(Pin(13), freq=50)servo_tilt = PWM(Pin(14), freq=50)    #wifié€£ç·š    def wifiConn():    wifi = network.WLAN(network.STA_IF)    wifi.active(True)Â  Â  wifi.connect(ssid, password) Â   while wifi.isconnected() == False:        pass    print(&quot;Connected successful!&quot;)    print(&quot;IP: &#123;&#125;&quot;.format(wifi.ifconfig()))    #æ¨¹è“æ´¾ä¸Šçš„mqttå›æ‡‰è¨‚é–±def callBack(topic, msg):    print((topic, msg))    if topic == client_servoPan:        servo_pan.duty(int(msg))        sleep(0.5)    elif topic == client_servoTilt:        servo_tilt.duty(int(msg))        sleep(0.5)    #é€£ç·šMQTT,é€£ç·šæˆåŠŸå¾Œè¨‚é–±ä¸»é¡Œdef connToMqtt():    try:        client = MQTTClient(mqtt_id, mqtt_server)        client.set_callback(callBack)        client.connect()        client.subscribe(client_servoPan)        client.subscribe(client_servoTilt)        print(&quot;connect to %s&quot;%mqtt_server)        return client        #å¦‚æœç„¡æ³•é€£ç·šé‡æ–°é€£ç·š    except OSError as e:        print(&quot;not to connected for MQTT server!&quot;)        machine.reset()    wifiConn()client = connToMqtt()while True:    #æª¢æŸ¥æœ‰ç„¡é€²ä¾†çš„è¨Šæ¯    client.check_msg()</code></pre><p>èª¿éç­‰å¾…æ™‚é–“é‚„æ˜¯æœƒå¶çˆ¾æŠ–å‹•ï¼Œé›–ç„¶ä¸çŸ¥é“æŠ–å‹•åŸåœ¨å“ªï¼Œå…ˆé€™æ¨£å¥½äº†ï¼Œä¸‹æ¬¡å†ä¾†æŠ“åŸå› ã€‚</p><div class="video-container"><iframe src="https://www.youtube.com/embed/HxkOYhqcgaY" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mqtt </tag>
            
            <tag> node-red </tag>
            
            <tag> äºŒè»¸äº‘å° </tag>
            
            <tag> servo </tag>
            
            <tag> ä¼ºæœé¦¬é” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–æ¡¿æ§åˆ¶äº‘å°-ESP32</title>
      <link href="/2021/08/28/yao-gan-kong-zhi-yun-tai-esp32/"/>
      <url>/2021/08/28/yao-gan-kong-zhi-yun-tai-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="æ–æ¡¿æ§åˆ¶äº‘å°-ESP32"><a href="#æ–æ¡¿æ§åˆ¶äº‘å°-ESP32" class="headerlink" title="æ–æ¡¿æ§åˆ¶äº‘å°-ESP32"></a>æ–æ¡¿æ§åˆ¶äº‘å°-ESP32</h1><h6 id="tags-esp32-æ–æ¡¿-äº‘å°"><a href="#tags-esp32-æ–æ¡¿-äº‘å°" class="headerlink" title="tags: esp32 æ–æ¡¿ äº‘å°"></a>tags: <code>esp32</code> <code>æ–æ¡¿</code> <code>äº‘å°</code></h6><h3 id="å¯¦é©—ç›®çš„"><a href="#å¯¦é©—ç›®çš„" class="headerlink" title="å¯¦é©—ç›®çš„"></a>å¯¦é©—ç›®çš„</h3><p><strong>ä»¥æ–æ¡¿çš„è®€å€¼åŒæ­¥æ§åˆ¶ä¼ºæœé¦¬é”ã€‚</strong></p><p><strong>é ˆæ³¨æ„å€¼è¦è½‰æ›æˆè§’åº¦ã€‚</strong></p><h3 id="ä¼ºæœé¦¬é”"><a href="#ä¼ºæœé¦¬é”" class="headerlink" title="ä¼ºæœé¦¬é”"></a>ä¼ºæœé¦¬é”</h3><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/3060329269915131288#"><img src="https://1.bp.blogspot.com/-qUFym3H-21Q/YIywjKU9TPI/AAAAAAAAeGk/_GiSq6LVWYA4sOlvfkGRHzt-lUoZgKjjwCNcBGAsYHQ/w315-h210/servo.jpg"></a></p><p><strong>ä¼ºæœé¦¬é”è¢«å»£ç¯„é‹åœ¨å¾®æ§æ¿çš„æ§åˆ¶ä¸Š,å¹¾ä¹é€™æ˜¯å­¸ç¿’å¾®æ§æ¿çš„åŸºç¤</strong></p><p><strong>å…·ä»£è¡¨çš„å¯¦é©—å°±æ˜¯äºŒè»¸äº‘å°,å®ƒæ˜¯ä»¥å…©å€‹ä¼ºæœé¦¬é”æ§‹æˆå¹³ç§»å’Œä¸Šä¸‹</strong></p><p><strong>é‹å‹•çš„è£ç½®,è‡³æ–¼SG90é€™ç¨®å°å‹ä¼ºæœé¦¬é”çš„é‹ä½œç¶²è·¯ä¸Šå¾ˆå¤šè³‡æº,</strong></p><p><strong>å°±ä¸ä¸€ä¸€è´…è¿°ã€‚</strong></p><h2 id="æ–æ¡¿æ¨¡çµ„"><a href="#æ–æ¡¿æ¨¡çµ„" class="headerlink" title="æ–æ¡¿æ¨¡çµ„"></a>æ–æ¡¿æ¨¡çµ„</h2><h4 id="è«‹åƒç…§é€™ç¯‡çš„å¯¦é©—â€”https-esp32-blairan-blogspot-com-2021-04-esp32-28-html"><a href="#è«‹åƒç…§é€™ç¯‡çš„å¯¦é©—â€”https-esp32-blairan-blogspot-com-2021-04-esp32-28-html" class="headerlink" title="è«‹åƒç…§é€™ç¯‡çš„å¯¦é©—â€”https://esp32-blairan.blogspot.com/2021/04/esp32_28.html"></a>è«‹åƒç…§é€™ç¯‡çš„å¯¦é©—â€”<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/3060329269915131288#">https://esp32-blairan.blogspot.com/2021/04/esp32_28.html</a></h4><h2 id="æ¥ç·šåœ–"><a href="#æ¥ç·šåœ–" class="headerlink" title="æ¥ç·šåœ–"></a>æ¥ç·šåœ–</h2><p><strong>POSï¼¸-D33</strong></p><p><strong>POSï¼¹â€”D32</strong></p><p><strong>SERVO_PANâ€”-&gt;D12</strong></p><p><strong>SERVO_TITâ€”-&gt;D13</strong></p><p><strong>GND</strong></p><p><strong>3V3</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/3060329269915131288#"><img src="https://1.bp.blogspot.com/-OySoM8bHU9s/YIyyJmCXZLI/AAAAAAAAeGs/G450OX409awrx2D8wMHg3dZGLJPPd5QLwCNcBGAsYHQ/w450-h467/1.jpg"></a></p><p><strong>é ˆåŒ¯å…¥</strong><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/3060329269915131288#">ESP32Servo.h</a></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><pre><code class="c#">#include &lt;ESP32Servo.h&gt;ServoÂ Pan;ServoÂ Tit;#define servoPAN 12#define servoTIT 13#define posX 33#define posY 32 voidÂ setup()&#123;Â Â Serial.begin(115200);Â Â analogSetAttenuation(ADC_11db);Â Â analogSetWidth(10);Â Â Pan.setPeriodHertz(50);Â Â Tit.setPeriodHertz(50);Â Â Pan.attach(servoPAN,Â 500,Â 2400);Â Â Tit.attach(servoTIT,Â 500,Â 2400);&#125;voidÂ loop()&#123;Â Â intÂ valx=analogRead(posX);Â Â valx=map(valx,Â 0,Â 1023,Â 0,Â 180);Â Â Pan.write(valx);Â Â intÂ valy=analogRead(posY);Â Â valy=map(valy,Â 0,Â 1023,Â 0,Â 180);Â Â Tit.write(valy);Â Â delay(500);Â Â Serial.printf(&quot;posXçš„æ–æ¡¿å€¼ç‚º:Â %dÂ Â //Â posYçš„æ–æ¡¿å€¼ç‚º:Â %d\\n&quot;,valx,Â valy);&#125;</code></pre><div class="video-container"><iframe src="https://www.youtube.com/embed/-CYCyibcFn0" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> esp32 </tag>
            
            <tag> æ–æ¡¿ </tag>
            
            <tag> äº‘å° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è—èŠ½åŸºæœ¬é€šè¨Š&amp;æ§åˆ¶LED-ESP32</title>
      <link href="/2021/08/28/lan-ya-ji-ben-tong-xun-kong-zhi-led-esp32/"/>
      <url>/2021/08/28/lan-ya-ji-ben-tong-xun-kong-zhi-led-esp32/</url>
      
        <content type="html"><![CDATA[<h1 id="è—èŠ½åŸºæœ¬é€šè¨Š-amp-æ§åˆ¶LED-ESP32"><a href="#è—èŠ½åŸºæœ¬é€šè¨Š-amp-æ§åˆ¶LED-ESP32" class="headerlink" title="è—èŠ½åŸºæœ¬é€šè¨Š&amp;æ§åˆ¶LED-ESP32"></a>è—èŠ½åŸºæœ¬é€šè¨Š&amp;æ§åˆ¶LED-ESP32</h1><h6 id="tags-esp32-è—èŠ½"><a href="#tags-esp32-è—èŠ½" class="headerlink" title="tags: esp32 è—èŠ½"></a>tags: <code>esp32</code> <code>è—èŠ½</code></h6><hr><h4 id="Arduinoæœ¬èº«ä¹Ÿå¯ä»¥å¤–æ¥è—èŠ½å’ŒWIFIï¼Œä½†æ˜¯é ˆè¦å¤–æ›ï¼Œé€™é»"><a href="#Arduinoæœ¬èº«ä¹Ÿå¯ä»¥å¤–æ¥è—èŠ½å’ŒWIFIï¼Œä½†æ˜¯é ˆè¦å¤–æ›ï¼Œé€™é»" class="headerlink" title="Arduinoæœ¬èº«ä¹Ÿå¯ä»¥å¤–æ¥è—èŠ½å’ŒWIFIï¼Œä½†æ˜¯é ˆè¦å¤–æ›ï¼Œé€™é»"></a>Arduinoæœ¬èº«ä¹Ÿå¯ä»¥å¤–æ¥è—èŠ½å’ŒWIFIï¼Œä½†æ˜¯é ˆè¦å¤–æ›ï¼Œé€™é»</h4><h4 id="å°±é¡¯å¾—éº»ç…©ä¸€äº›ï¼›ESP32ç³»åˆ—éƒ½æœ‰å…§å»ºè—èŠ½å’ŒWIFIé€™æ¨£å°±ç¨"><a href="#å°±é¡¯å¾—éº»ç…©ä¸€äº›ï¼›ESP32ç³»åˆ—éƒ½æœ‰å…§å»ºè—èŠ½å’ŒWIFIé€™æ¨£å°±ç¨" class="headerlink" title="å°±é¡¯å¾—éº»ç…©ä¸€äº›ï¼›ESP32ç³»åˆ—éƒ½æœ‰å…§å»ºè—èŠ½å’ŒWIFIé€™æ¨£å°±ç¨"></a>å°±é¡¯å¾—éº»ç…©ä¸€äº›ï¼›ESP32ç³»åˆ—éƒ½æœ‰å…§å»ºè—èŠ½å’ŒWIFIé€™æ¨£å°±ç¨</h4><h4 id="èƒ½çœäº‹ï¼Œè€Œä¸”èªæ³•å’ŒArduinoçš„è—èŠ½ç”¨æ³•å¹¾ä¹ä¸€æ¨£ã€‚"><a href="#èƒ½çœäº‹ï¼Œè€Œä¸”èªæ³•å’ŒArduinoçš„è—èŠ½ç”¨æ³•å¹¾ä¹ä¸€æ¨£ã€‚" class="headerlink" title="èƒ½çœäº‹ï¼Œè€Œä¸”èªæ³•å’ŒArduinoçš„è—èŠ½ç”¨æ³•å¹¾ä¹ä¸€æ¨£ã€‚"></a>èƒ½çœäº‹ï¼Œè€Œä¸”èªæ³•å’ŒArduinoçš„è—èŠ½ç”¨æ³•å¹¾ä¹ä¸€æ¨£ã€‚</h4><hr><h2 id="æ“ä½œæ–¹æ³•"><a href="#æ“ä½œæ–¹æ³•" class="headerlink" title="æ“ä½œæ–¹æ³•:"></a>æ“ä½œæ–¹æ³•:</h2><p>:memo: <strong><em>é¦–å…ˆå¯«å¥½ç¨‹å¼ä¸¦ä¸Šå‚³è‡³ESP32</em></strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;BluetoothSerial.h&gt;BluetoothSerialÂ myBT;charÂ incomeData;voidÂ setup()&#123;Â Â Â Â Serial.begin(115200);Â Â Â Â myBT.begin(&quot;ctkBT-01&quot;);Â Â Â Â pinMode(LED_BUILTIN,Â OUTPUT);&#125;voidÂ loop()&#123;Â Â Â Â ifÂ (myBT.available())&#123;Â Â Â Â Â Â Â Â incomeData&#x3D;myBT.read();Â Â Â Â Â Â Â Â Serial.printf(&quot;å¾è—èŠ½åˆ°:Â %d\&quot;,Â incomeData);Â Â Â Â &#125;Â Â Â Â ifÂ (incomeData&#x3D;&#x3D;&#39;1&#39;)&#123;Â Â Â Â Â Â Â Â digitalWrite(LED_BUILTIN,Â HIGH);Â Â Â Â Â Â Â Â myBT.printf(&quot;LEDé–‹å•“å›‰!!!&quot;);Â Â &#x2F;&#x2F;æ‰‹æ©Ÿç«¯æ”¶è¨ŠÂ Â Â Â &#125;elseÂ ifÂ (incomeData&#x3D;&#x3D;&#39;0&#39;)Â Â Â Â &#123;Â Â Â Â Â Â Â Â digitalWrite(LED_BUILTIN,Â LOW);Â Â Â Â Â Â Â Â myBT.printf(&quot;LEDé—œé–‰å›‰!!!&quot;);Â &#x2F;&#x2F;æ‰‹æ©Ÿç«¯æ”¶è¨ŠÂ Â Â Â &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p>:memo:<strong>æ‰‹æ©Ÿç«¯</strong></p><ol><li> <strong>æ‰‹æ©Ÿè—èŠ½é…å°ESP32</strong></li><li><strong>åœ¨google playerä¸‹è¼‰Serial Bluetooth Terminal</strong></li></ol><p><strong>å…¶å®ƒè«‹çœ‹è¦–é »æ“ä½œ</strong></p><div class="video-container"><iframe src="https://www.youtube.com/embed/G1-VYOFByYU" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> esp32 </tag>
            
            <tag> è—èŠ½ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ESP32è¨­å®šç„¡ç·šåŸºåœ°å°å’Œå›ºå®šIP</title>
      <link href="/2021/08/28/esp32-she-ding-wu-xian-ji-di-tai-he-gu-ding-ip/"/>
      <url>/2021/08/28/esp32-she-ding-wu-xian-ji-di-tai-he-gu-ding-ip/</url>
      
        <content type="html"><![CDATA[<h1 id="ESP32è¨­å®šç„¡ç·šåŸºåœ°å°å’Œå›ºå®šIP"><a href="#ESP32è¨­å®šç„¡ç·šåŸºåœ°å°å’Œå›ºå®šIP" class="headerlink" title="ESP32è¨­å®šç„¡ç·šåŸºåœ°å°å’Œå›ºå®šIP"></a>ESP32è¨­å®šç„¡ç·šåŸºåœ°å°å’Œå›ºå®šIP</h1><h6 id="tags-esp32-ç„¡ç·šåŸºåœ°å°"><a href="#tags-esp32-ç„¡ç·šåŸºåœ°å°" class="headerlink" title="tags: esp32 ç„¡ç·šåŸºåœ°å°"></a>tags: <code>esp32</code> <code>ç„¡ç·šåŸºåœ°å°</code></h6><p><strong>ESP32ä¹Ÿèƒ½ä½¿è‡ªå·±è®Šæˆç„¡ç·šåŸºåœ°å°(AP)ï¼Œä½¿å…¶å®ƒè¨­å‚™é€£ä¸Šè‡ªå·±çš„ç¶²è·¯ï¼Œ</strong></p><p><strong>é›–ç„¶å¾ˆæ–¹ä¾¿ï¼Œä½†ä¸é©åˆç”¨æ–¼è² è·é«˜çš„æ‡‰ç”¨ã€‚</strong></p><p><strong>åªè¦ä¸€è¡ŒçŸ­çš„æŒ‡ä»¤å°±èƒ½è¾¦åˆ°</strong></p><p><strong>WiFi.softAP(â€œSSIDåç¨±â€)</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;WiFi.h&gt;  voidÂ setup()&#123;Â Â Â Â WiFi.softAP(&quot;ESP32ç„¡ç·šåŸºåœ°å°&quot;);&#125;voidÂ loop()&#123;&#125;  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä¸Šå‚³ä¹‹å¾Œåœ¨æ‰‹æ©Ÿç«¯æœå°‹WiFiå¯ä»¥çœ‹åˆ°ESP32é¡¯ç¤ºç‚ºåŸºåœ°å°åç¨±</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/801948207668992406#"><img src="https://lh3.googleusercontent.com/-I6zVUPbh2t8/YKdSssq03vI/AAAAAAAAeLI/W5jfwPBtPwc887winp2CTalxbKSl_xSzwCNcBGAsYHQ/s1600/1621578415343300-0.png"></a></p><p><strong>åšè©¦è·ŸESP32é€£ç·šä¹‹å¾Œï¼Œæ‰‹æ©Ÿæœ¬èº«çš„ç¶²è·¯åŠŸèƒ½å°‡ç„¡æ³•ä½¿ç”¨ã€‚</strong></p><hr><h2 id="è‡ªè¨‚åŸºåœ°å°ä¸¦è¨­å®šå›ºå®šIP"><a href="#è‡ªè¨‚åŸºåœ°å°ä¸¦è¨­å®šå›ºå®šIP" class="headerlink" title="è‡ªè¨‚åŸºåœ°å°ä¸¦è¨­å®šå›ºå®šï¼©ï¼°"></a>è‡ªè¨‚åŸºåœ°å°ä¸¦è¨­å®šå›ºå®šï¼©ï¼°</h2><p><strong>softAP(â€œSSIDâ€, å¯†ç¢¼, é€šé“)</strong></p><p><strong>SSID:åŸºåœ°å°åç¨±</strong></p><p><strong>å¯†ç¢¼:åŸºåœ°å°å¯†ç¢¼</strong></p><p><strong>é€šé“:1~13å€‹é€šé“å¯ä¾›é¸æ“‡</strong></p><p><strong>softAPConfig(IPä½å€, é–˜é“IPä½å€, å­ç¶²è·¯é®ç½©)</strong></p><p><strong>é ˆæ³¨æ„ä¸Šé¢æŒè™Ÿè£¡é è¨­å€¼åˆ†åˆ¥ç‚º192.168.4.1ï¼Œ192.168.4.1ï¼Œ255.255.255.0</strong></p><p>*<strong>ä¸€èˆ¬IPä½ç½®å’Œé–˜é“IPä½å€è¨­å®šç›¸åŒ</strong></p><p><strong>å› ç‚ºIPè¨­å®šçš„æ ¼å¼å¯èƒ½è¼ƒç‚ºè¤‡é›œï¼Œç¿’æ…£ä¸Šæœƒä½¿ç”¨IPAddressé¡åˆ¥ä¾†</strong></p><p><strong>å»ºç«‹ipï¼Œé–˜é“ipï¼Œå­ç¶²è·¯é®ç½©ã€‚</strong></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;WiFi.h&gt;IPAddressÂ local_IP(192,Â 168,Â 4,Â 11);IPAddressÂ gateway(192,Â 168,Â 4,Â 11);IPAddressÂ subnet(255,Â 255Â ,255,Â 0);constÂ charÂ *SSIDÂ &#x3D;Â &quot;ESP32åŸºåœ°å°&quot;;constÂ charÂ *passwordÂ &#x3D;Â &quot;ctk674011&quot;;voidÂ setup()&#123;Â Â Â Â Serial.begin(115200);Â Â Â Â WiFi.softAPConfig(local_IP,Â gateway,Â subnet);Â Â Â Â whileÂ (!WiFi.softAP(SSID,Â password))&#123;Â Â Â Â &#125;Â Â Â Â Serial.println(&quot;å•“å‹•æˆåŠŸ&quot;);Â Â Â Â Serial.print(&quot;IPä½å€:Â &quot;);Â Â Â Â Serial.println(WiFi.softAPIP());&#125;voidÂ loop()&#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ç¨‹å¼ä¸Šå‚³å¾Œå¦‚æœåŸºåœ°å°å•“å‹•æˆåŠŸï¼Œç€è¦½å™¨æœƒé¡¯ç¤ºå¦‚ä¸‹è³‡è¨Š</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/801948207668992406#"><img src="https://1.bp.blogspot.com/-crYRZRbaPA8/YKdRi7oX4PI/AAAAAAAAeK0/ivBD_2fyreYrHTiRHS59iVeQsWcfMqe7gCNcBGAsYHQ/w293-h303/%25E6%2593%25B7%25E5%258F%2596_2021_05_21_14_17_56_195.jpg"></a></p><p><strong>ç„¶å¾Œæ‰‹æ©ŸWiFiæœƒæœå°‹åˆ°ESP32åŸºåœ°å°çš„åç¨±ï¼Œè¼¸å…¥å‰›è¨­å®šçš„å¯†ç¢¼å³å¯é€£ç·š</strong></p><p><strong>ï¼Šæ‰‹æ©Ÿå’ŒESP32é€£ç·šå¾Œï¼Œæ‰‹æ©Ÿå°‡ç„¡æ³•é€£å¤–ç¶²ã€‚</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/801948207668992406#"><img src="https://lh3.googleusercontent.com/-QeQlaToWUVE/YKdSr-Y4OTI/AAAAAAAAeLE/Sp1uUgsegwMhx-SmZM5HR8QFY5ZOZucLgCNcBGAsYHQ/s1600/1621578412456247-1.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/801948207668992406#"><img src="https://lh3.googleusercontent.com/-cr2sa2BFcto/YKdSrfhHEkI/AAAAAAAAeLA/oA2qnepOO-MJL8S9LAJrvYemWHSvIk8vQCNcBGAsYHQ/s1600/1621578409821481-2.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/801948207668992406#"><img src="https://lh3.googleusercontent.com/-6aaKJ8_SzlQ/YKdSqtnZGCI/AAAAAAAAeK8/56YBZ12PQnkLhIv9z09KUHIrM_lmV2yYACNcBGAsYHQ/s1600/1621578407212556-3.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> esp32 </tag>
            
            <tag> wifi </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0.91å‹_OLEDå¯¦é©—</title>
      <link href="/2021/08/28/0-91-cun-oled-shi-yan/"/>
      <url>/2021/08/28/0-91-cun-oled-shi-yan/</url>
      
        <content type="html"><![CDATA[<h1 id="0-91å‹-OLEDå¯¦é©—"><a href="#0-91å‹-OLEDå¯¦é©—" class="headerlink" title="0.91å‹_OLEDå¯¦é©—"></a>0.91å‹_OLEDå¯¦é©—</h1><h6 id="tags-esp32-0-91oled"><a href="#tags-esp32-0-91oled" class="headerlink" title="tags: esp32 0.91oled"></a>tags: <code>esp32</code> <code>0.91oled</code></h6><hr><h2 id="æ›²æŠ˜é›¢å¥‡çš„0-91OLED"><a href="#æ›²æŠ˜é›¢å¥‡çš„0-91OLED" class="headerlink" title="æ›²æŠ˜é›¢å¥‡çš„0.91OLED"></a><em>æ›²æŠ˜é›¢å¥‡çš„0.91OLED</em></h2><p><strong>ç‚ºä»€éº¼æˆ‘é€™éº¼èªªå®ƒæ›²æŠ˜é›¢å¥‡,å› ç‚ºæˆ‘è©¦äº†å…©å¤©äº†</strong></p><p><strong>å¾æ·˜Bè²·å›ä¾†å…©å€‹,å› ç‚ºå¸¶åœ¨èº«é‚Šçš„ä¸€å€‹,å°±æ‹¿ä¾†</strong></p><p><strong>é–‹å§‹ç ”ç©¶,å…ˆæ˜¯ç”¨Adafriut_SSD1306åº«,çµæœéƒ½ä¸</strong></p><p><strong>æˆåŠŸ,å¾Œä¾†ä½¿ç”¨u8g2libä¹Ÿä¸è¡Œ,æ•´å€‹è«åçš„ğŸ’¥ğŸ’¥ğŸ’¥</strong></p><p><strong>ç„¶å¾Œç¬¬äºŒå¤©è¡å›å®¶æ‹¿å¦ä¸€å€‹OLEDä¾†è©¦,æ‰ç™¼ç¾</strong></p><p><strong>ç¬¬ä¸€å€‹OLEDå£çš„ï¼Œç„¶å¾Œæˆ‘åˆç”¨Adafriut_SSD1306</strong></p><p><strong>åº«è©¦ï¼Œä¸€æ¨£æ˜¯ä¸è¡Œï¼Œæœ€å¾Œæ‰¾åˆ°é€™å€‹<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1717125022706858388#">ssd1306</a>åº«(éAdafruit)</strong></p><p><strong>çµ‚æ–¼å¯ä»¥é¡¯ç¤ºäº†ã€‚</strong></p><hr><p><strong>åƒè€ƒ:</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1717125022706858388#">http://arduino-er.blogspot.com/2020/12/i2c-ssd1306-oledesp32-esp32-devkitc-v4.html?m=1</a>  </p><p><strong><em>å…ˆä¾†çœ‹çœ‹å¯¦éš›ä¸Šé¡¯ç¤ºçš„æ¨£å­</em></strong></p><p><strong>ä¾‹1:</strong></p><div class="video-container"><iframe src="https://www.youtube.com/embed/se70n6MqrS0" frameborder="0" loading="lazy" allowfullscreen></iframe></div><p><strong>ä¾‹2:</strong></p><div class="video-container"><iframe src="https://www.youtube.com/embed/oKcyi8UBHak" frameborder="0" loading="lazy" allowfullscreen></iframe></div><hr><p>h</p><p><a href="https://diyprojects.io/media/2020/10/091-inch-128x32-iic-i2c-blue-oled-lcd-display-diy-oled-module-ssd1306-driver-1-1024x1024.jpg"><img src="https://diyprojects.io/media/2020/10/091-inch-128x32-iic-i2c-blue-oled-lcd-display-diy-oled-module-ssd1306-driver-1-1024x1024.jpg"></a></p><p><strong>æ¥ç·šæ–¹å¾ˆç°¡å–®,ä¸»è¦æ˜¯ä½¿ç”¨I2Cå‚³è¼¸,æ‰€ä»¥åªè¦æŠŠ</strong></p><p>ESP32Â  Â  Â OLED</p><p>--------------------</p><p>3VÂ  Â  Â  |Â  Â  Â VCC</p><p>GNDÂ  |Â  Â  Â GND</p><p>SCLÂ  Â  |Â  Â  Â D22</p><p>SDAÂ  Â |Â  Â  Â D21</p><hr><p><strong>ç„¶å¾Œå°‡<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/1717125022706858388#">ssd1306</a>åº«æ”¾å…¥Arduino IDEåº«è£¡å°±è¡Œ</strong></p><h2 id="ç¨‹å¼ç¢¼"><a href="#ç¨‹å¼ç¢¼" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><p><strong>ä¾‹1:</strong></p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ssd1306.h"</span></span>  <span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">ssd1306_setFixedFont</span><span class="token punctuation">(</span>ssd1306xled_font8x16<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">ssd1306_128x32_i2c_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">ssd1306_clearScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  <span class="token keyword">void</span> <span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">ssd1306_setFixedFont</span><span class="token punctuation">(</span>ssd1306xled_font8x16<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">ssd1306_printFixed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"Hello World!!!"</span><span class="token punctuation">,</span> STYLE_BOLD<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">ssd1306_clearScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">textDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">ssd1306_clearScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä¾‹2:</strong></p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ssd1306.h"</span></span><span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">ssd1306_setFixedFont</span><span class="token punctuation">(</span>ssd1306xled_font8x16<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">ssd1306_128x32_i2c_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">ssd1306_clearScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">ssd1306_setFixedFont</span><span class="token punctuation">(</span>ssd1306xled_font8x16<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">ssd1306_print</span><span class="token punctuation">(</span><span class="token string">"Hello World!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">ssd1306_clearScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> esp32 </tag>
            
            <tag> OLED </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ESP32è§£æ±ºå¿…é ˆæŒ‰BOOTæ‰èƒ½ä¸Šå‚³çš„å°æ–¹æ³•</title>
      <link href="/2021/08/28/esp32-jie-jue-bi-xu-an-boot-cai-neng-shang-chuan-de-xiao-fang-fa/"/>
      <url>/2021/08/28/esp32-jie-jue-bi-xu-an-boot-cai-neng-shang-chuan-de-xiao-fang-fa/</url>
      
        <content type="html"><![CDATA[<h1 id="ESP32è§£æ±ºå¿…é ˆæŒ‰BOOTæ‰èƒ½ä¸Šå‚³çš„å°æ–¹æ³•"><a href="#ESP32è§£æ±ºå¿…é ˆæŒ‰BOOTæ‰èƒ½ä¸Šå‚³çš„å°æ–¹æ³•" class="headerlink" title="ESP32è§£æ±ºå¿…é ˆæŒ‰BOOTæ‰èƒ½ä¸Šå‚³çš„å°æ–¹æ³•"></a>ESP32è§£æ±ºå¿…é ˆæŒ‰BOOTæ‰èƒ½ä¸Šå‚³çš„å°æ–¹æ³•</h1><h6 id="tags-esp32-è‡ªå‹•ä¸Šå‚³"><a href="#tags-esp32-è‡ªå‹•ä¸Šå‚³" class="headerlink" title="tags: esp32 è‡ªå‹•ä¸Šå‚³"></a>tags: <code>esp32</code> <code>è‡ªå‹•ä¸Šå‚³</code></h6><p><strong>æœ€è¿‘é–‹å§‹ç©ESP32ç™¼ç¾æœ‰é»éº»ç…©çš„æ˜¯æ¯æ¬¡ä¸€ä¸Šå‚³åˆ°æ¿å­éƒ½è¦å’Œè·Ÿâ€¦.___â€¦.</strong></p><p><strong>è³½è·‘,å¾Œä¾†çœ‹åˆ°ç¤¾åœ˜ä¸Šæœ‰äº›å¤§å¤§æ•™å­¸ä½¿ç”¨10u~100uFçš„é›»å®¹å³å¯è§£æ±ºæ‰‹å‹•ä¸Šå‚³</strong></p><p><strong>çš„å›°æ“¾ï¼Œæ­£å¥½å…¬å¸æœ‰100uF çš„é›»å®¹,æ‹¿ä¾†è©¦è©¦æœçœŸå¯ä»¥å‘¢!!!</strong></p><p><strong>åƒè€ƒ:<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7627629995084093339#">https://blog.darkthread.net/blog/esp32-upload-timeout-fix/?fbclid=IwAR2LK8WYw0P28fvPJDFXoARzUGvGylDiDCZUkpFhwD9u2TXvTX-yvM8yBGw</a></strong></p><p><strong>æ–¹æ³•å¾ˆç°¡å–®ï¼Œåªè¦æ‹¿åˆ°é›»å®¹ï¼Œå°‡é›»å®¹æ­£ç«¯ç„Šåœ¨ENï¼Œè² ç«¯ç„Šåœ¨GNDï¼Œé€™æ¨£å°±è¡Œäº†ã€‚</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7627629995084093339#"><img src="https://lh3.googleusercontent.com/-s_bry0zMywg/YK2yct35J8I/AAAAAAAAeM4/stIzQCfRT2cHLZNzMPnxxpC1YsXVbeS8ACNcBGAsYHQ/s1600/1621996128028104-0.png"></a></p><p><a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/7627629995084093339#"><img src="https://lh3.googleusercontent.com/-jJ-hOL_8GZg/YK2yXokvQFI/AAAAAAAAeM0/PLUQjbiaHfsRFYvit0UBIWz6vVgwRqp5wCNcBGAsYHQ/s1600/1621996094011888-1.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> esp32 </tag>
            
            <tag> è‡ªå‹•ä¸Šå‚³ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…©å€‹ESP32è—èŠ½ä¸»å¾ç«¯äº’è¯</title>
      <link href="/2021/08/28/liang-ge-esp32-lan-ya-zhu-cong-duan-hu-lian/"/>
      <url>/2021/08/28/liang-ge-esp32-lan-ya-zhu-cong-duan-hu-lian/</url>
      
        <content type="html"><![CDATA[<h1 id="å…©å€‹ESP32è—èŠ½ä¸»å¾ç«¯äº’è¯"><a href="#å…©å€‹ESP32è—èŠ½ä¸»å¾ç«¯äº’è¯" class="headerlink" title="å…©å€‹ESP32è—èŠ½ä¸»å¾ç«¯äº’è¯"></a>å…©å€‹ESP32è—èŠ½ä¸»å¾ç«¯äº’è¯</h1><h6 id="tags-esp32-è—èŠ½"><a href="#tags-esp32-è—èŠ½" class="headerlink" title="tags: esp32 è—èŠ½"></a>tags: <code>esp32</code> <code>è—èŠ½</code></h6><hr><h2 id="å¾ç«¯ç¨‹å¼ç¢¼å¯åƒè€ƒ-è—èŠ½åŸºæœ¬é€šè¨Š-amp-æ§åˆ¶LED-ESP32"><a href="#å¾ç«¯ç¨‹å¼ç¢¼å¯åƒè€ƒ-è—èŠ½åŸºæœ¬é€šè¨Š-amp-æ§åˆ¶LED-ESP32" class="headerlink" title="å¾ç«¯ç¨‹å¼ç¢¼å¯åƒè€ƒ-è—èŠ½åŸºæœ¬é€šè¨Š&amp;æ§åˆ¶LED-ESP32"></a>å¾ç«¯ç¨‹å¼ç¢¼å¯åƒè€ƒ-<a href="https://draft.blogger.com/blog/post/edit/3809681606094011522/2055229884501562897#">è—èŠ½åŸºæœ¬é€šè¨Š&amp;æ§åˆ¶LED-ESP32</a></h2><hr><p>ç¾åœ¨åˆ©ç”¨å…©å€‹ESP32çš„è—èŠ½äº’ç›¸æºé€šï¼Œæ‰€ä»¥ä¸€å€‹è¦ç•¶â€ä¸»(Master)â€,å¦ä¸€å€‹</p><p>è¦ç•¶â€å¾(slave)â€ã€‚</p><h3 id="ä¸»ç«¯ç¨‹å¼ç¢¼"><a href="#ä¸»ç«¯ç¨‹å¼ç¢¼" class="headerlink" title="ä¸»ç«¯ç¨‹å¼ç¢¼"></a>ä¸»ç«¯ç¨‹å¼ç¢¼</h3><p>å…ˆå°‡ä¸»ç«¯ç¨‹å¼ç¢¼ä¸Šå‚³è‡³esp32-1</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;BluetoothSerial.h&gt;&#x2F;&#x2F;masterBluetoothSerialÂ myBTmaster; --å»ºç«‹ä¸»ç«¯ç‰©ä»¶åconstÂ StringÂ slave&#x3D;&quot;myBTslave&quot;; --&quot; &quot;è£¡é¢æ˜¯å¾ç«¯è—èŠ½å  constÂ charÂ *PIN&#x3D;&quot;1234&quot;;--é è¨­çš„pinç¢¼boolÂ connected; --voidÂ setup()&#123;Â Â Â Â myBTmaster.begin(&quot;bt-master&quot;,Â true); --è¨­å®šä¸»ç«¯åå’Œè¨­æˆä¸»æ§ç«¯Â Â Â Â Serial.begin(115200);Â Â Â Â Serial.printf(&quot;è—èŠ½å·²å•“å‹•,é€²å…¥masteræ¨¡å¼\\n&quot;);Â Â Â Â Serial.println(&quot;é€£ç·šä¸­...&quot;);Â Â Â Â connected&#x3D;myBTmaster.connect(slave); --æª¢æŸ¥æ˜¯å¦å·²é€£çµå¾ç«¯è—èŠ½Â Â Â Â ifÂ (connected)&#123;Â Â Â Â Â Â Â Â Serial.println(&quot;é€£ç·šæˆåŠŸ&quot;);Â Â Â Â &#125;&#125;voidÂ loop()&#123;Â Â Â Â myBTmaster.println(&quot;1&quot;);Â Â Â Â delay(300);Â Â Â Â myBTmaster.println(&quot;0&quot;);Â Â Â Â delay(300);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å¾ç«¯ç¨‹å¼ç¢¼"><a href="#å¾ç«¯ç¨‹å¼ç¢¼" class="headerlink" title="å¾ç«¯ç¨‹å¼ç¢¼"></a>å¾ç«¯ç¨‹å¼ç¢¼</h3><p>å†å°‡å¾ç«¯ç¨‹å¼ç¢¼ä¸Šå‚³è‡³esp32-2</p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">#include &lt;BluetoothSerial.h&gt;&#x2F;&#x2F;slaveBluetoothSerialÂ myBTslave;charÂ incomeData;voidÂ setup()&#123;Â Â Â Â myBTslave.begin(&quot;bt-slave&quot;); â€”â€”å»ºç«‹å¾ç«¯è—èŠ½åç¨±Â Â Â Â pinMode(LED_BUILTIN,Â OUTPUT);&#125;  voidÂ loop()&#123;Â Â Â Â incomeData&#x3D;myBTslave.read();Â Â Â Â ifÂ (incomeData&#x3D;&#x3D;&#39;1&#39;)&#123;Â Â Â Â Â Â Â Â digitalWrite(LED_BUILTIN,Â HIGH);Â Â Â Â &#125;else if (incomeData&#x3D;&#x3D;&#39;0&#39;)&#123;Â Â Â Â Â Â Â Â digitalWrite(LED_BUILTIN,Â LOW);Â Â Â Â &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p><strong>éƒ½ä¸Šå‚³å®Œä¹‹å¾Œå°‡å…©å¡Šæ¿å­resetï¼Œå¦‚æœæˆåŠŸï¼Œæœƒçœ‹åˆ°å¾ç«¯æ¿å­ä¸Šçš„å…§å»ºLEDé–ƒçˆ</strong></p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> esp32 </tag>
            
            <tag> è—èŠ½ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WiFiç¶²è·¯é€£æ¥</title>
      <link href="/2021/08/28/wifi-wang-lu-lian-jie/"/>
      <url>/2021/08/28/wifi-wang-lu-lian-jie/</url>
      
        <content type="html"><![CDATA[<h1 id="WiFiç¶²è·¯é€£æ¥"><a href="#WiFiç¶²è·¯é€£æ¥" class="headerlink" title="WiFiç¶²è·¯é€£æ¥"></a>WiFiç¶²è·¯é€£æ¥</h1><h6 id="tags-micropython-WiFi"><a href="#tags-micropython-WiFi" class="headerlink" title="tags: micropython WiFi"></a>tags: <code>micropython</code> <code>WiFi</code></h6><hr><h2 id="micropython-ESP32ä¸‹ç¶²è·¯é€£æ¥çš„æ¨¡å¼å¯åˆ†ç‚º"><a href="#micropython-ESP32ä¸‹ç¶²è·¯é€£æ¥çš„æ¨¡å¼å¯åˆ†ç‚º" class="headerlink" title="micropython ESP32ä¸‹ç¶²è·¯é€£æ¥çš„æ¨¡å¼å¯åˆ†ç‚º"></a>micropython ESP32ä¸‹ç¶²è·¯é€£æ¥çš„æ¨¡å¼å¯åˆ†ç‚º</h2><ul><li>  STA:åšç‚ºç«™é»æ¥å…¥WiFi</li><li>  AP:åšç‚ºç†±é»,å……è¨±å…¶å®ƒè¨­å‚™æ¥å…¥</li></ul><h2 id="å‡½å¼åƒè€ƒ-micropythonå‡½å¼ç­†è¨˜æœ¬"><a href="#å‡½å¼åƒè€ƒ-micropythonå‡½å¼ç­†è¨˜æœ¬" class="headerlink" title="å‡½å¼åƒè€ƒ-micropythonå‡½å¼ç­†è¨˜æœ¬"></a>å‡½å¼åƒè€ƒ-<a href="https://draft.blogger.com/blog/post/edit/6280040346040914276/8403042239316796526#">micropythonå‡½å¼ç­†è¨˜æœ¬</a></h2><h2 id="ç†±é»æ¨¡å¼-AP"><a href="#ç†±é»æ¨¡å¼-AP" class="headerlink" title="ç†±é»æ¨¡å¼(AP)"></a>ç†±é»æ¨¡å¼(AP)</h2><p>ç†±é»æ¨¡å¼å…è¨±ç”¨æˆ¶å°‡è‡ªå·±çš„ESP32é…ç½®ç‚ºç†±é»ï¼Œé€™è®“å¤šå€‹ESP32èŠ¯ç‰‡ä¹‹é–“çš„ç„¡ç·šé€£æ¥åœ¨ä¸å€ŸåŠ©å¤–éƒ¨è·¯ç”±å™¨ç¶²çµ¡çš„æƒ…æ³ä¸‹æˆç‚ºå¯èƒ½ã€‚ </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> networkap <span class="token operator">=</span> network<span class="token punctuation">.</span>wifi<span class="token punctuation">(</span>network<span class="token punctuation">.</span>AP_IF<span class="token punctuation">)</span> <span class="token comment"># å‰µå»ºç†±é»</span>ap<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>         <span class="token comment"># å»ºç«‹ç†±é»</span>ap<span class="token punctuation">.</span>config<span class="token punctuation">(</span>ssid<span class="token operator">=</span><span class="token string">'ESP-AP'</span><span class="token punctuation">)</span> <span class="token comment"># å»ºç«‹ç†±é»åç¨±</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ç«™é»æ¨¡å¼-STA"><a href="#ç«™é»æ¨¡å¼-STA" class="headerlink" title="ç«™é»æ¨¡å¼(STA)"></a>ç«™é»æ¨¡å¼(STA)</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> networkssid<span class="token operator">=</span><span class="token string">"åŸºåœ°å°åç¨±"</span>password<span class="token operator">=</span><span class="token string">"å¯†ç¢¼"</span>wifi<span class="token operator">=</span>network<span class="token punctuation">.</span>WLAN<span class="token punctuation">(</span>network<span class="token punctuation">.</span>STA_IF<span class="token punctuation">)</span>wifi<span class="token punctuation">.</span>active<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>wifi<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token keyword">while</span> wifi<span class="token punctuation">.</span>isconnected<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token boolean">False</span><span class="token punctuation">:</span>  <span class="token keyword">pass</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connrcted success"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>wifi<span class="token punctuation">.</span>ifconfig<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="çµæœé¡¯ç¤º"><a href="#çµæœé¡¯ç¤º" class="headerlink" title="çµæœé¡¯ç¤º"></a>çµæœé¡¯ç¤º</h3><p><em><strong>å…¶ä¸­â€™192.168.243.124â€™å°±æ˜¯localIP</strong></em></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">&gt;&gt;&gt;Â TrueconnrctedÂ success(&#39;192.168.243.124&#39;,Â &#39;255.255.255.0&#39;,Â &#39;192.168.243.101&#39;,Â &#39;192.168.243.101&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> esp32 </tag>
            
            <tag> wifi </tag>
            
            <tag> micropython </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŒ‰éˆ•æ§åˆ¶LED-micropython</title>
      <link href="/2021/08/28/an-niu-kong-zhi-led-micropython/"/>
      <url>/2021/08/28/an-niu-kong-zhi-led-micropython/</url>
      
        <content type="html"><![CDATA[<h1 id="æŒ‰éˆ•æ§åˆ¶LEDâ€“micropython"><a href="#æŒ‰éˆ•æ§åˆ¶LEDâ€“micropython" class="headerlink" title="æŒ‰éˆ•æ§åˆ¶LEDâ€“micropython"></a>æŒ‰éˆ•æ§åˆ¶LEDâ€“micropython</h1><h6 id="tags-micropython"><a href="#tags-micropython" class="headerlink" title="tags: micropython"></a>tags: <code>micropython</code></h6><h2 id="æ¥ç·š"><a href="#æ¥ç·š" class="headerlink" title="æ¥ç·š"></a>æ¥ç·š</h2><p><a href="https://i0.wp.com/randomnerdtutorials.com/wp-content/uploads/2019/04/led_button_esp32_bb.png?w=1065&quality=100&strip=all&ssl=1"><img src="https://i0.wp.com/randomnerdtutorials.com/wp-content/uploads/2019/04/led_button_esp32_bb.png?w=1065&quality=100&strip=all&ssl=1"></a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep  led <span class="token operator">=</span> Pin<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> Pin<span class="token punctuation">.</span>OUT<span class="token punctuation">)</span>button <span class="token operator">=</span> Pin<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> Pin<span class="token punctuation">.</span>IN<span class="token punctuation">)</span>  <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    led<span class="token punctuation">.</span>value<span class="token punctuation">(</span>button<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><p><strong>é¦–å…ˆå¾machineè¼‰å…¥Pinï¼Œå¾timeè¼‰å…¥sleep</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> machine <span class="token keyword">import</span> Pin <span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>ä¸‹é¢è·¨è™Ÿæœ‰å…©å€‹åƒæ•¸ï¼Œï¼•æ˜¯esp32ä¸Šçš„GPIOæ¥è…³ï¼ŒPin.OUTè¡¨ç¤ºç¬¬5è…³ä½é è¨­ç‚ºè¼¸å‡º</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">led <span class="token operator">=</span> Pin<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> Pin<span class="token punctuation">.</span>OUT<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å’Œä¸Šé¢ä¸€æ¨£é“ç†ï¼Œåªä¸éç¬¬äºŒå€‹åƒæ•¸æ˜¯ç”¨Pin.INè¡¨ç¤ºæŒ‰éˆ•æ˜¯ä»¥è¼¸å…¥çš„æ–¹å¼è¨­å®š</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">button <span class="token operator">=</span> Pin<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> Pin<span class="token punctuation">.</span>IN<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>ç•¶æˆ‘å€‘æŒ‰ä¸‹æŒ‰éˆ•æ™‚ï¼Œbutton.value() è¿”å› 1ã€‚å› æ­¤ï¼Œé€™èˆ‡ led.value(1) ç›¸åŒã€‚é€™æœƒå°‡ LED ç‹€æ…‹è¨­ç½®ç‚º 1ï¼Œé»äº® LEDã€‚ç•¶æŒ‰éˆ•æœªè¢«æŒ‰ä¸‹æ™‚ï¼Œbutton.value() è¿”å› 0ã€‚å› æ­¤ï¼Œæˆ‘å€‘æœ‰ led.value(0)ï¼Œä¸¦ä¸” LED ä¿æŒé—œé–‰ç‹€æ…‹ã€‚</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">led<span class="token punctuation">.</span>value<span class="token punctuation">(</span>button<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="å¯¦ä½œçµæœ"><a href="#å¯¦ä½œçµæœ" class="headerlink" title="å¯¦ä½œçµæœ"></a>å¯¦ä½œçµæœ</h2><div class="video-container"><iframe src="https://www.youtube.com/embed/4boMaNGBm8I" frameborder="0" loading="lazy" allowfullscreen></iframe></div>]]></content>
      
      
      <categories>
          
          <category> micropython </category>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> led </tag>
            
            <tag> micropython </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MediaPipe+UNOæ‰‹å‹¢æ§åˆ¶ä¼ºæœé¦¬é”</title>
      <link href="/2021/08/28/mediapipe-uno-shou-shi-kong-zhi-si-fu-ma-da/"/>
      <url>/2021/08/28/mediapipe-uno-shou-shi-kong-zhi-si-fu-ma-da/</url>
      
        <content type="html"><![CDATA[<h1 id="MediaPipe-UNOæ‰‹å‹¢æ§åˆ¶ä¼ºæœé¦¬é”"><a href="#MediaPipe-UNOæ‰‹å‹¢æ§åˆ¶ä¼ºæœé¦¬é”" class="headerlink" title="MediaPipe+UNOæ‰‹å‹¢æ§åˆ¶ä¼ºæœé¦¬é”"></a>MediaPipe+UNOæ‰‹å‹¢æ§åˆ¶ä¼ºæœé¦¬é”</h1><h6 id="tags-mediapipe-arduino-servo"><a href="#tags-mediapipe-arduino-servo" class="headerlink" title="tags: mediapipe arduino servo"></a>tags: <code>mediapipe</code> <code>arduino</code> <code>servo</code></h6><p><strong>åƒè€ƒè¦–é »ç¶²å€:</strong></p><p><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/5177980124815283469#">https://youtu.be/9iEPzbG-xLE</a></p><h3 id="MediaPipe"><a href="#MediaPipe" class="headerlink" title="MediaPipe"></a><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/5177980124815283469#">MediaPipe</a></h3><p>ç°¡å–®ä¾†èªªæ˜¯googleè·¨å¹³å°è€Œä¸”é–‹æºçš„æ©Ÿå™¨å­¸ç¿’é‹ç”¨</p><p>MediaPipeæ˜¯ä¸€æ¬¾ç”±Googleé–‹ç™¼ä¸¦é–‹æºçš„æ•¸æ“šæµè™•ç†æ©Ÿå™¨å­¸ç¿’æ‡‰ç”¨é–‹ç™¼æ¡†æ¶ã€‚å®ƒæ˜¯ä¸€å€‹åŸºæ–¼åœ–çš„æ•¸æ“šè™•ç†ç®¡ç·šï¼Œç”¨æ–¼æ§‹å»ºä½¿ç”¨äº†å¤šç¨®å½¢å¼çš„æ•¸æ“šæºï¼Œå¦‚è¦–é »ã€éŸ³é »ã€å‚³æ„Ÿå™¨æ•¸æ“šä»¥åŠä»»ä½•æ™‚é–“åºåˆ—æ•¸æ“šã€‚ MediaPipeæ˜¯è·¨å¹³å°çš„ï¼Œå¯ä»¥é‹è¡Œåœ¨åµŒå…¥å¼å¹³å°(æ¨¹è“æ´¾ç­‰)ï¼Œç§»å‹•è¨­å‚™(iOSå’ŒAndroid)ï¼Œå·¥ä½œç«™å’Œæœå‹™å™¨ä¸Šï¼Œä¸¦æ”¯æŒç§»å‹•ç«¯GPUåŠ é€Ÿã€‚ä½¿ç”¨MediaPipeï¼Œå¯ä»¥å°‡æ©Ÿå™¨å­¸ç¿’ä»»å‹™æ§‹å»ºç‚ºä¸€å€‹åœ–å½¢çš„æ¨¡å¡Šè¡¨ç¤ºçš„æ•¸æ“šæµç®¡é“ï¼Œå¯ä»¥åŒ…æ‹¬æ¨ç†æ¨¡å‹å’Œæµåª’é«”è™•ç†åŠŸèƒ½ã€‚</p><h3 id="pinpong"><a href="#pinpong" class="headerlink" title="pinpong"></a><a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/5177980124815283469#">pinpong</a></h3><p>pinpongåº«æ˜¯ä¸€å¥—æ§åˆ¶é–‹æºç¡¬ä»¶ä¸»æ§æ¿çš„Pythonåº«</p><p>ï¼ŒåŸºæ–¼Firmataå”è­°ä¸¦å…¼å®¹MicroPythonèªæ³•ï¼Œ5åˆ†é˜å³å¯è®“ä½ ä¸Šæ‰‹ä½¿ç”¨Pythonæ§åˆ¶é–‹æºç¡¬ä»¶ã€‚</p><p>æœ‰èˆˆè¶£å¯ä»¥åˆ°<a href="https://draft.blogger.com/blog/post/edit/6959160158145357673/5177980124815283469#">pinpongå®˜ç¶²</a>çœ‹ä¸€ä¸‹ï¼Œ</p><p>æˆ‘æ˜¯ä½¿ç”¨pycharmï¼Œæ‰€ä»¥é¦–å…ˆå®‰è£opencv-pythonï¼Œmediapipeå’Œpinpongé€™å…©å€‹ä¸»è¦çš„ç¨‹å¼åº«</p><h2 id="æ­¥é©Ÿ1"><a href="#æ­¥é©Ÿ1" class="headerlink" title="æ­¥é©Ÿ1:"></a>æ­¥é©Ÿ1:</h2><p><strong>å…ˆæŠŠé€™å€‹ç¨‹å¼åº«å‘½åç‚ºhandutil.pyå’Œä¸»ç¨‹å¼æ”¾ä¸€èµ·</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> cv2  <span class="token keyword">import</span> mediapipe <span class="token keyword">as</span> mp    <span class="token keyword">class</span> <span class="token class-name">HandDetector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token triple-quoted-string string">'''     æ‰‹åŠ¿è¯†åˆ«ç±»  '''</span>   <span class="token keyword">def</span> <span class="token function">_init_</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> max_hands<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> detection_con<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> track_con<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token triple-quoted-string string">'''     åˆå§‹åŒ–     :param mode: æ˜¯å¦é™æ€å›¾ç‰‡ï¼Œé»˜è®¤ä¸ºFalse     :param max_hands: æœ€å¤šå‡ åªæ‰‹ï¼Œé»˜è®¤ä¸º2åª     :param detection_con: æœ€å°æ£€æµ‹ä¿¡åº¦å€¼ï¼Œé»˜è®¤ä¸º0.5     :param track_con: æœ€å°è·Ÿè¸ªä¿¡åº¦å€¼ï¼Œé»˜è®¤ä¸º0.5   '''</span>       self<span class="token punctuation">.</span>mode <span class="token operator">=</span> mode      self<span class="token punctuation">.</span>max_hands <span class="token operator">=</span> max_hands      self<span class="token punctuation">.</span>detection_con <span class="token operator">=</span> detection_con      self<span class="token punctuation">.</span>track_con <span class="token operator">=</span> track_con      self<span class="token punctuation">.</span>hands <span class="token operator">=</span> mp<span class="token punctuation">.</span>solutions<span class="token punctuation">.</span>hands<span class="token punctuation">.</span>Hands<span class="token punctuation">(</span>self<span class="token punctuation">.</span>mode<span class="token punctuation">,</span> self<span class="token punctuation">.</span>max_hands<span class="token punctuation">,</span> self<span class="token punctuation">.</span>detection_con<span class="token punctuation">,</span> self<span class="token punctuation">.</span>track_con<span class="token punctuation">)</span>        <span class="token keyword">def</span> <span class="token function">find_hands</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> img<span class="token punctuation">,</span> draw<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>          <span class="token triple-quoted-string string">'''     æ£€æµ‹æ‰‹åŠ¿     :param img: è§†é¢‘å¸§å›¾ç‰‡     :param draw: æ˜¯å¦ç”»å‡ºæ‰‹åŠ¿ä¸­çš„èŠ‚ç‚¹å’Œè¿æ¥å›¾     :return: å¤„ç†è¿‡çš„è§†é¢‘å¸§å›¾ç‰‡   '''</span>   imgRGB <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2RGB<span class="token punctuation">)</span>          <span class="token comment"># å¤„ç†å›¾ç‰‡ï¼Œæ£€æµ‹æ˜¯å¦æœ‰æ‰‹åŠ¿ï¼Œå°†æ•°æ®å­˜è¿›self.resultsä¸­  </span>        self<span class="token punctuation">.</span>results <span class="token operator">=</span> self<span class="token punctuation">.</span>hands<span class="token punctuation">.</span>process<span class="token punctuation">(</span>imgRGB<span class="token punctuation">)</span>                  <span class="token keyword">if</span> draw<span class="token punctuation">:</span>                      <span class="token keyword">if</span> self<span class="token punctuation">.</span>results<span class="token punctuation">.</span>multi_hand_landmarks<span class="token punctuation">:</span>                          <span class="token keyword">for</span> handlms <span class="token keyword">in</span> self<span class="token punctuation">.</span>results<span class="token punctuation">.</span>multi_hand_landmarks<span class="token punctuation">:</span>                              mp<span class="token punctuation">.</span>solutions<span class="token punctuation">.</span>drawing_utils<span class="token punctuation">.</span>draw_landmarks<span class="token punctuation">(</span>img<span class="token punctuation">,</span> handlms<span class="token punctuation">,</span> mp<span class="token punctuation">.</span>solutions<span class="token punctuation">.</span>hands<span class="token punctuation">.</span>HAND_CONNECTIONS<span class="token punctuation">)</span>          <span class="token keyword">return</span> img        <span class="token keyword">def</span> <span class="token function">find_positions</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> img<span class="token punctuation">,</span> hand_no<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>          <span class="token triple-quoted-string string">'''     è·å–æ‰‹åŠ¿æ•°æ®     :param img: è§†é¢‘å¸§å›¾ç‰‡     :param hand_no: æ‰‹ç¼–å·ï¼ˆé»˜è®¤ç¬¬1åªæ‰‹ï¼‰     :return: æ‰‹åŠ¿æ•°æ®åˆ—è¡¨ï¼Œæ¯ä¸ªæ•°æ®æˆå‘˜ç”±id, x, yç»„æˆï¼Œä»£ç è¿™ä¸ªæ‰‹åŠ¿ä½ç½®ç¼–å·ä»¥åŠåœ¨å±å¹•ä¸­çš„ä½ç½®      '''</span>           self<span class="token punctuation">.</span>lmslist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>          <span class="token keyword">if</span> self<span class="token punctuation">.</span>results<span class="token punctuation">.</span>multi_hand_landmarks<span class="token punctuation">:</span>              hand <span class="token operator">=</span> self<span class="token punctuation">.</span>results<span class="token punctuation">.</span>multi_hand_landmarks<span class="token punctuation">[</span>hand_no<span class="token punctuation">]</span>              <span class="token keyword">for</span> <span class="token builtin">id</span><span class="token punctuation">,</span> lm <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>hand<span class="token punctuation">.</span>landmark<span class="token punctuation">)</span><span class="token punctuation">:</span>                  h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> c <span class="token operator">=</span> img<span class="token punctuation">.</span>shape                  cx<span class="token punctuation">,</span> cy <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>lm<span class="token punctuation">.</span>x <span class="token operator">*</span> w<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>lm<span class="token punctuation">.</span>y <span class="token operator">*</span> h<span class="token punctuation">)</span>                  self<span class="token punctuation">.</span>lmslist<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">id</span><span class="token punctuation">,</span> cx<span class="token punctuation">,</span> cy<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> self<span class="token punctuation">.</span>lmslist<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="æ­¥é©Ÿ2"><a href="#æ­¥é©Ÿ2" class="headerlink" title="æ­¥é©Ÿ2:"></a>æ­¥é©Ÿ2:</h2><h2 id="è¤‡åˆ¶è²¼ä¸Šä¸»ç¨‹å¼"><a href="#è¤‡åˆ¶è²¼ä¸Šä¸»ç¨‹å¼" class="headerlink" title="è¤‡åˆ¶è²¼ä¸Šä¸»ç¨‹å¼"></a><strong>è¤‡åˆ¶è²¼ä¸Šä¸»ç¨‹å¼</strong></h2><h2 id="é€™è£¡ç•™æ„ä¸€ä¸‹è¨ˆç®—æ–œè§’è½‰æˆè§’åº¦çš„å…¬å¼"><a href="#é€™è£¡ç•™æ„ä¸€ä¸‹è¨ˆç®—æ–œè§’è½‰æˆè§’åº¦çš„å…¬å¼" class="headerlink" title="*é€™è£¡ç•™æ„ä¸€ä¸‹è¨ˆç®—æ–œè§’è½‰æˆè§’åº¦çš„å…¬å¼"></a>*<strong>é€™è£¡ç•™æ„ä¸€ä¸‹è¨ˆç®—æ–œè§’è½‰æˆè§’åº¦çš„å…¬å¼</strong></h2><h3 id="ç®—å‡ºè§’åº¦"><a href="#ç®—å‡ºè§’åº¦" class="headerlink" title="ç®—å‡ºè§’åº¦:"></a>ç®—å‡ºè§’åº¦:</h3><pre class="line-numbers language-none"><code class="language-none">å‡å¦‚ä¸¤ç‚¹åæ ‡åˆ†åˆ«æ˜¯ï¼ˆx1ï¼Œy1ï¼‰ï¼ˆx2ï¼Œy2ï¼‰é‚£ä¹ˆæ–œç‡æ˜¯ï¼šï¼ˆy2-y1ï¼‰&#x2F;ï¼ˆx2-x1ï¼‰k&#x3D;(y2-y1)&#x2F;(x2-x1) å…¶ä¸­(x1,y1),(x2,y2) æ˜¯å·²çŸ¥ä¸¤ç‚¹çš„åæ ‡å·²çŸ¥A(x1ï¼Œy1)ï¼ŒB(x2ï¼Œy2)  1ã€è‹¥x1&#x3D;x2ï¼Œåˆ™æ–œç‡ä¸å­˜åœ¨ï¼›  2ã€è‹¥x1â‰ x2ï¼Œåˆ™æ–œç‡k&#x3D;(y2ï¼y1)&#x2F;(x2ï¼x1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç®—å‡ºå¼§åº¦"><a href="#ç®—å‡ºå¼§åº¦" class="headerlink" title="ç®—å‡ºå¼§åº¦:"></a><strong>ç®—å‡ºå¼§åº¦:</strong></h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> mathmath<span class="token punctuation">.</span>degrees<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">**</span>xç‚ºä¸€å€‹å€¼<span class="token operator">**</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> cv2  <span class="token keyword">from</span> HandTrackingMoudle <span class="token keyword">import</span> handDetector  <span class="token keyword">import</span> math  <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np  <span class="token keyword">from</span> pinpong<span class="token punctuation">.</span>board <span class="token keyword">import</span> Board<span class="token punctuation">,</span> Pin<span class="token punctuation">,</span> Servo  <span class="token keyword">import</span> time    Board<span class="token punctuation">(</span><span class="token string">"uno"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>begin<span class="token punctuation">(</span><span class="token punctuation">)</span>  myServo <span class="token operator">=</span> Servo<span class="token punctuation">(</span>Pin<span class="token punctuation">(</span>Pin<span class="token punctuation">.</span>A0<span class="token punctuation">)</span><span class="token punctuation">)</span>    cap <span class="token operator">=</span> cv2<span class="token punctuation">.</span>VideoCapture<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    detector <span class="token operator">=</span> handDetector<span class="token punctuation">(</span><span class="token punctuation">)</span>  angle <span class="token operator">=</span> <span class="token number">0</span>  <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>      success<span class="token punctuation">,</span> img <span class="token operator">=</span> cap<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>      img <span class="token operator">=</span> detector<span class="token punctuation">.</span>findHands<span class="token punctuation">(</span>img<span class="token punctuation">,</span> draw<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>      lmList <span class="token operator">=</span> detector<span class="token punctuation">.</span>findPosition<span class="token punctuation">(</span>img<span class="token punctuation">,</span> personDraw<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>      <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>lmList<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>          <span class="token keyword">print</span><span class="token punctuation">(</span>lmList<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> lmList<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>          x1<span class="token punctuation">,</span> y1 <span class="token operator">=</span> lmList<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> lmList<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>          x2<span class="token punctuation">,</span> y2 <span class="token operator">=</span> lmList<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> lmList<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>          cv2<span class="token punctuation">.</span>circle<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>FILLED<span class="token punctuation">)</span>          cv2<span class="token punctuation">.</span>circle<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">(</span>x2<span class="token punctuation">,</span> y2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>FILLED<span class="token punctuation">)</span>          cv2<span class="token punctuation">.</span>line<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x2<span class="token punctuation">,</span> y2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>x1 <span class="token operator">-</span> x2<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>              angle <span class="token operator">=</span> math<span class="token punctuation">.</span>degrees<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arctan<span class="token punctuation">(</span><span class="token punctuation">(</span>y2 <span class="token operator">-</span> y1<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>x2 <span class="token operator">-</span> x1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>              a <span class="token operator">=</span> <span class="token number">180</span> <span class="token operator">-</span> angle              myServo<span class="token punctuation">.</span>write_angle<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>              <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>          <span class="token keyword">if</span> angle <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>              angle <span class="token operator">=</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>angle<span class="token punctuation">)</span>              myServo<span class="token punctuation">.</span>write_angle<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>angle<span class="token punctuation">)</span><span class="token punctuation">)</span>              <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>angle<span class="token punctuation">)</span><span class="token punctuation">)</span>          cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"Image"</span><span class="token punctuation">,</span> img<span class="token punctuation">)</span>      cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ­¥é©Ÿ3"><a href="#æ­¥é©Ÿ3" class="headerlink" title="æ­¥é©Ÿ3:"></a>æ­¥é©Ÿ3:</h2><h2 id="åŸ·è¡Œç¨‹å¼ç¢¼"><a href="#åŸ·è¡Œç¨‹å¼ç¢¼" class="headerlink" title="åŸ·è¡Œç¨‹å¼ç¢¼"></a>åŸ·è¡Œç¨‹å¼ç¢¼</h2><div class="video-container"><iframe src="https://www.youtube.com/embed/tTvcI0AKj-U" frameborder="0" loading="lazy" allowfullscreen></iframe></div><hr>]]></content>
      
      
      <categories>
          
          <category> mediapipe </category>
          
          <category> arduino </category>
          
      </categories>
      
      
        <tags>
            
            <tag> servo </tag>
            
            <tag> mediapipe </tag>
            
            <tag> arduino </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
